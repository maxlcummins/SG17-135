Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 36
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	fasttree
	1	gubbins
	1	snippy_clean
	1	snippy_core
	199	snippy_run
	1	snp_dists
	1	snp_sites
	206

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1353AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out
    jobid: 190
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1353AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1353AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
    jobid: 174
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PB5476AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
    jobid: 165
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB7879AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB2995AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out
    jobid: 69
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB2995AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB2995AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9821AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out
    jobid: 85
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9821AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9821AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0612AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out
    jobid: 134
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB0612AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0612AA_AS.fasta

[Tue Jun 16 08:21:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
    jobid: 44
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB7066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] This is snippy 4.4.3
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Written by Torsten Seemann
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] This is snippy 4.4.3
[08:21:36] Written by Torsten Seemann
[08:21:36] Obtained from https://github.com/tseemann/snippy
[08:21:36] Detected operating system: linux
[08:21:36] Enabling bundled linux tools.
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found gzip - /usr/bin/gzip
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:21:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB2995AA_AS.fasta
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0612AA_AS.fasta
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1353AA_AS.fasta
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9821AA_AS.fasta
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Creating reference folder: reference
[08:21:36] Treating reference as 'fasta' format.
[08:21:36] Will use 8 CPU cores.
[08:21:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
[08:21:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[08:21:36] Creating reference folder: reference
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Extracting FASTA and GFF from reference.
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0612AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1353AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB2995AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9821AA_AS.fasta into pseudo-reads
[08:21:36] Wrote 3 sequences to ref.fa
[08:21:36] Wrote 0 features to ref.gff
[08:21:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta into pseudo-reads
[08:21:39] Wrote 439498 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:39] Using BAM RG (Read Group) ID: SAL_CB0612AA_AS.out
[08:21:39] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:39] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:39] Wrote 410630 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:39] Using BAM RG (Read Group) ID: SAL_MB7066AA_AS.out
[08:21:39] Wrote 410326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:39] Using BAM RG (Read Group) ID: SAL_PB5476AA_AS.out
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Wrote 446424 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:40] Using BAM RG (Read Group) ID: SAL_BB9821AA_AS.out
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Wrote 414490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:40] Using BAM RG (Read Group) ID: SAL_FB7879AA_AS.out
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:40] Wrote 426010 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:40] Using BAM RG (Read Group) ID: SAL_BB1353AA_AS.out
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:40] Wrote 471920 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:21:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:21:40] Using BAM RG (Read Group) ID: SAL_IB2995AA_AS.out
[08:21:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:21:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:21:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:21:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:41] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0612AA_AS.out\tSM:SAL_CB0612AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:21:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:21:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:21:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 119498 sequences (29874500 bp)...
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9821AA_AS.out\tSM:SAL_BB9821AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::process] read 320090 sequences (80000262 bp)...
[08:21:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB2995AA_AS.out\tSM:SAL_IB2995AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 90630 sequences (22628860 bp)...
[M::process] read 90236 sequences (22559000 bp)...
[08:21:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:21:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:21:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:21:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:21:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1353AA_AS.out\tSM:SAL_BB1353AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 320084 sequences (80000076 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320026 sequences (80000118 bp)...
[M::process] read 126424 sequences (31603618 bp)...
[M::process] read 151920 sequences (37967390 bp)...
[M::process] read 105984 sequences (26496000 bp)...
[M::process] read 94406 sequences (23596172 bp)...
[M::mem_process_seqs] Processed 320090 reads in 19.522 CPU sec, 3.702 real sec
[M::mem_process_seqs] Processed 320000 reads in 24.370 CPU sec, 4.235 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 90236 reads in 4.973 CPU sec, 0.621 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 26.644 CPU sec, 4.609 real sec
[M::mem_process_seqs] Processed 119498 reads in 8.209 CPU sec, 1.009 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 19.499 CPU sec, 5.205 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0612AA_AS.out\tSM:SAL_CB0612AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.184 sec; CPU: 33.114 sec
[samclip] Total SAM records 441378, removed 11088, allowed 1085, passed 430290
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.098 sec; CPU: 25.113 sec
[samclip] Total SAM records 410862, removed 2313, allowed 84, passed 408549
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 90630 reads in 5.239 CPU sec, 0.645 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 126424 reads in 10.547 CPU sec, 1.308 real sec
[M::mem_process_seqs] Processed 320084 reads in 20.879 CPU sec, 5.937 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 28.483 CPU sec, 5.908 real sec
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 320026 reads in 24.534 CPU sec, 5.750 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9821AA_AS.out\tSM:SAL_BB9821AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.797 sec; CPU: 37.698 sec
[samclip] Total SAM records 448222, removed 11671, allowed 1496, passed 436551
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 7.104 sec; CPU: 25.348 sec
[samclip] Total SAM records 410973, removed 1976, allowed 116, passed 408997
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 94406 reads in 6.590 CPU sec, 0.799 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 105984 reads in 8.353 CPU sec, 1.025 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 7.646 sec; CPU: 28.043 sec
[samclip] Total SAM records 415359, removed 5083, allowed 375, passed 410276
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:21:50] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 151920 reads in 12.009 CPU sec, 1.456 real sec
[08:21:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1353AA_AS.out\tSM:SAL_BB1353AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 427731, removed 10177, allowed 1295, passed 417554

[main] Real time: 7.664 sec; CPU: 33.425 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[08:21:50] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB2995AA_AS.out\tSM:SAL_IB2995AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 8.168 sec; CPU: 41.002 sec
[samclip] Total SAM records 474152, removed 12832, allowed 1640, passed 461320
[samclip] Header contained 5 lines
[samclip] Done.
[08:21:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:21:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:21:51] Running: samtools index snps.bam 2>> snps.log
[08:21:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:51] Running: samtools index snps.bam 2>> snps.log
[08:21:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:21:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:21:52] Running: samtools index snps.bam 2>> snps.log
[08:21:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:21:53] Running: samtools index snps.bam 2>> snps.log
[08:21:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:21:53] Running: samtools index snps.bam 2>> snps.log
[08:21:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:21:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:21:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 383
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:21:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:21:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 2618
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:21:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:21:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:21:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:21:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:54] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:21:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:21:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:21:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:21:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2232
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:21:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:21:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 17
          no. right trimmed                     : 54
          no. left and right trimmed            : 6
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 77

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 77
       total no. variants observed              : 8218
       total no. reference observed             : 0

Time elapsed: 0.10s

[08:21:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:21:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:56] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:21:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:21:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:57] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 14
          no. right trimmed                     : 87
          no. left and right trimmed            : 14
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 115

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 115
       total no. variants observed              : 9120
       total no. reference observed             : 0

Time elapsed: 0.12s

[08:21:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:21:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:21:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 12
          no. right trimmed                     : 86
          no. left and right trimmed            : 10
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 108

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 108
       total no. variants observed              : 8353
       total no. reference observed             : 0

Time elapsed: 0.11s

[08:21:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:21:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:21:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:58] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:21:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:21:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:21:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:21:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:21:59] Marked 150 heterozygous sites with 'n'
[08:21:59] Creating extra output files: BED GFF CSV TXT HTML
[08:21:59] Identified 383 variants.
[08:21:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[08:21:59] Result files:
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.aligned.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam.bai
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bed
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.subs.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.csv
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.filt.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.gff
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.html
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.log
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.raw.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.subs.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.tab
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.txt
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz.csi
[08:21:59] Walltime used: 23 seconds
[08:21:59] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:21:59] Done.
[08:21:59] Marked 199 heterozygous sites with 'n'
[08:21:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[Tue Jun 16 08:21:59 2020]
Finished job 174.
1 of 206 steps (0.49%) done

[Tue Jun 16 08:21:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
    jobid: 67
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_QA4878AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
[08:21:59] Creating extra output files: BED GFF CSV TXT HTML
[08:21:59] Identified 401 variants.
[08:21:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:21:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[08:21:59] Result files:
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.aligned.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam.bai
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bed
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.subs.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.csv
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.filt.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.gff
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.html
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.log
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.raw.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.subs.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.tab
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.txt
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz.csi
[08:21:59] Walltime used: 23 seconds
[08:21:59] Questionable SNP? Try the --report option to see the alignments.
[08:21:59] Done.
[08:21:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[Tue Jun 16 08:21:59 2020]
Finished job 44.
2 of 206 steps (0.97%) done

[Tue Jun 16 08:21:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
    jobid: 157
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA5298AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
[08:21:59] Marked 6054 heterozygous sites with 'n'
[08:21:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:21:59] Running: rm -f fake_reads\.fq 2>> snps.log
[08:21:59] Creating extra output files: BED GFF CSV TXT HTML
[08:21:59] Identified 2618 variants.
[08:21:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out
[08:21:59] Result files:
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.aligned.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.bam
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.bam.bai
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.bed
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.consensus.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.consensus.subs.fa
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.csv
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.filt.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.gff
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.html
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.log
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.raw.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.subs.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.tab
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.txt
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.vcf
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.vcf.gz
[08:21:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0612AA_AS.out/snps.vcf.gz.csi
[08:21:59] Walltime used: 23 seconds
[08:21:59] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:21:59] Done.
[Tue Jun 16 08:21:59 2020]
Finished job 134.
3 of 206 steps (1%) done

[Tue Jun 16 08:21:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
    jobid: 176
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB9710AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
[08:21:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:00] This is snippy 4.4.3
[08:22:00] Written by Torsten Seemann
[08:22:00] Obtained from https://github.com/tseemann/snippy
[08:22:00] Detected operating system: linux
[08:22:00] Enabling bundled linux tools.
[08:22:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:00] Found gzip - /usr/bin/gzip
[08:22:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:00] This is snippy 4.4.3
[08:22:00] Written by Torsten Seemann
[08:22:00] Obtained from https://github.com/tseemann/snippy
[08:22:00] Detected operating system: linux
[08:22:00] Enabling bundled linux tools.
[08:22:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:00] Found gzip - /usr/bin/gzip
[08:22:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:00] Treating reference as 'fasta' format.
[08:22:00] Will use 8 CPU cores.
[08:22:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
[08:22:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[08:22:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[08:22:00] Creating reference folder: reference
[08:22:00] Extracting FASTA and GFF from reference.
[08:22:00] This is snippy 4.4.3
[08:22:00] Written by Torsten Seemann
[08:22:00] Obtained from https://github.com/tseemann/snippy
[08:22:00] Detected operating system: linux
[08:22:00] Enabling bundled linux tools.
[08:22:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:00] Found gzip - /usr/bin/gzip
[08:22:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:00] Treating reference as 'fasta' format.
[08:22:00] Will use 8 CPU cores.
[08:22:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
[08:22:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[08:22:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[08:22:00] Creating reference folder: reference
[08:22:00] Extracting FASTA and GFF from reference.
[08:22:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:00] Wrote 3 sequences to ref.fa
[08:22:00] Wrote 0 features to ref.gff
[08:22:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta into pseudo-reads
[08:22:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:00] Wrote 3 sequences to ref.fa
[08:22:00] Wrote 0 features to ref.gff
[08:22:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta into pseudo-reads
[08:22:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:00] Treating reference as 'fasta' format.
[08:22:00] Will use 8 CPU cores.
[08:22:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
[08:22:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[08:22:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[08:22:00] Creating reference folder: reference
[08:22:00] Extracting FASTA and GFF from reference.
[08:22:00] Wrote 3 sequences to ref.fa
[08:22:00] Wrote 0 features to ref.gff
[08:22:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta into pseudo-reads
[08:22:00] Marked 169 heterozygous sites with 'n'
[08:22:00] Creating extra output files: BED GFF CSV TXT HTML
[08:22:00] Identified 2232 variants.
[08:22:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[08:22:00] Result files:
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.aligned.fa
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam.bai
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bed
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.fa
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.subs.fa
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.csv
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.filt.vcf
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.gff
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.html
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.log
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.raw.vcf
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.subs.vcf
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.tab
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.txt
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz
[08:22:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz.csi
[08:22:00] Walltime used: 24 seconds
[08:22:00] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:22:00] Done.
[Tue Jun 16 08:22:01 2020]
Finished job 165.
4 of 206 steps (2%) done

[Tue Jun 16 08:22:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
    jobid: 105
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1371AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:01] This is snippy 4.4.3
[08:22:01] Written by Torsten Seemann
[08:22:01] Obtained from https://github.com/tseemann/snippy
[08:22:01] Detected operating system: linux
[08:22:01] Enabling bundled linux tools.
[08:22:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:01] Found gzip - /usr/bin/gzip
[08:22:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:01] Marked 6750 heterozygous sites with 'n'
[08:22:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:01] Creating extra output files: BED GFF CSV TXT HTML
[08:22:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:01] Identified 8218 variants.
[08:22:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out
[08:22:01] Result files:
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.aligned.fa
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.bam
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.bam.bai
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.bed
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.consensus.fa
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.consensus.subs.fa
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.csv
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.filt.vcf
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.gff
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.html
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.log
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.raw.vcf
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.subs.vcf
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.tab
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.txt
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.vcf
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.vcf.gz
[08:22:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9821AA_AS.out/snps.vcf.gz.csi
[08:22:01] Walltime used: 25 seconds
[08:22:01] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:22:01] Done.
[Tue Jun 16 08:22:01 2020]
Finished job 85.
5 of 206 steps (2%) done

[Tue Jun 16 08:22:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
    jobid: 187
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5463AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[08:22:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:01] Treating reference as 'fasta' format.
[08:22:01] Will use 8 CPU cores.
[08:22:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
[08:22:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[08:22:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[08:22:01] Creating reference folder: reference
[08:22:01] Extracting FASTA and GFF from reference.
[08:22:02] Wrote 3 sequences to ref.fa
[08:22:02] Wrote 0 features to ref.gff
[08:22:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:02] This is snippy 4.4.3
[08:22:02] Written by Torsten Seemann
[08:22:02] Obtained from https://github.com/tseemann/snippy
[08:22:02] Detected operating system: linux
[08:22:02] Enabling bundled linux tools.
[08:22:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:02] Found gzip - /usr/bin/gzip
[08:22:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:02] Treating reference as 'fasta' format.
[08:22:02] Will use 8 CPU cores.
[08:22:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[08:22:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[08:22:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[08:22:02] Creating reference folder: reference
[08:22:02] Extracting FASTA and GFF from reference.
[08:22:02] Wrote 3 sequences to ref.fa
[08:22:02] Wrote 0 features to ref.gff
[08:22:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta into pseudo-reads
[08:22:03] Marked 2327 heterozygous sites with 'n'
[08:22:03] Creating extra output files: BED GFF CSV TXT HTML
[08:22:03] Identified 9120 variants.
[08:22:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out
[08:22:03] Result files:
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.aligned.fa
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.bam
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.bam.bai
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.bed
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.consensus.fa
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.consensus.subs.fa
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.csv
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.filt.vcf
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.gff
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.html
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.log
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.raw.vcf
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.subs.vcf
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.tab
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.txt
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.vcf
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.vcf.gz
[08:22:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1353AA_AS.out/snps.vcf.gz.csi
[08:22:03] Walltime used: 27 seconds
[08:22:03] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:22:03] Done.
[Tue Jun 16 08:22:03 2020]
Finished job 190.
6 of 206 steps (3%) done

[Tue Jun 16 08:22:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
    jobid: 73
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA8881AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
[08:22:03] Wrote 413060 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:03] Using BAM RG (Read Group) ID: SAL_QA4878AA_AS.out
[08:22:03] Wrote 406412 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:03] Using BAM RG (Read Group) ID: SAL_ZA5298AA_AS.out
[08:22:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:03] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:03] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:03] Wrote 406280 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:03] Using BAM RG (Read Group) ID: SAL_JB9710AA_AS.out
[08:22:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:03] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:03] Marked 5212 heterozygous sites with 'n'
[08:22:04] Creating extra output files: BED GFF CSV TXT HTML
[08:22:04] Identified 8353 variants.
[08:22:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out
[08:22:04] Result files:
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.aligned.fa
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.bam
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.bam.bai
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.bed
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.consensus.fa
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.consensus.subs.fa
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.csv
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.filt.vcf
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.gff
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.html
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.log
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.raw.vcf
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.subs.vcf
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.tab
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.txt
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.vcf
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.vcf.gz
[08:22:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB2995AA_AS.out/snps.vcf.gz.csi
[08:22:04] Walltime used: 28 seconds
[08:22:04] Questionable SNP? Try the --report option to see the alignments.
[08:22:04] Done.
[Tue Jun 16 08:22:04 2020]
Finished job 69.
7 of 206 steps (3%) done

[Tue Jun 16 08:22:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
    jobid: 161
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB7540AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:04] This is snippy 4.4.3
[08:22:04] Written by Torsten Seemann
[08:22:04] Obtained from https://github.com/tseemann/snippy
[08:22:04] Detected operating system: linux
[08:22:04] Enabling bundled linux tools.
[08:22:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:04] Found gzip - /usr/bin/gzip
[08:22:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:04] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:04] Treating reference as 'fasta' format.
[08:22:04] Will use 8 CPU cores.
[08:22:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
[08:22:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[08:22:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[08:22:04] Creating reference folder: reference
[08:22:04] Extracting FASTA and GFF from reference.
[08:22:04] Wrote 3 sequences to ref.fa
[08:22:04] Wrote 0 features to ref.gff
[08:22:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta into pseudo-reads
[08:22:05] This is snippy 4.4.3
[08:22:05] Written by Torsten Seemann
[08:22:05] Obtained from https://github.com/tseemann/snippy
[08:22:05] Detected operating system: linux
[08:22:05] Enabling bundled linux tools.
[08:22:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:05] Found gzip - /usr/bin/gzip
[08:22:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:05] Wrote 406056 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:05] Using BAM RG (Read Group) ID: SAL_BB1371AA_AS.out
[08:22:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:05] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:05] Treating reference as 'fasta' format.
[08:22:05] Will use 8 CPU cores.
[08:22:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
[08:22:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[08:22:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[08:22:05] Creating reference folder: reference
[08:22:05] Extracting FASTA and GFF from reference.
[08:22:05] Wrote 3 sequences to ref.fa
[08:22:05] Wrote 0 features to ref.gff
[08:22:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta into pseudo-reads
[08:22:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:22:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:22:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:22:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:22:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320004 sequences (80000188 bp)...
[08:22:05] Wrote 410514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:05] Using BAM RG (Read Group) ID: SAL_WA5463AA_AS.out
[08:22:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:06] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 86408 sequences (21602000 bp)...
[M::process] read 320224 sequences (80000224 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 92836 sequences (23202520 bp)...
[M::process] read 86280 sequences (21535684 bp)...
[08:22:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[08:22:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 86056 sequences (21495038 bp)...
[08:22:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:07] Wrote 413214 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:07] Using BAM RG (Read Group) ID: SAL_KA8881AA_AS.out
[08:22:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:08] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320132 sequences (80000022 bp)...
[08:22:08] Wrote 405032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:08] Using BAM RG (Read Group) ID: SAL_IB7540AA_AS.out
[08:22:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::process] read 90382 sequences (22584208 bp)...
[08:22:08] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320004 reads in 18.804 CPU sec, 2.554 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86408 reads in 4.477 CPU sec, 0.537 real sec
[M::mem_process_seqs] Processed 320000 reads in 18.471 CPU sec, 2.979 real sec
[M::mem_process_seqs] Processed 320224 reads in 20.225 CPU sec, 3.013 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86280 reads in 5.201 CPU sec, 0.636 real sec
[M::mem_process_seqs] Processed 92836 reads in 5.533 CPU sec, 0.690 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.307 sec; CPU: 23.840 sec
[samclip] Total SAM records 406715, removed 1929, allowed 105, passed 404786
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[08:22:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[08:22:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.664 sec; CPU: 24.309 sec
[samclip] Total SAM records 406763, removed 2268, allowed 107, passed 404495
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 400000 records...
[M::process] read 320186 sequences (80000468 bp)...
[M::mem_process_seqs] Processed 320000 reads in 19.432 CPU sec, 2.809 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.744 sec; CPU: 26.369 sec
[samclip] Total SAM records 413310, removed 2191, allowed 165, passed 411119
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 93028 sequences (23245926 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 86056 reads in 5.301 CPU sec, 0.642 real sec
[M::process] read 85032 sequences (21258000 bp)...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320132 reads in 21.127 CPU sec, 3.353 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 406245, removed 1464, allowed 88, passed 404781

[main] Real time: 4.416 sec; CPU: 25.315 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[08:22:12] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[08:22:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 90382 reads in 5.751 CPU sec, 0.681 real sec
[samclip] Processed 300000 records...
[08:22:12] Running: samtools index snps.bam 2>> snps.log
[08:22:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:12] Running: samtools index snps.bam 2>> snps.log
[08:22:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.897 sec; CPU: 27.440 sec
[samclip] Total SAM records 411033, removed 3773, allowed 393, passed 407260
[samclip] Header contained 5 lines
[samclip] Done.
[08:22:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320186 reads in 18.910 CPU sec, 2.584 real sec
[M::mem_process_seqs] Processed 93028 reads in 5.345 CPU sec, 0.746 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[08:22:13] Running: samtools index snps.bam 2>> snps.log
[08:22:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.332 CPU sec, 3.538 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 85032 reads in 4.615 CPU sec, 0.654 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.890 sec; CPU: 24.957 sec
[samclip] Total SAM records 413454, removed 2921, allowed 296, passed 410533
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[08:22:15] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 200000 records...

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:22:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:15] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 392
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.536 sec; CPU: 23.629 sec
[samclip] Total SAM records 405377, removed 2030, allowed 118, passed 403347
[samclip] Header contained 5 lines
[samclip] Done.
[08:22:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 459
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:16] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:16] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:17] Running: samtools index snps.bam 2>> snps.log
[08:22:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 341
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:17] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:17] Running: samtools index snps.bam 2>> snps.log
[08:22:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2007
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:22:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:19] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:19] Marked 188 heterozygous sites with 'n'
[08:22:19] Creating extra output files: BED GFF CSV TXT HTML
[08:22:19] Identified 398 variants.
[08:22:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[08:22:19] Result files:
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.aligned.fa
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam.bai
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bed
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.fa
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.subs.fa
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.csv
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.filt.vcf
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.gff
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.html
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.log
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.raw.vcf
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.subs.vcf
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.tab
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.txt
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz
[08:22:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz.csi
[08:22:19] Walltime used: 19 seconds
[08:22:19] Wishing you a life free of homopolymer errors.
[08:22:19] Done.
[Tue Jun 16 08:22:19 2020]
Finished job 157.
8 of 206 steps (4%) done

[Tue Jun 16 08:22:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
    jobid: 39
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA8731AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[08:22:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 715
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:22:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:20] Marked 198 heterozygous sites with 'n'
[08:22:20] Creating extra output files: BED GFF CSV TXT HTML
[08:22:20] Identified 392 variants.
[08:22:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[08:22:20] Result files:
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.aligned.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam.bai
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bed
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.subs.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.csv
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.filt.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.gff
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.html
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.log
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.raw.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.subs.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.tab
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.txt
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz.csi
[08:22:20] Walltime used: 20 seconds
[08:22:20] Wishing you a life free of homopolymer errors.
[08:22:20] Done.
[Tue Jun 16 08:22:20 2020]
Finished job 176.
9 of 206 steps (4%) done

[Tue Jun 16 08:22:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
    jobid: 129
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB1045AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[08:22:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:20] This is snippy 4.4.3
[08:22:20] Written by Torsten Seemann
[08:22:20] Obtained from https://github.com/tseemann/snippy
[08:22:20] Detected operating system: linux
[08:22:20] Enabling bundled linux tools.
[08:22:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:20] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:20] Found gzip - /usr/bin/gzip
[08:22:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:20] Marked 441 heterozygous sites with 'n'
[08:22:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:20] Creating extra output files: BED GFF CSV TXT HTML
[08:22:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:20] Identified 459 variants.
[08:22:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[08:22:20] Result files:
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.aligned.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam.bai
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bed
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.subs.fa
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.csv
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.filt.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.gff
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.html
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.log
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.raw.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.subs.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.tab
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.txt
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz
[08:22:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz.csi
[08:22:20] Walltime used: 20 seconds
[08:22:20] May the SNPs be with you.
[08:22:20] Done.
[Tue Jun 16 08:22:20 2020]
Finished job 67.
10 of 206 steps (5%) done

[Tue Jun 16 08:22:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
    jobid: 1
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB0648AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
[08:22:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:20] Treating reference as 'fasta' format.
[08:22:20] Will use 8 CPU cores.
[08:22:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[08:22:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[08:22:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[08:22:20] Creating reference folder: reference
[08:22:20] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:22:21] Wrote 3 sequences to ref.fa
[08:22:21] Wrote 0 features to ref.gff
[08:22:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta into pseudo-reads
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:21] This is snippy 4.4.3
[08:22:21] Written by Torsten Seemann
[08:22:21] Obtained from https://github.com/tseemann/snippy
[08:22:21] Detected operating system: linux
[08:22:21] Enabling bundled linux tools.
[08:22:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:21] Found gzip - /usr/bin/gzip
[08:22:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:21] Treating reference as 'fasta' format.
[08:22:21] Will use 8 CPU cores.
[08:22:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[08:22:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[08:22:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[08:22:21] Creating reference folder: reference
[08:22:21] Extracting FASTA and GFF from reference.
[08:22:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:21] This is snippy 4.4.3
[08:22:21] Written by Torsten Seemann
[08:22:21] Obtained from https://github.com/tseemann/snippy
[08:22:21] Detected operating system: linux
[08:22:21] Enabling bundled linux tools.
[08:22:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:21] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:21] Wrote 3 sequences to ref.fa
[08:22:21] Wrote 0 features to ref.gff
[08:22:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta into pseudo-reads
[08:22:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:21] Found gzip - /usr/bin/gzip
[08:22:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:21] Treating reference as 'fasta' format.
[08:22:21] Will use 8 CPU cores.
[08:22:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
[08:22:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[08:22:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[08:22:21] Creating reference folder: reference
[08:22:21] Extracting FASTA and GFF from reference.
[08:22:21] Wrote 3 sequences to ref.fa
[08:22:21] Wrote 0 features to ref.gff
[08:22:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta into pseudo-reads
[08:22:21] Marked 432 heterozygous sites with 'n'
[08:22:22] Creating extra output files: BED GFF CSV TXT HTML
[08:22:22] Identified 341 variants.
[08:22:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[08:22:22] Result files:
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.aligned.fa
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam.bai
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bed
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.fa
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.subs.fa
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.csv
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.filt.vcf
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.gff
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.html
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.log
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.raw.vcf
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.subs.vcf
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.tab
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.txt
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz
[08:22:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz.csi
[08:22:22] Walltime used: 21 seconds
[08:22:22] Questionable SNP? Try the --report option to see the alignments.
[08:22:22] Done.
[Tue Jun 16 08:22:22 2020]
Finished job 105.
11 of 206 steps (5%) done

[Tue Jun 16 08:22:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
    jobid: 159
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5013AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:22] This is snippy 4.4.3
[08:22:22] Written by Torsten Seemann
[08:22:22] Obtained from https://github.com/tseemann/snippy
[08:22:22] Detected operating system: linux
[08:22:22] Enabling bundled linux tools.
[08:22:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:22] Found gzip - /usr/bin/gzip
[08:22:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:23] Treating reference as 'fasta' format.
[08:22:23] Will use 8 CPU cores.
[08:22:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
[08:22:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[08:22:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[08:22:23] Creating reference folder: reference
[08:22:23] Extracting FASTA and GFF from reference.
[08:22:23] Wrote 3 sequences to ref.fa
[08:22:23] Wrote 0 features to ref.gff
[08:22:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta into pseudo-reads
[08:22:23] Marked 189 heterozygous sites with 'n'
[08:22:23] Creating extra output files: BED GFF CSV TXT HTML
[08:22:23] Identified 2007 variants.
[08:22:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[08:22:23] Result files:
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.aligned.fa
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam.bai
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bed
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.fa
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.subs.fa
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.csv
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.filt.vcf
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.gff
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.html
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.log
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.raw.vcf
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.subs.vcf
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.tab
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.txt
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz
[08:22:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz.csi
[08:22:23] Walltime used: 21 seconds
[08:22:23] Wishing you a life free of homopolymer errors.
[08:22:23] Done.
[Tue Jun 16 08:22:23 2020]
Finished job 187.
12 of 206 steps (6%) done

[Tue Jun 16 08:22:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
    jobid: 22
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2593AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[08:22:23] Wrote 404780 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:23] Using BAM RG (Read Group) ID: SAL_ZA8731AA_AS.out
[08:22:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:23] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:24] Wrote 404984 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:24] Using BAM RG (Read Group) ID: SAL_EB1045AA_AS.out
[08:22:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:24] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:24] This is snippy 4.4.3
[08:22:24] Written by Torsten Seemann
[08:22:24] Obtained from https://github.com/tseemann/snippy
[08:22:24] Detected operating system: linux
[08:22:24] Enabling bundled linux tools.
[08:22:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:24] Found gzip - /usr/bin/gzip
[08:22:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:24] Marked 374 heterozygous sites with 'n'
[08:22:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:24] Treating reference as 'fasta' format.
[08:22:24] Will use 8 CPU cores.
[08:22:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[08:22:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[08:22:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[08:22:24] Creating reference folder: reference
[08:22:24] Extracting FASTA and GFF from reference.
[08:22:25] Wrote 3 sequences to ref.fa
[08:22:25] Wrote 0 features to ref.gff
[08:22:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta into pseudo-reads
[08:22:25] Creating extra output files: BED GFF CSV TXT HTML
[08:22:25] Identified 715 variants.
[08:22:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[08:22:25] Result files:
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.aligned.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam.bai
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bed
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.subs.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.csv
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.filt.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.gff
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.html
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.log
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.raw.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.subs.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.tab
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.txt
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz.csi
[08:22:25] Walltime used: 21 seconds
[08:22:25] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:22:25] Done.
[Tue Jun 16 08:22:25 2020]
Finished job 73.
13 of 206 steps (6%) done

[Tue Jun 16 08:22:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
    jobid: 186
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA1544AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
[08:22:25] Marked 224 heterozygous sites with 'n'
[08:22:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:25] Creating extra output files: BED GFF CSV TXT HTML
[08:22:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:25] Identified 398 variants.
[08:22:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[08:22:25] Result files:
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.aligned.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam.bai
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bed
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.subs.fa
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.csv
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.filt.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.gff
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.html
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.log
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.raw.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.subs.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.tab
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.txt
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz
[08:22:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz.csi
[08:22:25] Walltime used: 20 seconds
[08:22:25] Questionable SNP? Try the --report option to see the alignments.
[08:22:25] Done.
[08:22:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[Tue Jun 16 08:22:25 2020]
Finished job 161.
14 of 206 steps (7%) done

[Tue Jun 16 08:22:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
    jobid: 145
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA2493AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 84780 sequences (21192786 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:26] This is snippy 4.4.3
[08:22:26] Written by Torsten Seemann
[08:22:26] Obtained from https://github.com/tseemann/snippy
[08:22:26] Detected operating system: linux
[08:22:26] Enabling bundled linux tools.
[08:22:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:26] Wrote 406206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:26] Using BAM RG (Read Group) ID: SAL_BB0648AA_AS.out
[08:22:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:22:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:26] Found gzip - /usr/bin/gzip
[08:22:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:22:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:26] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:27] This is snippy 4.4.3
[08:22:27] Written by Torsten Seemann
[08:22:27] Obtained from https://github.com/tseemann/snippy
[08:22:27] Detected operating system: linux
[08:22:27] Enabling bundled linux tools.
[08:22:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:27] Found gzip - /usr/bin/gzip
[08:22:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:27] Treating reference as 'fasta' format.
[08:22:27] Will use 8 CPU cores.
[08:22:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
[08:22:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[08:22:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[08:22:27] Creating reference folder: reference
[08:22:27] Extracting FASTA and GFF from reference.
[08:22:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:27] Wrote 409500 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:27] Using BAM RG (Read Group) ID: SAL_WA5013AA_AS.out
[08:22:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:27] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:27] Wrote 3 sequences to ref.fa
[08:22:27] Wrote 0 features to ref.gff
[08:22:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta into pseudo-reads
[08:22:27] Treating reference as 'fasta' format.
[08:22:27] Will use 8 CPU cores.
[08:22:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[08:22:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[M::process] read 320000 sequences (80000000 bp)...
[08:22:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[08:22:27] Creating reference folder: reference
[08:22:27] Extracting FASTA and GFF from reference.
[M::process] read 84984 sequences (21244752 bp)...
[08:22:27] Wrote 3 sequences to ref.fa
[08:22:27] Wrote 0 features to ref.gff
[08:22:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta into pseudo-reads
[08:22:27] Wrote 405698 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:27] Using BAM RG (Read Group) ID: SAL_BB2593AA_AS.out
[08:22:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:27] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.690 CPU sec, 2.543 real sec
[samclip] Processed 100000 records...
[08:22:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:22:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 84780 reads in 5.390 CPU sec, 0.630 real sec
[08:22:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320116 sequences (80000194 bp)...
[M::process] read 86090 sequences (21522500 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.980 sec; CPU: 25.595 sec
[samclip] Total SAM records 405148, removed 2630, allowed 279, passed 402518
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320370 sequences (80000034 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 18.558 CPU sec, 2.452 real sec
[08:22:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 89130 sequences (22267784 bp)...
[08:22:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[08:22:30] Wrote 407900 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:30] Using BAM RG (Read Group) ID: SAL_TA1544AA_AS.out
[08:22:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:22:30] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:30] Wrote 410746 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::mem_process_seqs] Processed 84984 reads in 5.223 CPU sec, 0.608 real sec
[08:22:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:30] Using BAM RG (Read Group) ID: SAL_FA2493AA_AS.out
[08:22:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:30] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320008 sequences (80000064 bp)...
[samclip] Processed 300000 records...
[M::process] read 85690 sequences (21422500 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.900 sec; CPU: 24.314 sec
[samclip] Total SAM records 405367, removed 2039, allowed 122, passed 403328
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:31] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::mem_process_seqs] Processed 320116 reads in 20.158 CPU sec, 2.717 real sec
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 87900 sequences (21975000 bp)...
[M::process] read 320582 sequences (80000206 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 86090 reads in 5.151 CPU sec, 0.624 real sec
[08:22:32] Running: samtools index snps.bam 2>> snps.log
[08:22:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 300000 records...
[08:22:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 90164 sequences (22499880 bp)...
[M::mem_process_seqs] Processed 320370 reads in 21.126 CPU sec, 3.541 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.469 sec; CPU: 25.855 sec
[samclip] Total SAM records 406412, removed 1570, allowed 112, passed 404842
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320008 reads in 19.576 CPU sec, 3.352 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 89130 reads in 5.557 CPU sec, 0.723 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 85690 reads in 5.873 CPU sec, 0.760 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.586 sec; CPU: 27.349 sec
[samclip] Total SAM records 409939, removed 3495, allowed 278, passed 406444
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[08:22:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out -t 8[samclip] Total SAM records 405987, removed 2166, allowed 277, passed 403821
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 5.389 sec; CPU: 26.109 sec

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 26
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:22:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:35] Running: samtools index snps.bam 2>> snps.log
[08:22:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.638 CPU sec, 3.378 real sec
[08:22:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320582 reads in 18.700 CPU sec, 3.267 real sec
[08:22:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:22:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 87900 reads in 5.710 CPU sec, 0.681 real sec
[08:22:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 90164 reads in 6.366 CPU sec, 0.764 real sec
[samclip] Processed 300000 records...
[08:22:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:22:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 400000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 408288, removed 2066, allowed 153, passed 406222
 bwa mem -Y[samclip] Header contained 5 lines
 -M -R[samclip] Done.
 @RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.875 sec; CPU: 24.882 sec
[08:22:37] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.771 sec; CPU: 25.554 sec
[samclip] Total SAM records 411023, removed 3956, allowed 144, passed 407067
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:37] Running: samtools index snps.bam 2>> snps.log
[08:22:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:39] Running: samtools index snps.bam 2>> snps.log
[08:22:39] Running: samtools index snps.bam 2>> snps.log
[08:22:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 338
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:39] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:40] Marked 169 heterozygous sites with 'n'
[08:22:40] Creating extra output files: BED GFF CSV TXT HTML
[08:22:40] Identified 2000 variants.
[08:22:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[08:22:40] Result files:
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.aligned.fa
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam.bai
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bed
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.fa
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.subs.fa
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.csv
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.filt.vcf
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.gff
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.html
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.log
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.raw.vcf
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.subs.vcf
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.tab
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.txt
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz
[08:22:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz.csi
[08:22:40] Walltime used: 20 seconds
[08:22:40] Wishing you a life free of homopolymer errors.
[08:22:40] Done.
[Tue Jun 16 08:22:40 2020]
Finished job 39.
15 of 206 steps (7%) done

[Tue Jun 16 08:22:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
    jobid: 90
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6773AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[08:22:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 27
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 1987
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:22:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:22:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1980
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:22:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:41] Marked 236 heterozygous sites with 'n'
[08:22:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:41] Creating extra output files: BED GFF CSV TXT HTML
[08:22:41] Identified 401 variants.
[08:22:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[08:22:41] Result files:
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.aligned.fa
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam.bai
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bed
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.fa
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.subs.fa
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.csv
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.filt.vcf
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.gff
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.html
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.log
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.raw.vcf
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.subs.vcf
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.tab
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.txt
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz
[08:22:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz.csi
[08:22:41] Walltime used: 20 seconds
[08:22:41] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:22:41] Done.
[Tue Jun 16 08:22:41 2020]
Finished job 129.
16 of 206 steps (8%) done

[Tue Jun 16 08:22:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
    jobid: 52
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA7787AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[08:22:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:41] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:41] This is snippy 4.4.3
[08:22:41] Written by Torsten Seemann
[08:22:41] Obtained from https://github.com/tseemann/snippy
[08:22:41] Detected operating system: linux
[08:22:41] Enabling bundled linux tools.
[08:22:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:41] Found gzip - /usr/bin/gzip
[08:22:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:41] Treating reference as 'fasta' format.
[08:22:41] Will use 8 CPU cores.
[08:22:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[08:22:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[08:22:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[08:22:41] Creating reference folder: reference
[08:22:41] Extracting FASTA and GFF from reference.
[08:22:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:41] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:41] Wrote 3 sequences to ref.fa
[08:22:41] Wrote 0 features to ref.gff
[08:22:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta into pseudo-reads
[08:22:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:41] This is snippy 4.4.3
[08:22:41] Written by Torsten Seemann
[08:22:41] Obtained from https://github.com/tseemann/snippy
[08:22:41] Detected operating system: linux
[08:22:41] Enabling bundled linux tools.
[08:22:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:41] Found gzip - /usr/bin/gzip
[08:22:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:42] Treating reference as 'fasta' format.
[08:22:42] Will use 8 CPU cores.
[08:22:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[08:22:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[08:22:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[08:22:42] Creating reference folder: reference
[08:22:42] Extracting FASTA and GFF from reference.
[08:22:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 11
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 11

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 11
       total no. variants observed              : 231
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:42] Wrote 3 sequences to ref.fa
[08:22:42] Wrote 0 features to ref.gff
[08:22:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta into pseudo-reads
[08:22:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 395
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:22:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:22:43] Marked 430 heterozygous sites with 'n'
[08:22:44] Creating extra output files: BED GFF CSV TXT HTML
[08:22:44] Identified 338 variants.
[08:22:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[08:22:44] Result files:
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.aligned.fa
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam.bai
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bed
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.fa
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.subs.fa
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.csv
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.filt.vcf
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.gff
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.html
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.log
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.raw.vcf
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.subs.vcf
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.tab
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.txt
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz
[08:22:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz.csi
[08:22:44] Walltime used: 23 seconds
[08:22:44] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:22:44] Done.
[Tue Jun 16 08:22:44 2020]
Finished job 1.
17 of 206 steps (8%) done

[Tue Jun 16 08:22:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
    jobid: 154
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB7965AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[08:22:44] Wrote 407344 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:44] Using BAM RG (Read Group) ID: SAL_KB6773AA_AS.out
[08:22:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:44] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:45] This is snippy 4.4.3
[08:22:45] Written by Torsten Seemann
[08:22:45] Obtained from https://github.com/tseemann/snippy
[08:22:45] Detected operating system: linux
[08:22:45] Enabling bundled linux tools.
[08:22:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:45] Wrote 408542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:45] Found gzip - /usr/bin/gzip
[08:22:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:45] Using BAM RG (Read Group) ID: SAL_LA7787AA_AS.out
[08:22:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:45] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:45] Treating reference as 'fasta' format.
[08:22:45] Will use 8 CPU cores.
[08:22:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[08:22:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[08:22:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[08:22:45] Creating reference folder: reference
[08:22:45] Extracting FASTA and GFF from reference.
[08:22:45] Marked 153 heterozygous sites with 'n'
[08:22:45] Creating extra output files: BED GFF CSV TXT HTML
[08:22:45] Identified 1987 variants.
[08:22:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[08:22:45] Result files:
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.aligned.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam.bai
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bed
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.subs.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.csv
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.filt.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.gff
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.html
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.log
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.raw.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.subs.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.tab
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.txt
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz.csi
[08:22:45] Walltime used: 23 seconds
[08:22:45] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:22:45] Done.
[Tue Jun 16 08:22:45 2020]
Finished job 159.
18 of 206 steps (9%) done

[Tue Jun 16 08:22:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
    jobid: 135
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB7623AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
[08:22:45] Wrote 3 sequences to ref.fa
[08:22:45] Wrote 0 features to ref.gff
[08:22:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta into pseudo-reads
[08:22:45] Marked 151 heterozygous sites with 'n'
[08:22:45] Creating extra output files: BED GFF CSV TXT HTML
[08:22:45] Identified 1980 variants.
[08:22:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[08:22:45] Result files:
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.aligned.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam.bai
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bed
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.subs.fa
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.csv
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.filt.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.gff
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.html
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.log
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.raw.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.subs.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.tab
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.txt
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz
[08:22:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz.csi
[08:22:45] Walltime used: 21 seconds
[08:22:45] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:22:45] Done.
[Tue Jun 16 08:22:45 2020]
Finished job 22.
19 of 206 steps (9%) done

[Tue Jun 16 08:22:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
    jobid: 146
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA7615AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:46] This is snippy 4.4.3
[08:22:46] Written by Torsten Seemann
[08:22:46] Obtained from https://github.com/tseemann/snippy
[08:22:46] Detected operating system: linux
[08:22:46] Enabling bundled linux tools.
[08:22:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:46] Found gzip - /usr/bin/gzip
[08:22:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:46] Treating reference as 'fasta' format.
[08:22:46] Will use 8 CPU cores.
[08:22:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
[08:22:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[08:22:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[08:22:46] Creating reference folder: reference
[08:22:46] Extracting FASTA and GFF from reference.
[08:22:46] Wrote 3 sequences to ref.fa
[08:22:46] Wrote 0 features to ref.gff
[08:22:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta into pseudo-reads
[08:22:46] This is snippy 4.4.3
[08:22:46] Written by Torsten Seemann
[08:22:46] Obtained from https://github.com/tseemann/snippy
[08:22:46] Detected operating system: linux
[08:22:46] Enabling bundled linux tools.
[08:22:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:46] Found gzip - /usr/bin/gzip
[08:22:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320040 sequences (80000138 bp)...
[08:22:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 87304 sequences (21826000 bp)...
[08:22:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:46] Treating reference as 'fasta' format.
[08:22:46] Will use 8 CPU cores.
[08:22:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
[08:22:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[08:22:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[08:22:46] Creating reference folder: reference
[08:22:46] Extracting FASTA and GFF from reference.
[08:22:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:46] Marked 12 heterozygous sites with 'n'
[08:22:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:22:46] Marked 228 heterozygous sites with 'n'
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:46] Creating extra output files: BED GFF CSV TXT HTML
[08:22:46] Identified 231 variants.
[08:22:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[08:22:46] Result files:
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.aligned.fa
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam.bai
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bed
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.fa
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.subs.fa
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.csv
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.filt.vcf
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.gff
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.html
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.log
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.raw.vcf
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.subs.vcf
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.tab
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.txt
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz
[08:22:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz.csi
[08:22:46] Walltime used: 19 seconds
[08:22:46] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:22:46] Done.
[Tue Jun 16 08:22:46 2020]
Finished job 145.
20 of 206 steps (10%) done

[Tue Jun 16 08:22:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
    jobid: 115
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7588AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
[08:22:46] Creating extra output files: BED GFF CSV TXT HTML
[08:22:47] Wrote 3 sequences to ref.fa
[08:22:47] Wrote 0 features to ref.gff
[08:22:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta into pseudo-reads
[08:22:47] Identified 395 variants.
[08:22:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[08:22:47] Result files:
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.aligned.fa
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam.bai
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bed
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.fa
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.subs.fa
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.csv
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.filt.vcf
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.gff
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.html
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.log
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.raw.vcf
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.subs.vcf
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.tab
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.txt
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz
[08:22:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz.csi
[08:22:47] Walltime used: 21 seconds
[08:22:47] Wishing you a life free of homopolymer errors.
[08:22:47] Done.
[Tue Jun 16 08:22:47 2020]
Finished job 186.
21 of 206 steps (10%) done

[Tue Jun 16 08:22:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
    jobid: 16
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA8627AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[M::process] read 320148 sequences (80000262 bp)...
[M::process] read 88394 sequences (22098500 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:22:47] This is snippy 4.4.3
[08:22:47] Written by Torsten Seemann
[08:22:47] Obtained from https://github.com/tseemann/snippy
[08:22:47] Detected operating system: linux
[08:22:47] Enabling bundled linux tools.
[08:22:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:47] This is snippy 4.4.3
[08:22:47] Written by Torsten Seemann
[08:22:47] Obtained from https://github.com/tseemann/snippy
[08:22:47] Detected operating system: linux
[08:22:47] Enabling bundled linux tools.
[08:22:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:22:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:22:47] Found gzip - /usr/bin/gzip
[08:22:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:22:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:22:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:22:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:22:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:22:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:22:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:22:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:22:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:22:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:22:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:22:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:22:47] Found gzip - /usr/bin/gzip
[08:22:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:22:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:22:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:22:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:22:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:22:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:22:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:22:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:47] Treating reference as 'fasta' format.
[08:22:47] Will use 8 CPU cores.
[08:22:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
[08:22:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[08:22:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[08:22:47] Creating reference folder: reference
[08:22:47] Extracting FASTA and GFF from reference.
[08:22:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:22:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:22:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:22:47] Treating reference as 'fasta' format.
[08:22:47] Will use 8 CPU cores.
[08:22:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[08:22:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[08:22:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[08:22:47] Creating reference folder: reference
[08:22:47] Extracting FASTA and GFF from reference.
[08:22:48] Wrote 3 sequences to ref.fa
[08:22:48] Wrote 0 features to ref.gff
[08:22:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta into pseudo-reads
[08:22:48] Wrote 3 sequences to ref.fa
[08:22:48] Wrote 0 features to ref.gff
[08:22:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta into pseudo-reads
[08:22:48] Wrote 404884 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:48] Using BAM RG (Read Group) ID: SAL_MB7965AA_AS.out
[08:22:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:48] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320040 reads in 19.216 CPU sec, 2.594 real sec
[08:22:49] Wrote 415768 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:49] Using BAM RG (Read Group) ID: SAL_LB7623AA_AS.out
[08:22:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:49] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320148 reads in 19.908 CPU sec, 2.603 real sec
[08:22:49] Wrote 406744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:49] Using BAM RG (Read Group) ID: SAL_TA7615AA_AS.out
[08:22:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 87304 reads in 5.949 CPU sec, 0.692 real sec
[08:22:49] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[08:22:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 400000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.028 sec; CPU: 25.671 sec
[samclip] Total SAM records 407629, removed 2177, allowed 226, passed 405452
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 88394 reads in 6.120 CPU sec, 0.710 real sec
[M::process] read 320126 sequences (80000292 bp)...
[samclip] Processed 300000 records...
[M::process] read 84758 sequences (21189500 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.072 sec; CPU: 26.551 sec
[samclip] Total SAM records 409091, removed 3332, allowed 310, passed 405759
[samclip] Header contained 5 lines
[samclip] Done.
[08:22:51] Wrote 403046 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:51] Using BAM RG (Read Group) ID: SAL_AB7588AA_AS.out
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:22:51] Wrote 407736 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:22:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:22:51] Using BAM RG (Read Group) ID: SAL_NA8627AA_AS.out
[08:22:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:22:51] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB7623AA_AS.out\tSM:SAL_LB7623AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 95768 sequences (23942000 bp)...
[M::process] read 320138 sequences (80000040 bp)...
[M::process] read 86606 sequences (21651500 bp)...
[08:22:52] Running: samtools index snps.bam 2>> snps.log
[08:22:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:22:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:22:53] Running: samtools index snps.bam 2>> snps.log
[08:22:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:22:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:22:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:22:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::mem_process_seqs] Processed 320126 reads in 18.316 CPU sec, 2.734 real sec
[M::process] read 320356 sequences (80000092 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 84758 reads in 4.478 CPU sec, 0.560 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::process] read 83046 sequences (20734284 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.726 sec; CPU: 23.427 sec
[samclip] Total SAM records 405031, removed 687, allowed 84, passed 404344
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 87380 sequences (21841040 bp)...
[08:22:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 15
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 265
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:22:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:22:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:22:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320138 reads in 19.169 CPU sec, 3.835 real sec
[08:22:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 21.119 CPU sec, 4.178 real sec
[08:22:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:56] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:22:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2027
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:22:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:22:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 86606 reads in 5.677 CPU sec, 0.682 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[08:22:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 95768 reads in 5.831 CPU sec, 0.690 real sec
[08:22:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:22:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:22:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 18.693 CPU sec, 3.783 real sec
[08:22:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:22:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:22:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:22:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:22:57] Running: rm -f fake_reads\.fq 2>> snps.log
[08:22:57] Running: samtools index snps.bam 2>> snps.log
[08:22:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[08:22:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[08:22:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.529 sec; CPU: 25.429 sec
[samclip] Total SAM records 407133, removed 2739, allowed 331, passed 404394
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB7623AA_AS.out\tSM:SAL_LB7623AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.770 sec; CPU: 27.508 sec
[samclip] Total SAM records 416259, removed 9557, allowed 1022, passed 406702
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 83046 reads in 5.083 CPU sec, 0.592 real sec
[M::mem_process_seqs] Processed 320356 reads in 18.918 CPU sec, 4.335 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.250 sec; CPU: 24.346 sec
[samclip] Total SAM records 403383, removed 1599, allowed 139, passed 401784
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 87380 reads in 5.472 CPU sec, 0.632 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.814 sec; CPU: 24.942 sec
[samclip] Total SAM records 407929, removed 1519, allowed 106, passed 406410
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:22:59] Running: samtools index snps.bam 2>> snps.log
[08:22:59] Running: samtools index snps.bam 2>> snps.log
[08:22:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:22:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:22:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:00] Running: samtools index snps.bam 2>> snps.log
[08:23:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:00] Marked 654 heterozygous sites with 'n'
[08:23:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:00] Creating extra output files: BED GFF CSV TXT HTML
[08:23:00] Identified 265 variants.
[08:23:00] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[08:23:00] Result files:
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.aligned.fa
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam.bai
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bed
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.fa
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.subs.fa
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.csv
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.filt.vcf
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.gff
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.html
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.log
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.raw.vcf
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.subs.vcf
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.tab
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.txt
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz
[08:23:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz.csi
[08:23:00] Walltime used: 19 seconds
[08:23:00] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:23:00] Done.
[Tue Jun 16 08:23:00 2020]
Finished job 90.
22 of 206 steps (11%) done

[Tue Jun 16 08:23:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
    jobid: 49
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1153AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
[08:23:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:00] Running: samtools index snps.bam 2>> snps.log
[08:23:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:01] Marked 69 heterozygous sites with 'n'
[08:23:01] This is snippy 4.4.3
[08:23:01] Written by Torsten Seemann
[08:23:01] Obtained from https://github.com/tseemann/snippy
[08:23:01] Detected operating system: linux
[08:23:01] Enabling bundled linux tools.
[08:23:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:01] Creating extra output files: BED GFF CSV TXT HTML
[08:23:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:01] Identified 2027 variants.
[08:23:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[08:23:01] Result files:
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.aligned.fa
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam.bai
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bed
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.fa
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.subs.fa
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.csv
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.filt.vcf
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.gff
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.html
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.log
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.raw.vcf
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.subs.vcf
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.tab
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.txt
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz
[08:23:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz.csi
[08:23:01] Walltime used: 20 seconds
[08:23:01] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:23:01] Done.
[08:23:01] Found gzip - /usr/bin/gzip
[08:23:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[Tue Jun 16 08:23:01 2020]
Finished job 52.
23 of 206 steps (11%) done

[Tue Jun 16 08:23:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
    jobid: 53
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA7748AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[08:23:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:01] Treating reference as 'fasta' format.
[08:23:01] Will use 8 CPU cores.
[08:23:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
[08:23:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[08:23:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[08:23:01] Creating reference folder: reference
[08:23:01] Extracting FASTA and GFF from reference.
[08:23:01] Wrote 3 sequences to ref.fa
[08:23:01] Wrote 0 features to ref.gff
[08:23:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:02] This is snippy 4.4.3
[08:23:02] Written by Torsten Seemann
[08:23:02] Obtained from https://github.com/tseemann/snippy
[08:23:02] Detected operating system: linux
[08:23:02] Enabling bundled linux tools.
[08:23:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:02] Found gzip - /usr/bin/gzip
[08:23:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:02] Treating reference as 'fasta' format.
[08:23:02] Will use 8 CPU cores.
[08:23:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[08:23:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[08:23:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[08:23:02] Creating reference folder: reference
[08:23:02] Extracting FASTA and GFF from reference.
[08:23:02] Wrote 3 sequences to ref.fa
[08:23:02] Wrote 0 features to ref.gff
[08:23:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta into pseudo-reads
[08:23:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:23:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2094
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 24
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2004
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:03] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:03] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:03] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 333
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:04] Wrote 402534 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:04] Using BAM RG (Read Group) ID: SAL_CB1153AA_AS.out
[08:23:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:04] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:04] Marked 0 heterozygous sites with 'n'
[08:23:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:04] Creating extra output files: BED GFF CSV TXT HTML
[08:23:04] Identified 20 variants.
[08:23:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[08:23:04] Result files:
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.aligned.fa
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam.bai
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bed
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.fa
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.subs.fa
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.csv
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.filt.vcf
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.gff
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.html
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.log
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.raw.vcf
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.subs.vcf
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.tab
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.txt
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz
[08:23:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz.csi
[08:23:04] Walltime used: 19 seconds
[08:23:04] Questionable SNP? Try the --report option to see the alignments.
[08:23:04] Done.
[08:23:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:04] Running: rm -f fake_reads\.fq 2>> snps.log
[Tue Jun 16 08:23:05 2020]
Finished job 154.
24 of 206 steps (12%) done

[Tue Jun 16 08:23:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
    jobid: 33
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB2895AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
[08:23:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:05] Wrote 405610 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:05] Using BAM RG (Read Group) ID: SAL_YA7748AA_AS.out
[08:23:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:05] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:05] This is snippy 4.4.3
[08:23:05] Written by Torsten Seemann
[08:23:05] Obtained from https://github.com/tseemann/snippy
[08:23:05] Detected operating system: linux
[08:23:05] Enabling bundled linux tools.
[08:23:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:05] Found gzip - /usr/bin/gzip
[08:23:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:06] Treating reference as 'fasta' format.
[08:23:06] Will use 8 CPU cores.
[08:23:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
[08:23:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[08:23:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[08:23:06] Creating reference folder: reference
[08:23:06] Extracting FASTA and GFF from reference.
[08:23:06] Wrote 3 sequences to ref.fa
[08:23:06] Wrote 0 features to ref.gff
[08:23:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta into pseudo-reads
[08:23:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 82534 sequences (20616314 bp)...
[08:23:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:07] Marked 95 heterozygous sites with 'n'
[M::process] read 320092 sequences (80000466 bp)...
[08:23:07] Marked 97 heterozygous sites with 'n'
[08:23:07] Creating extra output files: BED GFF CSV TXT HTML
[08:23:07] Identified 2004 variants.
[08:23:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[08:23:07] Result files:
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.aligned.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam.bai
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bed
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.subs.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.csv
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.filt.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.gff
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.html
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.log
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.raw.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.subs.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.tab
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.txt
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz.csi
[08:23:07] Walltime used: 21 seconds
[08:23:07] Questionable SNP? Try the --report option to see the alignments.
[08:23:07] Done.
[Tue Jun 16 08:23:07 2020]
Finished job 146.
25 of 206 steps (12%) done

[Tue Jun 16 08:23:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
    jobid: 20
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5465AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
[08:23:07] Creating extra output files: BED GFF CSV TXT HTML
[M::process] read 85518 sequences (21375596 bp)...
[08:23:07] Identified 2094 variants.
[08:23:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[08:23:07] Result files:
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.aligned.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bam
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bam.bai
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bed
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.consensus.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.consensus.subs.fa
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.csv
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.filt.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.gff
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.html
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.log
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.raw.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.subs.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.tab
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.txt
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf.gz
[08:23:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf.gz.csi
[08:23:07] Walltime used: 21 seconds
[08:23:07] May the SNPs be with you.
[08:23:07] Done.
[Tue Jun 16 08:23:07 2020]
Finished job 135.
26 of 206 steps (13%) done

[Tue Jun 16 08:23:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
    jobid: 162
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB9321AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[08:23:08] Marked 216 heterozygous sites with 'n'
[08:23:08] Creating extra output files: BED GFF CSV TXT HTML
[08:23:08] Identified 345 variants.
[08:23:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[08:23:08] Result files:
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.aligned.fa
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam.bai
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bed
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.fa
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.subs.fa
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.csv
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.filt.vcf
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.gff
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.html
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.log
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.raw.vcf
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.subs.vcf
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.tab
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.txt
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz
[08:23:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz.csi
[08:23:08] Walltime used: 21 seconds
[08:23:08] Wishing you a life free of homopolymer errors.
[08:23:08] Done.
[Tue Jun 16 08:23:08 2020]
Finished job 115.
27 of 206 steps (13%) done

[Tue Jun 16 08:23:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
    jobid: 151
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6600AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:08] This is snippy 4.4.3
[08:23:08] Written by Torsten Seemann
[08:23:08] Obtained from https://github.com/tseemann/snippy
[08:23:08] Detected operating system: linux
[08:23:08] Enabling bundled linux tools.
[08:23:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:08] This is snippy 4.4.3
[08:23:08] Written by Torsten Seemann
[08:23:08] Obtained from https://github.com/tseemann/snippy
[08:23:08] Detected operating system: linux
[08:23:08] Enabling bundled linux tools.
[08:23:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:08] Found gzip - /usr/bin/gzip
[08:23:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:08] Found gzip - /usr/bin/gzip
[08:23:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:08] Treating reference as 'fasta' format.
[08:23:08] Will use 8 CPU cores.
[08:23:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
[08:23:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[08:23:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[08:23:08] Creating reference folder: reference
[08:23:08] Extracting FASTA and GFF from reference.
[08:23:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:08] This is snippy 4.4.3
[08:23:08] Written by Torsten Seemann
[08:23:08] Obtained from https://github.com/tseemann/snippy
[08:23:08] Detected operating system: linux
[08:23:08] Enabling bundled linux tools.
[08:23:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:08] Treating reference as 'fasta' format.
[08:23:08] Will use 8 CPU cores.
[08:23:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[08:23:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[08:23:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[08:23:08] Creating reference folder: reference
[08:23:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:08] Extracting FASTA and GFF from reference.
[08:23:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:08] Wrote 3 sequences to ref.fa
[08:23:08] Wrote 0 features to ref.gff
[08:23:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta into pseudo-reads
[08:23:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:08] Found gzip - /usr/bin/gzip
[08:23:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:09] Wrote 3 sequences to ref.fa
[08:23:09] Wrote 0 features to ref.gff
[08:23:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta into pseudo-reads
[08:23:09] Wrote 404570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:09] Using BAM RG (Read Group) ID: SAL_EB2895AA_AS.out
[08:23:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:09] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:09] Marked 431 heterozygous sites with 'n'
[08:23:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:09] Treating reference as 'fasta' format.
[08:23:09] Will use 8 CPU cores.
[08:23:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
[08:23:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[08:23:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[08:23:09] Creating reference folder: reference
[08:23:09] Extracting FASTA and GFF from reference.
[08:23:09] Creating extra output files: BED GFF CSV TXT HTML
[08:23:09] Identified 333 variants.
[08:23:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[08:23:09] Result files:
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.aligned.fa
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam.bai
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bed
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.fa
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.subs.fa
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.csv
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.filt.vcf
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.gff
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.html
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.log
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.raw.vcf
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.subs.vcf
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.tab
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.txt
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz
[08:23:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz.csi
[08:23:09] Walltime used: 22 seconds
[08:23:09] May the SNPs be with you.
[08:23:09] Done.
[Tue Jun 16 08:23:09 2020]
Finished job 16.
28 of 206 steps (14%) done

[Tue Jun 16 08:23:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
    jobid: 112
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA5706AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[08:23:09] Wrote 3 sequences to ref.fa
[08:23:09] Wrote 0 features to ref.gff
[08:23:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320000 reads in 19.603 CPU sec, 2.629 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[08:23:09] This is snippy 4.4.3
[08:23:09] Written by Torsten Seemann
[08:23:09] Obtained from https://github.com/tseemann/snippy
[08:23:09] Detected operating system: linux
[08:23:09] Enabling bundled linux tools.
[08:23:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:10] Found gzip - /usr/bin/gzip
[08:23:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[08:23:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::mem_process_seqs] Processed 82534 reads in 5.351 CPU sec, 0.619 real sec
[08:23:10] Treating reference as 'fasta' format.
[08:23:10] Will use 8 CPU cores.
[08:23:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[08:23:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[08:23:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[08:23:10] Creating reference folder: reference
[08:23:10] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[08:23:10] Wrote 3 sequences to ref.fa
[08:23:10] Wrote 0 features to ref.gff
[08:23:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320092 reads in 19.731 CPU sec, 2.671 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.062 sec; CPU: 25.487 sec
[samclip] Total SAM records 402828, removed 1466, allowed 132, passed 401362
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:23:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 85518 reads in 6.737 CPU sec, 0.782 real sec
[samclip] Processed 300000 records...
[M::process] read 320278 sequences (80000248 bp)...
[M::process] read 84292 sequences (21073000 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.108 sec; CPU: 26.947 sec
[samclip] Total SAM records 405840, removed 1509, allowed 205, passed 404331
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:11] Wrote 405876 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:11] Using BAM RG (Read Group) ID: SAL_WA5465AA_AS.out
[08:23:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:11] Wrote 402154 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:12] Using BAM RG (Read Group) ID: SAL_AB9321AA_AS.out
[08:23:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:12] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:12] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:12] Running: samtools index snps.bam 2>> snps.log
[08:23:12] Wrote 404506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:12] Using BAM RG (Read Group) ID: SAL_YA6600AA_AS.out
[08:23:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:12] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:13] Wrote 404550 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:13] Using BAM RG (Read Group) ID: SAL_FA5706AA_AS.out
[08:23:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:13] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:13] Running: samtools index snps.bam 2>> snps.log
[08:23:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320278 reads in 18.082 CPU sec, 2.427 real sec
[08:23:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 100000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::mem_process_seqs] Processed 84292 reads in 5.512 CPU sec, 0.636 real sec
[M::process] read 82154 sequences (20501814 bp)...
[M::process] read 320220 sequences (80000068 bp)...
[samclip] Processed 300000 records...
[M::process] read 85656 sequences (21413362 bp)...
[08:23:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.929 sec; CPU: 24.120 sec
[samclip] Total SAM records 404840, removed 868, allowed 67, passed 403972
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320054 sequences (80000362 bp)...
[08:23:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320054 sequences (80000082 bp)...
[08:23:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 351
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 84452 sequences (21101846 bp)...
[08:23:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:16] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 84496 sequences (21118820 bp)...
[08:23:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 17.298 CPU sec, 2.592 real sec
[08:23:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1803
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:17] Running: samtools index snps.bam 2>> snps.log
[08:23:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[08:23:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::mem_process_seqs] Processed 82154 reads in 5.449 CPU sec, 0.652 real sec
[08:23:17] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[08:23:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320220 reads in 20.192 CPU sec, 3.389 real sec
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.249 sec; CPU: 23.319 sec
[samclip] Total SAM records 402607, removed 1844, allowed 140, passed 400763
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 85656 reads in 5.148 CPU sec, 0.610 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320054 reads in 19.174 CPU sec, 3.613 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 406397, removed 2896, allowed 341, passed 403501
[main] CMD:[samclip] Header contained 5 lines
 bwa[samclip] Done.
 mem -Y -M -R @RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.989 sec; CPU: 25.938 sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320054 reads in 19.616 CPU sec, 3.648 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 84452 reads in 5.699 CPU sec, 0.676 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 404993, removed 3185, allowed 439, passed 401808

[main] Real time: 5.102 sec; CPU: 25.407 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 84496 reads in 7.170 CPU sec, 0.837 real sec
[08:23:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 35
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:20] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 404881, removed 2154, allowed 357, passed 402727
[main] CMD:[samclip] Header contained 5 lines
 bwa mem[samclip] Done.
 -Y -M -R @RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.118 sec; CPU: 27.266 sec
[08:23:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:20] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:20] Marked 216 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:20] Creating extra output files: BED GFF CSV TXT HTML
[08:23:20] Identified 351 variants.
[08:23:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[08:23:20] Result files:
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.aligned.fa
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam.bai
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bed
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.fa
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.subs.fa
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.csv
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.filt.vcf
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.gff
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.html
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.log
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.raw.vcf
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.subs.vcf
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.tab
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.txt
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz
[08:23:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz.csi
[08:23:20] Walltime used: 19 seconds
[08:23:20] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:23:20] Done.
[Tue Jun 16 08:23:20 2020]
Finished job 49.
29 of 206 steps (14%) done

[Tue Jun 16 08:23:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
    jobid: 123
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
[08:23:21] Running: samtools index snps.bam 2>> snps.log
[08:23:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:21] This is snippy 4.4.3
[08:23:21] Written by Torsten Seemann
[08:23:21] Obtained from https://github.com/tseemann/snippy
[08:23:21] Detected operating system: linux
[08:23:21] Enabling bundled linux tools.
[08:23:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:21] Found gzip - /usr/bin/gzip
[08:23:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:21] Running: samtools index snps.bam 2>> snps.log
[08:23:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:21] Treating reference as 'fasta' format.
[08:23:21] Will use 8 CPU cores.
[08:23:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
[08:23:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[08:23:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[08:23:21] Creating reference folder: reference
[08:23:21] Extracting FASTA and GFF from reference.
[08:23:21] Marked 0 heterozygous sites with 'n'
[08:23:21] Creating extra output files: BED GFF CSV TXT HTML
[08:23:21] Identified 1803 variants.
[08:23:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[08:23:21] Result files:
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.aligned.fa
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam.bai
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bed
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.fa
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.subs.fa
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.csv
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.filt.vcf
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.gff
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.html
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.log
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.raw.vcf
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.subs.vcf
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.tab
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.txt
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz
[08:23:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz.csi
[08:23:21] Walltime used: 19 seconds
[08:23:21] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:23:21] Done.
[Tue Jun 16 08:23:21 2020]
Finished job 53.
30 of 206 steps (15%) done

[Tue Jun 16 08:23:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
    jobid: 15
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA7782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[08:23:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:21] Wrote 3 sequences to ref.fa
[08:23:21] Wrote 0 features to ref.gff
[08:23:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta into pseudo-reads
[08:23:22] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:22] This is snippy 4.4.3
[08:23:22] Written by Torsten Seemann
[08:23:22] Obtained from https://github.com/tseemann/snippy
[08:23:22] Detected operating system: linux
[08:23:22] Enabling bundled linux tools.
[08:23:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:22] Found gzip - /usr/bin/gzip
[08:23:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:22] Treating reference as 'fasta' format.
[08:23:22] Will use 8 CPU cores.
[08:23:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[08:23:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[08:23:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[08:23:22] Creating reference folder: reference
[08:23:22] Extracting FASTA and GFF from reference.
[08:23:23] Wrote 3 sequences to ref.fa
[08:23:23] Wrote 0 features to ref.gff
[08:23:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta into pseudo-reads
[08:23:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:24] Marked 0 heterozygous sites with 'n'
[08:23:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:23:24] Creating extra output files: BED GFF CSV TXT HTML
[08:23:24] Identified 35 variants.

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[08:23:24] Result files:
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.aligned.fa
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam.bai
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bed
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.fa
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.subs.fa
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.csv
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.filt.vcf
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.gff
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.html
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.log
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.raw.vcf
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.subs.vcf
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.tab
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.txt
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz
[08:23:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz.csi
[08:23:24] Walltime used: 19 seconds
[08:23:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:23:24] Done.
[08:23:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[Tue Jun 16 08:23:24 2020]
Finished job 33.
31 of 206 steps (15%) done

[Tue Jun 16 08:23:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
    jobid: 139
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6602AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[08:23:24] Wrote 405058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:24] Using BAM RG (Read Group) ID: SAL_XA1782AA_AS.out
[08:23:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:24] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:23:25] Running: rm -f fake_reads\.fq 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 25
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2099
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:25] This is snippy 4.4.3
[08:23:25] Written by Torsten Seemann
[08:23:25] Obtained from https://github.com/tseemann/snippy
[08:23:25] Detected operating system: linux
[08:23:25] Enabling bundled linux tools.
[08:23:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:25] Found gzip - /usr/bin/gzip
[08:23:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:23:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1842
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:25] Wrote 405414 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:25] Treating reference as 'fasta' format.
[08:23:25] Will use 8 CPU cores.
[08:23:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[08:23:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[08:23:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[08:23:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:25] Using BAM RG (Read Group) ID: SAL_LA7782AA_AS.out
[08:23:25] Creating reference folder: reference
[08:23:25] Extracting FASTA and GFF from reference.
[08:23:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:25] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:25] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:26] Wrote 3 sequences to ref.fa
[08:23:26] Wrote 0 features to ref.gff
[08:23:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta into pseudo-reads
[08:23:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320182 sequences (80000392 bp)...
[M::process] read 84876 sequences (21209724 bp)...
[08:23:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320080 sequences (80000452 bp)...
[08:23:28] Marked 224 heterozygous sites with 'n'
[08:23:28] Creating extra output files: BED GFF CSV TXT HTML
[08:23:28] Identified 345 variants.
[08:23:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[08:23:28] Result files:
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.aligned.fa
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam.bai
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bed
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.fa
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.subs.fa
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.csv
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.filt.vcf
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.gff
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.html
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.log
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.raw.vcf
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.subs.vcf
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.tab
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.txt
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz
[08:23:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz.csi
[08:23:28] Walltime used: 20 seconds
[08:23:28] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:23:28] Done.
[M::process] read 85334 sequences (21318726 bp)...
[Tue Jun 16 08:23:28 2020]
Finished job 162.
32 of 206 steps (16%) done

[Tue Jun 16 08:23:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
    jobid: 133
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1915AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:28] Wrote 404406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:28] Using BAM RG (Read Group) ID: SAL_YA6602AA_AS.out
[08:23:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:28] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:29] This is snippy 4.4.3
[08:23:29] Written by Torsten Seemann
[08:23:29] Obtained from https://github.com/tseemann/snippy
[08:23:29] Detected operating system: linux
[08:23:29] Enabling bundled linux tools.
[08:23:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:29] Found gzip - /usr/bin/gzip
[08:23:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:29] Treating reference as 'fasta' format.
[08:23:29] Will use 8 CPU cores.
[08:23:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
[08:23:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[08:23:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[08:23:29] Creating reference folder: reference
[08:23:29] Extracting FASTA and GFF from reference.
[08:23:29] Wrote 3 sequences to ref.fa
[08:23:29] Wrote 0 features to ref.gff
[08:23:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta into pseudo-reads
[08:23:29] Marked 117 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320182 reads in 18.389 CPU sec, 2.542 real sec
[08:23:29] Creating extra output files: BED GFF CSV TXT HTML
[08:23:29] Identified 2000 variants.
[08:23:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[08:23:29] Result files:
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.aligned.fa
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam.bai
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bed
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.fa
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.subs.fa
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.csv
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.filt.vcf
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.gff
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.html
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.log
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.raw.vcf
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.subs.vcf
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.tab
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.txt
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz
[08:23:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz.csi
[08:23:29] Walltime used: 21 seconds
[08:23:29] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:23:29] Done.
[Tue Jun 16 08:23:29 2020]
Finished job 20.
33 of 206 steps (16%) done

[Tue Jun 16 08:23:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
    jobid: 96
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5468AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:30] Marked 96 heterozygous sites with 'n'
[08:23:30] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 84876 reads in 6.275 CPU sec, 0.731 real sec
[08:23:30] Identified 2099 variants.
[08:23:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[08:23:30] Result files:
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.aligned.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam.bai
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bed
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.subs.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.csv
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.filt.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.gff
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.html
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.log
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.raw.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.subs.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.tab
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.txt
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz.csi
[08:23:30] Walltime used: 22 seconds
[08:23:30] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:23:30] Done.
[Tue Jun 16 08:23:30 2020]
Finished job 151.
34 of 206 steps (17%) done

[Tue Jun 16 08:23:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
    jobid: 62
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA4227AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[08:23:30] This is snippy 4.4.3
[08:23:30] Written by Torsten Seemann
[08:23:30] Obtained from https://github.com/tseemann/snippy
[08:23:30] Detected operating system: linux
[08:23:30] Enabling bundled linux tools.
[08:23:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[samclip] Processed 300000 records...
[08:23:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:30] Found gzip - /usr/bin/gzip
[08:23:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320080 reads in 18.760 CPU sec, 2.460 real sec
[08:23:30] Marked 7 heterozygous sites with 'n'
[08:23:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:30] Treating reference as 'fasta' format.
[08:23:30] Will use 8 CPU cores.
[08:23:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[08:23:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[08:23:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[08:23:30] Creating reference folder: reference
[08:23:30] Extracting FASTA and GFF from reference.
[08:23:30] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 400000 records...
[08:23:30] Identified 1842 variants.
[08:23:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[08:23:30] Result files:
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.aligned.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam.bai
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bed
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.subs.fa
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.csv
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.filt.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.gff
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.html
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.log
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.raw.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.subs.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.tab
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.txt
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz
[08:23:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz.csi
[08:23:30] Walltime used: 21 seconds
[08:23:30] Questionable SNP? Try the --report option to see the alignments.
[08:23:30] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 405367, removed 2700, allowed 170, passed 402667

[main] Real time: 4.009 sec; CPU: 25.181 sec
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 08:23:30 2020]
Finished job 112.
35 of 206 steps (17%) done

[Tue Jun 16 08:23:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
    jobid: 138
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA6251AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:30] Wrote 3 sequences to ref.fa
[08:23:30] Wrote 0 features to ref.gff
[08:23:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[08:23:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:30] This is snippy 4.4.3
[08:23:30] Written by Torsten Seemann
[08:23:30] Obtained from https://github.com/tseemann/snippy
[08:23:30] Detected operating system: linux
[08:23:30] Enabling bundled linux tools.
[08:23:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[samclip] Processed 200000 records...
[08:23:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:31] Found gzip - /usr/bin/gzip
[08:23:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:31] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320150 sequences (80000310 bp)...
[M::mem_process_seqs] Processed 85334 reads in 5.948 CPU sec, 0.696 real sec
[08:23:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:31] Treating reference as 'fasta' format.
[08:23:31] Will use 8 CPU cores.
[08:23:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[08:23:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[08:23:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[08:23:31] Creating reference folder: reference
[08:23:31] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[M::process] read 84256 sequences (21053322 bp)...
[08:23:31] This is snippy 4.4.3
[08:23:31] Written by Torsten Seemann
[08:23:31] Obtained from https://github.com/tseemann/snippy
[08:23:31] Detected operating system: linux
[08:23:31] Enabling bundled linux tools.
[08:23:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:31] Wrote 3 sequences to ref.fa
[08:23:31] Wrote 0 features to ref.gff
[08:23:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta into pseudo-reads
[08:23:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:31] Found gzip - /usr/bin/gzip
[08:23:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 405778, removed 2756, allowed 243, passed 403022
[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.894 sec; CPU: 25.206 sec
[08:23:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:31] Treating reference as 'fasta' format.
[08:23:31] Will use 8 CPU cores.
[08:23:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[08:23:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[08:23:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[08:23:31] Creating reference folder: reference
[08:23:31] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:31] Wrote 3 sequences to ref.fa
[08:23:31] Wrote 0 features to ref.gff
[08:23:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta into pseudo-reads
[08:23:32] Wrote 400510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:32] Using BAM RG (Read Group) ID: SAL_BB1915AA_AS.out
[08:23:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:32] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:32] Running: samtools index snps.bam 2>> snps.log
[08:23:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:33] Wrote 399890 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:33] Using BAM RG (Read Group) ID: SAL_CB5468AA_AS.out
[08:23:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:33] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:33] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320150 reads in 19.070 CPU sec, 2.537 real sec
[08:23:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[08:23:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:34] Wrote 403620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:34] Using BAM RG (Read Group) ID: SAL_TA4227AA_AS.out
[08:23:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:23:34] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 84256 reads in 6.064 CPU sec, 0.703 real sec
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 300000 records...
[08:23:34] Wrote 405514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::process] read 80510 sequences (20127500 bp)...
[08:23:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:34] Using BAM RG (Read Group) ID: SAL_WA6251AA_AS.out
[08:23:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:34] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.060 sec; CPU: 25.686 sec
[samclip] Total SAM records 404746, removed 3172, allowed 410, passed 401574
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 130
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320032 sequences (80000134 bp)...
[08:23:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 79858 sequences (19922496 bp)...
[08:23:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:23:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 320186 sequences (80000138 bp)...
[08:23:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 83434 sequences (20847472 bp)...
[08:23:36] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320166 sequences (80000378 bp)...
[M::process] read 85348 sequences (21329224 bp)...
[08:23:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 2010
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:23:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.358 CPU sec, 2.810 real sec
[08:23:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:23:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:37] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 80510 reads in 4.714 CPU sec, 0.567 real sec
[samclip] Processed 200000 records...
[08:23:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.478 sec; CPU: 24.635 sec
[samclip] Total SAM records 400671, removed 744, allowed 46, passed 399927
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320032 reads in 17.684 CPU sec, 3.298 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320186 reads in 19.005 CPU sec, 3.043 real sec
[M::mem_process_seqs] Processed 320166 reads in 19.202 CPU sec, 2.783 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 79858 reads in 4.644 CPU sec, 0.575 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 83434 reads in 5.066 CPU sec, 0.612 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 85348 reads in 5.387 CPU sec, 0.641 real sec
[samclip] Processed 200000 records...
[08:23:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 400000 records...

stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 26
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 2097
       total no. reference observed             : 0

Time elapsed: 0.02s

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.877 sec; CPU: 22.906 sec
[samclip] Total SAM records 400217, removed 960, allowed 90, passed 399257
[samclip] Header contained 5 lines
[samclip] Done.
[08:23:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:40] Marked 3 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:23:40] Creating extra output files: BED GFF CSV TXT HTML
[08:23:40] Identified 130 variants.
[08:23:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[08:23:40] Result files:
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.aligned.fa
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam.bai
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bed
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.fa
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.subs.fa
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.csv
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.filt.vcf
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.gff
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.html
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.log
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.raw.vcf
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.subs.vcf
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.tab
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.txt
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz
[08:23:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz.csi
[08:23:40] Walltime used: 19 seconds
[08:23:40] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:23:40] Done.
[08:23:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[Tue Jun 16 08:23:40 2020]
Finished job 123.
36 of 206 steps (17%) done

[Tue Jun 16 08:23:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
    jobid: 4
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA2587AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[08:23:40] Running: samtools index snps.bam 2>> snps.log
[08:23:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[08:23:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 403869, removed 2657, allowed 178, passed 401212
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.677 sec; CPU: 24.681 sec
[08:23:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[08:23:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.408 sec; CPU: 25.164 sec
[samclip] Total SAM records 405808, removed 2367, allowed 207, passed 403441
[samclip] Header contained 5 lines
[samclip] Done.
[08:23:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:41] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:41] This is snippy 4.4.3
[08:23:41] Written by Torsten Seemann
[08:23:41] Obtained from https://github.com/tseemann/snippy
[08:23:41] Detected operating system: linux
[08:23:41] Enabling bundled linux tools.
[08:23:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:41] Found gzip - /usr/bin/gzip
[08:23:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:41] Treating reference as 'fasta' format.
[08:23:41] Will use 8 CPU cores.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[08:23:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[08:23:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[08:23:41] Creating reference folder: reference
[08:23:41] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:42] Wrote 3 sequences to ref.fa
[08:23:42] Wrote 0 features to ref.gff
[08:23:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta into pseudo-reads
[08:23:42] Marked 9 heterozygous sites with 'n'
[08:23:42] Creating extra output files: BED GFF CSV TXT HTML
[08:23:42] Identified 2010 variants.
[08:23:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[08:23:42] Result files:
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.aligned.fa
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam.bai
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bed
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.fa
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.subs.fa
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.csv
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.filt.vcf
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.gff
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.html
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.log
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.raw.vcf
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.subs.vcf
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.tab
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.txt
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz
[08:23:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz.csi
[08:23:42] Walltime used: 20 seconds
[08:23:42] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:23:42] Done.
[Tue Jun 16 08:23:42 2020]
Finished job 15.
37 of 206 steps (18%) done

[Tue Jun 16 08:23:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
    jobid: 54
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB8076AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[08:23:42] Running: samtools index snps.bam 2>> snps.log
[08:23:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:42] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:42] Running: samtools index snps.bam 2>> snps.log
[08:23:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:43] This is snippy 4.4.3
[08:23:43] Written by Torsten Seemann
[08:23:43] Obtained from https://github.com/tseemann/snippy
[08:23:43] Detected operating system: linux
[08:23:43] Enabling bundled linux tools.
[08:23:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:43] Found gzip - /usr/bin/gzip
[08:23:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:43] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:23:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:43] Treating reference as 'fasta' format.
[08:23:43] Will use 8 CPU cores.
[08:23:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[08:23:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[08:23:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[08:23:43] Creating reference folder: reference
[08:23:43] Extracting FASTA and GFF from reference.
[08:23:43] Wrote 3 sequences to ref.fa
[08:23:43] Wrote 0 features to ref.gff
[08:23:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta into pseudo-reads
[08:23:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:44] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:44] Wrote 403896 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:44] Using BAM RG (Read Group) ID: SAL_TA2587AA_AS.out
[08:23:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:44] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:45] Marked 95 heterozygous sites with 'n'
[08:23:45] Creating extra output files: BED GFF CSV TXT HTML
[08:23:45] Identified 2097 variants.
[08:23:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[08:23:45] Result files:
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.aligned.fa
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam.bai
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bed
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.fa
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.subs.fa
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.csv
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.filt.vcf
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.gff
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.html
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.log
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.raw.vcf
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.subs.vcf
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.tab
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.txt
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz
[08:23:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz.csi
[08:23:45] Walltime used: 20 seconds
[08:23:45] May the SNPs be with you.
[08:23:45] Done.
[Tue Jun 16 08:23:45 2020]
Finished job 139.
38 of 206 steps (18%) done

[Tue Jun 16 08:23:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
    jobid: 175
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_QA5436AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
[08:23:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:45] This is snippy 4.4.3
[08:23:45] Written by Torsten Seemann
[08:23:45] Obtained from https://github.com/tseemann/snippy
[08:23:45] Detected operating system: linux
[08:23:45] Enabling bundled linux tools.
[08:23:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:45] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:46] Found gzip - /usr/bin/gzip
[08:23:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:23:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:23:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 669
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:46] Wrote 399724 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:46] Using BAM RG (Read Group) ID: SAL_LB8076AA_AS.out
[08:23:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:46] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:46] Treating reference as 'fasta' format.
[08:23:46] Will use 8 CPU cores.
[08:23:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
[08:23:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[08:23:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[08:23:46] Creating reference folder: reference
[08:23:46] Extracting FASTA and GFF from reference.
[08:23:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:23:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 317
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:46] Wrote 3 sequences to ref.fa
[08:23:46] Wrote 0 features to ref.gff
[08:23:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta into pseudo-reads
[08:23:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:46] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:23:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:46] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320232 sequences (80000328 bp)...
[M::process] read 83664 sequences (20911040 bp)...
[08:23:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:48] Marked 0 heterozygous sites with 'n'
[08:23:48] Creating extra output files: BED GFF CSV TXT HTML
[08:23:48] Identified 19 variants.
[08:23:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[08:23:48] Result files:
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.aligned.fa
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam.bai
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bed
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.fa
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.subs.fa
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.csv
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.filt.vcf
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.gff
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.html
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.log
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.raw.vcf
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.subs.vcf
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.tab
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.txt
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz
[08:23:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz.csi
[08:23:48] Walltime used: 19 seconds
[08:23:48] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:23:48] Done.
[Tue Jun 16 08:23:48 2020]
Finished job 133.
39 of 206 steps (19%) done

[Tue Jun 16 08:23:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
    jobid: 65
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4921AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[M::process] read 320116 sequences (80000394 bp)...
[M::process] read 79608 sequences (19902000 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:49] This is snippy 4.4.3
[08:23:49] Written by Torsten Seemann
[08:23:49] Obtained from https://github.com/tseemann/snippy
[08:23:49] Detected operating system: linux
[08:23:49] Enabling bundled linux tools.
[08:23:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:49] Found gzip - /usr/bin/gzip
[08:23:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:49] Wrote 403504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:49] Using BAM RG (Read Group) ID: SAL_QA5436AA_AS.out
[08:23:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:49] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:49] Treating reference as 'fasta' format.
[08:23:49] Will use 8 CPU cores.
[08:23:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[08:23:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[08:23:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[08:23:49] Creating reference folder: reference
[08:23:49] Extracting FASTA and GFF from reference.
[08:23:49] Wrote 3 sequences to ref.fa
[08:23:49] Wrote 0 features to ref.gff
[08:23:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320232 reads in 18.483 CPU sec, 2.495 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[08:23:50] Marked 0 heterozygous sites with 'n'
[08:23:50] Creating extra output files: BED GFF CSV TXT HTML
[08:23:50] Identified 25 variants.
[08:23:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[08:23:50] Result files:
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.aligned.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam.bai
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bed
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.subs.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.csv
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.filt.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.gff
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.html
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.log
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.raw.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.subs.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.tab
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.txt
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz.csi
[08:23:50] Walltime used: 20 seconds
[08:23:50] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:23:50] Done.
[Tue Jun 16 08:23:50 2020]
Finished job 96.
40 of 206 steps (19%) done

[Tue Jun 16 08:23:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
    jobid: 188
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
[M::mem_process_seqs] Processed 83664 reads in 5.761 CPU sec, 0.666 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.939 sec; CPU: 24.771 sec
[samclip] Total SAM records 404132, removed 2606, allowed 194, passed 401526
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:50] Marked 381 heterozygous sites with 'n'
[08:23:50] Creating extra output files: BED GFF CSV TXT HTML
[08:23:50] Identified 669 variants.
[08:23:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[08:23:50] Result files:
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.aligned.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam.bai
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bed
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.subs.fa
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.csv
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.filt.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.gff
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.html
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.log
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.raw.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.subs.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.tab
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.txt
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz
[08:23:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz.csi
[08:23:50] Walltime used: 20 seconds
[08:23:50] Wishing you a life free of homopolymer errors.
[08:23:50] Done.
[M::mem_process_seqs] Processed 320116 reads in 17.869 CPU sec, 2.408 real sec
[Tue Jun 16 08:23:50 2020]
Finished job 62.
41 of 206 steps (20%) done

[Tue Jun 16 08:23:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
    jobid: 70
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA4888AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[08:23:51] This is snippy 4.4.3
[08:23:51] Written by Torsten Seemann
[08:23:51] Obtained from https://github.com/tseemann/snippy
[08:23:51] Detected operating system: linux
[08:23:51] Enabling bundled linux tools.
[08:23:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:51] Found gzip - /usr/bin/gzip
[08:23:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[08:23:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:51] Marked 638 heterozygous sites with 'n'
[08:23:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:51] Treating reference as 'fasta' format.
[08:23:51] Will use 8 CPU cores.
[08:23:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
[08:23:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[08:23:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[08:23:51] Creating reference folder: reference
[08:23:51] Extracting FASTA and GFF from reference.
[08:23:51] Creating extra output files: BED GFF CSV TXT HTML
[08:23:51] Identified 317 variants.
[08:23:51] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[08:23:51] Result files:
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.aligned.fa
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam.bai
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bed
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.fa
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.subs.fa
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.csv
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.filt.vcf
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.gff
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.html
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.log
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.raw.vcf
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.subs.vcf
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.tab
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.txt
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz
[08:23:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz.csi
[08:23:51] Walltime used: 20 seconds
[08:23:51] Wishing you a life free of homopolymer errors.
[08:23:51] Done.
[Tue Jun 16 08:23:51 2020]
Finished job 138.
42 of 206 steps (20%) done

[Tue Jun 16 08:23:51 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
    jobid: 125
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA4307AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:51] Wrote 3 sequences to ref.fa
[08:23:51] Wrote 0 features to ref.gff
[08:23:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 79608 reads in 4.851 CPU sec, 0.563 real sec
[M::process] read 320164 sequences (80000414 bp)...
[08:23:51] This is snippy 4.4.3
[08:23:51] Written by Torsten Seemann
[08:23:51] Obtained from https://github.com/tseemann/snippy
[08:23:51] Detected operating system: linux
[08:23:51] Enabling bundled linux tools.
[08:23:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::process] read 83340 sequences (20806156 bp)...
[08:23:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[samclip] Processed 300000 records...
[08:23:51] Found gzip - /usr/bin/gzip
[08:23:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:23:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:51] Treating reference as 'fasta' format.
[08:23:51] Will use 8 CPU cores.
[08:23:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[08:23:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[08:23:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[08:23:51] Creating reference folder: reference
[08:23:51] Extracting FASTA and GFF from reference.
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.836 sec; CPU: 23.267 sec
[samclip] Total SAM records 400362, removed 2981, allowed 142, passed 397381
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:52] Wrote 3 sequences to ref.fa
[08:23:52] Wrote 0 features to ref.gff
[08:23:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta into pseudo-reads
[08:23:52] This is snippy 4.4.3
[08:23:52] Written by Torsten Seemann
[08:23:52] Obtained from https://github.com/tseemann/snippy
[08:23:52] Detected operating system: linux
[08:23:52] Enabling bundled linux tools.
[08:23:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:23:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:23:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:23:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:23:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:23:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:23:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:23:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:23:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:23:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:23:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:23:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:23:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:23:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:23:52] Found gzip - /usr/bin/gzip
[08:23:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:23:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:23:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:23:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:23:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:23:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:23:52] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:23:52] Wrote 397582 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:52] Using BAM RG (Read Group) ID: SAL_BB4921AA_AS.out
[08:23:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:23:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:23:52] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:23:52] Treating reference as 'fasta' format.
[08:23:52] Will use 8 CPU cores.
[08:23:52] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
[08:23:52] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[08:23:52] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[08:23:52] Creating reference folder: reference
[08:23:52] Extracting FASTA and GFF from reference.
[08:23:52] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:52] Wrote 3 sequences to ref.fa
[08:23:52] Wrote 0 features to ref.gff
[08:23:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta into pseudo-reads
[08:23:52] Running: samtools index snps.bam 2>> snps.log
[08:23:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:54] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320164 reads in 18.944 CPU sec, 2.576 real sec
[08:23:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::process] read 320000 sequences (80000000 bp)...
[08:23:54] Wrote 398166 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:54] Using BAM RG (Read Group) ID: SAL_CB5243AA_AS.out
[samclip] Processed 200000 records...
[08:23:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:54] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 77582 sequences (19392188 bp)...
[M::mem_process_seqs] Processed 83340 reads in 6.022 CPU sec, 0.701 real sec
[08:23:54] Wrote 401826 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:54] Using BAM RG (Read Group) ID: SAL_KA4888AA_AS.out
[08:23:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:23:54] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.038 sec; CPU: 25.489 sec
[samclip] Total SAM records 403759, removed 2662, allowed 189, passed 401097
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 687
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:23:56] Wrote 401744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:23:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:23:56] Using BAM RG (Read Group) ID: SAL_UA4307AA_AS.out
[08:23:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:23:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:23:56] Running: bwa index reference/ref.fa 2>> snps.log
[08:23:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:23:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:56] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:23:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:23:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 78166 sequences (19480154 bp)...
[M::process] read 320224 sequences (80000284 bp)...
[08:23:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 388
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:23:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:23:57] Running: samtools index snps.bam 2>> snps.log
[08:23:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 81602 sequences (20383156 bp)...
[08:23:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:23:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 20.935 CPU sec, 2.885 real sec
[08:23:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:23:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:23:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:23:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:23:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:23:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:23:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:23:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:23:57] Running: rm -f fake_reads\.fq 2>> snps.log
[08:23:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 77582 reads in 4.635 CPU sec, 0.570 real sec
[samclip] Processed 100000 records...
[08:23:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:23:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:23:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:23:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:23:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::process] read 320132 sequences (80000216 bp)...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.653 sec; CPU: 26.203 sec
[samclip] Total SAM records 397955, removed 1774, allowed 218, passed 396181
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 81612 sequences (20380304 bp)...
[M::mem_process_seqs] Processed 320000 reads in 18.163 CPU sec, 2.646 real sec
[M::mem_process_seqs] Processed 320224 reads in 18.095 CPU sec, 2.539 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 78166 reads in 4.526 CPU sec, 0.557 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 81602 reads in 5.223 CPU sec, 0.646 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[08:24:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 672
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:24:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[08:24:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:24:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:24:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:00] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:00] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.398 sec; CPU: 23.345 sec
[samclip] Total SAM records 398723, removed 1507, allowed 93, passed 397216
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:01] Marked 380 heterozygous sites with 'n'
[08:24:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:01] Creating extra output files: BED GFF CSV TXT HTML
[08:24:01] Identified 687 variants.
[08:24:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[08:24:01] Result files:
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.aligned.fa
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam.bai
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bed
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.fa
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.subs.fa
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.csv
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.filt.vcf
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.gff
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.html
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.log
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.raw.vcf
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.subs.vcf
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.tab
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.txt
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz
[08:24:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz.csi
[08:24:01] Walltime used: 20 seconds
[08:24:01] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:24:01] Done.
[08:24:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Tue Jun 16 08:24:01 2020]
Finished job 4.
43 of 206 steps (21%) done

[Tue Jun 16 08:24:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
    jobid: 77
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NB4129AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.352 sec; CPU: 23.950 sec
[samclip] Total SAM records 402122, removed 1283, allowed 212, passed 400839
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320132 reads in 18.394 CPU sec, 2.803 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[08:24:01] This is snippy 4.4.3
[08:24:01] Written by Torsten Seemann
[08:24:01] Obtained from https://github.com/tseemann/snippy
[08:24:01] Detected operating system: linux
[08:24:01] Enabling bundled linux tools.
[08:24:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[M::mem_process_seqs] Processed 81612 reads in 5.539 CPU sec, 0.641 real sec
[08:24:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:01] Found gzip - /usr/bin/gzip
[08:24:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:02] Treating reference as 'fasta' format.
[08:24:02] Will use 8 CPU cores.
[08:24:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[08:24:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[08:24:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[08:24:02] Creating reference folder: reference
[08:24:02] Extracting FASTA and GFF from reference.
[08:24:02] Marked 0 heterozygous sites with 'n'
[08:24:02] Creating extra output files: BED GFF CSV TXT HTML
[08:24:02] Identified 388 variants.
[08:24:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[08:24:02] Result files:
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.aligned.fa
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam.bai
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bed
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.fa
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.subs.fa
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.csv
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.filt.vcf
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.gff
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.html
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.log
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.raw.vcf
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.subs.vcf
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.tab
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.txt
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz
[08:24:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz.csi
[08:24:02] Walltime used: 19 seconds
[08:24:02] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:24:02] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Tue Jun 16 08:24:02 2020]
Finished job 54.
44 of 206 steps (21%) done

[Tue Jun 16 08:24:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
    jobid: 35
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1790AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
[08:24:02] Wrote 3 sequences to ref.fa
[08:24:02] Wrote 0 features to ref.gff
[08:24:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta into pseudo-reads
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.231 sec; CPU: 24.445 sec
[samclip] Total SAM records 401984, removed 2467, allowed 193, passed 399517
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:02] This is snippy 4.4.3
[08:24:02] Written by Torsten Seemann
[08:24:02] Obtained from https://github.com/tseemann/snippy
[08:24:02] Detected operating system: linux
[08:24:02] Enabling bundled linux tools.
[08:24:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:02] Found gzip - /usr/bin/gzip
[08:24:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:03] Running: samtools index snps.bam 2>> snps.log
[08:24:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:03] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:03] Treating reference as 'fasta' format.
[08:24:03] Will use 8 CPU cores.
[08:24:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
[08:24:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[08:24:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[08:24:03] Creating reference folder: reference
[08:24:03] Extracting FASTA and GFF from reference.
[08:24:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:03] Running: samtools index snps.bam 2>> snps.log
[08:24:03] Wrote 3 sequences to ref.fa
[08:24:03] Wrote 0 features to ref.gff
[08:24:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta into pseudo-reads
[08:24:03] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:04] Running: samtools index snps.bam 2>> snps.log
[08:24:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:24:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1932
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:24:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:05] Wrote 395494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:05] Using BAM RG (Read Group) ID: SAL_NB4129AA_AS.out
[08:24:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:05] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:05] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:05] Marked 364 heterozygous sites with 'n'
[08:24:05] Creating extra output files: BED GFF CSV TXT HTML
[08:24:05] Identified 672 variants.
[08:24:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[08:24:05] Result files:
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.aligned.fa
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam.bai
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bed
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.fa
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.subs.fa
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.csv
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.filt.vcf
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.gff
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.html
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.log
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.raw.vcf
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.subs.vcf
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.tab
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.txt
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz
[08:24:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz.csi
[08:24:05] Walltime used: 20 seconds
[08:24:05] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:24:05] Done.
[Tue Jun 16 08:24:05 2020]
Finished job 175.
45 of 206 steps (22%) done

[Tue Jun 16 08:24:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
    jobid: 132
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB2521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:06] Wrote 396332 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:06] Using BAM RG (Read Group) ID: SAL_CB1790AA_AS.out
[08:24:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:06] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:06] This is snippy 4.4.3
[08:24:06] Written by Torsten Seemann
[08:24:06] Obtained from https://github.com/tseemann/snippy
[08:24:06] Detected operating system: linux
[08:24:06] Enabling bundled linux tools.
[08:24:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:06] Found gzip - /usr/bin/gzip
[08:24:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:24:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:06] Checking version: java -version is >= 1.8 - ok, have 1.8

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 37
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:06] Treating reference as 'fasta' format.
[08:24:06] Will use 8 CPU cores.
[08:24:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
[08:24:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[08:24:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[08:24:06] Creating reference folder: reference
[08:24:06] Extracting FASTA and GFF from reference.
[08:24:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:06] Wrote 3 sequences to ref.fa
[08:24:06] Wrote 0 features to ref.gff
[08:24:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta into pseudo-reads
[08:24:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320018 sequences (80000346 bp)...
[M::process] read 75476 sequences (18869000 bp)...
[08:24:07] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 666
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:24:07] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:07] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:07] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320046 sequences (80000154 bp)...
[M::process] read 76286 sequences (19045174 bp)...
[08:24:09] Marked 0 heterozygous sites with 'n'
[08:24:09] Wrote 395948 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:09] Using BAM RG (Read Group) ID: SAL_MB2521AA_AS.out
[08:24:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:09] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:09] Creating extra output files: BED GFF CSV TXT HTML
[08:24:09] Identified 1932 variants.
[08:24:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[08:24:09] Result files:
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.aligned.fa
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam.bai
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bed
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.fa
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.subs.fa
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.csv
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.filt.vcf
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.gff
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.html
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.log
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.raw.vcf
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.subs.vcf
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.tab
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.txt
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz
[08:24:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz.csi
[08:24:09] Walltime used: 20 seconds
[08:24:09] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:24:09] Done.
[Tue Jun 16 08:24:09 2020]
Finished job 65.
46 of 206 steps (22%) done

[Tue Jun 16 08:24:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
    jobid: 100
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1826AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
[M::mem_process_seqs] Processed 320018 reads in 18.767 CPU sec, 2.505 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[08:24:10] This is snippy 4.4.3
[08:24:10] Written by Torsten Seemann
[08:24:10] Obtained from https://github.com/tseemann/snippy
[08:24:10] Detected operating system: linux
[08:24:10] Enabling bundled linux tools.
[08:24:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:10] Found gzip - /usr/bin/gzip
[08:24:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 75476 reads in 4.992 CPU sec, 0.573 real sec
[08:24:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:10] Treating reference as 'fasta' format.
[08:24:10] Will use 8 CPU cores.
[08:24:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
[08:24:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[08:24:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[08:24:10] Creating reference folder: reference
[08:24:10] Extracting FASTA and GFF from reference.
[08:24:10] Wrote 3 sequences to ref.fa
[08:24:10] Wrote 0 features to ref.gff
[08:24:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320046 reads in 16.891 CPU sec, 2.287 real sec
[08:24:10] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[08:24:10] Creating extra output files: BED GFF CSV TXT HTML
[08:24:10] Identified 21 variants.
[08:24:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[08:24:10] Result files:
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.aligned.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam.bai
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bed
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.subs.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.csv
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.filt.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.gff
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.html
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.log
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.raw.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.subs.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.tab
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.txt
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz.csi
[08:24:10] Walltime used: 19 seconds
[08:24:10] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:24:10] Done.
[08:24:10] Marked 0 heterozygous sites with 'n'
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.918 sec; CPU: 24.303 sec
[samclip] Total SAM records 395722, removed 1343, allowed 191, passed 394379
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 08:24:10 2020]
Finished job 188.
47 of 206 steps (23%) done

[Tue Jun 16 08:24:10 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
    jobid: 68
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9835AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:10] Creating extra output files: BED GFF CSV TXT HTML
[08:24:10] Identified 37 variants.
[08:24:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[08:24:10] Result files:
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.aligned.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam.bai
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bed
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.subs.fa
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.csv
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.filt.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.gff
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.html
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.log
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.raw.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.subs.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.tab
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.txt
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz
[08:24:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz.csi
[08:24:10] Walltime used: 19 seconds
[08:24:10] Questionable SNP? Try the --report option to see the alignments.
[08:24:10] Done.
[Tue Jun 16 08:24:10 2020]
Finished job 70.
48 of 206 steps (23%) done

[Tue Jun 16 08:24:10 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
    jobid: 197
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB9521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 76286 reads in 4.779 CPU sec, 0.557 real sec
[08:24:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320000 sequences (80000000 bp)...
[08:24:11] This is snippy 4.4.3
[08:24:11] Written by Torsten Seemann
[08:24:11] Obtained from https://github.com/tseemann/snippy
[08:24:11] Detected operating system: linux
[08:24:11] Enabling bundled linux tools.
[08:24:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:11] Found gzip - /usr/bin/gzip
[08:24:11] This is snippy 4.4.3
[08:24:11] Written by Torsten Seemann
[08:24:11] Obtained from https://github.com/tseemann/snippy
[08:24:11] Detected operating system: linux
[08:24:11] Enabling bundled linux tools.
[08:24:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.706 sec; CPU: 22.208 sec
[samclip] Total SAM records 396567, removed 730, allowed 71, passed 395837
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 75948 sequences (18967186 bp)...
[08:24:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:11] Found gzip - /usr/bin/gzip
[08:24:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:11] Treating reference as 'fasta' format.
[08:24:11] Will use 8 CPU cores.
[08:24:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
[08:24:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[08:24:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[08:24:11] Creating reference folder: reference
[08:24:11] Extracting FASTA and GFF from reference.
[08:24:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:11] Treating reference as 'fasta' format.
[08:24:11] Will use 8 CPU cores.
[08:24:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[08:24:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[08:24:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[08:24:11] Creating reference folder: reference
[08:24:11] Extracting FASTA and GFF from reference.
[08:24:12] Wrote 3 sequences to ref.fa
[08:24:12] Wrote 0 features to ref.gff
[08:24:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta into pseudo-reads
[08:24:12] Wrote 3 sequences to ref.fa
[08:24:12] Wrote 0 features to ref.gff
[08:24:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta into pseudo-reads
[08:24:12] Marked 382 heterozygous sites with 'n'
[08:24:12] Creating extra output files: BED GFF CSV TXT HTML
[08:24:12] Identified 666 variants.
[08:24:12] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[08:24:12] Result files:
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.aligned.fa
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam.bai
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bed
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.fa
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.subs.fa
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.csv
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.filt.vcf
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.gff
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.html
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.log
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.raw.vcf
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.subs.vcf
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.tab
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.txt
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz
[08:24:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz.csi
[08:24:12] Walltime used: 20 seconds
[08:24:12] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:24:12] Done.
[Tue Jun 16 08:24:12 2020]
Finished job 125.
49 of 206 steps (24%) done

[Tue Jun 16 08:24:12 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
    jobid: 76
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB0953AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:12] Running: samtools index snps.bam 2>> snps.log
[08:24:12] This is snippy 4.4.3
[08:24:12] Written by Torsten Seemann
[08:24:12] Obtained from https://github.com/tseemann/snippy
[08:24:12] Detected operating system: linux
[08:24:12] Enabling bundled linux tools.
[08:24:12] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:12] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:12] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:12] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:12] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:12] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:12] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:12] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:12] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:12] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:12] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:12] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:12] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:12] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:12] Found gzip - /usr/bin/gzip
[08:24:12] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:12] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:12] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:12] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:13] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:13] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:13] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:13] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:13] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:13] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:13] Treating reference as 'fasta' format.
[08:24:13] Will use 8 CPU cores.
[08:24:13] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
[08:24:13] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[08:24:13] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[08:24:13] Creating reference folder: reference
[08:24:13] Extracting FASTA and GFF from reference.
[08:24:13] Wrote 395606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:13] Using BAM RG (Read Group) ID: SAL_KB1826AA_AS.out
[08:24:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:13] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:13] Wrote 3 sequences to ref.fa
[08:24:13] Wrote 0 features to ref.gff
[08:24:13] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta into pseudo-reads
[08:24:13] Running: samtools index snps.bam 2>> snps.log
[08:24:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.674 CPU sec, 2.574 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 75948 reads in 5.384 CPU sec, 0.623 real sec
[08:24:14] Wrote 394846 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:14] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:14] Using BAM RG (Read Group) ID: SAL_CB9835AA_AS.out
[08:24:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:14] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:14] Wrote 394794 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:14] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:14] Using BAM RG (Read Group) ID: SAL_JB9521AA_AS.out
[08:24:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:24:15] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.997 sec; CPU: 24.577 sec
[samclip] Total SAM records 396515, removed 2385, allowed 111, passed 394130
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320140 sequences (80000052 bp)...
[M::process] read 75466 sequences (18860340 bp)...
[08:24:16] Wrote 398246 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:16] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:16] Using BAM RG (Read Group) ID: SAL_JB0953AA_AS.out
[08:24:16] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:16] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1823
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:24:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:16] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:24:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 30
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:16] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:24:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:17] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 320152 sequences (80000310 bp)...
[08:24:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 74694 sequences (18673500 bp)...
[08:24:17] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320196 sequences (80000406 bp)...
[08:24:17] Running: samtools index snps.bam 2>> snps.log
[08:24:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 74598 sequences (18601214 bp)...
[08:24:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:18] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320008 sequences (80000424 bp)...
[M::mem_process_seqs] Processed 320140 reads in 19.739 CPU sec, 3.000 real sec
[samclip] Processed 100000 records...
[M::process] read 78238 sequences (19559500 bp)...
[M::mem_process_seqs] Processed 75466 reads in 4.328 CPU sec, 0.521 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320152 reads in 17.508 CPU sec, 2.710 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.543 sec; CPU: 24.671 sec
[samclip] Total SAM records 395965, removed 1616, allowed 126, passed 394349
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320196 reads in 18.206 CPU sec, 2.770 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74694 reads in 4.668 CPU sec, 0.554 real sec
[samclip] Processed 200000 records...
[08:24:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 260
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 100000 records...
[08:24:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 74598 reads in 4.615 CPU sec, 0.547 real sec
[08:24:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:24:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:24:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:20] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.155 sec; CPU: 22.705 sec
[samclip] Total SAM records 395104, removed 1437, allowed 126, passed 393667
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.341 sec; CPU: 23.417 sec
[samclip] Total SAM records 395069, removed 883, allowed 95, passed 394186
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320008 reads in 18.026 CPU sec, 2.997 real sec
[08:24:21] Marked 0 heterozygous sites with 'n'
[08:24:21] Creating extra output files: BED GFF CSV TXT HTML
[08:24:21] Identified 30 variants.
[08:24:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[08:24:21] Result files:
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.aligned.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam.bai
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bed
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.subs.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.csv
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.filt.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.gff
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.html
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.log
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.raw.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.subs.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.tab
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.txt
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz.csi
[08:24:21] Walltime used: 19 seconds
[08:24:21] May the SNPs be with you.
[08:24:21] Done.
[Tue Jun 16 08:24:21 2020]
Finished job 35.
50 of 206 steps (24%) done

[Tue Jun 16 08:24:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
    jobid: 13
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5642AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[08:24:21] Marked 0 heterozygous sites with 'n'
[08:24:21] Creating extra output files: BED GFF CSV TXT HTML
[08:24:21] Identified 1823 variants.
[08:24:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[08:24:21] Result files:
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.aligned.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam.bai
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bed
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.subs.fa
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.csv
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.filt.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.gff
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.html
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.log
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.raw.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.subs.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.tab
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.txt
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz
[08:24:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz.csi
[08:24:21] Walltime used: 20 seconds
[08:24:21] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:24:21] Done.
[Tue Jun 16 08:24:21 2020]
Finished job 77.
51 of 206 steps (25%) done

[Tue Jun 16 08:24:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
    jobid: 156
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:21] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[08:24:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 78238 reads in 5.242 CPU sec, 0.611 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[08:24:22] This is snippy 4.4.3
[08:24:22] Written by Torsten Seemann
[08:24:22] Obtained from https://github.com/tseemann/snippy
[08:24:22] Detected operating system: linux
[08:24:22] Enabling bundled linux tools.
[08:24:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:22] Found gzip - /usr/bin/gzip
[08:24:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:22] This is snippy 4.4.3
[08:24:22] Written by Torsten Seemann
[08:24:22] Obtained from https://github.com/tseemann/snippy
[08:24:22] Detected operating system: linux
[08:24:22] Enabling bundled linux tools.
[08:24:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:22] Found gzip - /usr/bin/gzip
[08:24:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:22] Treating reference as 'fasta' format.
[08:24:22] Will use 8 CPU cores.
[08:24:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[08:24:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[08:24:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[08:24:22] Creating reference folder: reference
[08:24:22] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.400 sec; CPU: 23.769 sec
[samclip] Total SAM records 398486, removed 1292, allowed 243, passed 397194
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:22] Treating reference as 'fasta' format.
[08:24:22] Will use 8 CPU cores.
[08:24:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[08:24:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[08:24:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[08:24:22] Creating reference folder: reference
[08:24:22] Extracting FASTA and GFF from reference.
[08:24:22] Wrote 3 sequences to ref.fa
[08:24:22] Wrote 0 features to ref.gff
[08:24:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta into pseudo-reads
[08:24:22] Wrote 3 sequences to ref.fa
[08:24:22] Wrote 0 features to ref.gff
[08:24:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta into pseudo-reads
[08:24:22] Running: samtools index snps.bam 2>> snps.log
[08:24:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:23] Running: samtools index snps.bam 2>> snps.log
[08:24:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:24] Running: samtools index snps.bam 2>> snps.log
[08:24:24] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:24] Marked 0 heterozygous sites with 'n'
[08:24:25] Creating extra output files: BED GFF CSV TXT HTML
[08:24:25] Identified 260 variants.
[08:24:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[08:24:25] Result files:
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.aligned.fa
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam.bai
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bed
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.fa
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.subs.fa
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.csv
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.filt.vcf
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.gff
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.html
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.log
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.raw.vcf
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.subs.vcf
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.tab
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.txt
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz
[08:24:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz.csi
[08:24:25] Walltime used: 19 seconds
[08:24:25] Questionable SNP? Try the --report option to see the alignments.
[08:24:25] Done.
[Tue Jun 16 08:24:25 2020]
Finished job 132.
52 of 206 steps (25%) done

[Tue Jun 16 08:24:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
    jobid: 40
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
[08:24:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:24:25] Wrote 394490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 467
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:25] Using BAM RG (Read Group) ID: SAL_AB5642AA_AS.out
[08:24:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:25] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:25] Wrote 394170 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:25] Using BAM RG (Read Group) ID: SAL_BB2967AA_AS.out
[08:24:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:25] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:26] This is snippy 4.4.3
[08:24:26] Written by Torsten Seemann
[08:24:26] Obtained from https://github.com/tseemann/snippy
[08:24:26] Detected operating system: linux
[08:24:26] Enabling bundled linux tools.
[08:24:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:26] Found gzip - /usr/bin/gzip
[08:24:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 490
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 64
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:26] Treating reference as 'fasta' format.
[08:24:26] Will use 8 CPU cores.
[08:24:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
[08:24:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[08:24:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[08:24:26] Creating reference folder: reference
[08:24:26] Extracting FASTA and GFF from reference.
[08:24:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:26] Wrote 3 sequences to ref.fa
[08:24:26] Wrote 0 features to ref.gff
[08:24:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta into pseudo-reads
[08:24:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320160 sequences (80000364 bp)...
[M::process] read 74330 sequences (18582500 bp)...
[M::process] read 320016 sequences (80000230 bp)...
[08:24:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 74154 sequences (18463210 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 17
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 1797
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:24:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:28] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:29] Wrote 393608 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:29] Using BAM RG (Read Group) ID: SAL_CB9243AA_AS.out
[08:24:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:29] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320160 reads in 17.556 CPU sec, 2.404 real sec
[08:24:30] Marked 0 heterozygous sites with 'n'
[08:24:30] Creating extra output files: BED GFF CSV TXT HTML
[08:24:30] Identified 467 variants.
[08:24:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[08:24:30] Result files:
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.aligned.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam.bai
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bed
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.subs.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.csv
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.filt.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.gff
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.html
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.log
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.raw.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.subs.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.tab
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.txt
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz.csi
[08:24:30] Walltime used: 20 seconds
[08:24:30] Questionable SNP? Try the --report option to see the alignments.
[08:24:30] Done.
[Tue Jun 16 08:24:30 2020]
Finished job 100.
53 of 206 steps (26%) done

[Tue Jun 16 08:24:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
    jobid: 42
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB6441AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[M::mem_process_seqs] Processed 320016 reads in 17.298 CPU sec, 2.369 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74330 reads in 4.398 CPU sec, 0.510 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[08:24:30] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 74154 reads in 4.973 CPU sec, 0.571 real sec
[08:24:30] Marked 0 heterozygous sites with 'n'
[08:24:30] Creating extra output files: BED GFF CSV TXT HTML
[08:24:30] Identified 64 variants.
[08:24:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[08:24:30] Result files:
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.aligned.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam.bai
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bed
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.subs.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.csv
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.filt.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.gff
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.html
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.log
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.raw.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.subs.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.tab
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.txt
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz.csi
[08:24:30] Walltime used: 19 seconds
[08:24:30] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:24:30] Done.
[Tue Jun 16 08:24:30 2020]
Finished job 197.
54 of 206 steps (26%) done

[Tue Jun 16 08:24:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
    jobid: 160
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1299AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
[samclip] Processed 300000 records...
[08:24:30] Creating extra output files: BED GFF CSV TXT HTML
[08:24:30] Identified 490 variants.
[08:24:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[08:24:30] Result files:
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.aligned.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam.bai
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bed
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.subs.fa
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.csv
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.filt.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.gff
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.html
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.log
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.raw.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.subs.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.tab
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.txt
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz
[08:24:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz.csi
[08:24:30] Walltime used: 19 seconds
[08:24:30] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:24:30] Done.
[Tue Jun 16 08:24:30 2020]
Finished job 68.
55 of 206 steps (27%) done

[Tue Jun 16 08:24:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
    jobid: 48
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9086AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
[08:24:30] This is snippy 4.4.3
[08:24:30] Written by Torsten Seemann
[08:24:30] Obtained from https://github.com/tseemann/snippy
[08:24:30] Detected operating system: linux
[08:24:30] Enabling bundled linux tools.
[08:24:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:31] Found gzip - /usr/bin/gzip
[08:24:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[08:24:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.802 sec; CPU: 22.503 sec
[samclip] Total SAM records 394735, removed 1211, allowed 74, passed 393524
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:24:31] Treating reference as 'fasta' format.
[08:24:31] Will use 8 CPU cores.
[08:24:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[08:24:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[08:24:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[08:24:31] Creating reference folder: reference
[08:24:31] Extracting FASTA and GFF from reference.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.792 sec; CPU: 22.802 sec
[samclip] Total SAM records 394473, removed 1082, allowed 98, passed 393391
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:31] Wrote 3 sequences to ref.fa
[08:24:31] Wrote 0 features to ref.gff
[08:24:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320140 sequences (80000152 bp)...
[08:24:31] This is snippy 4.4.3
[08:24:31] Written by Torsten Seemann
[08:24:31] Obtained from https://github.com/tseemann/snippy
[08:24:31] Detected operating system: linux
[08:24:31] Enabling bundled linux tools.
[08:24:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:31] Found gzip - /usr/bin/gzip
[M::process] read 73468 sequences (18367000 bp)...
[08:24:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:31] This is snippy 4.4.3
[08:24:31] Written by Torsten Seemann
[08:24:31] Obtained from https://github.com/tseemann/snippy
[08:24:31] Detected operating system: linux
[08:24:31] Enabling bundled linux tools.
[08:24:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:31] Found gzip - /usr/bin/gzip
[08:24:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:31] Treating reference as 'fasta' format.
[08:24:31] Will use 8 CPU cores.
[08:24:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
[08:24:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[08:24:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[08:24:31] Creating reference folder: reference
[08:24:31] Extracting FASTA and GFF from reference.
[08:24:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:31] Treating reference as 'fasta' format.
[08:24:31] Will use 8 CPU cores.
[08:24:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
[08:24:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[08:24:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[08:24:31] Creating reference folder: reference
[08:24:31] Extracting FASTA and GFF from reference.
[08:24:32] Wrote 3 sequences to ref.fa
[08:24:32] Wrote 0 features to ref.gff
[08:24:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta into pseudo-reads
[08:24:32] Wrote 3 sequences to ref.fa
[08:24:32] Wrote 0 features to ref.gff
[08:24:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:32] Marked 78 heterozygous sites with 'n'
[08:24:32] Creating extra output files: BED GFF CSV TXT HTML
[08:24:32] Identified 1797 variants.
[08:24:32] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[08:24:32] Result files:
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.aligned.fa
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam.bai
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bed
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.fa
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.subs.fa
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.csv
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.filt.vcf
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.gff
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.html
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.log
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.raw.vcf
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.subs.vcf
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.tab
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.txt
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz
[08:24:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz.csi
[08:24:32] Walltime used: 20 seconds
[08:24:32] Wishing you a life free of homopolymer errors.
[08:24:32] Done.
[Tue Jun 16 08:24:32 2020]
Finished job 76.
56 of 206 steps (27%) done

[Tue Jun 16 08:24:32 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
    jobid: 113
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB8676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:33] Running: samtools index snps.bam 2>> snps.log
[08:24:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:33] Running: samtools index snps.bam 2>> snps.log
[08:24:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:33] This is snippy 4.4.3
[08:24:33] Written by Torsten Seemann
[08:24:33] Obtained from https://github.com/tseemann/snippy
[08:24:33] Detected operating system: linux
[08:24:33] Enabling bundled linux tools.
[08:24:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:33] Found gzip - /usr/bin/gzip
[08:24:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:33] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:33] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:33] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:33] Treating reference as 'fasta' format.
[08:24:33] Will use 8 CPU cores.
[08:24:33] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
[08:24:33] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[08:24:33] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[08:24:33] Creating reference folder: reference
[08:24:33] Extracting FASTA and GFF from reference.
[08:24:33] Wrote 3 sequences to ref.fa
[08:24:33] Wrote 0 features to ref.gff
[08:24:33] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320140 reads in 17.763 CPU sec, 2.445 real sec
[08:24:34] Wrote 394306 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:34] Using BAM RG (Read Group) ID: SAL_BB6441AA_AS.out
[08:24:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[08:24:34] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 73468 reads in 4.270 CPU sec, 0.492 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:24:34] Wrote 393026 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:34] Using BAM RG (Read Group) ID: SAL_BB9086AA_AS.out
[08:24:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:35] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.858 sec; CPU: 22.592 sec
[samclip] Total SAM records 393980, removed 1071, allowed 135, passed 392909
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:35] Wrote 397540 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:35] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:35] Using BAM RG (Read Group) ID: SAL_XA1299AA_AS.out
[08:24:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:35] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:24:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[M::process] read 320138 sequences (80000338 bp)...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 51
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 163
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 74168 sequences (18517842 bp)...
[08:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:36] Wrote 392172 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:36] Using BAM RG (Read Group) ID: SAL_KB8676AA_AS.out
[08:24:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:36] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:37] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:24:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 73026 sequences (18200700 bp)...
[08:24:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:37] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:37] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320158 sequences (80000292 bp)...
[M::process] read 77382 sequences (19326182 bp)...
[08:24:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320138 reads in 17.453 CPU sec, 2.721 real sec
[M::process] read 320128 sequences (80000194 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 16.889 CPU sec, 2.360 real sec
[M::mem_process_seqs] Processed 74168 reads in 4.925 CPU sec, 0.599 real sec
[samclip] Processed 200000 records...
[M::process] read 72044 sequences (18011000 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 73026 reads in 4.236 CPU sec, 0.505 real sec
[samclip] Processed 300000 records...
[08:24:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 200000 records...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.329 sec; CPU: 22.958 sec
[samclip] Total SAM records 394628, removed 1210, allowed 135, passed 393418
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320158 reads in 17.803 CPU sec, 2.738 real sec
[08:24:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:24:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:40] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[08:24:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.891 sec; CPU: 21.716 sec
[samclip] Total SAM records 393328, removed 872, allowed 140, passed 392456
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 77382 reads in 5.671 CPU sec, 0.659 real sec
[08:24:41] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:24:41] Creating extra output files: BED GFF CSV TXT HTML
[08:24:41] Identified 163 variants.
[08:24:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[08:24:41] Result files:
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.aligned.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam.bai
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bed
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.subs.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.csv
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.filt.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.gff
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.html
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.log
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.raw.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.subs.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.tab
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.txt
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz.csi
[08:24:41] Walltime used: 19 seconds
[08:24:41] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:24:41] Done.
[08:24:41] Marked 0 heterozygous sites with 'n'
[Tue Jun 16 08:24:41 2020]
Finished job 13.
57 of 206 steps (28%) done

[Tue Jun 16 08:24:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
    jobid: 94
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7534AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[08:24:41] Creating extra output files: BED GFF CSV TXT HTML
[08:24:41] Identified 51 variants.
[08:24:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[08:24:41] Result files:
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.aligned.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam.bai
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bed
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.subs.fa
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.csv
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.filt.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.gff
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.html
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.log
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.raw.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.subs.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.tab
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.txt
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz
[08:24:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz.csi
[08:24:41] Walltime used: 19 seconds
[08:24:41] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:24:41] Done.
[Tue Jun 16 08:24:41 2020]
Finished job 156.
58 of 206 steps (28%) done

[Tue Jun 16 08:24:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
    jobid: 82
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA3268AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.192 sec; CPU: 24.010 sec
[samclip] Total SAM records 398069, removed 1650, allowed 237, passed 396419
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:42] This is snippy 4.4.3
[08:24:42] Written by Torsten Seemann
[08:24:42] Obtained from https://github.com/tseemann/snippy
[08:24:42] Detected operating system: linux
[08:24:42] Enabling bundled linux tools.
[08:24:42] This is snippy 4.4.3
[08:24:42] Written by Torsten Seemann
[08:24:42] Obtained from https://github.com/tseemann/snippy
[08:24:42] Detected operating system: linux
[08:24:42] Enabling bundled linux tools.
[08:24:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:42] Found gzip - /usr/bin/gzip
[08:24:42] Found gzip - /usr/bin/gzip
[08:24:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320128 reads in 19.391 CPU sec, 3.028 real sec
[08:24:42] Running: samtools index snps.bam 2>> snps.log
[08:24:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:42] Treating reference as 'fasta' format.
[08:24:42] Will use 8 CPU cores.
[08:24:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[08:24:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[08:24:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[08:24:42] Creating reference folder: reference
[08:24:42] Treating reference as 'fasta' format.
[08:24:42] Will use 8 CPU cores.
[08:24:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[08:24:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[08:24:42] Extracting FASTA and GFF from reference.
[08:24:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[08:24:42] Creating reference folder: reference
[08:24:42] Extracting FASTA and GFF from reference.
[08:24:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[08:24:42] Wrote 3 sequences to ref.fa
[08:24:42] Wrote 0 features to ref.gff
[08:24:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta into pseudo-reads
[08:24:42] Wrote 3 sequences to ref.fa
[08:24:42] Wrote 0 features to ref.gff
[08:24:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta into pseudo-reads
[08:24:42] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 72044 reads in 4.186 CPU sec, 0.485 real sec
[samclip] Processed 200000 records...
[08:24:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.431 sec; CPU: 24.146 sec
[samclip] Total SAM records 392256, removed 966, allowed 100, passed 391290
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:43] Running: samtools index snps.bam 2>> snps.log
[08:24:43] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:44] Marked 0 heterozygous sites with 'n'
[08:24:44] Creating extra output files: BED GFF CSV TXT HTML
[08:24:44] Identified 22 variants.
[08:24:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[08:24:44] Result files:
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.aligned.fa
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam.bai
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bed
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.fa
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.subs.fa
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.csv
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.filt.vcf
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.gff
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.html
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.log
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.raw.vcf
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.subs.vcf
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.tab
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.txt
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz
[08:24:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz.csi
[08:24:44] Walltime used: 18 seconds
[08:24:44] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:24:44] Done.
[Tue Jun 16 08:24:44 2020]
Finished job 40.
59 of 206 steps (29%) done

[Tue Jun 16 08:24:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
    jobid: 84
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB8845AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[08:24:45] Running: samtools index snps.bam 2>> snps.log
[08:24:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:24:45] Wrote 393274 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:45] Using BAM RG (Read Group) ID: SAL_AB7534AA_AS.out

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 132
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:45] Wrote 397176 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:45] Using BAM RG (Read Group) ID: SAL_XA3268AA_AS.out
[08:24:45] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:45] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:45] This is snippy 4.4.3
[08:24:45] Written by Torsten Seemann
[08:24:45] Obtained from https://github.com/tseemann/snippy
[08:24:45] Detected operating system: linux
[08:24:45] Enabling bundled linux tools.
[08:24:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:45] Found gzip - /usr/bin/gzip
[08:24:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:24:46] Running: rm -f fake_reads\.fq 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:46] Treating reference as 'fasta' format.
[08:24:46] Will use 8 CPU cores.
[08:24:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[08:24:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[08:24:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[08:24:46] Creating reference folder: reference
[08:24:46] Extracting FASTA and GFF from reference.
[08:24:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:46] Wrote 3 sequences to ref.fa
[08:24:46] Wrote 0 features to ref.gff
[08:24:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta into pseudo-reads
[08:24:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:46] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:47] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:47] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:47] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:47] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:24:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320362 sequences (80000096 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 73274 sequences (18271504 bp)...
[M::process] read 76814 sequences (19186104 bp)...
[08:24:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 318
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:49] Wrote 393052 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:49] Using BAM RG (Read Group) ID: SAL_EB8845AA_AS.out
[08:24:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:49] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:49] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 18.402 CPU sec, 2.554 real sec
[08:24:50] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320362 reads in 19.249 CPU sec, 2.621 real sec
[08:24:50] Creating extra output files: BED GFF CSV TXT HTML
[08:24:50] Identified 132 variants.
[08:24:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[08:24:50] Result files:
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.aligned.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam.bai
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bed
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.subs.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.csv
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.filt.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.gff
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.html
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.log
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.raw.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.subs.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.tab
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.txt
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz.csi
[08:24:50] Walltime used: 20 seconds
[08:24:50] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:24:50] Done.
[Tue Jun 16 08:24:50 2020]
Finished job 42.
60 of 206 steps (29%) done

[Tue Jun 16 08:24:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
    jobid: 21
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA0287AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:24:50] Marked 236 heterozygous sites with 'n'
[08:24:50] Creating extra output files: BED GFF CSV TXT HTML
[08:24:50] Identified 20 variants.
[08:24:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[08:24:50] Result files:
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.aligned.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam.bai
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bed
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.subs.fa
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.csv
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.filt.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.gff
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.html
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.log
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.raw.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.subs.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.tab
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.txt
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz
[08:24:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz.csi
[08:24:50] Walltime used: 19 seconds
[08:24:50] Wishing you a life free of homopolymer errors.
[08:24:50] Done.
[Tue Jun 16 08:24:50 2020]
Finished job 48.
61 of 206 steps (30%) done

[Tue Jun 16 08:24:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
    jobid: 141
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2224AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[M::mem_process_seqs] Processed 73274 reads in 4.505 CPU sec, 0.522 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 76814 reads in 4.458 CPU sec, 0.517 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[08:24:51] This is snippy 4.4.3
[08:24:51] Written by Torsten Seemann
[08:24:51] Obtained from https://github.com/tseemann/snippy
[08:24:51] Detected operating system: linux
[08:24:51] Enabling bundled linux tools.
[08:24:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:51] Found gzip - /usr/bin/gzip
[08:24:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:51] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.979 sec; CPU: 23.468 sec
[samclip] Total SAM records 393670, removed 1211, allowed 78, passed 392459
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320212 sequences (80000078 bp)...
[08:24:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:51] Treating reference as 'fasta' format.
[08:24:51] Will use 8 CPU cores.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[08:24:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[08:24:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[08:24:51] Creating reference folder: reference
[08:24:51] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.053 sec; CPU: 24.272 sec
[samclip] Total SAM records 397271, removed 743, allowed 79, passed 396528
[samclip] Header contained 5 lines
[samclip] Done.
[08:24:51] Marked 31 heterozygous sites with 'n'
[M::process] read 72840 sequences (18210000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:51] This is snippy 4.4.3
[08:24:51] Written by Torsten Seemann
[08:24:51] Obtained from https://github.com/tseemann/snippy
[08:24:51] Detected operating system: linux
[08:24:51] Enabling bundled linux tools.
[08:24:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:51] Creating extra output files: BED GFF CSV TXT HTML
[08:24:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:51] Identified 27 variants.
[08:24:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:51] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[08:24:51] Result files:
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.aligned.fa
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam.bai
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bed
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.fa
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.subs.fa
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.csv
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.filt.vcf
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.gff
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.html
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.log
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.raw.vcf
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.subs.vcf
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.tab
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.txt
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz
[08:24:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz.csi
[08:24:51] Walltime used: 20 seconds
[08:24:51] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:24:51] Done.
[08:24:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:51] Found gzip - /usr/bin/gzip
[08:24:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[Tue Jun 16 08:24:51 2020]
Finished job 160.
62 of 206 steps (30%) done

[Tue Jun 16 08:24:51 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
    jobid: 169
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA4572AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[08:24:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:51] Wrote 3 sequences to ref.fa
[08:24:51] Wrote 0 features to ref.gff
[08:24:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta into pseudo-reads
[08:24:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:24:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:51] Treating reference as 'fasta' format.
[08:24:51] Will use 8 CPU cores.
[08:24:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[08:24:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[08:24:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[08:24:51] Creating reference folder: reference
[08:24:51] Extracting FASTA and GFF from reference.
[08:24:51] Wrote 3 sequences to ref.fa
[08:24:51] Wrote 0 features to ref.gff
[08:24:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:24:52] This is snippy 4.4.3
[08:24:52] Written by Torsten Seemann
[08:24:52] Obtained from https://github.com/tseemann/snippy
[08:24:52] Detected operating system: linux
[08:24:52] Enabling bundled linux tools.
[08:24:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:52] Found gzip - /usr/bin/gzip
[08:24:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:52] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:52] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:52] Treating reference as 'fasta' format.
[08:24:52] Will use 8 CPU cores.
[08:24:52] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[08:24:52] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[08:24:52] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[08:24:52] Creating reference folder: reference
[08:24:52] Extracting FASTA and GFF from reference.
[08:24:52] Wrote 3 sequences to ref.fa
[08:24:52] Wrote 0 features to ref.gff
[08:24:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta into pseudo-reads
[08:24:53] Running: samtools index snps.bam 2>> snps.log
[08:24:53] Running: samtools index snps.bam 2>> snps.log
[08:24:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:53] Marked 40 heterozygous sites with 'n'
[08:24:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:53] Creating extra output files: BED GFF CSV TXT HTML
[08:24:53] Identified 318 variants.
[08:24:53] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[08:24:53] Result files:
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.aligned.fa
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam.bai
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bed
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.fa
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.subs.fa
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.csv
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.filt.vcf
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.gff
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.html
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.log
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.raw.vcf
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.subs.vcf
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.tab
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.txt
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz
[08:24:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz.csi
[08:24:53] Walltime used: 20 seconds
[08:24:53] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:24:53] Done.
[08:24:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[Tue Jun 16 08:24:53 2020]
Finished job 113.
63 of 206 steps (31%) done

[Tue Jun 16 08:24:53 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
    jobid: 119
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB4034AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
[08:24:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320212 reads in 17.071 CPU sec, 2.295 real sec
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 72840 reads in 4.351 CPU sec, 0.500 real sec
[samclip] Processed 200000 records...
[08:24:54] Wrote 394326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:54] Using BAM RG (Read Group) ID: SAL_ZA0287AA_AS.out
[08:24:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:24:54] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:54] This is snippy 4.4.3
[08:24:54] Written by Torsten Seemann
[08:24:54] Obtained from https://github.com/tseemann/snippy
[08:24:54] Detected operating system: linux
[08:24:54] Enabling bundled linux tools.
[08:24:54] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:24:54] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:24:54] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:24:54] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:24:54] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:24:54] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:24:54] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:24:54] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:24:54] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:24:54] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:24:54] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:24:54] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:24:54] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:24:54] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:24:54] Wrote 392296 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:54] Found gzip - /usr/bin/gzip
[08:24:54] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:24:54] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:24:54] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:24:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:54] Using BAM RG (Read Group) ID: SAL_HB2224AA_AS.out
[08:24:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:54] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:24:54] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:24:54] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:24:54] Running: bwa index reference/ref.fa 2>> snps.log
[08:24:54] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.699 sec; CPU: 21.975 sec
[samclip] Total SAM records 393465, removed 1178, allowed 128, passed 392287
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:54] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:24:54] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:24:54] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:24:54] Treating reference as 'fasta' format.
[08:24:54] Will use 8 CPU cores.
[08:24:54] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
[08:24:54] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[08:24:54] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[08:24:54] Creating reference folder: reference
[08:24:54] Extracting FASTA and GFF from reference.
[08:24:54] Wrote 3 sequences to ref.fa
[08:24:54] Wrote 0 features to ref.gff
[08:24:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta into pseudo-reads
[08:24:55] Wrote 396758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:55] Using BAM RG (Read Group) ID: SAL_LA4572AA_AS.out
[08:24:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:55] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:24:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:24:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:24:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:24:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:24:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:24:56] Running: samtools index snps.bam 2>> snps.log
[08:24:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:24:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:24:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:24:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320096 sequences (80000188 bp)...
[08:24:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:56] Running: rm -f fake_reads\.fq 2>> snps.log
[08:24:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:24:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:24:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:24:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:24:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 74230 sequences (18552290 bp)...
[08:24:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:24:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:24:56] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:24:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 72296 sequences (18038458 bp)...
[08:24:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320068 sequences (80000128 bp)...
[M::process] read 76690 sequences (19135790 bp)...
[08:24:57] Wrote 391912 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:24:57] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:24:57] Using BAM RG (Read Group) ID: SAL_LB4034AA_AS.out
[08:24:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:24:57] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.019 CPU sec, 2.497 real sec
[08:24:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:24:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:24:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:24:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:24:59] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::mem_process_seqs] Processed 320096 reads in 19.767 CPU sec, 2.813 real sec
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[08:24:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:24:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:24:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[M::process] read 320018 sequences (80000480 bp)...
[08:24:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 72296 reads in 4.466 CPU sec, 0.528 real sec
[08:24:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 200000 records...
[08:24:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:24:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 71894 sequences (17973500 bp)...
[08:25:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 74230 reads in 4.741 CPU sec, 0.554 real sec
[samclip] Processed 200000 records...
[08:25:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:00] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320068 reads in 18.486 CPU sec, 2.720 real sec
[samclip] Processed 300000 records...
[08:25:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.957 sec; CPU: 23.053 sec
[samclip] Total SAM records 392637, removed 954, allowed 181, passed 391683
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 394998, removed 7111, allowed 443, passed 387887

[main] Real time: 4.301 sec; CPU: 25.073 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 76690 reads in 5.039 CPU sec, 0.586 real sec
[samclip] Processed 300000 records...
[08:25:01] Marked 68 heterozygous sites with 'n'
[08:25:01] Creating extra output files: BED GFF CSV TXT HTML
[08:25:01] Identified 15 variants.
[08:25:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[08:25:01] Result files:
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.aligned.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam.bai
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bed
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.subs.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.csv
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.filt.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.gff
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.html
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.log
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.raw.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.subs.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.tab
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.txt
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz.csi
[08:25:01] Walltime used: 19 seconds
[08:25:01] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:25:01] Done.
[Tue Jun 16 08:25:01 2020]
Finished job 94.
64 of 206 steps (31%) done

[Tue Jun 16 08:25:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
    jobid: 189
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5906AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[08:25:01] Marked 0 heterozygous sites with 'n'
[08:25:01] Creating extra output files: BED GFF CSV TXT HTML
[08:25:01] Identified 100 variants.
[08:25:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[08:25:01] Result files:
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.aligned.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam.bai
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bed
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.subs.fa
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.csv
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.filt.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.gff
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.html
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.log
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.raw.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.subs.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.tab
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.txt
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz
[08:25:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz.csi
[08:25:01] Walltime used: 19 seconds
[08:25:01] May the SNPs be with you.
[08:25:01] Done.
[Tue Jun 16 08:25:01 2020]
Finished job 82.
65 of 206 steps (32%) done
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 396933, removed 880, allowed 169, passed 396053

[main] Real time: 4.175 sec; CPU: 24.074 sec
[samclip] Header contained 5 lines
[samclip] Done.

[Tue Jun 16 08:25:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
    jobid: 92
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB8884AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:01] This is snippy 4.4.3
[08:25:01] Written by Torsten Seemann
[08:25:01] Obtained from https://github.com/tseemann/snippy
[08:25:01] Detected operating system: linux
[08:25:01] Enabling bundled linux tools.
[08:25:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:01] Found gzip - /usr/bin/gzip
[08:25:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:02] This is snippy 4.4.3
[08:25:02] Written by Torsten Seemann
[08:25:02] Obtained from https://github.com/tseemann/snippy
[08:25:02] Detected operating system: linux
[08:25:02] Enabling bundled linux tools.
[08:25:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:02] Found gzip - /usr/bin/gzip
[08:25:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:02] Treating reference as 'fasta' format.
[08:25:02] Will use 8 CPU cores.
[08:25:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[08:25:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[08:25:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[08:25:02] Creating reference folder: reference
[08:25:02] Extracting FASTA and GFF from reference.
[08:25:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:02] Treating reference as 'fasta' format.
[08:25:02] Will use 8 CPU cores.
[08:25:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
[08:25:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[08:25:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[08:25:02] Creating reference folder: reference
[08:25:02] Extracting FASTA and GFF from reference.
[08:25:02] Wrote 3 sequences to ref.fa
[08:25:02] Wrote 0 features to ref.gff
[08:25:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320018 reads in 18.459 CPU sec, 2.457 real sec
[08:25:02] Wrote 3 sequences to ref.fa
[08:25:02] Wrote 0 features to ref.gff
[08:25:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta into pseudo-reads
[08:25:02] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[08:25:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:02] Running: samtools index snps.bam 2>> snps.log
[08:25:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 71894 reads in 4.863 CPU sec, 0.564 real sec
[samclip] Processed 300000 records...
[08:25:03] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.856 sec; CPU: 23.857 sec
[samclip] Total SAM records 392199, removed 1061, allowed 175, passed 391138
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:03] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:04] Marked 1 heterozygous sites with 'n'
[08:25:04] Creating extra output files: BED GFF CSV TXT HTML
[08:25:04] Identified 22 variants.
[08:25:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[08:25:04] Result files:
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.aligned.fa
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam.bai
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bed
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.fa
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.subs.fa
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.csv
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.filt.vcf
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.gff
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.html
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.log
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.raw.vcf
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.subs.vcf
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.tab
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.txt
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz
[08:25:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz.csi
[08:25:04] Walltime used: 19 seconds
[08:25:04] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:25:04] Done.
[Tue Jun 16 08:25:04 2020]
Finished job 84.
66 of 206 steps (32%) done

[Tue Jun 16 08:25:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
    jobid: 110
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB5769AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:05] Wrote 390314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:05] Using BAM RG (Read Group) ID: SAL_AB5906AA_AS.out
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:05] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:05] Wrote 391628 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:05] Using BAM RG (Read Group) ID: SAL_AB8884AA_AS.out
[08:25:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:05] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:05] This is snippy 4.4.3
[08:25:05] Written by Torsten Seemann
[08:25:05] Obtained from https://github.com/tseemann/snippy
[08:25:05] Detected operating system: linux
[08:25:05] Enabling bundled linux tools.
[08:25:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:05] Running: samtools index snps.bam 2>> snps.log
[08:25:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:05] Found gzip - /usr/bin/gzip
[08:25:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 23
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:05] Treating reference as 'fasta' format.
[08:25:05] Will use 8 CPU cores.
[08:25:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[08:25:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[08:25:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[08:25:05] Creating reference folder: reference
[08:25:05] Extracting FASTA and GFF from reference.
[08:25:05] Wrote 3 sequences to ref.fa
[08:25:05] Wrote 0 features to ref.gff
[08:25:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta into pseudo-reads
[08:25:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1883
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:25:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 136
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:25:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:07] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320072 sequences (80000244 bp)...
[M::process] read 70314 sequences (17547474 bp)...
[M::process] read 71556 sequences (17889000 bp)...
[08:25:08] Wrote 390122 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:08] Using BAM RG (Read Group) ID: SAL_FB5769AA_AS.out
[08:25:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:08] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1716
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:25:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:09] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 18.143 CPU sec, 2.503 real sec
[M::mem_process_seqs] Processed 320072 reads in 18.509 CPU sec, 2.534 real sec
[samclip] Processed 100000 records...
[08:25:10] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[08:25:10] Creating extra output files: BED GFF CSV TXT HTML
[08:25:10] Identified 23 variants.
[08:25:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[08:25:10] Result files:
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.aligned.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam.bai
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bed
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.subs.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.csv
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.filt.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.gff
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.html
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.log
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.raw.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.subs.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.tab
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.txt
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz.csi
[08:25:10] Walltime used: 19 seconds
[08:25:10] Wishing you a life free of homopolymer errors.
[08:25:10] Done.
[Tue Jun 16 08:25:10 2020]
Finished job 141.
67 of 206 steps (33%) done

[Tue Jun 16 08:25:10 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
    jobid: 38
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NB6620AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[08:25:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 70314 reads in 4.253 CPU sec, 0.493 real sec
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 71556 reads in 4.317 CPU sec, 0.496 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::process] read 320022 sequences (80000370 bp)...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 70100 sequences (17509008 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.930 sec; CPU: 22.943 sec
[samclip] Total SAM records 390431, removed 709, allowed 60, passed 389722
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:10] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:10] This is snippy 4.4.3
[08:25:10] Written by Torsten Seemann
[08:25:10] Obtained from https://github.com/tseemann/snippy
[08:25:10] Detected operating system: linux
[08:25:10] Enabling bundled linux tools.
[08:25:10] Creating extra output files: BED GFF CSV TXT HTML
[08:25:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.941 sec; CPU: 23.386 sec
[samclip] Total SAM records 391994, removed 1043, allowed 151, passed 390951
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:10] Identified 1883 variants.
[08:25:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[08:25:10] Result files:
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.aligned.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam.bai
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bed
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.subs.fa
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.csv
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.filt.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.gff
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.html
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.log
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.raw.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.subs.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.tab
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.txt
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz
[08:25:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz.csi
[08:25:10] Walltime used: 19 seconds
[08:25:10] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:25:10] Done.
[08:25:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[Tue Jun 16 08:25:11 2020]
Finished job 21.
68 of 206 steps (33%) done

[Tue Jun 16 08:25:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
    jobid: 140
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB5050AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[08:25:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:11] Found gzip - /usr/bin/gzip
[08:25:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:11] Marked 0 heterozygous sites with 'n'
[08:25:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:11] Creating extra output files: BED GFF CSV TXT HTML
[08:25:11] Identified 136 variants.
[08:25:11] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[08:25:11] Result files:
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.aligned.fa
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam.bai
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bed
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.fa
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.subs.fa
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.csv
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.filt.vcf
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.gff
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.html
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.log
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.raw.vcf
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.subs.vcf
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.tab
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.txt
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz
[08:25:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz.csi
[08:25:11] Walltime used: 19 seconds
[08:25:11] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:25:11] Done.
[Tue Jun 16 08:25:11 2020]
Finished job 169.
69 of 206 steps (33%) done

[Tue Jun 16 08:25:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
    jobid: 86
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB5439AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[08:25:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:11] Treating reference as 'fasta' format.
[08:25:11] Will use 8 CPU cores.
[08:25:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[08:25:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[08:25:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[08:25:11] Creating reference folder: reference
[08:25:11] Extracting FASTA and GFF from reference.
[08:25:11] Wrote 3 sequences to ref.fa
[08:25:11] Wrote 0 features to ref.gff
[08:25:11] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:11] This is snippy 4.4.3
[08:25:11] Written by Torsten Seemann
[08:25:11] Obtained from https://github.com/tseemann/snippy
[08:25:11] Detected operating system: linux
[08:25:11] Enabling bundled linux tools.
[08:25:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:11] Found gzip - /usr/bin/gzip
[08:25:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:11] This is snippy 4.4.3
[08:25:11] Written by Torsten Seemann
[08:25:11] Obtained from https://github.com/tseemann/snippy
[08:25:11] Detected operating system: linux
[08:25:11] Enabling bundled linux tools.
[08:25:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:11] Found gzip - /usr/bin/gzip
[08:25:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:11] Treating reference as 'fasta' format.
[08:25:11] Will use 8 CPU cores.
[08:25:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[08:25:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[08:25:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[08:25:11] Creating reference folder: reference
[08:25:11] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:12] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:12] Treating reference as 'fasta' format.
[08:25:12] Will use 8 CPU cores.
[08:25:12] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[08:25:12] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[08:25:12] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[08:25:12] Creating reference folder: reference
[08:25:12] Extracting FASTA and GFF from reference.
[08:25:12] Wrote 3 sequences to ref.fa
[08:25:12] Wrote 0 features to ref.gff
[08:25:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta into pseudo-reads
[08:25:12] Wrote 3 sequences to ref.fa
[08:25:12] Wrote 0 features to ref.gff
[08:25:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta into pseudo-reads
[08:25:12] Running: samtools index snps.bam 2>> snps.log
[08:25:12] Running: samtools index snps.bam 2>> snps.log
[08:25:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320022 reads in 18.198 CPU sec, 2.507 real sec
[08:25:13] Marked 0 heterozygous sites with 'n'
[08:25:13] Creating extra output files: BED GFF CSV TXT HTML
[08:25:13] Identified 1716 variants.
[08:25:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[08:25:13] Result files:
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.aligned.fa
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam.bai
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bed
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.fa
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.subs.fa
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.csv
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.filt.vcf
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.gff
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.html
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.log
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.raw.vcf
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.subs.vcf
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.tab
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.txt
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz
[08:25:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz.csi
[08:25:13] Walltime used: 19 seconds
[08:25:13] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:25:13] Done.
[Tue Jun 16 08:25:13 2020]
Finished job 119.
70 of 206 steps (34%) done

[Tue Jun 16 08:25:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
    jobid: 126
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB7996AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70100 reads in 4.206 CPU sec, 0.485 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:25:14] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:14] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:14] Using BAM RG (Read Group) ID: SAL_NB6620AA_AS.out
[08:25:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 390554, removed 1191, allowed 124, passed 389363
 -R @RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.945 sec; CPU: 22.989 sec
[08:25:14] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:15] Wrote 390662 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:15] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:15] Using BAM RG (Read Group) ID: SAL_BB5050AA_AS.out
[08:25:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:15] Wrote 389178 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:15] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:15] Using BAM RG (Read Group) ID: SAL_MB5439AA_AS.out
[08:25:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:15] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:15] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:15] This is snippy 4.4.3
[08:25:15] Written by Torsten Seemann
[08:25:15] Obtained from https://github.com/tseemann/snippy
[08:25:15] Detected operating system: linux
[08:25:15] Enabling bundled linux tools.
[08:25:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:15] Found gzip - /usr/bin/gzip
[08:25:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:15] Treating reference as 'fasta' format.
[08:25:15] Will use 8 CPU cores.
[08:25:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[08:25:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[08:25:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[08:25:15] Creating reference folder: reference
[08:25:15] Extracting FASTA and GFF from reference.
[08:25:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 201
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:16] Wrote 3 sequences to ref.fa
[08:25:16] Wrote 0 features to ref.gff
[08:25:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta into pseudo-reads
[08:25:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:25:16] Running: ln -sf reference/ref.fa . 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 49
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:16] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:25:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:25:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:16] Running: samtools index snps.bam 2>> snps.log
[08:25:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:16] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:25:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:16] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 70182 sequences (17512214 bp)...
[08:25:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:17] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:25:17] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320196 sequences (80000214 bp)...
[M::process] read 70466 sequences (17591806 bp)...
[M::process] read 69178 sequences (17293548 bp)...
[08:25:18] Wrote 390506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:18] Using BAM RG (Read Group) ID: SAL_IB7996AA_AS.out
[08:25:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:18] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.733 CPU sec, 2.499 real sec
[samclip] Processed 100000 records...
[08:25:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 70182 reads in 4.058 CPU sec, 0.480 real sec

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[08:25:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:25:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:19] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 18.255 CPU sec, 2.438 real sec
[M::mem_process_seqs] Processed 320196 reads in 17.988 CPU sec, 2.520 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.978 sec; CPU: 22.368 sec
[samclip] Total SAM records 390419, removed 721, allowed 60, passed 389698
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:25:20] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 69178 reads in 4.212 CPU sec, 0.489 real sec
[08:25:20] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:20] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:20] Marked 0 heterozygous sites with 'n'
[08:25:20] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:20] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:20] Creating extra output files: BED GFF CSV TXT HTML
[08:25:20] Identified 201 variants.
[08:25:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[08:25:20] Result files:
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.aligned.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam.bai
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bed
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.subs.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.csv
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.filt.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.gff
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.html
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.log
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.raw.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.subs.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.tab
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.txt
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz.csi
[08:25:20] Walltime used: 19 seconds
[08:25:20] Wishing you a life free of homopolymer errors.
[08:25:20] Done.
[Tue Jun 16 08:25:20 2020]
Finished job 189.
71 of 206 steps (34%) done

[Tue Jun 16 08:25:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
    jobid: 182
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[M::mem_process_seqs] Processed 70466 reads in 4.576 CPU sec, 0.531 real sec
[samclip] Processed 200000 records...
[08:25:20] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:25:20] Creating extra output files: BED GFF CSV TXT HTML
[08:25:20] Identified 49 variants.
[08:25:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[08:25:20] Result files:
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.aligned.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam.bai
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bed
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.subs.fa
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.csv
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.filt.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.gff
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.html
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.log
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.raw.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.subs.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.tab
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.txt
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz
[08:25:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz.csi
[08:25:20] Walltime used: 18 seconds
[08:25:20] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:25:20] Done.
[Tue Jun 16 08:25:20 2020]
Finished job 92.
72 of 206 steps (35%) done

[Tue Jun 16 08:25:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
    jobid: 34
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6830AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
[M::process] read 320292 sequences (80000104 bp)...
[samclip] Processed 300000 records...
[M::process] read 70214 sequences (17551350 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.822 sec; CPU: 23.005 sec
[samclip] Total SAM records 389353, removed 1107, allowed 184, passed 388246
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.946 sec; CPU: 23.118 sec
[samclip] Total SAM records 390961, removed 904, allowed 84, passed 390057
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:21] This is snippy 4.4.3
[08:25:21] Written by Torsten Seemann
[08:25:21] Obtained from https://github.com/tseemann/snippy
[08:25:21] Detected operating system: linux
[08:25:21] Enabling bundled linux tools.
[08:25:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:21] Found gzip - /usr/bin/gzip
[08:25:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:21] Treating reference as 'fasta' format.
[08:25:21] Will use 8 CPU cores.
[08:25:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[08:25:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[08:25:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[08:25:21] Creating reference folder: reference
[08:25:21] Extracting FASTA and GFF from reference.
[08:25:21] This is snippy 4.4.3
[08:25:21] Written by Torsten Seemann
[08:25:21] Obtained from https://github.com/tseemann/snippy
[08:25:21] Detected operating system: linux
[08:25:21] Enabling bundled linux tools.
[08:25:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:21] Found gzip - /usr/bin/gzip
[08:25:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:21] Wrote 3 sequences to ref.fa
[08:25:21] Wrote 0 features to ref.gff
[08:25:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta into pseudo-reads
[08:25:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:21] Treating reference as 'fasta' format.
[08:25:21] Will use 8 CPU cores.
[08:25:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
[08:25:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[08:25:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[08:25:21] Creating reference folder: reference
[08:25:21] Extracting FASTA and GFF from reference.
[08:25:22] Wrote 3 sequences to ref.fa
[08:25:22] Wrote 0 features to ref.gff
[08:25:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:22] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:23] Running: samtools index snps.bam 2>> snps.log
[08:25:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:23] Running: samtools index snps.bam 2>> snps.log
[08:25:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320292 reads in 17.025 CPU sec, 2.318 real sec
[08:25:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70214 reads in 4.213 CPU sec, 0.526 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:25:24] Marked 0 heterozygous sites with 'n'
[08:25:24] Creating extra output files: BED GFF CSV TXT HTML
[08:25:24] Identified 19 variants.
[08:25:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[08:25:24] Result files:
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.aligned.fa
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam.bai
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bed
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.fa
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.subs.fa
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.csv
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.filt.vcf
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.gff
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.html
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.log
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.raw.vcf
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.subs.vcf
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.tab
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.txt
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz
[08:25:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz.csi
[08:25:24] Walltime used: 19 seconds
[08:25:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:25:24] Done.
[Tue Jun 16 08:25:24 2020]
Finished job 110.
73 of 206 steps (35%) done

[Tue Jun 16 08:25:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
    jobid: 117
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7542AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.816 sec; CPU: 21.812 sec
[samclip] Total SAM records 390743, removed 795, allowed 71, passed 389948
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:24] Wrote 393742 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:24] Using BAM RG (Read Group) ID: SAL_SA1324AA_AS.out
[08:25:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:24] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:24] Wrote 390082 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:24] Using BAM RG (Read Group) ID: SAL_KB6830AA_AS.out
[08:25:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:24] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:25] This is snippy 4.4.3
[08:25:25] Written by Torsten Seemann
[08:25:25] Obtained from https://github.com/tseemann/snippy
[08:25:25] Detected operating system: linux
[08:25:25] Enabling bundled linux tools.
[08:25:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:25] Found gzip - /usr/bin/gzip
[08:25:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:25] Treating reference as 'fasta' format.
[08:25:25] Will use 8 CPU cores.
[08:25:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[08:25:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[08:25:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[08:25:25] Creating reference folder: reference
[08:25:25] Extracting FASTA and GFF from reference.
[08:25:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:25] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:25] Wrote 3 sequences to ref.fa
[08:25:25] Wrote 0 features to ref.gff
[08:25:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta into pseudo-reads
[08:25:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:26] Running: samtools index snps.bam 2>> snps.log
[08:25:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1809
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:25:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:25:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320118 sequences (80000122 bp)...
[08:25:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:27] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320008 sequences (80000410 bp)...
[M::process] read 73624 sequences (18390972 bp)...
[08:25:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 70074 sequences (17518500 bp)...
[08:25:28] Wrote 390342 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:28] Using BAM RG (Read Group) ID: SAL_AB7542AA_AS.out
[08:25:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:28] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320118 reads in 17.799 CPU sec, 2.419 real sec
[08:25:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320008 reads in 18.267 CPU sec, 2.456 real sec
[08:25:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[08:25:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:25:29] Marked 0 heterozygous sites with 'n'
[08:25:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:29] Creating extra output files: BED GFF CSV TXT HTML
[08:25:29] Identified 18 variants.
[08:25:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[08:25:29] Result files:
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.aligned.fa
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam.bai
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bed
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.fa
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.subs.fa
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.csv
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.filt.vcf
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.gff
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.html
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.log
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.raw.vcf
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.subs.vcf
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.tab
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.txt
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz
[08:25:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz.csi
[08:25:29] Walltime used: 19 seconds
[08:25:29] Wishing you a life free of homopolymer errors.
[08:25:29] Done.
[08:25:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[Tue Jun 16 08:25:29 2020]
Finished job 38.
74 of 206 steps (36%) done

[Tue Jun 16 08:25:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
    jobid: 58
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[08:25:29] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 73624 reads in 4.584 CPU sec, 0.529 real sec
[samclip] Processed 200000 records...
[08:25:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 70074 reads in 4.445 CPU sec, 0.514 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:25:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:25:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.854 sec; CPU: 22.933 sec
[samclip] Total SAM records 393923, removed 902, allowed 133, passed 393021
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.889 sec; CPU: 23.267 sec
[samclip] Total SAM records 390268, removed 1175, allowed 164, passed 389093
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:30] This is snippy 4.4.3
[08:25:30] Written by Torsten Seemann
[08:25:30] Obtained from https://github.com/tseemann/snippy
[08:25:30] Detected operating system: linux
[08:25:30] Enabling bundled linux tools.
[08:25:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:30] Found gzip - /usr/bin/gzip
[08:25:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320000 sequences (80000000 bp)...
[08:25:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 70342 sequences (17519162 bp)...
[08:25:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:30] Treating reference as 'fasta' format.
[08:25:30] Will use 8 CPU cores.
[08:25:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[08:25:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[08:25:30] Marked 0 heterozygous sites with 'n'
[08:25:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[08:25:30] Creating reference folder: reference
[08:25:30] Extracting FASTA and GFF from reference.
[08:25:30] Creating extra output files: BED GFF CSV TXT HTML
[08:25:30] Identified 27 variants.
[08:25:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[08:25:30] Result files:
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.aligned.fa
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam.bai
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bed
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.fa
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.subs.fa
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.csv
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.filt.vcf
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.gff
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.html
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.log
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.raw.vcf
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.subs.vcf
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.tab
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.txt
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz
[08:25:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz.csi
[08:25:30] Walltime used: 19 seconds
[08:25:30] Questionable SNP? Try the --report option to see the alignments.
[08:25:30] Done.
[Tue Jun 16 08:25:30 2020]
Finished job 140.
75 of 206 steps (36%) done

[Tue Jun 16 08:25:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
    jobid: 31
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB6779AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[08:25:31] Wrote 3 sequences to ref.fa
[08:25:31] Wrote 0 features to ref.gff
[08:25:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta into pseudo-reads
[08:25:31] Marked 0 heterozygous sites with 'n'
[08:25:31] Creating extra output files: BED GFF CSV TXT HTML
[08:25:31] Identified 1809 variants.
[08:25:31] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[08:25:31] Result files:
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.aligned.fa
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam.bai
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bed
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.fa
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.subs.fa
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.csv
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.filt.vcf
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.gff
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.html
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.log
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.raw.vcf
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.subs.vcf
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.tab
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.txt
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz
[08:25:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz.csi
[08:25:31] Walltime used: 20 seconds
[08:25:31] May the SNPs be with you.
[08:25:31] Done.
[Tue Jun 16 08:25:31 2020]
Finished job 86.
76 of 206 steps (37%) done

[Tue Jun 16 08:25:31 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
    jobid: 180
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2669AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:31] This is snippy 4.4.3
[08:25:31] Written by Torsten Seemann
[08:25:31] Obtained from https://github.com/tseemann/snippy
[08:25:31] Detected operating system: linux
[08:25:31] Enabling bundled linux tools.
[08:25:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:31] Found gzip - /usr/bin/gzip
[08:25:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:31] Treating reference as 'fasta' format.
[08:25:31] Will use 8 CPU cores.
[08:25:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[08:25:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[08:25:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[08:25:31] Creating reference folder: reference
[08:25:31] Extracting FASTA and GFF from reference.
[08:25:31] This is snippy 4.4.3
[08:25:31] Written by Torsten Seemann
[08:25:31] Obtained from https://github.com/tseemann/snippy
[08:25:31] Detected operating system: linux
[08:25:31] Enabling bundled linux tools.
[08:25:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:32] Found gzip - /usr/bin/gzip
[08:25:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:32] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:32] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:32] Wrote 3 sequences to ref.fa
[08:25:32] Wrote 0 features to ref.gff
[08:25:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta into pseudo-reads
[08:25:32] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:32] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:32] Treating reference as 'fasta' format.
[08:25:32] Will use 8 CPU cores.
[08:25:32] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
[08:25:32] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[08:25:32] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[08:25:32] Creating reference folder: reference
[08:25:32] Extracting FASTA and GFF from reference.
[08:25:32] Wrote 3 sequences to ref.fa
[08:25:32] Wrote 0 features to ref.gff
[08:25:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta into pseudo-reads
[08:25:32] Running: samtools index snps.bam 2>> snps.log
[08:25:32] Running: samtools index snps.bam 2>> snps.log
[08:25:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.658 CPU sec, 2.450 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70342 reads in 4.540 CPU sec, 0.533 real sec
[samclip] Processed 200000 records...
[08:25:33] Wrote 389596 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:33] Using BAM RG (Read Group) ID: SAL_BB9988AA_AS.out
[08:25:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:33] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:25:34] Marked 0 heterozygous sites with 'n'
[08:25:34] Creating extra output files: BED GFF CSV TXT HTML
[08:25:34] Identified 20 variants.
[08:25:34] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[08:25:34] Result files:
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.aligned.fa
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam.bai
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bed
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.fa
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.subs.fa
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.csv
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.filt.vcf
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.gff
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.html
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.log
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.raw.vcf
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.subs.vcf
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.tab
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.txt
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz
[08:25:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz.csi
[08:25:34] Walltime used: 19 seconds
[08:25:34] Questionable SNP? Try the --report option to see the alignments.
[08:25:34] Done.
[Tue Jun 16 08:25:34 2020]
Finished job 126.
77 of 206 steps (37%) done

[Tue Jun 16 08:25:34 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
    jobid: 78
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2598AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.932 sec; CPU: 22.777 sec
[samclip] Total SAM records 391084, removed 1808, allowed 278, passed 389276
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:34] Wrote 389130 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:34] Using BAM RG (Read Group) ID: SAL_IB6779AA_AS.out
[08:25:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:34] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:35] Wrote 390114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:35] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:35] Using BAM RG (Read Group) ID: SAL_CB2669AA_AS.out
[08:25:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:35] This is snippy 4.4.3
[08:25:35] Written by Torsten Seemann
[08:25:35] Obtained from https://github.com/tseemann/snippy
[08:25:35] Detected operating system: linux
[08:25:35] Enabling bundled linux tools.
[08:25:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:35] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:35] Found gzip - /usr/bin/gzip
[08:25:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:35] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:35] Treating reference as 'fasta' format.
[08:25:35] Will use 8 CPU cores.
[08:25:35] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[08:25:35] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[08:25:35] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[08:25:35] Creating reference folder: reference
[08:25:35] Extracting FASTA and GFF from reference.
[08:25:35] Wrote 3 sequences to ref.fa
[08:25:35] Wrote 0 features to ref.gff
[08:25:35] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta into pseudo-reads
[08:25:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:25:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 1799
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:25:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:36] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 69596 sequences (17394542 bp)...
[08:25:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:36] Running: samtools index snps.bam 2>> snps.log
[08:25:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:36] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320016 sequences (80000232 bp)...
[M::process] read 69114 sequences (17274708 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 70114 sequences (17460752 bp)...
[08:25:38] Wrote 389850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:38] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:38] Using BAM RG (Read Group) ID: SAL_CB2598AA_AS.out
[08:25:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:38] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.525 CPU sec, 2.489 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69596 reads in 3.959 CPU sec, 0.488 real sec
[samclip] Processed 200000 records...
[08:25:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[08:25:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320016 reads in 18.435 CPU sec, 2.469 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.059 sec; CPU: 22.094 sec
[samclip] Total SAM records 389928, removed 961, allowed 81, passed 388967
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:39] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.664 CPU sec, 2.421 real sec
[08:25:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:25:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:40] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 69114 reads in 4.367 CPU sec, 0.511 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 70114 reads in 4.065 CPU sec, 0.473 real sec
[samclip] Processed 200000 records...
[08:25:40] Marked 224 heterozygous sites with 'n'
[08:25:40] Creating extra output files: BED GFF CSV TXT HTML
[08:25:40] Identified 24 variants.
[08:25:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[08:25:40] Result files:
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.aligned.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam.bai
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bed
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.subs.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.csv
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.filt.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.gff
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.html
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.log
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.raw.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.subs.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.tab
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.txt
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz.csi
[08:25:40] Walltime used: 19 seconds
[08:25:40] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:25:40] Done.
[Tue Jun 16 08:25:40 2020]
Finished job 182.
78 of 206 steps (38%) done

[Tue Jun 16 08:25:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
    jobid: 121
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB6801AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[samclip] Processed 300000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 69850 sequences (17398288 bp)...
[samclip] Processed 300000 records...
[08:25:40] Marked 11 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:40] Creating extra output files: BED GFF CSV TXT HTML
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.904 sec; CPU: 23.331 sec
[samclip] Total SAM records 389354, removed 1595, allowed 224, passed 387759
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:40] Identified 1799 variants.
[08:25:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[08:25:40] Result files:
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.aligned.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam.bai
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bed
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.subs.fa
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.csv
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.filt.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.gff
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.html
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.log
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.raw.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.subs.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.tab
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.txt
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz
[08:25:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz.csi
[08:25:40] Walltime used: 19 seconds
[08:25:40] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:25:40] Done.
[Tue Jun 16 08:25:40 2020]
Finished job 34.
79 of 206 steps (38%) done

[Tue Jun 16 08:25:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
    jobid: 108
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out -t[samclip] Total SAM records 390411, removed 831, allowed 90, passed 389580
 8 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.842 sec; CPU: 22.299 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:41] This is snippy 4.4.3
[08:25:41] Written by Torsten Seemann
[08:25:41] Obtained from https://github.com/tseemann/snippy
[08:25:41] Detected operating system: linux
[08:25:41] Enabling bundled linux tools.
[08:25:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:41] Found gzip - /usr/bin/gzip
[08:25:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:41] Treating reference as 'fasta' format.
[08:25:41] Will use 8 CPU cores.
[08:25:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[08:25:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[08:25:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[08:25:41] Creating reference folder: reference
[08:25:41] Extracting FASTA and GFF from reference.
[08:25:41] This is snippy 4.4.3
[08:25:41] Written by Torsten Seemann
[08:25:41] Obtained from https://github.com/tseemann/snippy
[08:25:41] Detected operating system: linux
[08:25:41] Enabling bundled linux tools.
[08:25:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:41] Found gzip - /usr/bin/gzip
[08:25:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:41] Wrote 3 sequences to ref.fa
[08:25:41] Wrote 0 features to ref.gff
[08:25:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta into pseudo-reads
[08:25:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:41] Running: samtools index snps.bam 2>> snps.log
[08:25:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:41] Treating reference as 'fasta' format.
[08:25:41] Will use 8 CPU cores.
[08:25:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
[08:25:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[08:25:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[08:25:41] Creating reference folder: reference
[08:25:41] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:41] Wrote 3 sequences to ref.fa
[08:25:41] Wrote 0 features to ref.gff
[08:25:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta into pseudo-reads
[08:25:42] Running: samtools index snps.bam 2>> snps.log
[08:25:42] Running: samtools index snps.bam 2>> snps.log
[08:25:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.052 CPU sec, 2.465 real sec
[08:25:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 69850 reads in 3.890 CPU sec, 0.480 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:25:44] Marked 0 heterozygous sites with 'n'
[08:25:44] Creating extra output files: BED GFF CSV TXT HTML
[08:25:44] Identified 27 variants.
[08:25:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[08:25:44] Result files:
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.aligned.fa
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam.bai
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bed
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.fa
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.subs.fa
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.csv
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.filt.vcf
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.gff
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.html
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.log
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.raw.vcf
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.subs.vcf
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.tab
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.txt
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz
[08:25:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz.csi
[08:25:44] Walltime used: 19 seconds
[08:25:44] Wishing you a life free of homopolymer errors.
[08:25:44] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.109 sec; CPU: 22.591 sec
[samclip] Total SAM records 390229, removed 1109, allowed 119, passed 389120
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 08:25:44 2020]
Finished job 117.
80 of 206 steps (39%) done

[Tue Jun 16 08:25:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
    jobid: 144
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2970AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:44] Wrote 389442 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:44] Using BAM RG (Read Group) ID: SAL_IB6801AA_AS.out
[08:25:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:44] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:44] Wrote 389650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:44] Using BAM RG (Read Group) ID: SAL_CB1324AA_AS.out
[08:25:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:44] Running: bwa index reference/ref.fa 2>> snps.log
[08:25:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 42
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:45] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:45] This is snippy 4.4.3
[08:25:45] Written by Torsten Seemann
[08:25:45] Obtained from https://github.com/tseemann/snippy
[08:25:45] Detected operating system: linux
[08:25:45] Enabling bundled linux tools.
[08:25:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:45] Found gzip - /usr/bin/gzip
[08:25:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:45] Treating reference as 'fasta' format.
[08:25:45] Will use 8 CPU cores.
[08:25:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
[08:25:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[08:25:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[08:25:45] Creating reference folder: reference
[08:25:45] Extracting FASTA and GFF from reference.
[08:25:45] Wrote 3 sequences to ref.fa
[08:25:45] Wrote 0 features to ref.gff
[08:25:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta into pseudo-reads
[08:25:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:46] Running: samtools index snps.bam 2>> snps.log
[08:25:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:25:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 2003
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:25:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:46] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:25:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:25:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320040 sequences (80000230 bp)...
[08:25:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:46] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 69402 sequences (17313044 bp)...
[M::process] read 320020 sequences (80000364 bp)...
[08:25:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 69630 sequences (17337020 bp)...
[08:25:48] Wrote 391206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:48] Using BAM RG (Read Group) ID: SAL_BB2970AA_AS.out
[08:25:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:48] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320040 reads in 17.729 CPU sec, 2.458 real sec
[M::mem_process_seqs] Processed 320020 reads in 17.398 CPU sec, 2.401 real sec
[08:25:49] Marked 0 heterozygous sites with 'n'
[08:25:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:49] Creating extra output files: BED GFF CSV TXT HTML
[08:25:49] Identified 42 variants.
[08:25:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[08:25:49] Result files:
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.aligned.fa
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam.bai
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bed
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.fa
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.subs.fa
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.csv
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.filt.vcf
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.gff
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.html
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.log
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.raw.vcf
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.subs.vcf
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.tab
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.txt
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz
[08:25:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz.csi
[08:25:49] Walltime used: 19 seconds
[08:25:49] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:25:49] Done.
[Tue Jun 16 08:25:49 2020]
Finished job 58.
81 of 206 steps (39%) done

[Tue Jun 16 08:25:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
    jobid: 25
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2131AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[samclip] Processed 100000 records...
[08:25:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[08:25:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 69402 reads in 3.967 CPU sec, 0.460 real sec
[08:25:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:25:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:49] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 69630 reads in 4.359 CPU sec, 0.502 real sec
[samclip] Processed 200000 records...
[08:25:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[08:25:50] This is snippy 4.4.3
[08:25:50] Written by Torsten Seemann
[08:25:50] Obtained from https://github.com/tseemann/snippy
[08:25:50] Detected operating system: linux
[08:25:50] Enabling bundled linux tools.
[08:25:50] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:50] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:50] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:50] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:50] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:50] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:50] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:50] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:50] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:50] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:50] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:50] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:50] Found gzip - /usr/bin/gzip
[08:25:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.839 sec; CPU: 22.250 sec
[samclip] Total SAM records 389685, removed 716, allowed 60, passed 388969
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.807 sec; CPU: 22.326 sec
[samclip] Total SAM records 390070, removed 1171, allowed 134, passed 388899
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:50] Treating reference as 'fasta' format.
[08:25:50] Will use 8 CPU cores.
[08:25:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[08:25:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[08:25:50] Creating reference folder: reference
[08:25:50] Extracting FASTA and GFF from reference.
[08:25:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:50] Marked 0 heterozygous sites with 'n'
[08:25:50] Creating extra output files: BED GFF CSV TXT HTML
[08:25:50] Identified 17 variants.
[08:25:50] Wrote 3 sequences to ref.fa
[08:25:50] Wrote 0 features to ref.gff
[08:25:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta into pseudo-reads
[08:25:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[08:25:50] Result files:
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.aligned.fa
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam.bai
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bed
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.fa
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.subs.fa
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.csv
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.filt.vcf
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.gff
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.html
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.log
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.raw.vcf
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.subs.vcf
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.tab
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.txt
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz
[08:25:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz.csi
[08:25:50] Walltime used: 19 seconds
[08:25:50] May the SNPs be with you.
[08:25:50] Done.
[Tue Jun 16 08:25:50 2020]
Finished job 180.
82 of 206 steps (40%) done

[Tue Jun 16 08:25:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
    jobid: 143
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6734AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
[M::process] read 320386 sequences (80000080 bp)...
[M::process] read 70820 sequences (17705000 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:51] Marked 0 heterozygous sites with 'n'
[08:25:51] Creating extra output files: BED GFF CSV TXT HTML
[08:25:51] Identified 2003 variants.
[08:25:51] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[08:25:51] Result files:
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.aligned.fa
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam.bai
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bed
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.fa
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.subs.fa
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.csv
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.filt.vcf
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.gff
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.html
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.log
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.raw.vcf
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.subs.vcf
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.tab
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.txt
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz
[08:25:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz.csi
[08:25:51] Walltime used: 20 seconds
[08:25:51] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:25:51] Done.
[Tue Jun 16 08:25:51 2020]
Finished job 31.
83 of 206 steps (40%) done

[Tue Jun 16 08:25:51 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
    jobid: 74
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5379AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:51] This is snippy 4.4.3
[08:25:51] Written by Torsten Seemann
[08:25:51] Obtained from https://github.com/tseemann/snippy
[08:25:51] Detected operating system: linux
[08:25:51] Enabling bundled linux tools.
[08:25:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:51] Found gzip - /usr/bin/gzip
[08:25:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:51] Treating reference as 'fasta' format.
[08:25:51] Will use 8 CPU cores.
[08:25:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
[08:25:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[08:25:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[08:25:51] Creating reference folder: reference
[08:25:51] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:51] Wrote 3 sequences to ref.fa
[08:25:51] Wrote 0 features to ref.gff
[08:25:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta into pseudo-reads
[08:25:51] This is snippy 4.4.3
[08:25:51] Written by Torsten Seemann
[08:25:51] Obtained from https://github.com/tseemann/snippy
[08:25:51] Detected operating system: linux
[08:25:51] Enabling bundled linux tools.
[08:25:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:25:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:25:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:51] Found gzip - /usr/bin/gzip
[08:25:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:52] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:52] Treating reference as 'fasta' format.
[08:25:52] Will use 8 CPU cores.
[08:25:52] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
[08:25:52] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[08:25:52] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[08:25:52] Creating reference folder: reference
[08:25:52] Extracting FASTA and GFF from reference.
[08:25:52] Running: samtools index snps.bam 2>> snps.log
[08:25:52] Wrote 3 sequences to ref.fa
[08:25:52] Wrote 0 features to ref.gff
[08:25:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta into pseudo-reads
[08:25:52] Running: samtools index snps.bam 2>> snps.log
[08:25:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320386 reads in 16.277 CPU sec, 2.186 real sec
[samclip] Processed 100000 records...
[08:25:53] Wrote 390266 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:53] Using BAM RG (Read Group) ID: SAL_BB2131AA_AS.out
[08:25:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:53] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 70820 reads in 5.247 CPU sec, 0.613 real sec
[samclip] Processed 300000 records...
[08:25:53] Marked 0 heterozygous sites with 'n'
[08:25:53] Creating extra output files: BED GFF CSV TXT HTML
[08:25:53] Identified 29 variants.
[08:25:53] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[08:25:53] Result files:
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.aligned.fa
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam.bai
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bed
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.fa
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.subs.fa
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.csv
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.filt.vcf
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.gff
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.html
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.log
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.raw.vcf
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.subs.vcf
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.tab
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.txt
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz
[08:25:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz.csi
[08:25:53] Walltime used: 18 seconds
[08:25:53] Questionable SNP? Try the --report option to see the alignments.
[08:25:53] Done.
[Tue Jun 16 08:25:53 2020]
Finished job 78.
84 of 206 steps (41%) done

[Tue Jun 16 08:25:53 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
    jobid: 56
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2219AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.608 sec; CPU: 22.046 sec
[samclip] Total SAM records 391641, removed 1206, allowed 106, passed 390435
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:54] Wrote 387804 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:54] Using BAM RG (Read Group) ID: SAL_KB6734AA_AS.out
[08:25:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:54] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:25:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:55] Wrote 388498 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:55] Using BAM RG (Read Group) ID: SAL_CB5379AA_AS.out
[08:25:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:25:55] Running: bwa index reference/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:25:55] This is snippy 4.4.3
[08:25:55] Written by Torsten Seemann
[08:25:55] Obtained from https://github.com/tseemann/snippy
[08:25:55] Detected operating system: linux
[08:25:55] Enabling bundled linux tools.
[08:25:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:25:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:25:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:25:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:25:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:25:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 41
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:25:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:25:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:25:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:25:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:25:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:25:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:25:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:25:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:25:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:25:55] Found gzip - /usr/bin/gzip
[08:25:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:25:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:25:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:25:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:25:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:25:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:25:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:25:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320024 sequences (80000176 bp)...
[08:25:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:25:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:25:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:25:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:55] Treating reference as 'fasta' format.
[08:25:55] Will use 8 CPU cores.
[08:25:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[08:25:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[08:25:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[08:25:55] Creating reference folder: reference
[08:25:55] Extracting FASTA and GFF from reference.
[08:25:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 70242 sequences (17560500 bp)...
[08:25:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:25:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:55] Wrote 3 sequences to ref.fa
[08:25:55] Wrote 0 features to ref.gff
[08:25:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta into pseudo-reads
[08:25:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:25:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:25:55] Running: samtools index snps.bam 2>> snps.log
[08:25:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:25:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:25:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:25:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000476 bp)...
[08:25:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 67760 sequences (16940000 bp)...
[08:25:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:25:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:25:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:25:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 68498 sequences (17108608 bp)...
[M::mem_process_seqs] Processed 320024 reads in 17.762 CPU sec, 2.545 real sec
[samclip] Processed 100000 records...
[08:25:58] Wrote 388312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:25:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:25:58] Using BAM RG (Read Group) ID: SAL_HB2219AA_AS.out
[08:25:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:25:58] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 70242 reads in 4.136 CPU sec, 0.497 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:25:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:25:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:25:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.110 sec; CPU: 22.507 sec
[samclip] Total SAM records 390573, removed 982, allowed 240, passed 389591
[samclip] Header contained 5 lines
[samclip] Done.
[08:25:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:25:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:25:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:25:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:25:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:25:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:25:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:25:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:25:59] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320044 reads in 18.055 CPU sec, 2.544 real sec
[08:25:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.698 CPU sec, 2.412 real sec
[08:25:59] Marked 0 heterozygous sites with 'n'
[08:25:59] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 67760 reads in 4.167 CPU sec, 0.478 real sec
[08:25:59] Identified 41 variants.
[08:25:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[08:25:59] Result files:
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.aligned.fa
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam.bai
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bed
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.fa
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.subs.fa
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.csv
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.filt.vcf
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.gff
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.html
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.log
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.raw.vcf
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.subs.vcf
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.tab
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.txt
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz
[08:25:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz.csi
[08:25:59] Walltime used: 18 seconds
[08:25:59] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:25:59] Done.
[Tue Jun 16 08:25:59 2020]
Finished job 121.
85 of 206 steps (41%) done

[Tue Jun 16 08:25:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
    jobid: 45
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB3115AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[08:26:00] Marked 0 heterozygous sites with 'n'
[08:26:00] Creating extra output files: BED GFF CSV TXT HTML
[08:26:00] Identified 19 variants.
[08:26:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[08:26:00] Result files:
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.aligned.fa
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam.bai
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bed
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.fa
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.subs.fa
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.csv
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.filt.vcf
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.gff
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.html
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.log
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.raw.vcf
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.subs.vcf
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.tab
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.txt
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz
[08:26:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz.csi
[08:26:00] Walltime used: 19 seconds
[08:26:00] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:26:00] Done.
[08:26:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[Tue Jun 16 08:26:00 2020]
Finished job 108.
86 of 206 steps (42%) done

[Tue Jun 16 08:26:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
    jobid: 30
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB9118AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
[08:26:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::mem_process_seqs] Processed 68498 reads in 3.828 CPU sec, 0.448 real sec
[08:26:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.924 sec; CPU: 22.783 sec
[samclip] Total SAM records 387938, removed 504, allowed 38, passed 387434
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::process] read 320024 sequences (80000272 bp)...
[08:26:00] This is snippy 4.4.3
[08:26:00] Written by Torsten Seemann
[08:26:00] Obtained from https://github.com/tseemann/snippy
[08:26:00] Detected operating system: linux
[08:26:00] Enabling bundled linux tools.
[08:26:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::process] read 68288 sequences (17043056 bp)...
[08:26:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:00] Found gzip - /usr/bin/gzip
[08:26:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.791 sec; CPU: 22.078 sec
[samclip] Total SAM records 388916, removed 1029, allowed 78, passed 387887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:00] This is snippy 4.4.3
[08:26:00] Written by Torsten Seemann
[08:26:00] Obtained from https://github.com/tseemann/snippy
[08:26:00] Detected operating system: linux
[08:26:00] Enabling bundled linux tools.
[08:26:00] Treating reference as 'fasta' format.
[08:26:00] Will use 8 CPU cores.
[08:26:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[08:26:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[08:26:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[08:26:00] Creating reference folder: reference
[08:26:00] Extracting FASTA and GFF from reference.
[08:26:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:00] Found gzip - /usr/bin/gzip
[08:26:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:01] Wrote 3 sequences to ref.fa
[08:26:01] Wrote 0 features to ref.gff
[08:26:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta into pseudo-reads
[08:26:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:01] Running: samtools index snps.bam 2>> snps.log
[08:26:01] Treating reference as 'fasta' format.
[08:26:01] Will use 8 CPU cores.
[08:26:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
[08:26:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[08:26:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[08:26:01] Creating reference folder: reference
[08:26:01] Extracting FASTA and GFF from reference.
[08:26:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:01] Wrote 3 sequences to ref.fa
[08:26:01] Wrote 0 features to ref.gff
[08:26:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:02] Running: samtools index snps.bam 2>> snps.log
[08:26:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:02] Running: samtools index snps.bam 2>> snps.log
[08:26:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320024 reads in 17.376 CPU sec, 2.439 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 68288 reads in 3.892 CPU sec, 0.470 real sec
[samclip] Processed 200000 records...
[08:26:03] Marked 0 heterozygous sites with 'n'
[08:26:03] Wrote 388058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:03] Using BAM RG (Read Group) ID: SAL_IB3115AA_AS.out
[08:26:03] Creating extra output files: BED GFF CSV TXT HTML
[08:26:03] Identified 17 variants.
[08:26:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[08:26:03] Result files:
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.aligned.fa
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam.bai
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bed
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.fa
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.subs.fa
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.csv
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.filt.vcf
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.gff
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.html
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.log
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.raw.vcf
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.subs.vcf
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.tab
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.txt
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz
[08:26:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz.csi
[08:26:03] Walltime used: 18 seconds
[08:26:03] May the SNPs be with you.
[08:26:03] Done.
[samclip] Processed 300000 records...
[Tue Jun 16 08:26:03 2020]
Finished job 144.
87 of 206 steps (42%) done

[Tue Jun 16 08:26:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
    jobid: 122
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[08:26:03] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:04] Wrote 387684 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:04] Using BAM RG (Read Group) ID: SAL_IB9118AA_AS.out
[08:26:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:04] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.977 sec; CPU: 21.885 sec
[samclip] Total SAM records 388641, removed 826, allowed 90, passed 387815
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:04] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:04] This is snippy 4.4.3
[08:26:04] Written by Torsten Seemann
[08:26:04] Obtained from https://github.com/tseemann/snippy
[08:26:04] Detected operating system: linux
[08:26:04] Enabling bundled linux tools.
[08:26:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:04] Found gzip - /usr/bin/gzip
[08:26:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:04] Treating reference as 'fasta' format.
[08:26:04] Will use 8 CPU cores.
[08:26:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[08:26:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[08:26:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[08:26:04] Creating reference folder: reference
[08:26:04] Extracting FASTA and GFF from reference.
[08:26:05] Wrote 3 sequences to ref.fa
[08:26:05] Wrote 0 features to ref.gff
[08:26:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:26:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:05] Running: ln -sf reference/ref.fa . 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:05] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 320062 sequences (80000346 bp)...
[08:26:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 67996 sequences (16962818 bp)...
[08:26:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:06] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320094 sequences (80000328 bp)...
[08:26:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:06] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 67590 sequences (16897500 bp)...
[08:26:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:07] Wrote 392448 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:07] Using BAM RG (Read Group) ID: SAL_CA4728AA_AS.out
[08:26:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:07] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320062 reads in 17.431 CPU sec, 2.287 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320094 reads in 17.751 CPU sec, 2.466 real sec
[M::mem_process_seqs] Processed 67996 reads in 3.691 CPU sec, 0.431 real sec
[08:26:08] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[08:26:08] Creating extra output files: BED GFF CSV TXT HTML
[08:26:08] Identified 29 variants.
[08:26:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[08:26:08] Result files:
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.aligned.fa
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam.bai
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bed
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.fa
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.subs.fa
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.csv
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.filt.vcf
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.gff
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.html
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.log
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.raw.vcf
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.subs.vcf
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.tab
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.txt
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz
[08:26:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz.csi
[08:26:08] Walltime used: 18 seconds
[08:26:08] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:26:08] Done.
[Tue Jun 16 08:26:08 2020]
Finished job 25.
88 of 206 steps (43%) done

[Tue Jun 16 08:26:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
    jobid: 167
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4803AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67590 reads in 3.877 CPU sec, 0.456 real sec
[samclip] Processed 300000 records...
[08:26:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 200000 records...
[08:26:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.665 sec; CPU: 21.654 sec
[samclip] Total SAM records 388474, removed 1480, allowed 193, passed 386994
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:26:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:09] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:09] This is snippy 4.4.3
[08:26:09] Written by Torsten Seemann
[08:26:09] Obtained from https://github.com/tseemann/snippy
[08:26:09] Detected operating system: linux
[08:26:09] Enabling bundled linux tools.
[08:26:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:09] Found gzip - /usr/bin/gzip
[08:26:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:26:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.922 sec; CPU: 22.217 sec
[samclip] Total SAM records 387893, removed 737, allowed 98, passed 387156
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:09] Treating reference as 'fasta' format.
[08:26:09] Will use 8 CPU cores.
[08:26:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[08:26:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[08:26:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[08:26:09] Creating reference folder: reference
[08:26:09] Extracting FASTA and GFF from reference.
[08:26:10] Marked 0 heterozygous sites with 'n'
[08:26:10] Wrote 3 sequences to ref.fa
[08:26:10] Wrote 0 features to ref.gff
[08:26:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta into pseudo-reads
[M::process] read 320100 sequences (80000048 bp)...
[08:26:10] Creating extra output files: BED GFF CSV TXT HTML
[08:26:10] Identified 105 variants.
[08:26:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[08:26:10] Result files:
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.aligned.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam.bai
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bed
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.subs.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.csv
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.filt.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.gff
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.html
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.log
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.raw.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.subs.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.tab
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.txt
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz.csi
[08:26:10] Walltime used: 19 seconds
[08:26:10] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:26:10] Done.
[Tue Jun 16 08:26:10 2020]
Finished job 143.
89 of 206 steps (43%) done

[Tue Jun 16 08:26:10 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
    jobid: 158
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB4414AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[M::process] read 72348 sequences (18083964 bp)...
[08:26:10] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:10] Creating extra output files: BED GFF CSV TXT HTML
[08:26:10] Identified 13 variants.
[08:26:10] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[08:26:10] Result files:
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.aligned.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam.bai
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bed
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.subs.fa
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.csv
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.filt.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.gff
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.html
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.log
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.raw.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.subs.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.tab
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.txt
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz
[08:26:10] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz.csi
[08:26:10] Walltime used: 19 seconds
[08:26:10] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:26:10] Done.
[Tue Jun 16 08:26:10 2020]
Finished job 74.
90 of 206 steps (44%) done

[Tue Jun 16 08:26:10 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
    jobid: 118
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4937AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:10] This is snippy 4.4.3
[08:26:10] Written by Torsten Seemann
[08:26:10] Obtained from https://github.com/tseemann/snippy
[08:26:10] Detected operating system: linux
[08:26:10] Enabling bundled linux tools.
[08:26:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:10] Found gzip - /usr/bin/gzip
[08:26:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:10] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:11] Treating reference as 'fasta' format.
[08:26:11] Will use 8 CPU cores.
[08:26:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[08:26:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[08:26:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[08:26:11] Creating reference folder: reference
[08:26:11] Extracting FASTA and GFF from reference.
[08:26:11] This is snippy 4.4.3
[08:26:11] Written by Torsten Seemann
[08:26:11] Obtained from https://github.com/tseemann/snippy
[08:26:11] Detected operating system: linux
[08:26:11] Enabling bundled linux tools.
[08:26:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:11] Found gzip - /usr/bin/gzip
[08:26:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:11] Wrote 3 sequences to ref.fa
[08:26:11] Wrote 0 features to ref.gff
[08:26:11] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta into pseudo-reads
[08:26:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:11] Running: samtools index snps.bam 2>> snps.log
[08:26:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:11] Treating reference as 'fasta' format.
[08:26:11] Will use 8 CPU cores.
[08:26:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
[08:26:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[08:26:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[08:26:11] Creating reference folder: reference
[08:26:11] Extracting FASTA and GFF from reference.
[08:26:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:11] Wrote 3 sequences to ref.fa
[08:26:11] Wrote 0 features to ref.gff
[08:26:11] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta into pseudo-reads
[08:26:11] Running: samtools index snps.bam 2>> snps.log
[08:26:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320100 reads in 18.613 CPU sec, 2.599 real sec
[08:26:12] Wrote 392020 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:12] Using BAM RG (Read Group) ID: SAL_CA4803AA_AS.out
[08:26:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:12] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 72348 reads in 4.951 CPU sec, 0.577 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out -t 8[samclip] Total SAM records 392624, removed 994, allowed 114, passed 391630
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.006 sec; CPU: 24.090 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:13] Wrote 387532 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:13] Using BAM RG (Read Group) ID: SAL_JB4414AA_AS.out
[08:26:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:13] Marked 0 heterozygous sites with 'n'
[08:26:13] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:13] Creating extra output files: BED GFF CSV TXT HTML
[08:26:13] Identified 17 variants.
[08:26:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[08:26:13] Result files:
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.aligned.fa
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam.bai
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bed
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.fa
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.subs.fa
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.csv
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.filt.vcf
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.gff
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.html
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.log
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.raw.vcf
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.subs.vcf
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.tab
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.txt
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz
[08:26:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz.csi
[08:26:13] Walltime used: 18 seconds
[08:26:14] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:26:14] Done.
[Tue Jun 16 08:26:14 2020]
Finished job 56.
91 of 206 steps (44%) done

[Tue Jun 16 08:26:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
    jobid: 185
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9389AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[08:26:14] Wrote 388660 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:14] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:14] Using BAM RG (Read Group) ID: SAL_BB4937AA_AS.out
[08:26:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:14] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1697
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:26:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 185
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:14] This is snippy 4.4.3
[08:26:14] Written by Torsten Seemann
[08:26:14] Obtained from https://github.com/tseemann/snippy
[08:26:14] Detected operating system: linux
[08:26:14] Enabling bundled linux tools.
[08:26:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:26:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:14] Found gzip - /usr/bin/gzip
[08:26:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:15] Treating reference as 'fasta' format.
[08:26:15] Will use 8 CPU cores.
[08:26:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[08:26:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[08:26:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[08:26:15] Creating reference folder: reference
[08:26:15] Extracting FASTA and GFF from reference.
[08:26:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:15] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:15] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320018 sequences (80000222 bp)...
[08:26:15] Wrote 3 sequences to ref.fa
[08:26:15] Wrote 0 features to ref.gff
[08:26:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta into pseudo-reads
[08:26:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 72002 sequences (17989846 bp)...
[08:26:15] Running: samtools index snps.bam 2>> snps.log
[08:26:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320096 sequences (80000392 bp)...
[08:26:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:16] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 67436 sequences (16851378 bp)...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320226 sequences (80000298 bp)...
[M::process] read 68434 sequences (17060382 bp)...
[M::mem_process_seqs] Processed 320018 reads in 18.255 CPU sec, 2.505 real sec
[08:26:18] Wrote 387434 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:18] Using BAM RG (Read Group) ID: SAL_CB9389AA_AS.out
[08:26:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:18] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 72002 reads in 4.491 CPU sec, 0.532 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320096 reads in 16.823 CPU sec, 2.395 real sec
[samclip] Processed 300000 records...
[08:26:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 120
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.016 sec; CPU: 23.339 sec
[samclip] Total SAM records 392443, removed 2978, allowed 329, passed 389465
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 67436 reads in 4.170 CPU sec, 0.483 real sec
[08:26:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:26:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:19] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320226 reads in 17.739 CPU sec, 2.756 real sec
[samclip] Processed 300000 records...
[08:26:19] Marked 4 heterozygous sites with 'n'
[08:26:19] Creating extra output files: BED GFF CSV TXT HTML
[08:26:19] Identified 185 variants.
[08:26:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[08:26:19] Result files:
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.aligned.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam.bai
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bed
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.subs.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.csv
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.filt.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.gff
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.html
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.log
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.raw.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.subs.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.tab
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.txt
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz.csi
[08:26:19] Walltime used: 19 seconds
[08:26:19] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:26:19] Done.
[Tue Jun 16 08:26:19 2020]
Finished job 30.
92 of 206 steps (45%) done

[Tue Jun 16 08:26:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
    jobid: 17
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB1406AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[08:26:19] Marked 0 heterozygous sites with 'n'
[08:26:19] Creating extra output files: BED GFF CSV TXT HTML
[08:26:19] Identified 1697 variants.
[08:26:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[08:26:19] Result files:
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.aligned.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam.bai
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bed
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.subs.fa
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.csv
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.filt.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.gff
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.html
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.log
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.raw.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.subs.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.tab
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.txt
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz
[08:26:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz.csi
[08:26:19] Walltime used: 19 seconds
[08:26:19] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:26:19] Done.
[Tue Jun 16 08:26:19 2020]
Finished job 45.
93 of 206 steps (45%) done

[Tue Jun 16 08:26:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
    jobid: 46
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB4026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.780 sec; CPU: 21.531 sec
[samclip] Total SAM records 387882, removed 1240, allowed 78, passed 386642
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 200000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 68434 reads in 4.620 CPU sec, 0.534 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[08:26:20] This is snippy 4.4.3
[08:26:20] Written by Torsten Seemann
[08:26:20] Obtained from https://github.com/tseemann/snippy
[08:26:20] Detected operating system: linux
[08:26:20] Enabling bundled linux tools.
[08:26:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::process] read 320000 sequences (80000000 bp)...
[08:26:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:20] Found gzip - /usr/bin/gzip
[08:26:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 67434 sequences (16826322 bp)...
[08:26:20] This is snippy 4.4.3
[08:26:20] Written by Torsten Seemann
[08:26:20] Obtained from https://github.com/tseemann/snippy
[08:26:20] Detected operating system: linux
[08:26:20] Enabling bundled linux tools.
[08:26:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:20] Found gzip - /usr/bin/gzip
[08:26:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.159 sec; CPU: 22.905 sec
[samclip] Total SAM records 389113, removed 1279, allowed 151, passed 387834
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:20] Treating reference as 'fasta' format.
[08:26:20] Will use 8 CPU cores.
[08:26:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[08:26:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[08:26:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[08:26:20] Creating reference folder: reference
[08:26:20] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:20] Treating reference as 'fasta' format.
[08:26:20] Will use 8 CPU cores.
[08:26:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
[08:26:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[08:26:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[08:26:20] Creating reference folder: reference
[08:26:20] Extracting FASTA and GFF from reference.
[08:26:20] Wrote 3 sequences to ref.fa
[08:26:20] Wrote 0 features to ref.gff
[08:26:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:20] Wrote 3 sequences to ref.fa
[08:26:20] Wrote 0 features to ref.gff
[08:26:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta into pseudo-reads
[08:26:20] Running: samtools index snps.bam 2>> snps.log
[08:26:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:21] Running: samtools index snps.bam 2>> snps.log
[08:26:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:22] Running: samtools index snps.bam 2>> snps.log
[08:26:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.090 CPU sec, 2.360 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67434 reads in 3.768 CPU sec, 0.453 real sec
[samclip] Processed 200000 records...
[08:26:23] Wrote 387620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:23] Marked 1 heterozygous sites with 'n'
[08:26:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:23] Using BAM RG (Read Group) ID: SAL_IB1406AA_AS.out
[08:26:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:23] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:23] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 300000 records...
[08:26:23] Identified 120 variants.
[08:26:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[08:26:23] Result files:
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.aligned.fa
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam.bai
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bed
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.fa
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.subs.fa
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.csv
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.filt.vcf
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.gff
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.html
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.log
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.raw.vcf
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.subs.vcf
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.tab
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.txt
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz
[08:26:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz.csi
[08:26:23] Walltime used: 19 seconds
[08:26:23] Wishing you a life free of homopolymer errors.
[08:26:23] Done.
[Tue Jun 16 08:26:23 2020]
Finished job 122.
94 of 206 steps (46%) done

[Tue Jun 16 08:26:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
    jobid: 28
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5909AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[08:26:23] Wrote 388648 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:23] Using BAM RG (Read Group) ID: SAL_KB4026AA_AS.out
[08:26:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:23] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.882 sec; CPU: 21.457 sec
[samclip] Total SAM records 387789, removed 947, allowed 69, passed 386842
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:24] This is snippy 4.4.3
[08:26:24] Written by Torsten Seemann
[08:26:24] Obtained from https://github.com/tseemann/snippy
[08:26:24] Detected operating system: linux
[08:26:24] Enabling bundled linux tools.
[08:26:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:24] Found gzip - /usr/bin/gzip
[08:26:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:26:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:26:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1902
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:26:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:24] Treating reference as 'fasta' format.
[08:26:24] Will use 8 CPU cores.
[08:26:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[08:26:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[08:26:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[08:26:24] Creating reference folder: reference
[08:26:24] Extracting FASTA and GFF from reference.
[08:26:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:24] Wrote 3 sequences to ref.fa
[08:26:24] Wrote 0 features to ref.gff
[08:26:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta into pseudo-reads
[08:26:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:24] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:25] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320060 sequences (80000232 bp)...
[08:26:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 67560 sequences (16890000 bp)...
[08:26:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:25] Running: samtools index snps.bam 2>> snps.log
[08:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320132 sequences (80000104 bp)...
[08:26:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 68516 sequences (17114840 bp)...
[08:26:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:25] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:27] Wrote 386744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:27] Using BAM RG (Read Group) ID: SAL_AB5909AA_AS.out
[08:26:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:27] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320060 reads in 17.160 CPU sec, 2.433 real sec
[M::mem_process_seqs] Processed 320132 reads in 17.061 CPU sec, 2.349 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67560 reads in 4.415 CPU sec, 0.510 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 68516 reads in 4.145 CPU sec, 0.484 real sec
[samclip] Processed 200000 records...
[08:26:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[08:26:28] Marked 0 heterozygous sites with 'n'
[08:26:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:29] Creating extra output files: BED GFF CSV TXT HTML
[08:26:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:29] Identified 1902 variants.
[08:26:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[08:26:29] Result files:
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.aligned.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam.bai
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bed
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.subs.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.csv
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.filt.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.gff
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.html
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.log
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.raw.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.subs.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.tab
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.txt
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz.csi
[08:26:29] Walltime used: 20 seconds
[08:26:29] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:26:29] Done.
[Tue Jun 16 08:26:29 2020]
Finished job 167.
95 of 206 steps (46%) done

[Tue Jun 16 08:26:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
    jobid: 9
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB5660AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.822 sec; CPU: 22.119 sec
[samclip] Total SAM records 387912, removed 862, allowed 124, passed 387050
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 389838, removed 2946, allowed 93, passed 386892

[main] Real time: 3.746 sec; CPU: 21.749 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:29] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:29] Marked 0 heterozygous sites with 'n'
[08:26:29] Creating extra output files: BED GFF CSV TXT HTML
[08:26:29] Identified 122 variants.
[08:26:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[08:26:29] Result files:
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.aligned.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam.bai
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bed
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.subs.fa
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.csv
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.filt.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.gff
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.html
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.log
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.raw.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.subs.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.tab
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.txt
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz
[08:26:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz.csi
[08:26:29] Walltime used: 19 seconds
[08:26:29] Questionable SNP? Try the --report option to see the alignments.
[08:26:29] Done.
[Tue Jun 16 08:26:29 2020]
Finished job 158.
96 of 206 steps (47%) done

[Tue Jun 16 08:26:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
    jobid: 7
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA8052AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[M::process] read 320028 sequences (80000470 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 66716 sequences (16679000 bp)...
[08:26:29] This is snippy 4.4.3
[08:26:29] Written by Torsten Seemann
[08:26:29] Obtained from https://github.com/tseemann/snippy
[08:26:29] Detected operating system: linux
[08:26:29] Enabling bundled linux tools.
[08:26:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:29] Found gzip - /usr/bin/gzip
[08:26:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:29] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:30] Treating reference as 'fasta' format.
[08:26:30] Will use 8 CPU cores.
[08:26:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[08:26:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[08:26:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[08:26:30] Creating reference folder: reference
[08:26:30] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:30] Wrote 3 sequences to ref.fa
[08:26:30] Wrote 0 features to ref.gff
[08:26:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta into pseudo-reads
[08:26:30] This is snippy 4.4.3
[08:26:30] Written by Torsten Seemann
[08:26:30] Obtained from https://github.com/tseemann/snippy
[08:26:30] Detected operating system: linux
[08:26:30] Enabling bundled linux tools.
[08:26:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:30] Marked 0 heterozygous sites with 'n'
[08:26:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:30] Found gzip - /usr/bin/gzip
[08:26:30] Creating extra output files: BED GFF CSV TXT HTML
[08:26:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:30] Identified 28 variants.
[08:26:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[08:26:30] Result files:
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.aligned.fa
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam.bai
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bed
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.fa
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.subs.fa
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.csv
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.filt.vcf
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.gff
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.html
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.log
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.raw.vcf
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.subs.vcf
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.tab
[08:26:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.txt
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz
[08:26:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz.csi
[08:26:30] Walltime used: 19 seconds
[08:26:30] Wishing you a life free of homopolymer errors.
[08:26:30] Done.
[08:26:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[Tue Jun 16 08:26:30 2020]
Finished job 118.
97 of 206 steps (47%) done
[08:26:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

[Tue Jun 16 08:26:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
    jobid: 37
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB6699AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
[08:26:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:30] Treating reference as 'fasta' format.
[08:26:30] Will use 8 CPU cores.
[08:26:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[08:26:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[08:26:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[08:26:30] Creating reference folder: reference
[08:26:30] Extracting FASTA and GFF from reference.
[08:26:30] Wrote 3 sequences to ref.fa
[08:26:30] Wrote 0 features to ref.gff
[08:26:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:30] This is snippy 4.4.3
[08:26:30] Written by Torsten Seemann
[08:26:30] Obtained from https://github.com/tseemann/snippy
[08:26:30] Detected operating system: linux
[08:26:30] Enabling bundled linux tools.
[08:26:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:31] Found gzip - /usr/bin/gzip
[08:26:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:31] Running: samtools index snps.bam 2>> snps.log
[08:26:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:31] Running: samtools index snps.bam 2>> snps.log
[08:26:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:31] Treating reference as 'fasta' format.
[08:26:31] Will use 8 CPU cores.
[08:26:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
[08:26:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[08:26:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[08:26:31] Creating reference folder: reference
[08:26:31] Extracting FASTA and GFF from reference.
[08:26:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:31] Wrote 3 sequences to ref.fa
[08:26:31] Wrote 0 features to ref.gff
[08:26:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320028 reads in 17.837 CPU sec, 2.462 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66716 reads in 3.866 CPU sec, 0.451 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:26:32] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:32] Using BAM RG (Read Group) ID: SAL_HB5660AA_AS.out
[08:26:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:32] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.860 sec; CPU: 22.279 sec
[samclip] Total SAM records 386819, removed 459, allowed 82, passed 386360
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:33] Marked 0 heterozygous sites with 'n'
[08:26:33] Creating extra output files: BED GFF CSV TXT HTML
[08:26:33] Identified 27 variants.
[08:26:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[08:26:33] Result files:
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.aligned.fa
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam.bai
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bed
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.fa
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.subs.fa
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.csv
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.filt.vcf
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.gff
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.html
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.log
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.raw.vcf
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.subs.vcf
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.tab
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.txt
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz
[08:26:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz.csi
[08:26:33] Walltime used: 19 seconds
[08:26:33] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:26:33] Done.
[Tue Jun 16 08:26:33 2020]
Finished job 185.
98 of 206 steps (48%) done

[Tue Jun 16 08:26:33 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
    jobid: 171
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1424AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[08:26:33] Wrote 392016 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:33] Using BAM RG (Read Group) ID: SAL_BA8052AA_AS.out
[08:26:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:33] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:34] Wrote 387752 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:34] Using BAM RG (Read Group) ID: SAL_HB6699AA_AS.out
[08:26:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:34] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 36
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 124
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:34] This is snippy 4.4.3
[08:26:34] Written by Torsten Seemann
[08:26:34] Obtained from https://github.com/tseemann/snippy
[08:26:34] Detected operating system: linux
[08:26:34] Enabling bundled linux tools.
[08:26:34] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:34] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:34] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:34] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:34] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:34] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:34] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:34] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:34] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:34] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:34] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:34] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:34] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:34] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:34] Found gzip - /usr/bin/gzip
[08:26:34] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:34] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:34] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:34] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:34] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:34] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:34] Treating reference as 'fasta' format.
[08:26:34] Will use 8 CPU cores.
[08:26:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[08:26:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[08:26:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[08:26:34] Creating reference folder: reference
[08:26:34] Extracting FASTA and GFF from reference.
[08:26:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:34] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:34] Wrote 3 sequences to ref.fa
[08:26:34] Wrote 0 features to ref.gff
[08:26:34] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta into pseudo-reads
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:35] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320038 sequences (80000204 bp)...
[M::process] read 66598 sequences (16649500 bp)...
[08:26:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320294 sequences (80000080 bp)...
[M::process] read 71722 sequences (17913654 bp)...
[08:26:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 67752 sequences (16917538 bp)...
[M::mem_process_seqs] Processed 320038 reads in 16.769 CPU sec, 2.314 real sec
[08:26:37] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:37] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:37] Using BAM RG (Read Group) ID: SAL_BB1424AA_AS.out
[08:26:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:37] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66598 reads in 3.896 CPU sec, 0.457 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320294 reads in 16.820 CPU sec, 2.345 real sec
[08:26:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 127
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:26:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[08:26:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.704 sec; CPU: 21.218 sec
[samclip] Total SAM records 386765, removed 664, allowed 86, passed 386101
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 71722 reads in 4.365 CPU sec, 0.507 real sec
[samclip] Processed 200000 records...
[08:26:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:38] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[08:26:38] Marked 0 heterozygous sites with 'n'
[08:26:38] Marked 24 heterozygous sites with 'n'
[08:26:38] Creating extra output files: BED GFF CSV TXT HTML
[08:26:38] Creating extra output files: BED GFF CSV TXT HTML
[08:26:38] Identified 36 variants.
[08:26:38] Identified 124 variants.
[08:26:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[08:26:38] Result files:
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.aligned.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam.bai
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bed
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.subs.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.csv
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.filt.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.gff
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.html
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.log
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.raw.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.subs.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.tab
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.txt
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz.csi
[08:26:38] Walltime used: 18 seconds
[08:26:38] May the SNPs be with you.
[08:26:38] Done.
[08:26:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[08:26:38] Result files:
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.aligned.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam.bai
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bed
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.subs.fa
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.csv
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.filt.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.gff
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.html
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.log
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.raw.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.subs.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.tab
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.txt
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz
[08:26:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz.csi
[08:26:38] Walltime used: 18 seconds
[08:26:38] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:26:38] Done.
[Tue Jun 16 08:26:38 2020]
Finished job 17.
99 of 206 steps (48%) done
[Tue Jun 16 08:26:38 2020]
Finished job 46.
100 of 206 steps (49%) done

[Tue Jun 16 08:26:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
    jobid: 183
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_GB5373AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta

[Tue Jun 16 08:26:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
    jobid: 107
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 17.978 CPU sec, 2.738 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.772 sec; CPU: 21.745 sec
[samclip] Total SAM records 392343, removed 1246, allowed 371, passed 391097
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[08:26:39] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:39] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:39] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:39] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:39] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 67752 reads in 4.132 CPU sec, 0.477 real sec
[samclip] Processed 200000 records...
[08:26:39] This is snippy 4.4.3
[08:26:39] This is snippy 4.4.3
[08:26:39] Written by Torsten Seemann
[08:26:39] Written by Torsten Seemann
[08:26:39] Obtained from https://github.com/tseemann/snippy
[08:26:39] Obtained from https://github.com/tseemann/snippy
[08:26:39] Detected operating system: linux
[08:26:39] Detected operating system: linux
[08:26:39] Enabling bundled linux tools.
[08:26:39] Enabling bundled linux tools.
[08:26:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:39] Found gzip - /usr/bin/gzip
[08:26:39] Found gzip - /usr/bin/gzip
[M::process] read 320022 sequences (80000134 bp)...
[08:26:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 66614 sequences (16649802 bp)...
[samclip] Processed 300000 records...
[08:26:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:39] Treating reference as 'fasta' format.
[08:26:39] Will use 8 CPU cores.
[08:26:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[08:26:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[08:26:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[08:26:39] Creating reference folder: reference
[08:26:39] Extracting FASTA and GFF from reference.
[08:26:39] Treating reference as 'fasta' format.
[08:26:39] Will use 8 CPU cores.
[08:26:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
[08:26:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[08:26:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[08:26:39] Creating reference folder: reference
[08:26:39] Extracting FASTA and GFF from reference.
[08:26:40] Wrote 3 sequences to ref.fa
[08:26:40] Wrote 0 features to ref.gff
[08:26:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta into pseudo-reads
[08:26:40] Wrote 3 sequences to ref.fa
[08:26:40] Wrote 0 features to ref.gff
[08:26:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.151 sec; CPU: 22.684 sec
[samclip] Total SAM records 388223, removed 1114, allowed 173, passed 387109
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:40] Running: samtools index snps.bam 2>> snps.log
[08:26:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:41] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320022 reads in 17.094 CPU sec, 2.306 real sec
[08:26:42] Running: samtools index snps.bam 2>> snps.log
[08:26:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66614 reads in 4.142 CPU sec, 0.494 real sec
[samclip] Processed 200000 records...
[08:26:42] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:26:42] Wrote 386690 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:42] Wrote 386850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:42] Using BAM RG (Read Group) ID: SAL_HB2237AA_AS.out
[08:26:42] Creating extra output files: BED GFF CSV TXT HTML
[08:26:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:42] Using BAM RG (Read Group) ID: SAL_GB5373AA_AS.out
[08:26:42] Identified 127 variants.
[08:26:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[08:26:42] Result files:
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.aligned.fa
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam.bai
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bed
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.fa
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.subs.fa
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.csv
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.filt.vcf
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.gff
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.html
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.log
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.raw.vcf
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.subs.vcf
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.tab
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.txt
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz
[08:26:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz.csi
[08:26:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:42] Walltime used: 18 seconds
[08:26:42] Questionable SNP? Try the --report option to see the alignments.
[08:26:42] Done.
[Tue Jun 16 08:26:42 2020]
Finished job 28.
101 of 206 steps (49%) done

[Tue Jun 16 08:26:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
    jobid: 131
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7947AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[08:26:42] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:42] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.759 sec; CPU: 21.805 sec
[samclip] Total SAM records 386760, removed 436, allowed 46, passed 386324
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 13
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:43] This is snippy 4.4.3
[08:26:43] Written by Torsten Seemann
[08:26:43] Obtained from https://github.com/tseemann/snippy
[08:26:43] Detected operating system: linux
[08:26:43] Enabling bundled linux tools.
[08:26:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:43] Found gzip - /usr/bin/gzip
[08:26:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:43] Treating reference as 'fasta' format.
[08:26:43] Will use 8 CPU cores.
[08:26:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[08:26:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[08:26:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[08:26:43] Creating reference folder: reference
[08:26:43] Extracting FASTA and GFF from reference.
[08:26:43] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:44] Wrote 3 sequences to ref.fa
[08:26:44] Wrote 0 features to ref.gff
[08:26:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:44] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:26:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320062 sequences (80000134 bp)...
[M::process] read 320072 sequences (80000370 bp)...
[08:26:45] Running: samtools index snps.bam 2>> snps.log
[08:26:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 66628 sequences (16657000 bp)...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 53
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 66778 sequences (16694500 bp)...
[08:26:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:45] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:46] Wrote 386696 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:46] Using BAM RG (Read Group) ID: SAL_BB7947AA_AS.out
[08:26:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:46] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320062 reads in 18.161 CPU sec, 2.516 real sec
[M::mem_process_seqs] Processed 320072 reads in 18.803 CPU sec, 2.582 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66628 reads in 3.942 CPU sec, 0.456 real sec
[samclip] Processed 200000 records...
[08:26:48] Marked 0 heterozygous sites with 'n'
[08:26:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 66778 reads in 4.189 CPU sec, 0.492 real sec

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:48] Creating extra output files: BED GFF CSV TXT HTML
[08:26:48] Identified 126 variants.
[08:26:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[08:26:48] Result files:
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.aligned.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam.bai
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bed
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.subs.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.csv
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.filt.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.gff
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.html
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.log
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.raw.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.subs.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.tab
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.txt
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz.csi
[08:26:48] Walltime used: 19 seconds
[08:26:48] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:26:48] Done.
[Tue Jun 16 08:26:48 2020]
Finished job 9.
102 of 206 steps (50%) done

[Tue Jun 16 08:26:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
    jobid: 2
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5376AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:26:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:48] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:48] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:48] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[08:26:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.926 sec; CPU: 22.681 sec
[samclip] Total SAM records 386963, removed 1362, allowed 123, passed 385601
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:48] Marked 0 heterozygous sites with 'n'
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.074 sec; CPU: 23.585 sec
[samclip] Total SAM records 387159, removed 1332, allowed 117, passed 385827
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:48] Creating extra output files: BED GFF CSV TXT HTML
[08:26:48] Identified 17 variants.
[08:26:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[08:26:48] Result files:
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.aligned.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam.bai
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bed
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.subs.fa
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.csv
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.filt.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.gff
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.html
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.log
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.raw.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.subs.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.tab
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.txt
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz
[08:26:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz.csi
[08:26:48] Walltime used: 18 seconds
[08:26:48] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:26:48] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Tue Jun 16 08:26:48 2020]
Finished job 7.
103 of 206 steps (50%) done

[Tue Jun 16 08:26:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
    jobid: 5
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB6160AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320154 sequences (80000082 bp)...
[M::process] read 66542 sequences (16623902 bp)...
[08:26:49] This is snippy 4.4.3
[08:26:49] Written by Torsten Seemann
[08:26:49] Obtained from https://github.com/tseemann/snippy
[08:26:49] Detected operating system: linux
[08:26:49] Enabling bundled linux tools.
[08:26:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:49] Found gzip - /usr/bin/gzip
[08:26:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:49] Treating reference as 'fasta' format.
[08:26:49] Will use 8 CPU cores.
[08:26:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[08:26:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[08:26:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[08:26:49] Creating reference folder: reference
[08:26:49] Extracting FASTA and GFF from reference.
[08:26:49] Wrote 3 sequences to ref.fa
[08:26:49] Wrote 0 features to ref.gff
[08:26:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta into pseudo-reads
[08:26:49] This is snippy 4.4.3
[08:26:49] Written by Torsten Seemann
[08:26:49] Obtained from https://github.com/tseemann/snippy
[08:26:49] Detected operating system: linux
[08:26:49] Enabling bundled linux tools.
[08:26:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:49] Found gzip - /usr/bin/gzip
[08:26:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:49] Marked 4 heterozygous sites with 'n'
[08:26:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:49] Creating extra output files: BED GFF CSV TXT HTML
[08:26:49] Identified 53 variants.
[08:26:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[08:26:49] Result files:
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.aligned.fa
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam.bai
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bed
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.fa
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.subs.fa
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.csv
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.filt.vcf
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.gff
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.html
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.log
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.raw.vcf
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.subs.vcf
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.tab
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.txt
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz
[08:26:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz.csi
[08:26:49] Walltime used: 19 seconds
[08:26:49] Wishing you a life free of homopolymer errors.
[08:26:49] Done.
[Tue Jun 16 08:26:49 2020]
Finished job 37.
104 of 206 steps (50%) done

[Tue Jun 16 08:26:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
    jobid: 87
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB6580AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
[08:26:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:49] Treating reference as 'fasta' format.
[08:26:49] Will use 8 CPU cores.
[08:26:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
[08:26:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[08:26:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[08:26:49] Creating reference folder: reference
[08:26:49] Extracting FASTA and GFF from reference.
[08:26:49] Wrote 3 sequences to ref.fa
[08:26:49] Wrote 0 features to ref.gff
[08:26:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:50] This is snippy 4.4.3
[08:26:50] Written by Torsten Seemann
[08:26:50] Obtained from https://github.com/tseemann/snippy
[08:26:50] Detected operating system: linux
[08:26:50] Enabling bundled linux tools.
[08:26:50] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:50] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:50] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:50] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:50] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:50] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:50] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:50] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:50] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:50] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:50] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:50] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:50] Found gzip - /usr/bin/gzip
[08:26:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:50] Running: samtools index snps.bam 2>> snps.log
[08:26:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:50] Treating reference as 'fasta' format.
[08:26:50] Will use 8 CPU cores.
[08:26:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
[08:26:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[08:26:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[08:26:50] Creating reference folder: reference
[08:26:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:50] Extracting FASTA and GFF from reference.
[08:26:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:26:50] Running: samtools index snps.bam 2>> snps.log
[08:26:50] Wrote 3 sequences to ref.fa
[08:26:50] Wrote 0 features to ref.gff
[08:26:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta into pseudo-reads
[08:26:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:26:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320154 reads in 17.147 CPU sec, 2.302 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66542 reads in 3.945 CPU sec, 0.484 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:26:52] Wrote 386032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:52] Using BAM RG (Read Group) ID: SAL_CB5376AA_AS.out
[08:26:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.737 sec; CPU: 21.651 sec
[samclip] Total SAM records 386970, removed 1115, allowed 55, passed 385855
[samclip] Header contained 5 lines
[samclip] Done.
[08:26:52] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:52] Wrote 386002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:52] Using BAM RG (Read Group) ID: SAL_AB6160AA_AS.out
[08:26:52] Marked 0 heterozygous sites with 'n'
[08:26:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:52] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:52] Creating extra output files: BED GFF CSV TXT HTML
[08:26:52] Identified 20 variants.
[08:26:52] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[08:26:52] Result files:
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.aligned.fa
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam.bai
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bed
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.fa
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.subs.fa
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.csv
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.filt.vcf
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.gff
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.html
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.log
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.raw.vcf
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.subs.vcf
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.tab
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.txt
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz
[08:26:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz.csi
[08:26:52] Walltime used: 18 seconds
[08:26:52] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:26:52] Done.
[Tue Jun 16 08:26:52 2020]
Finished job 171.
105 of 206 steps (51%) done

[Tue Jun 16 08:26:52 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
    jobid: 173
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA6324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:53] Wrote 386996 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:53] Using BAM RG (Read Group) ID: SAL_JB6580AA_AS.out
[08:26:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:53] Running: bwa index reference/ref.fa 2>> snps.log
[08:26:53] This is snippy 4.4.3
[08:26:53] Written by Torsten Seemann
[08:26:53] Obtained from https://github.com/tseemann/snippy
[08:26:53] Detected operating system: linux
[08:26:53] Enabling bundled linux tools.
[08:26:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:53] Found gzip - /usr/bin/gzip
[08:26:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 816
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:26:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:53] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:53] Treating reference as 'fasta' format.
[08:26:53] Will use 8 CPU cores.
[08:26:53] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
[08:26:53] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[08:26:53] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[08:26:53] Creating reference folder: reference
[08:26:53] Extracting FASTA and GFF from reference.
[08:26:54] Wrote 3 sequences to ref.fa
[08:26:54] Wrote 0 features to ref.gff
[08:26:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta into pseudo-reads
[08:26:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:26:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 818
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:26:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:26:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:26:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:54] Running: samtools index snps.bam 2>> snps.log
[08:26:54] Running: rm -f fake_reads\.fq 2>> snps.log
[08:26:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:26:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:26:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:26:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:26:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:26:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:26:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:54] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320006 sequences (80000324 bp)...
[M::process] read 66026 sequences (16506500 bp)...
[08:26:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320006 sequences (80000340 bp)...
[M::process] read 65996 sequences (16499000 bp)...
[08:26:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:26:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 66996 sequences (16687816 bp)...
[08:26:56] Wrote 389494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:26:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:26:56] Using BAM RG (Read Group) ID: SAL_TA6324AA_AS.out
[08:26:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:26:56] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320006 reads in 17.502 CPU sec, 2.520 real sec
[M::mem_process_seqs] Processed 320006 reads in 16.602 CPU sec, 2.523 real sec
[samclip] Processed 100000 records...
[08:26:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 160
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:26:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:26:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 66026 reads in 3.865 CPU sec, 0.454 real sec
[08:26:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[08:26:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:26:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:26:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:26:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:26:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:26:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 65996 reads in 3.962 CPU sec, 0.464 real sec
[08:26:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:26:57] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:26:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.651 CPU sec, 2.462 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.953 sec; CPU: 21.949 sec
[samclip] Total SAM records 386389, removed 1059, allowed 97, passed 385330
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out[samclip] Total SAM records 386357, removed 1270, allowed 143, passed 385087
 -t 8 reference/ref.fa[samclip] Header contained 5 lines
 fake_reads.fq[samclip] Done.

[main] Real time: 3.971 sec; CPU: 21.157 sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:58] Marked 0 heterozygous sites with 'n'
[08:26:58] Creating extra output files: BED GFF CSV TXT HTML
[08:26:58] Identified 816 variants.
[08:26:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[08:26:58] Result files:
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.aligned.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam.bai
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bed
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.subs.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.csv
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.filt.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.gff
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.html
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.log
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.raw.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.subs.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.tab
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.txt
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz.csi
[08:26:58] Walltime used: 19 seconds
[08:26:58] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:26:58] Done.
[Tue Jun 16 08:26:58 2020]
Finished job 107.
106 of 206 steps (51%) done

[Tue Jun 16 08:26:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
    jobid: 195
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA4237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[08:26:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 66996 reads in 4.027 CPU sec, 0.460 real sec
[08:26:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:26:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:26:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:26:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 200000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:26:58] Marked 0 heterozygous sites with 'n'
[08:26:58] Creating extra output files: BED GFF CSV TXT HTML
[08:26:58] Identified 818 variants.
[08:26:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[08:26:58] Result files:
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.aligned.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam.bai
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bed
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.subs.fa
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.csv
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.filt.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.gff
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.html
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.log
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.raw.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.subs.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.tab
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.txt
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz
[08:26:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz.csi
[08:26:58] Walltime used: 19 seconds
[08:26:58] Wishing you a life free of homopolymer errors.
[08:26:58] Done.
[Tue Jun 16 08:26:58 2020]
Finished job 183.
107 of 206 steps (52%) done

[Tue Jun 16 08:26:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
    jobid: 41
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB9302AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
[samclip] Processed 300000 records...
[M::process] read 320064 sequences (80000266 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 69430 sequences (17349116 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.867 sec; CPU: 22.264 sec
[samclip] Total SAM records 387265, removed 654, allowed 75, passed 386611
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:59] This is snippy 4.4.3
[08:26:59] Written by Torsten Seemann
[08:26:59] Obtained from https://github.com/tseemann/snippy
[08:26:59] Detected operating system: linux
[08:26:59] Enabling bundled linux tools.
[08:26:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:59] Found gzip - /usr/bin/gzip
[08:26:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:26:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:26:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:59] Treating reference as 'fasta' format.
[08:26:59] Will use 8 CPU cores.
[08:26:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[08:26:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[08:26:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[08:26:59] Creating reference folder: reference
[08:26:59] Extracting FASTA and GFF from reference.
[08:26:59] This is snippy 4.4.3
[08:26:59] Written by Torsten Seemann
[08:26:59] Obtained from https://github.com/tseemann/snippy
[08:26:59] Detected operating system: linux
[08:26:59] Enabling bundled linux tools.
[08:26:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:26:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:26:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:26:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:26:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:26:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:26:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:26:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:26:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:26:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:26:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:26:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:26:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:26:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:26:59] Found gzip - /usr/bin/gzip
[08:26:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:26:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:26:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:26:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:26:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:26:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:26:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:26:59] Wrote 3 sequences to ref.fa
[08:26:59] Wrote 0 features to ref.gff
[08:26:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta into pseudo-reads
[08:26:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:26:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:26:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:26:59] Treating reference as 'fasta' format.
[08:26:59] Will use 8 CPU cores.
[08:26:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
[08:26:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[08:26:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[08:26:59] Creating reference folder: reference
[08:26:59] Extracting FASTA and GFF from reference.
[08:26:59] Wrote 3 sequences to ref.fa
[08:26:59] Wrote 0 features to ref.gff
[08:26:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta into pseudo-reads
[08:27:00] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:00] Running: samtools index snps.bam 2>> snps.log
[08:27:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:01] Running: samtools index snps.bam 2>> snps.log
[08:27:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320064 reads in 18.642 CPU sec, 2.547 real sec
[08:27:02] Marked 1 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69430 reads in 4.370 CPU sec, 0.545 real sec
[08:27:02] Creating extra output files: BED GFF CSV TXT HTML
[08:27:02] Identified 160 variants.
[08:27:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[08:27:02] Result files:
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.aligned.fa
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam.bai
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bed
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.fa
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.subs.fa
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.csv
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.filt.vcf
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.gff
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.html
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.log
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.raw.vcf
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.subs.vcf
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.tab
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.txt
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz
[08:27:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz.csi
[08:27:02] Walltime used: 19 seconds
[08:27:02] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:27:02] Done.
[Tue Jun 16 08:27:02 2020]
Finished job 131.
108 of 206 steps (52%) done

[Tue Jun 16 08:27:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
    jobid: 149
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB1026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
[samclip] Processed 200000 records...
[08:27:02] Wrote 389584 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:02] Using BAM RG (Read Group) ID: SAL_UA4237AA_AS.out
[08:27:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:02] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:27:02] Wrote 386730 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:02] Using BAM RG (Read Group) ID: SAL_IB9302AA_AS.out
[08:27:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:02] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.296 sec; CPU: 23.649 sec
[samclip] Total SAM records 389663, removed 1036, allowed 184, passed 388627
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:03] This is snippy 4.4.3
[08:27:03] Written by Torsten Seemann
[08:27:03] Obtained from https://github.com/tseemann/snippy
[08:27:03] Detected operating system: linux
[08:27:03] Enabling bundled linux tools.
[08:27:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:03] Found gzip - /usr/bin/gzip
[08:27:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:27:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 123
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:03] Treating reference as 'fasta' format.
[08:27:03] Will use 8 CPU cores.
[08:27:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
[08:27:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[08:27:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[08:27:03] Creating reference folder: reference
[08:27:03] Extracting FASTA and GFF from reference.
[08:27:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:03] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:03] Wrote 3 sequences to ref.fa
[08:27:03] Wrote 0 features to ref.gff
[08:27:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta into pseudo-reads
[08:27:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:03] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:04] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320106 sequences (80000138 bp)...
[08:27:04] Running: samtools index snps.bam 2>> snps.log
[M::process] read 69478 sequences (17359898 bp)...
[08:27:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320082 sequences (80000060 bp)...
[M::process] read 66648 sequences (16662000 bp)...
[08:27:06] Wrote 386242 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:06] Using BAM RG (Read Group) ID: SAL_EB1026AA_AS.out
[08:27:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:06] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320106 reads in 18.945 CPU sec, 2.552 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320082 reads in 18.106 CPU sec, 2.533 real sec
[08:27:07] Marked 0 heterozygous sites with 'n'
[08:27:07] Creating extra output files: BED GFF CSV TXT HTML
[08:27:07] Identified 25 variants.
[08:27:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[08:27:07] Result files:
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.aligned.fa
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam.bai
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bed
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.fa
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.subs.fa
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.csv
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.filt.vcf
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.gff
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.html
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.log
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.raw.vcf
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.subs.vcf
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.tab
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.txt
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz
[08:27:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz.csi
[08:27:07] Walltime used: 18 seconds
[08:27:07] May the SNPs be with you.
[08:27:07] Done.
[Tue Jun 16 08:27:07 2020]
Finished job 2.
109 of 206 steps (53%) done

[Tue Jun 16 08:27:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
    jobid: 178
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OA4067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[M::mem_process_seqs] Processed 69478 reads in 4.305 CPU sec, 0.499 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[08:27:08] Marked 0 heterozygous sites with 'n'
[08:27:08] Creating extra output files: BED GFF CSV TXT HTML
[08:27:08] Identified 123 variants.
[08:27:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[08:27:08] Result files:
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.aligned.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam.bai
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bed
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.subs.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.csv
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.filt.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.gff
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.html
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.log
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.raw.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.subs.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.tab
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.txt
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz.csi
[08:27:08] Walltime used: 19 seconds
[08:27:08] May the SNPs be with you.
[08:27:08] Done.
[Tue Jun 16 08:27:08 2020]
Finished job 5.
110 of 206 steps (53%) done

[Tue Jun 16 08:27:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
    jobid: 60
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7261AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[08:27:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 66648 reads in 4.333 CPU sec, 0.502 real sec
[samclip] Processed 300000 records...
[08:27:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 200000 records...
[08:27:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 1806
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.938 sec; CPU: 23.785 sec
[samclip] Total SAM records 389774, removed 1167, allowed 287, passed 388607
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:08] This is snippy 4.4.3
[08:27:08] Written by Torsten Seemann
[08:27:08] Obtained from https://github.com/tseemann/snippy
[08:27:08] Detected operating system: linux
[08:27:08] Enabling bundled linux tools.
[samclip] Processed 300000 records...
[08:27:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:08] Found gzip - /usr/bin/gzip
[08:27:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320070 sequences (80000452 bp)...
[08:27:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 66172 sequences (16527628 bp)...
[08:27:08] Marked 0 heterozygous sites with 'n'
[08:27:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:08] Treating reference as 'fasta' format.
[08:27:08] Will use 8 CPU cores.
[08:27:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[08:27:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[08:27:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[08:27:08] Creating reference folder: reference
[08:27:08] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.927 sec; CPU: 22.990 sec
[samclip] Total SAM records 387142, removed 1082, allowed 126, passed 386060
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:08] Creating extra output files: BED GFF CSV TXT HTML
[08:27:08] Identified 16 variants.
[08:27:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[08:27:08] Result files:
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.aligned.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam.bai
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bed
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.subs.fa
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.csv
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.filt.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.gff
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.html
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.log
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.raw.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.subs.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.tab
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.txt
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz
[08:27:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz.csi
[08:27:08] Walltime used: 18 seconds
[08:27:08] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:27:08] Done.
[Tue Jun 16 08:27:08 2020]
Finished job 87.
111 of 206 steps (54%) done
[08:27:08] This is snippy 4.4.3
[08:27:08] Written by Torsten Seemann
[08:27:08] Obtained from https://github.com/tseemann/snippy
[08:27:08] Detected operating system: linux
[08:27:08] Enabling bundled linux tools.

[Tue Jun 16 08:27:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
    jobid: 79
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9820AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
[08:27:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:08] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:08] Found gzip - /usr/bin/gzip
[08:27:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:08] Wrote 3 sequences to ref.fa
[08:27:08] Wrote 0 features to ref.gff
[08:27:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta into pseudo-reads
[08:27:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:09] Treating reference as 'fasta' format.
[08:27:09] Will use 8 CPU cores.
[08:27:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[08:27:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[08:27:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[08:27:09] Creating reference folder: reference
[08:27:09] Extracting FASTA and GFF from reference.
[08:27:09] Wrote 3 sequences to ref.fa
[08:27:09] Wrote 0 features to ref.gff
[08:27:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:09] This is snippy 4.4.3
[08:27:09] Written by Torsten Seemann
[08:27:09] Obtained from https://github.com/tseemann/snippy
[08:27:09] Detected operating system: linux
[08:27:09] Enabling bundled linux tools.
[08:27:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:09] Found gzip - /usr/bin/gzip
[08:27:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:09] Treating reference as 'fasta' format.
[08:27:09] Will use 8 CPU cores.
[08:27:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
[08:27:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[08:27:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[08:27:09] Creating reference folder: reference
[08:27:09] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:09] Wrote 3 sequences to ref.fa
[08:27:09] Wrote 0 features to ref.gff
[08:27:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta into pseudo-reads
[08:27:10] Running: samtools index snps.bam 2>> snps.log
[08:27:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:10] Running: samtools index snps.bam 2>> snps.log
[08:27:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320070 reads in 17.585 CPU sec, 2.483 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66172 reads in 3.703 CPU sec, 0.449 real sec
[08:27:11] Wrote 390044 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:11] Using BAM RG (Read Group) ID: SAL_OA4067AA_AS.out
[samclip] Processed 200000 records...
[08:27:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:11] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:27:11] Wrote 386562 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:11] Using BAM RG (Read Group) ID: SAL_BB7261AA_AS.out
[08:27:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:12] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.955 sec; CPU: 21.893 sec
[samclip] Total SAM records 386598, removed 843, allowed 136, passed 385755
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:12] Wrote 385396 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:12] Using BAM RG (Read Group) ID: SAL_CB9820AA_AS.out
[08:27:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:12] Running: bwa index reference/ref.fa 2>> snps.log
[08:27:13] Marked 0 heterozygous sites with 'n'
[08:27:13] Creating extra output files: BED GFF CSV TXT HTML
[08:27:13] Identified 1806 variants.
[08:27:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[08:27:13] Result files:
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.aligned.fa
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam.bai
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bed
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.fa
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.subs.fa
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.csv
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.filt.vcf
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.gff
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.html
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.log
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.raw.vcf
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.subs.vcf
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.tab
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.txt
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz
[08:27:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz.csi
[08:27:13] Walltime used: 20 seconds
[08:27:13] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:27:13] Done.
[Tue Jun 16 08:27:13 2020]
Finished job 173.
112 of 206 steps (54%) done
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

[Tue Jun 16 08:27:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
    jobid: 114
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7634AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
[08:27:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:27:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1796
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:13] This is snippy 4.4.3
[08:27:13] Written by Torsten Seemann
[08:27:13] Obtained from https://github.com/tseemann/snippy
[08:27:13] Detected operating system: linux
[08:27:13] Enabling bundled linux tools.
[08:27:13] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:13] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:13] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:13] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:13] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:13] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:13] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::process] read 320132 sequences (80000202 bp)...
[08:27:13] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:13] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:13] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:13] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:14] Found gzip - /usr/bin/gzip
[08:27:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 69912 sequences (17453658 bp)...
[08:27:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320170 sequences (80000294 bp)...
[08:27:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:14] Running: samtools index snps.bam 2>> snps.log
[08:27:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:14] Treating reference as 'fasta' format.
[08:27:14] Will use 8 CPU cores.
[08:27:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
[08:27:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[08:27:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[08:27:14] Creating reference folder: reference
[08:27:14] Extracting FASTA and GFF from reference.
[08:27:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 66392 sequences (16598000 bp)...
[08:27:14] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:14] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:14] Wrote 3 sequences to ref.fa
[08:27:14] Wrote 0 features to ref.gff
[08:27:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta into pseudo-reads
[08:27:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:27:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65396 sequences (16349000 bp)...
[M::mem_process_seqs] Processed 320170 reads in 16.950 CPU sec, 2.620 real sec
[M::mem_process_seqs] Processed 320132 reads in 18.340 CPU sec, 2.922 real sec
[samclip] Processed 100000 records...
[08:27:17] Wrote 385520 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:17] Using BAM RG (Read Group) ID: SAL_AB7634AA_AS.out
[08:27:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:17] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66392 reads in 3.869 CPU sec, 0.452 real sec
[08:27:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 16.951 CPU sec, 2.546 real sec
[M::mem_process_seqs] Processed 69912 reads in 4.497 CPU sec, 0.522 real sec
[samclip] Processed 200000 records...
[08:27:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:27:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:27:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:17] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[08:27:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 65396 reads in 4.042 CPU sec, 0.466 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.055 sec; CPU: 21.419 sec
[samclip] Total SAM records 386977, removed 1091, allowed 73, passed 385886
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.347 sec; CPU: 23.398 sec
[samclip] Total SAM records 390296, removed 893, allowed 191, passed 389403
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.938 sec; CPU: 21.563 sec
[samclip] Total SAM records 385665, removed 767, allowed 60, passed 384898
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:18] Marked 0 heterozygous sites with 'n'
[08:27:18] Creating extra output files: BED GFF CSV TXT HTML
[08:27:18] Identified 27 variants.
[08:27:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[08:27:18] Result files:
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.aligned.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam.bai
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bed
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.subs.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.csv
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.filt.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.gff
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.html
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.log
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.raw.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.subs.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.tab
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.txt
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz.csi
[08:27:18] Walltime used: 19 seconds
[08:27:18] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:27:18] Done.
[Tue Jun 16 08:27:18 2020]
Finished job 41.
113 of 206 steps (55%) done

[Tue Jun 16 08:27:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
    jobid: 184
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA6621AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
[08:27:18] Marked 0 heterozygous sites with 'n'
[08:27:18] Creating extra output files: BED GFF CSV TXT HTML
[08:27:18] Identified 1796 variants.
[08:27:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[08:27:18] Result files:
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.aligned.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam.bai
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bed
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.subs.fa
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.csv
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.filt.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.gff
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.html
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.log
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.raw.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.subs.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.tab
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.txt
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz
[08:27:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz.csi
[08:27:18] Walltime used: 19 seconds
[08:27:18] May the SNPs be with you.
[08:27:18] Done.
[Tue Jun 16 08:27:18 2020]
Finished job 195.
114 of 206 steps (55%) done

[Tue Jun 16 08:27:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
    jobid: 3
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7197AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:18] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:19] This is snippy 4.4.3
[08:27:19] Written by Torsten Seemann
[08:27:19] Obtained from https://github.com/tseemann/snippy
[08:27:19] Detected operating system: linux
[08:27:19] Enabling bundled linux tools.
[08:27:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[M::process] read 320000 sequences (80000000 bp)...
[08:27:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:19] Found gzip - /usr/bin/gzip
[08:27:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 65520 sequences (16365686 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:19] This is snippy 4.4.3
[08:27:19] Written by Torsten Seemann
[08:27:19] Obtained from https://github.com/tseemann/snippy
[08:27:19] Detected operating system: linux
[08:27:19] Enabling bundled linux tools.
[08:27:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:19] Found gzip - /usr/bin/gzip
[08:27:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:19] Treating reference as 'fasta' format.
[08:27:19] Will use 8 CPU cores.
[08:27:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
[08:27:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[08:27:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[08:27:19] Creating reference folder: reference
[08:27:19] Extracting FASTA and GFF from reference.
[08:27:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:19] Treating reference as 'fasta' format.
[08:27:19] Will use 8 CPU cores.
[08:27:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[08:27:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[08:27:19] Wrote 3 sequences to ref.fa
[08:27:19] Wrote 0 features to ref.gff
[08:27:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta into pseudo-reads
[08:27:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[08:27:19] Creating reference folder: reference
[08:27:19] Extracting FASTA and GFF from reference.
[08:27:19] Running: samtools index snps.bam 2>> snps.log
[08:27:19] Wrote 3 sequences to ref.fa
[08:27:19] Wrote 0 features to ref.gff
[08:27:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta into pseudo-reads
[08:27:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:19] Running: samtools index snps.bam 2>> snps.log
[08:27:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:20] Running: samtools index snps.bam 2>> snps.log
[08:27:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:21] Marked 0 heterozygous sites with 'n'
[08:27:22] Creating extra output files: BED GFF CSV TXT HTML
[08:27:22] Identified 12 variants.
[08:27:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[08:27:22] Result files:
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.aligned.fa
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam.bai
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bed
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.fa
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.subs.fa
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.csv
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.filt.vcf
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.gff
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.html
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.log
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.raw.vcf
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.subs.vcf
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.tab
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.txt
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz
[08:27:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz.csi
[08:27:22] Walltime used: 19 seconds
[08:27:22] May the SNPs be with you.
[08:27:22] Done.
[Tue Jun 16 08:27:22 2020]
Finished job 149.
115 of 206 steps (56%) done

[Tue Jun 16 08:27:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
    jobid: 66
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EA3229AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 17.574 CPU sec, 2.764 real sec
[samclip] Processed 100000 records...
[08:27:22] Wrote 389570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::mem_process_seqs] Processed 65520 reads in 3.995 CPU sec, 0.462 real sec
[08:27:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:22] Using BAM RG (Read Group) ID: SAL_UA6621AA_AS.out
[08:27:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:22] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:23] Wrote 386790 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:23] Using BAM RG (Read Group) ID: SAL_BB7197AA_AS.out
[08:27:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:23] Running: bwa index reference/ref.fa 2>> snps.log
[08:27:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:27:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:23] This is snippy 4.4.3
[08:27:23] Written by Torsten Seemann
[08:27:23] Obtained from https://github.com/tseemann/snippy
[08:27:23] Detected operating system: linux
[08:27:23] Enabling bundled linux tools.
[08:27:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.163 sec; CPU: 22.146 sec
[samclip] Total SAM records 385694, removed 562, allowed 45, passed 385132
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:23] Found gzip - /usr/bin/gzip
[08:27:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:23] Treating reference as 'fasta' format.
[08:27:23] Will use 8 CPU cores.
[08:27:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[08:27:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[08:27:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[08:27:23] Creating reference folder: reference
[08:27:23] Extracting FASTA and GFF from reference.
[08:27:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:23] Wrote 3 sequences to ref.fa
[08:27:23] Wrote 0 features to ref.gff
[08:27:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta into pseudo-reads
[08:27:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320054 sequences (80000000 bp)...
[M::process] read 69516 sequences (17369250 bp)...
[08:27:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:25] Running: samtools index snps.bam 2>> snps.log
[08:27:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320016 sequences (80000308 bp)...
[M::process] read 66774 sequences (16651596 bp)...
[08:27:26] Wrote 389758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:26] Using BAM RG (Read Group) ID: SAL_EA3229AA_AS.out
[08:27:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:26] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320054 reads in 18.048 CPU sec, 2.382 real sec
[samclip] Processed 100000 records...
[08:27:27] Marked 1 heterozygous sites with 'n'
[08:27:27] Creating extra output files: BED GFF CSV TXT HTML
[08:27:27] Identified 19 variants.
[08:27:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[08:27:27] Result files:
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.aligned.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam.bai
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bed
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.subs.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.csv
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.filt.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.gff
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.html
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.log
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.raw.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.subs.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.tab
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.txt
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz.csi
[08:27:27] Walltime used: 19 seconds
[08:27:27] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:27:27] Done.
[Tue Jun 16 08:27:27 2020]
Finished job 60.
116 of 206 steps (56%) done

[Tue Jun 16 08:27:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
    jobid: 130
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA9926AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
[08:27:27] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[08:27:27] Creating extra output files: BED GFF CSV TXT HTML
[08:27:27] Identified 18 variants.
[08:27:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[08:27:27] Result files:
[M::mem_process_seqs] Processed 69516 reads in 4.907 CPU sec, 0.572 real sec
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.aligned.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam.bai
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bed
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.subs.fa
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.csv
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.filt.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.gff
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.html
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.log
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.raw.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.subs.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.tab
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.txt
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz
[08:27:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz.csi
[08:27:27] Walltime used: 19 seconds
[08:27:27] Wishing you a life free of homopolymer errors.
[08:27:27] Done.
[Tue Jun 16 08:27:27 2020]
Finished job 178.
117 of 206 steps (57%) done

[Tue Jun 16 08:27:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
    jobid: 99
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OA4072AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[M::mem_process_seqs] Processed 320016 reads in 17.684 CPU sec, 2.469 real sec
[samclip] Processed 300000 records...
[08:27:27] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:28] Creating extra output files: BED GFF CSV TXT HTML
[08:27:28] Identified 22 variants.
[08:27:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[08:27:28] Result files:
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.aligned.fa
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam.bai
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bed
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.fa
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.subs.fa
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.csv
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.filt.vcf
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.gff
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.html
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.log
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.raw.vcf
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.subs.vcf
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.tab
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.txt
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz
[08:27:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz.csi
[08:27:28] Walltime used: 19 seconds
[08:27:28] Wishing you a life free of homopolymer errors.
[08:27:28] Done.
[08:27:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 100000 records...
[08:27:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[Tue Jun 16 08:27:28 2020]
Finished job 79.
118 of 206 steps (57%) done

[Tue Jun 16 08:27:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
    jobid: 164
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PB8418AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[08:27:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.774 sec; CPU: 23.479 sec
[samclip] Total SAM records 389757, removed 1287, allowed 188, passed 388470
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:28] This is snippy 4.4.3
[08:27:28] Written by Torsten Seemann
[08:27:28] Obtained from https://github.com/tseemann/snippy
[08:27:28] Detected operating system: linux
[08:27:28] Enabling bundled linux tools.
[08:27:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:28] Found gzip - /usr/bin/gzip
[08:27:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::mem_process_seqs] Processed 66774 reads in 3.983 CPU sec, 0.462 real sec
[08:27:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[08:27:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:28] This is snippy 4.4.3
[08:27:28] Written by Torsten Seemann
[08:27:28] Obtained from https://github.com/tseemann/snippy
[08:27:28] Detected operating system: linux
[08:27:28] Enabling bundled linux tools.
[08:27:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::process] read 320092 sequences (80000166 bp)...
[08:27:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:28] Treating reference as 'fasta' format.
[08:27:28] Will use 8 CPU cores.
[08:27:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
[08:27:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[08:27:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[08:27:28] Creating reference folder: reference
[08:27:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:28] Extracting FASTA and GFF from reference.
[08:27:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:28] Found gzip - /usr/bin/gzip
[08:27:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 69666 sequences (17412620 bp)...
[08:27:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:28] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[08:27:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:28] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:28] Wrote 3 sequences to ref.fa
[08:27:28] Wrote 0 features to ref.gff
[08:27:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta into pseudo-reads
[08:27:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:28] Treating reference as 'fasta' format.
[08:27:28] Will use 8 CPU cores.
[08:27:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[08:27:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[08:27:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[08:27:28] Creating reference folder: reference
[08:27:28] Extracting FASTA and GFF from reference.
[08:27:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:28] This is snippy 4.4.3
[08:27:28] Written by Torsten Seemann
[08:27:28] Obtained from https://github.com/tseemann/snippy
[08:27:28] Detected operating system: linux
[08:27:28] Enabling bundled linux tools.
[08:27:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:28] Found gzip - /usr/bin/gzip
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.849 sec; CPU: 22.221 sec
[samclip] Total SAM records 387008, removed 613, allowed 54, passed 386395
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:28] Wrote 3 sequences to ref.fa
[08:27:28] Wrote 0 features to ref.gff
[08:27:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta into pseudo-reads
[08:27:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:29] Treating reference as 'fasta' format.
[08:27:29] Will use 8 CPU cores.
[08:27:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[08:27:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[08:27:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[08:27:29] Creating reference folder: reference
[08:27:29] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:29] Wrote 3 sequences to ref.fa
[08:27:29] Wrote 0 features to ref.gff
[08:27:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:30] Running: samtools index snps.bam 2>> snps.log
[08:27:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:30] Running: samtools index snps.bam 2>> snps.log
[08:27:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320092 reads in 18.842 CPU sec, 2.599 real sec
[samclip] Processed 100000 records...
[08:27:31] Wrote 389852 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:31] Using BAM RG (Read Group) ID: SAL_WA9926AA_AS.out
[08:27:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:31] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69666 reads in 4.723 CPU sec, 0.543 real sec
[08:27:31] Wrote 390014 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:31] Using BAM RG (Read Group) ID: SAL_OA4072AA_AS.out
[08:27:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:31] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[08:27:31] Wrote 385894 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:31] Using BAM RG (Read Group) ID: SAL_PB8418AA_AS.out
[08:27:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:31] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.028 sec; CPU: 24.112 sec
[samclip] Total SAM records 389981, removed 1621, allowed 403, passed 388360
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:32] Marked 0 heterozygous sites with 'n'
[08:27:32] Creating extra output files: BED GFF CSV TXT HTML
[08:27:32] Identified 16 variants.
[08:27:32] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[08:27:32] Result files:
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.aligned.fa
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam.bai
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bed
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.fa
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.subs.fa
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.csv
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.filt.vcf
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.gff
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.html
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.log
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.raw.vcf
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.subs.vcf
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.tab
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.txt
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz
[08:27:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz.csi
[08:27:32] Walltime used: 19 seconds
[08:27:32] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:27:32] Done.
[Tue Jun 16 08:27:32 2020]
Finished job 114.
119 of 206 steps (58%) done

[Tue Jun 16 08:27:32 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
    jobid: 179
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2372AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1801
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 320172 sequences (80000152 bp)...
[08:27:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69680 sequences (17397876 bp)...
[08:27:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:33] This is snippy 4.4.3
[08:27:33] Written by Torsten Seemann
[08:27:33] Obtained from https://github.com/tseemann/snippy
[08:27:33] Detected operating system: linux
[08:27:33] Enabling bundled linux tools.
[08:27:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:27:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:27:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:33] Found gzip - /usr/bin/gzip
[08:27:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:27:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:27:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:34] Treating reference as 'fasta' format.
[08:27:34] Will use 8 CPU cores.
[08:27:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[08:27:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[08:27:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[08:27:34] Creating reference folder: reference
[08:27:34] Extracting FASTA and GFF from reference.
[08:27:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:34] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:34] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320208 sequences (80000248 bp)...
[08:27:34] Wrote 3 sequences to ref.fa
[08:27:34] Wrote 0 features to ref.gff
[08:27:34] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta into pseudo-reads
[08:27:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 69806 sequences (17445592 bp)...
[08:27:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320000 sequences (80000000 bp)...
[08:27:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 65894 sequences (16464040 bp)...
[08:27:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:34] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320172 reads in 17.910 CPU sec, 2.691 real sec
[M::mem_process_seqs] Processed 320208 reads in 16.766 CPU sec, 2.328 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69680 reads in 4.197 CPU sec, 0.490 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 18.171 CPU sec, 2.630 real sec
[08:27:36] Wrote 386116 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:36] Using BAM RG (Read Group) ID: SAL_CB2372AA_AS.out
[08:27:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:36] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 69806 reads in 4.332 CPU sec, 0.509 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.169 sec; CPU: 22.683 sec
[samclip] Total SAM records 390278, removed 1126, allowed 137, passed 389152
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 65894 reads in 4.539 CPU sec, 0.523 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.822 sec; CPU: 21.677 sec
[samclip] Total SAM records 390269, removed 1087, allowed 146, passed 389182
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1918
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.025 sec; CPU: 23.262 sec
[samclip] Total SAM records 386153, removed 1352, allowed 154, passed 384801
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:38] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:38] Marked 0 heterozygous sites with 'n'
[08:27:38] Creating extra output files: BED GFF CSV TXT HTML
[08:27:38] Identified 1801 variants.
[08:27:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[08:27:38] Result files:
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.aligned.fa
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam.bai
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bed
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.fa
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.subs.fa
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.csv
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.filt.vcf
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.gff
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.html
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.log
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.raw.vcf
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.subs.vcf
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.tab
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.txt
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz
[08:27:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz.csi
[08:27:38] Walltime used: 19 seconds
[08:27:38] Wishing you a life free of homopolymer errors.
[08:27:38] Done.
[Tue Jun 16 08:27:38 2020]
Finished job 184.
120 of 206 steps (58%) done

[Tue Jun 16 08:27:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
    jobid: 194
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB8135AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:38] Marked 0 heterozygous sites with 'n'
[08:27:39] Creating extra output files: BED GFF CSV TXT HTML
[08:27:39] Identified 24 variants.
[08:27:39] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[08:27:39] Result files:
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.aligned.fa
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam.bai
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bed
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.fa
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.subs.fa
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.csv
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.filt.vcf
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.gff
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.html
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.log
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.raw.vcf
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.subs.vcf
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.tab
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.txt
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz
[08:27:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz.csi
[08:27:39] Walltime used: 20 seconds
[08:27:39] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:27:39] Done.
[Tue Jun 16 08:27:39 2020]
Finished job 3.
121 of 206 steps (59%) done

[Tue Jun 16 08:27:39 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
    jobid: 12
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1136AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 66116 sequences (16515168 bp)...
[08:27:39] This is snippy 4.4.3
[08:27:39] Written by Torsten Seemann
[08:27:39] Obtained from https://github.com/tseemann/snippy
[08:27:39] Detected operating system: linux
[08:27:39] Enabling bundled linux tools.
[08:27:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:39] Found gzip - /usr/bin/gzip
[08:27:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:39] Running: samtools index snps.bam 2>> snps.log
[08:27:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:39] Treating reference as 'fasta' format.
[08:27:39] Will use 8 CPU cores.
[08:27:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[08:27:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[08:27:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[08:27:39] Creating reference folder: reference
[08:27:39] Extracting FASTA and GFF from reference.
[08:27:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:39] Running: samtools index snps.bam 2>> snps.log
[08:27:39] Wrote 3 sequences to ref.fa
[08:27:39] Wrote 0 features to ref.gff
[08:27:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta into pseudo-reads
[08:27:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:39] This is snippy 4.4.3
[08:27:39] Written by Torsten Seemann
[08:27:39] Obtained from https://github.com/tseemann/snippy
[08:27:39] Detected operating system: linux
[08:27:39] Enabling bundled linux tools.
[08:27:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:39] Found gzip - /usr/bin/gzip
[08:27:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:39] Running: samtools index snps.bam 2>> snps.log
[08:27:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:39] Treating reference as 'fasta' format.
[08:27:39] Will use 8 CPU cores.
[08:27:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
[08:27:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[08:27:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[08:27:39] Creating reference folder: reference
[08:27:39] Extracting FASTA and GFF from reference.
[08:27:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:40] Wrote 3 sequences to ref.fa
[08:27:40] Wrote 0 features to ref.gff
[08:27:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320000 reads in 16.712 CPU sec, 2.375 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66116 reads in 4.059 CPU sec, 0.483 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:27:42] Wrote 385784 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:42] Using BAM RG (Read Group) ID: SAL_BB8135AA_AS.out
[08:27:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:42] Running: bwa index reference/ref.fa 2>> snps.log
[08:27:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.795 sec; CPU: 21.320 sec
[samclip] Total SAM records 386460, removed 948, allowed 111, passed 385512
[samclip] Header contained 5 lines
[samclip] Done.

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:42] Marked 0 heterozygous sites with 'n'
[08:27:42] Creating extra output files: BED GFF CSV TXT HTML
[08:27:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:27:42] Identified 1918 variants.
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:27:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[08:27:42] Result files:
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.aligned.fa
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam.bai
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bed
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.fa
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.subs.fa
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.csv
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.filt.vcf
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.gff
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.html
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.log
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.raw.vcf
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.subs.vcf
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.tab
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.txt
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz
[08:27:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz.csi
[08:27:42] Walltime used: 19 seconds
[08:27:42] Questionable SNP? Try the --report option to see the alignments.
[08:27:42] Done.
[08:27:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[Tue Jun 16 08:27:42 2020]
Finished job 66.
122 of 206 steps (59%) done

[Tue Jun 16 08:27:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
    jobid: 166
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7027AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[08:27:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:42] Wrote 385248 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:42] Using BAM RG (Read Group) ID: SAL_KB1136AA_AS.out
[08:27:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:42] Running: bwa index reference/ref.fa 2>> snps.log
[08:27:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:43] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:43] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:27:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:43] This is snippy 4.4.3
[08:27:43] Written by Torsten Seemann
[08:27:43] Obtained from https://github.com/tseemann/snippy
[08:27:43] Detected operating system: linux
[08:27:43] Enabling bundled linux tools.
[08:27:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:43] Found gzip - /usr/bin/gzip
[08:27:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:43] Treating reference as 'fasta' format.
[08:27:43] Will use 8 CPU cores.
[08:27:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[08:27:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[08:27:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[08:27:43] Creating reference folder: reference
[08:27:43] Extracting FASTA and GFF from reference.
[08:27:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:43] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:27:43] Wrote 3 sequences to ref.fa
[08:27:43] Wrote 0 features to ref.gff
[08:27:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta into pseudo-reads
[08:27:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:44] Running: samtools index snps.bam 2>> snps.log
[08:27:44] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:44] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320026 sequences (80000438 bp)...
[08:27:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::process] read 65758 sequences (16399466 bp)...
[08:27:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320066 sequences (80000238 bp)...
[M::process] read 65182 sequences (16295500 bp)...
[08:27:46] Wrote 385918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:46] Using BAM RG (Read Group) ID: SAL_BB7027AA_AS.out
[08:27:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:46] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320026 reads in 16.374 CPU sec, 2.232 real sec
[samclip] Processed 100000 records...
[08:27:47] Marked 0 heterozygous sites with 'n'
[08:27:47] Creating extra output files: BED GFF CSV TXT HTML
[08:27:47] Identified 27 variants.
[08:27:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[08:27:47] Result files:
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.aligned.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam.bai
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bed
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.subs.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.csv
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.filt.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.gff
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.html
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.log
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.raw.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.subs.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.tab
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.txt
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz.csi
[08:27:47] Walltime used: 19 seconds
[08:27:47] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:27:47] Done.
[Tue Jun 16 08:27:47 2020]
Finished job 130.
123 of 206 steps (60%) done

[Tue Jun 16 08:27:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
    jobid: 83
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB4088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[M::mem_process_seqs] Processed 65758 reads in 4.006 CPU sec, 0.464 real sec
[08:27:47] Marked 1 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[08:27:47] Creating extra output files: BED GFF CSV TXT HTML
[08:27:47] Identified 18 variants.
[08:27:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[08:27:47] Result files:
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.aligned.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam.bai
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bed
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.subs.fa
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.csv
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.filt.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.gff
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.html
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.log
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.raw.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.subs.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.tab
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.txt
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz
[08:27:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz.csi
[08:27:47] Walltime used: 19 seconds
[08:27:47] Wishing you a life free of homopolymer errors.
[08:27:47] Done.
[Tue Jun 16 08:27:47 2020]
Finished job 99.
124 of 206 steps (60%) done

[Tue Jun 16 08:27:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
    jobid: 6
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9822AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[08:27:47] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:47] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320066 reads in 18.856 CPU sec, 2.565 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:47] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:47] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.629 sec; CPU: 20.939 sec
[samclip] Total SAM records 386016, removed 651, allowed 69, passed 385365
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[08:27:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:47] This is snippy 4.4.3
[08:27:47] Written by Torsten Seemann
[08:27:47] Obtained from https://github.com/tseemann/snippy
[08:27:47] Detected operating system: linux
[08:27:47] Enabling bundled linux tools.
[08:27:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:47] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:47] Marked 1 heterozygous sites with 'n'
[08:27:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:47] Found gzip - /usr/bin/gzip
[08:27:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:48] Creating extra output files: BED GFF CSV TXT HTML
[08:27:48] Identified 1811 variants.
[08:27:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[08:27:48] Result files:
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.aligned.fa
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam.bai
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bed
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.fa
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.subs.fa
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.csv
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.filt.vcf
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.gff
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.html
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.log
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.raw.vcf
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.subs.vcf
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.tab
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.txt
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz
[08:27:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz.csi
[08:27:48] Walltime used: 20 seconds
[08:27:48] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:27:48] Done.
[08:27:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[Tue Jun 16 08:27:48 2020]
Finished job 164.
125 of 206 steps (61%) done

[Tue Jun 16 08:27:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
    jobid: 116
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA7988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
[M::mem_process_seqs] Processed 65182 reads in 4.272 CPU sec, 0.494 real sec
[08:27:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:48] This is snippy 4.4.3
[08:27:48] Written by Torsten Seemann
[08:27:48] Obtained from https://github.com/tseemann/snippy
[08:27:48] Detected operating system: linux
[08:27:48] Enabling bundled linux tools.
[samclip] Processed 200000 records...
[08:27:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:48] Treating reference as 'fasta' format.
[08:27:48] Will use 8 CPU cores.
[08:27:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[08:27:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[08:27:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[08:27:48] Creating reference folder: reference
[08:27:48] Extracting FASTA and GFF from reference.
[08:27:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:48] Found gzip - /usr/bin/gzip
[08:27:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:48] Wrote 3 sequences to ref.fa
[08:27:48] Wrote 0 features to ref.gff
[08:27:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta into pseudo-reads
[08:27:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:48] Treating reference as 'fasta' format.
[08:27:48] Will use 8 CPU cores.
[08:27:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[08:27:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[08:27:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[08:27:48] Creating reference folder: reference
[08:27:48] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[08:27:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:48] Wrote 3 sequences to ref.fa
[08:27:48] Wrote 0 features to ref.gff
[08:27:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.951 sec; CPU: 23.674 sec
[samclip] Total SAM records 385591, removed 1562, allowed 190, passed 384029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[08:27:48] This is snippy 4.4.3
[08:27:48] Written by Torsten Seemann
[08:27:48] Obtained from https://github.com/tseemann/snippy
[08:27:48] Detected operating system: linux
[08:27:48] Enabling bundled linux tools.
[08:27:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:48] Found gzip - /usr/bin/gzip
[08:27:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::process] read 65918 sequences (16444206 bp)...
[08:27:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:49] Treating reference as 'fasta' format.
[08:27:49] Will use 8 CPU cores.
[08:27:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
[08:27:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[08:27:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[08:27:49] Creating reference folder: reference
[08:27:49] Extracting FASTA and GFF from reference.
[08:27:49] Wrote 3 sequences to ref.fa
[08:27:49] Wrote 0 features to ref.gff
[08:27:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:49] Running: samtools index snps.bam 2>> snps.log
[08:27:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:50] Running: samtools index snps.bam 2>> snps.log
[08:27:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.336 CPU sec, 2.232 real sec
[samclip] Processed 100000 records...
[08:27:51] Wrote 385496 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:51] Using BAM RG (Read Group) ID: SAL_EB4088AA_AS.out
[08:27:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:27:51] Wrote 386426 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:51] Using BAM RG (Read Group) ID: SAL_CB9822AA_AS.out
[08:27:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:51] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 65918 reads in 4.360 CPU sec, 0.504 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:27:52] Wrote 389786 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:52] Using BAM RG (Read Group) ID: SAL_UA7988AA_AS.out
[08:27:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:52] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.618 sec; CPU: 21.220 sec
[samclip] Total SAM records 386160, removed 736, allowed 68, passed 385424
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:52] Marked 1 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:52] Creating extra output files: BED GFF CSV TXT HTML
[08:27:52] Identified 16 variants.
[08:27:52] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[08:27:52] Result files:
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.aligned.fa
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam.bai
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bed
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.fa
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.subs.fa
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.csv
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.filt.vcf
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.gff
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.html
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.log
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.raw.vcf
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.subs.vcf
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.tab
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.txt
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz
[08:27:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz.csi
[08:27:52] Walltime used: 19 seconds
[08:27:52] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:27:52] Done.
[Tue Jun 16 08:27:52 2020]
Finished job 179.
126 of 206 steps (61%) done

[Tue Jun 16 08:27:52 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
    jobid: 128
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:27:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:53] This is snippy 4.4.3
[08:27:53] Written by Torsten Seemann
[08:27:53] Obtained from https://github.com/tseemann/snippy
[08:27:53] Detected operating system: linux
[08:27:53] Enabling bundled linux tools.
[08:27:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:53] Found gzip - /usr/bin/gzip
[08:27:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:27:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:27:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:53] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:53] Treating reference as 'fasta' format.
[08:27:53] Will use 8 CPU cores.
[08:27:53] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
[08:27:53] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[08:27:53] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[08:27:53] Creating reference folder: reference
[08:27:53] Extracting FASTA and GFF from reference.
[08:27:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:53] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:53] Wrote 3 sequences to ref.fa
[08:27:53] Wrote 0 features to ref.gff
[08:27:53] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta into pseudo-reads
[08:27:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[08:27:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65496 sequences (16331678 bp)...
[M::process] read 320118 sequences (80000430 bp)...
[08:27:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::process] read 66308 sequences (16564590 bp)...
[08:27:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:27:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:27:54] Running: samtools index snps.bam 2>> snps.log
[08:27:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320082 sequences (80000088 bp)...
[08:27:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 69704 sequences (17426000 bp)...

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1912
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:27:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:27:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:27:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:27:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:27:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 17.022 CPU sec, 2.448 real sec
[08:27:56] Wrote 384936 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:27:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:27:56] Using BAM RG (Read Group) ID: SAL_CB9988AA_AS.out
[08:27:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:27:56] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320118 reads in 16.934 CPU sec, 2.570 real sec
[M::mem_process_seqs] Processed 65496 reads in 4.118 CPU sec, 0.485 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320082 reads in 18.502 CPU sec, 2.617 real sec
[M::mem_process_seqs] Processed 66308 reads in 4.480 CPU sec, 0.519 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 385770, removed 766, allowed 52, passed 385004

[main] Real time: 3.849 sec; CPU: 21.685 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[08:27:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:27:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:27:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[08:27:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:27:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:27:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 69704 reads in 4.408 CPU sec, 0.515 real sec
[08:27:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.978 sec; CPU: 21.970 sec
[samclip] Total SAM records 386705, removed 879, allowed 74, passed 385826
[samclip] Header contained 5 lines
[samclip] Done.
[08:27:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:27:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:27:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:27:57] Running: rm -f fake_reads\.fq 2>> snps.log
[08:27:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[08:27:57] Marked 0 heterozygous sites with 'n'
[08:27:57] Creating extra output files: BED GFF CSV TXT HTML
[08:27:57] Identified 22 variants.
[08:27:57] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[08:27:57] Result files:
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.aligned.fa
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam.bai
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bed
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.fa
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.subs.fa
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.csv
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.filt.vcf
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.gff
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.html
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.log
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.raw.vcf
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.subs.vcf
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.tab
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.txt
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz
[08:27:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz.csi
[08:27:57] Walltime used: 18 seconds
[08:27:57] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:27:57] Done.
[Tue Jun 16 08:27:57 2020]
Finished job 194.
127 of 206 steps (62%) done

[Tue Jun 16 08:27:57 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
    jobid: 170
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA2453AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 389973, removed 1419, allowed 239, passed 388554
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.995 sec; CPU: 23.421 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:27:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:27:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:27:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320000 sequences (80000000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 64936 sequences (16193398 bp)...
[08:27:58] This is snippy 4.4.3
[08:27:58] Written by Torsten Seemann
[08:27:58] Obtained from https://github.com/tseemann/snippy
[08:27:58] Detected operating system: linux
[08:27:58] Enabling bundled linux tools.
[08:27:58] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:27:58] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:27:58] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:27:58] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:27:58] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:27:58] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:27:58] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:27:58] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:27:58] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:27:58] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:27:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:27:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:27:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:27:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:27:58] Found gzip - /usr/bin/gzip
[08:27:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:27:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:27:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:27:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:27:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:27:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:27:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:27:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:27:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:27:58] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:27:58] Treating reference as 'fasta' format.
[08:27:58] Will use 8 CPU cores.
[08:27:58] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[08:27:58] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[08:27:58] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[08:27:58] Creating reference folder: reference
[08:27:58] Extracting FASTA and GFF from reference.
[08:27:58] Wrote 3 sequences to ref.fa
[08:27:58] Wrote 0 features to ref.gff
[08:27:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:27:59] Running: samtools index snps.bam 2>> snps.log
[08:27:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:59] Marked 0 heterozygous sites with 'n'
[08:27:59] Creating extra output files: BED GFF CSV TXT HTML
[08:27:59] Identified 1912 variants.
[08:27:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[08:27:59] Result files:
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.aligned.fa
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam.bai
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bed
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.fa
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.subs.fa
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.csv
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.filt.vcf
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.gff
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.html
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.log
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.raw.vcf
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.subs.vcf
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.tab
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.txt
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz
[08:27:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz.csi
[08:27:59] Walltime used: 20 seconds
[08:27:59] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:27:59] Done.
[08:27:59] Running: samtools index snps.bam 2>> snps.log
[Tue Jun 16 08:27:59 2020]
Finished job 12.
128 of 206 steps (62%) done

[Tue Jun 16 08:27:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
    jobid: 59
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_DB1444AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[08:27:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:27:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:27:59] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:00] This is snippy 4.4.3
[08:28:00] Written by Torsten Seemann
[08:28:00] Obtained from https://github.com/tseemann/snippy
[08:28:00] Detected operating system: linux
[08:28:00] Enabling bundled linux tools.
[08:28:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:00] Found gzip - /usr/bin/gzip
[08:28:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:00] Treating reference as 'fasta' format.
[08:28:00] Will use 8 CPU cores.
[08:28:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[08:28:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[08:28:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[08:28:00] Creating reference folder: reference
[08:28:00] Extracting FASTA and GFF from reference.
[08:28:00] Wrote 3 sequences to ref.fa
[08:28:00] Wrote 0 features to ref.gff
[08:28:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320000 reads in 16.969 CPU sec, 2.435 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64936 reads in 3.624 CPU sec, 0.482 real sec
[samclip] Processed 200000 records...
[08:28:01] Wrote 388114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:01] Using BAM RG (Read Group) ID: SAL_SA2453AA_AS.out
[08:28:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:01] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:01] Marked 0 heterozygous sites with 'n'
[08:28:01] Creating extra output files: BED GFF CSV TXT HTML
[08:28:01] Identified 22 variants.
[08:28:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[08:28:01] Result files:
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.aligned.fa
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam.bai
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bed
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.fa
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.subs.fa
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.csv
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.filt.vcf
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.gff
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.html
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.log
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.raw.vcf
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.subs.vcf
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.tab
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.txt
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz
[08:28:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz.csi
[08:28:01] Walltime used: 18 seconds
[08:28:01] Wishing you a life free of homopolymer errors.
[08:28:01] Done.
[Tue Jun 16 08:28:01 2020]
Finished job 166.
129 of 206 steps (63%) done

[Tue Jun 16 08:28:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
    jobid: 111
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB9523AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.007 sec; CPU: 21.215 sec
[samclip] Total SAM records 385174, removed 953, allowed 138, passed 384221
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:02] This is snippy 4.4.3
[08:28:02] Written by Torsten Seemann
[08:28:02] Obtained from https://github.com/tseemann/snippy
[08:28:02] Detected operating system: linux
[08:28:02] Enabling bundled linux tools.
[08:28:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:02] Found gzip - /usr/bin/gzip
[08:28:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:02] Treating reference as 'fasta' format.
[08:28:02] Will use 8 CPU cores.
[08:28:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[08:28:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[08:28:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[08:28:02] Creating reference folder: reference
[08:28:02] Extracting FASTA and GFF from reference.
[08:28:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:02] Wrote 3 sequences to ref.fa
[08:28:02] Wrote 0 features to ref.gff
[08:28:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta into pseudo-reads
[08:28:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1791
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:03] Wrote 384592 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:03] Using BAM RG (Read Group) ID: SAL_DB1444AA_AS.out
[08:28:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:03] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:03] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:03] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:03] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:03] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:03] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:03] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320138 sequences (80000116 bp)...
[08:28:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 67976 sequences (16989752 bp)...
[08:28:04] Running: samtools index snps.bam 2>> snps.log
[08:28:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000246 bp)...
[M::process] read 64548 sequences (16137000 bp)...
[08:28:05] Wrote 384522 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:05] Using BAM RG (Read Group) ID: SAL_KB9523AA_AS.out
[08:28:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:05] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320138 reads in 19.004 CPU sec, 2.630 real sec
[08:28:06] Marked 0 heterozygous sites with 'n'
[08:28:06] Creating extra output files: BED GFF CSV TXT HTML
[08:28:06] Identified 20 variants.
[08:28:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[08:28:06] Result files:
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.aligned.fa
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam.bai
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bed
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.fa
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.subs.fa
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.csv
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.filt.vcf
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.gff
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.html
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.log
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.raw.vcf
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.subs.vcf
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.tab
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.txt
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz
[08:28:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz.csi
[08:28:06] Walltime used: 19 seconds
[08:28:06] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:28:06] Done.
[Tue Jun 16 08:28:06 2020]
Finished job 83.
130 of 206 steps (63%) done

[Tue Jun 16 08:28:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
    jobid: 32
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB5876AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67976 reads in 4.476 CPU sec, 0.515 real sec
[samclip] Processed 200000 records...
[08:28:07] Marked 0 heterozygous sites with 'n'
[08:28:07] Creating extra output files: BED GFF CSV TXT HTML
[08:28:07] Identified 17 variants.
[08:28:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[08:28:07] Result files:
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.aligned.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam.bai
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bed
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.subs.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.csv
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.filt.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.gff
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.html
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.log
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.raw.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.subs.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.tab
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.txt
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz.csi
[08:28:07] Walltime used: 19 seconds
[08:28:07] Wishing you a life free of homopolymer errors.
[08:28:07] Done.
[Tue Jun 16 08:28:07 2020]
Finished job 6.
131 of 206 steps (64%) done

[Tue Jun 16 08:28:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
    jobid: 18
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB6687AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[08:28:07] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 516
       total no. reference observed             : 0

Time elapsed: 0.00s

Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:07] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[08:28:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:07] This is snippy 4.4.3
[08:28:07] Written by Torsten Seemann
[08:28:07] Obtained from https://github.com/tseemann/snippy
[08:28:07] Detected operating system: linux
[08:28:07] Enabling bundled linux tools.
[08:28:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:07] Found gzip - /usr/bin/gzip
[08:28:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 388314, removed 1268, allowed 208, passed 387046

[main] Real time: 4.041 sec; CPU: 24.040 sec
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:07] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:07] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:07] Treating reference as 'fasta' format.
[08:28:07] Will use 8 CPU cores.
[08:28:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
[08:28:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[08:28:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[08:28:07] Creating reference folder: reference
[08:28:07] Extracting FASTA and GFF from reference.
[08:28:07] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:07] Wrote 3 sequences to ref.fa
[08:28:07] Wrote 0 features to ref.gff
[08:28:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta into pseudo-reads
[08:28:07] Marked 0 heterozygous sites with 'n'
[08:28:07] This is snippy 4.4.3
[08:28:07] Written by Torsten Seemann
[08:28:07] Obtained from https://github.com/tseemann/snippy
[08:28:07] Detected operating system: linux
[08:28:07] Enabling bundled linux tools.
[08:28:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:07] Found gzip - /usr/bin/gzip
[08:28:07] Creating extra output files: BED GFF CSV TXT HTML
[08:28:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:07] Identified 1791 variants.
[08:28:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[08:28:07] Result files:
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.aligned.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam.bai
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bed
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.subs.fa
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.csv
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.filt.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.gff
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.html
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.log
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.raw.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.subs.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.tab
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.txt
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz
[08:28:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz.csi
[08:28:07] Walltime used: 19 seconds
[08:28:07] May the SNPs be with you.
[08:28:07] Done.
[08:28:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 320044 reads in 18.285 CPU sec, 2.455 real sec
[Tue Jun 16 08:28:07 2020]
Finished job 116.
132 of 206 steps (64%) done

[Tue Jun 16 08:28:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
    jobid: 93
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA7989AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[M::process] read 320054 sequences (80000440 bp)...
[08:28:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 64468 sequences (16115374 bp)...
[08:28:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:08] Treating reference as 'fasta' format.
[08:28:08] Will use 8 CPU cores.
[08:28:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[08:28:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[08:28:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[08:28:08] Creating reference folder: reference
[08:28:08] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[08:28:08] Wrote 3 sequences to ref.fa
[08:28:08] Wrote 0 features to ref.gff
[08:28:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 64548 reads in 4.083 CPU sec, 0.471 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:08] This is snippy 4.4.3
[08:28:08] Written by Torsten Seemann
[08:28:08] Obtained from https://github.com/tseemann/snippy
[08:28:08] Detected operating system: linux
[08:28:08] Enabling bundled linux tools.
[08:28:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:08] Found gzip - /usr/bin/gzip
[08:28:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[samclip] Processed 300000 records...
[08:28:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:08] Treating reference as 'fasta' format.
[08:28:08] Will use 8 CPU cores.
[08:28:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[08:28:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[08:28:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[08:28:08] Creating reference folder: reference
[08:28:08] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.860 sec; CPU: 22.948 sec
[samclip] Total SAM records 384693, removed 741, allowed 49, passed 383952
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:09] Wrote 3 sequences to ref.fa
[08:28:09] Wrote 0 features to ref.gff
[08:28:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta into pseudo-reads
[08:28:09] Running: samtools index snps.bam 2>> snps.log
[08:28:09] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320054 reads in 17.873 CPU sec, 2.465 real sec
[08:28:10] Wrote 385642 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:10] Using BAM RG (Read Group) ID: SAL_EB5876AA_AS.out
[08:28:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:10] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64468 reads in 4.126 CPU sec, 0.476 real sec
[samclip] Processed 200000 records...
[08:28:10] Running: samtools index snps.bam 2>> snps.log
[08:28:11] Wrote 384322 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:11] Using BAM RG (Read Group) ID: SAL_BB6687AA_AS.out
[08:28:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:11] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.855 sec; CPU: 22.556 sec
[samclip] Total SAM records 384620, removed 583, allowed 44, passed 384037
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:11] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:11] Using BAM RG (Read Group) ID: SAL_UA7989AA_AS.out
[08:28:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:11] Marked 0 heterozygous sites with 'n'
[08:28:11] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:11] Creating extra output files: BED GFF CSV TXT HTML
[08:28:11] Identified 516 variants.
[08:28:11] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[08:28:11] Result files:
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.aligned.fa
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam.bai
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bed
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.fa
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.subs.fa
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.csv
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.filt.vcf
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.gff
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.html
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.log
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.raw.vcf
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.subs.vcf
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.tab
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.txt
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz
[08:28:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz.csi
[08:28:11] Walltime used: 18 seconds
[08:28:11] Questionable SNP? Try the --report option to see the alignments.
[08:28:11] Done.
[Tue Jun 16 08:28:11 2020]
Finished job 128.
133 of 206 steps (65%) done

[Tue Jun 16 08:28:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
    jobid: 80
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB4083AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:12] This is snippy 4.4.3
[08:28:12] Written by Torsten Seemann
[08:28:12] Obtained from https://github.com/tseemann/snippy
[08:28:12] Detected operating system: linux
[08:28:12] Enabling bundled linux tools.
[08:28:12] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:12] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:12] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:12] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:12] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:12] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:12] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:12] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:12] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:12] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:12] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:12] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:12] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:12] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:12] Found gzip - /usr/bin/gzip
[08:28:12] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:12] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:12] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:12] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:12] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:12] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:12] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:12] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:12] Treating reference as 'fasta' format.
[08:28:12] Will use 8 CPU cores.
[08:28:12] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
[08:28:12] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[08:28:12] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[08:28:12] Creating reference folder: reference
[08:28:12] Extracting FASTA and GFF from reference.
[08:28:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320010 sequences (80000096 bp)...
[08:28:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:28:12] Running: ln -sf reference/ref.fa . 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:28:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 65632 sequences (16408000 bp)...
[08:28:13] Wrote 3 sequences to ref.fa
[08:28:13] Wrote 0 features to ref.gff
[08:28:13] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta into pseudo-reads
[08:28:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320202 sequences (80000426 bp)...
[08:28:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 64120 sequences (16030000 bp)...
[08:28:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:13] Running: samtools index snps.bam 2>> snps.log
[08:28:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:13] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320094 sequences (80000282 bp)...
[08:28:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 137
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 70088 sequences (17520596 bp)...
[08:28:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:14] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320010 reads in 19.164 CPU sec, 2.738 real sec
[08:28:15] Wrote 384666 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:15] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:15] Using BAM RG (Read Group) ID: SAL_EB4083AA_AS.out
[08:28:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:15] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320202 reads in 17.300 CPU sec, 2.548 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65632 reads in 4.311 CPU sec, 0.525 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64120 reads in 3.703 CPU sec, 0.453 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[08:28:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 10
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 142
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[08:28:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:28:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320094 reads in 19.363 CPU sec, 2.879 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.313 sec; CPU: 24.079 sec
[samclip] Total SAM records 385979, removed 1409, allowed 205, passed 384570
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:16] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.052 sec; CPU: 21.595 sec
[samclip] Total SAM records 384473, removed 460, allowed 55, passed 384013
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70088 reads in 4.356 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[08:28:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:17] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:17] Marked 0 heterozygous sites with 'n'
[08:28:17] Creating extra output files: BED GFF CSV TXT HTML
[08:28:17] Identified 1811 variants.
[08:28:17] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[08:28:17] Result files:
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.aligned.fa
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam.bai
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bed
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.fa
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.subs.fa
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.csv
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.filt.vcf
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.gff
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.html
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.log
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.raw.vcf
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.subs.vcf
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.tab
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.txt
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz
[08:28:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz.csi
[08:28:17] Walltime used: 19 seconds
[08:28:17] May the SNPs be with you.
[08:28:17] Done.
[Tue Jun 16 08:28:17 2020]
Finished job 170.
134 of 206 steps (65%) done

[Tue Jun 16 08:28:17 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
    jobid: 199
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MA3067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.265 sec; CPU: 24.262 sec
[samclip] Total SAM records 390362, removed 1702, allowed 252, passed 388660
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 64666 sequences (16094524 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:18] This is snippy 4.4.3
[08:28:18] Written by Torsten Seemann
[08:28:18] Obtained from https://github.com/tseemann/snippy
[08:28:18] Detected operating system: linux
[08:28:18] Enabling bundled linux tools.
[08:28:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:18] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:18] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:18] Found gzip - /usr/bin/gzip
[08:28:18] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:18] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:18] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:18] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:18] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:18] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:18] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:18] Treating reference as 'fasta' format.
[08:28:18] Will use 8 CPU cores.
[08:28:18] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[08:28:18] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[08:28:18] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[08:28:18] Creating reference folder: reference
[08:28:18] Extracting FASTA and GFF from reference.
[08:28:18] Marked 26 heterozygous sites with 'n'
[08:28:18] Running: samtools index snps.bam 2>> snps.log
[08:28:18] Wrote 3 sequences to ref.fa
[08:28:18] Wrote 0 features to ref.gff
[08:28:18] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta into pseudo-reads
[08:28:18] Creating extra output files: BED GFF CSV TXT HTML
[08:28:18] Identified 137 variants.
[08:28:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[08:28:18] Result files:
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.aligned.fa
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam.bai
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bed
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.fa
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.subs.fa
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.csv
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.filt.vcf
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.gff
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.html
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.log
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.raw.vcf
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.subs.vcf
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.tab
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.txt
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz
[08:28:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz.csi
[08:28:18] Walltime used: 18 seconds
[08:28:18] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:28:18] Done.
[Tue Jun 16 08:28:18 2020]
Finished job 59.
135 of 206 steps (66%) done

[Tue Jun 16 08:28:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
    jobid: 95
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB3497AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:18] Running: samtools index snps.bam 2>> snps.log
[08:28:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:19] This is snippy 4.4.3
[08:28:19] Written by Torsten Seemann
[08:28:19] Obtained from https://github.com/tseemann/snippy
[08:28:19] Detected operating system: linux
[08:28:19] Enabling bundled linux tools.
[08:28:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:19] Found gzip - /usr/bin/gzip
[08:28:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:19] Treating reference as 'fasta' format.
[08:28:19] Will use 8 CPU cores.
[08:28:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[08:28:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[08:28:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[08:28:19] Creating reference folder: reference
[08:28:19] Extracting FASTA and GFF from reference.
[08:28:19] Running: samtools index snps.bam 2>> snps.log
[08:28:19] Wrote 3 sequences to ref.fa
[08:28:19] Wrote 0 features to ref.gff
[08:28:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta into pseudo-reads
[08:28:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.116 CPU sec, 2.568 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64666 reads in 3.641 CPU sec, 0.444 real sec
[08:28:21] Marked 8 heterozygous sites with 'n'
[08:28:21] Creating extra output files: BED GFF CSV TXT HTML
[08:28:21] Identified 142 variants.
[08:28:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[08:28:21] Result files:
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.aligned.fa
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam.bai
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bed
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.fa
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.subs.fa
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.csv
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.filt.vcf
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.gff
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.html
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.log
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.raw.vcf
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.subs.vcf
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.tab
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.txt
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz
[08:28:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz.csi
[08:28:21] Walltime used: 19 seconds
[08:28:21] Wishing you a life free of homopolymer errors.
[08:28:21] Done.
[Tue Jun 16 08:28:21 2020]
Finished job 111.
136 of 206 steps (66%) done

[Tue Jun 16 08:28:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
    jobid: 11
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB0088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:28:21] Wrote 388222 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:21] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:21] Using BAM RG (Read Group) ID: SAL_MA3067AA_AS.out
[08:28:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:21] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.118 sec; CPU: 22.378 sec
[samclip] Total SAM records 384812, removed 583, allowed 99, passed 384229
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:22] This is snippy 4.4.3
[08:28:22] Written by Torsten Seemann
[08:28:22] Obtained from https://github.com/tseemann/snippy
[08:28:22] Detected operating system: linux
[08:28:22] Enabling bundled linux tools.
[08:28:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:28:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:28:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:22] Found gzip - /usr/bin/gzip
[08:28:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:22] Treating reference as 'fasta' format.
[08:28:22] Will use 8 CPU cores.
[08:28:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
[08:28:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[08:28:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[08:28:22] Creating reference folder: reference
[08:28:22] Extracting FASTA and GFF from reference.
[08:28:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:28:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1930
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:22] Wrote 3 sequences to ref.fa
[08:28:22] Wrote 0 features to ref.gff
[08:28:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta into pseudo-reads
[08:28:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:22] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:22] Wrote 385416 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:22] Using BAM RG (Read Group) ID: SAL_CB3497AA_AS.out
[08:28:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:22] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1804
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:23] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:28:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:23] Running: samtools index snps.bam 2>> snps.log
[08:28:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:23] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320126 sequences (80000090 bp)...
[M::process] read 68096 sequences (17012204 bp)...
[08:28:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320154 sequences (80000190 bp)...
[M::process] read 65262 sequences (16282550 bp)...
[08:28:25] Wrote 384750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:25] Using BAM RG (Read Group) ID: SAL_CB0088AA_AS.out
[08:28:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:25] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320126 reads in 18.645 CPU sec, 2.594 real sec
[08:28:26] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[08:28:26] Creating extra output files: BED GFF CSV TXT HTML
[08:28:26] Identified 98 variants.
[08:28:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[08:28:26] Result files:
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.aligned.fa
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam.bai
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bed
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.fa
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.subs.fa
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.csv
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.filt.vcf
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.gff
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.html
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.log
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.raw.vcf
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.subs.vcf
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.tab
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.txt
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz
[08:28:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz.csi
[08:28:26] Walltime used: 19 seconds
[08:28:26] May the SNPs be with you.
[08:28:26] Done.
[08:28:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[Tue Jun 16 08:28:26 2020]
Finished job 18.
137 of 206 steps (67%) done

[Tue Jun 16 08:28:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
    jobid: 193
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IA5065AA_AS
    threads: 5
normalize v0.5

options:     input VCF file                                  -

         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 103
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 68096 reads in 4.353 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[08:28:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:27] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:27] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:28:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:27] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:27] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320154 reads in 17.007 CPU sec, 2.317 real sec
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:27] Creating extra output files: BED GFF CSV TXT HTML
[08:28:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:27] Identified 1930 variants.
[08:28:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[08:28:27] Result files:
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.aligned.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam.bai
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bed
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.subs.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.csv
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.filt.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.gff
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.html
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.log
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.raw.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.subs.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.tab
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.txt
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz.csi
[08:28:27] Walltime used: 20 seconds
[08:28:27] May the SNPs be with you.
[08:28:27] Done.
[Tue Jun 16 08:28:27 2020]
Finished job 32.
138 of 206 steps (67%) done

[Tue Jun 16 08:28:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
    jobid: 19
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA7945AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[08:28:27] This is snippy 4.4.3
[08:28:27] Written by Torsten Seemann
[08:28:27] Obtained from https://github.com/tseemann/snippy
[08:28:27] Detected operating system: linux
[08:28:27] Enabling bundled linux tools.
[08:28:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.001 sec; CPU: 23.566 sec
[samclip] Total SAM records 388325, removed 994, allowed 107, passed 387331
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[samclip] Processed 100000 records...
[08:28:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[M::process] read 320024 sequences (80000480 bp)...
[08:28:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:27] Found gzip - /usr/bin/gzip
[08:28:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 64726 sequences (16096746 bp)...
[08:28:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:27] Treating reference as 'fasta' format.
[08:28:27] Will use 8 CPU cores.
[08:28:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
[08:28:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[08:28:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[08:28:27] Creating reference folder: reference
[08:28:27] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 65262 reads in 4.236 CPU sec, 0.496 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:27] Marked 0 heterozygous sites with 'n'
[08:28:27] Wrote 3 sequences to ref.fa
[08:28:27] Wrote 0 features to ref.gff
[08:28:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta into pseudo-reads
[08:28:27] Creating extra output files: BED GFF CSV TXT HTML
[08:28:27] Identified 1804 variants.
[08:28:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[08:28:27] Result files:
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.aligned.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam.bai
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bed
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.subs.fa
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.csv
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.filt.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.gff
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.html
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.log
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.raw.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.subs.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.tab
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.txt
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz
[08:28:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz.csi
[08:28:27] Walltime used: 19 seconds
[08:28:27] Wishing you a life free of homopolymer errors.
[08:28:27] Done.
[Tue Jun 16 08:28:27 2020]
Finished job 93.
139 of 206 steps (67%) done

[Tue Jun 16 08:28:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
    jobid: 91
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB3127AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[08:28:28] This is snippy 4.4.3
[08:28:28] Written by Torsten Seemann
[08:28:28] Obtained from https://github.com/tseemann/snippy
[08:28:28] Detected operating system: linux
[08:28:28] Enabling bundled linux tools.
[08:28:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[samclip] Processed 300000 records...
[08:28:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:28] Found gzip - /usr/bin/gzip
[08:28:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:28] Treating reference as 'fasta' format.
[08:28:28] Will use 8 CPU cores.
[08:28:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[08:28:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[08:28:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[08:28:28] Creating reference folder: reference
[08:28:28] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.751 sec; CPU: 21.803 sec
[samclip] Total SAM records 385748, removed 1012, allowed 128, passed 384736
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:28] Wrote 3 sequences to ref.fa
[08:28:28] Wrote 0 features to ref.gff
[08:28:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:28] This is snippy 4.4.3
[08:28:28] Written by Torsten Seemann
[08:28:28] Obtained from https://github.com/tseemann/snippy
[08:28:28] Detected operating system: linux
[08:28:28] Enabling bundled linux tools.
[08:28:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:28] Found gzip - /usr/bin/gzip
[08:28:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:28] Treating reference as 'fasta' format.
[08:28:28] Will use 8 CPU cores.
[08:28:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[08:28:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[08:28:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[08:28:28] Creating reference folder: reference
[08:28:28] Extracting FASTA and GFF from reference.
[08:28:29] Wrote 3 sequences to ref.fa
[08:28:29] Wrote 0 features to ref.gff
[08:28:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:29] Running: samtools index snps.bam 2>> snps.log
[08:28:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320024 reads in 17.059 CPU sec, 2.394 real sec
[samclip] Processed 100000 records...
[08:28:30] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 64726 reads in 3.721 CPU sec, 0.430 real sec
[08:28:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 200000 records...
[08:28:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:30] Wrote 389202 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:30] Using BAM RG (Read Group) ID: SAL_IA5065AA_AS.out
[08:28:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:30] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.814 sec; CPU: 21.372 sec
[samclip] Total SAM records 385165, removed 942, allowed 100, passed 384223
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:31] Wrote 387992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:31] Using BAM RG (Read Group) ID: SAL_BA7945AA_AS.out
[08:28:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:31] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:31] Marked 1 heterozygous sites with 'n'
[08:28:31] Creating extra output files: BED GFF CSV TXT HTML
[08:28:31] Identified 103 variants.
[08:28:31] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[08:28:31] Result files:
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.aligned.fa
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam.bai
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bed
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.fa
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.subs.fa
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.csv
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.filt.vcf
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.gff
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.html
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.log
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.raw.vcf
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.subs.vcf
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.tab
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.txt
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz
[08:28:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz.csi
[08:28:31] Walltime used: 19 seconds
[08:28:31] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:28:31] Done.
[Tue Jun 16 08:28:31 2020]
Finished job 80.
140 of 206 steps (68%) done

[Tue Jun 16 08:28:31 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
    jobid: 63
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB3375AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
[08:28:31] Wrote 384102 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:31] Using BAM RG (Read Group) ID: SAL_BB3127AA_AS.out
[08:28:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:31] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:32] This is snippy 4.4.3
[08:28:32] Written by Torsten Seemann
[08:28:32] Obtained from https://github.com/tseemann/snippy
[08:28:32] Detected operating system: linux
[08:28:32] Enabling bundled linux tools.
[08:28:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:32] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:32] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:32] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:32] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:32] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:32] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:32] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:32] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:32] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:32] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:32] Found gzip - /usr/bin/gzip
[08:28:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:32] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:32] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:32] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:32] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:32] Treating reference as 'fasta' format.
[08:28:32] Will use 8 CPU cores.
[08:28:32] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
[08:28:32] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[08:28:32] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[08:28:32] Creating reference folder: reference
[08:28:32] Extracting FASTA and GFF from reference.
[08:28:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:28:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::bwa_idx_load_from_disk] read 0 ALT contigs

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 374
       total no. reference observed             : 0

Time elapsed: 0.00s

[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:32] Wrote 3 sequences to ref.fa
[08:28:32] Wrote 0 features to ref.gff
[08:28:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta into pseudo-reads
[08:28:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320126 sequences (80000184 bp)...
[08:28:32] Running: samtools index snps.bam 2>> snps.log
[08:28:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:32] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 69076 sequences (17261518 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320056 sequences (80000148 bp)...
[M::process] read 67936 sequences (16980480 bp)...
[08:28:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:28:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 74
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:33] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320118 sequences (80000104 bp)...
[08:28:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 63984 sequences (15961616 bp)...
[M::mem_process_seqs] Processed 320126 reads in 18.263 CPU sec, 2.476 real sec
[samclip] Processed 100000 records...
[08:28:35] Wrote 383716 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:35] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:35] Using BAM RG (Read Group) ID: SAL_KB3375AA_AS.out
[08:28:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:35] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69076 reads in 4.864 CPU sec, 0.568 real sec
[08:28:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320056 reads in 19.217 CPU sec, 2.707 real sec
[samclip] Processed 300000 records...
[08:28:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:28:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320118 reads in 17.387 CPU sec, 2.495 real sec
[08:28:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:36] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.912 sec; CPU: 23.659 sec
[samclip] Total SAM records 389418, removed 1376, allowed 263, passed 388042
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 67936 reads in 4.408 CPU sec, 0.508 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63984 reads in 3.657 CPU sec, 0.425 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.090 sec; CPU: 24.165 sec
[samclip] Total SAM records 388364, removed 1774, allowed 267, passed 386590
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:37] Marked 0 heterozygous sites with 'n'
[08:28:37] Creating extra output files: BED GFF CSV TXT HTML
[08:28:37] Identified 374 variants.
[08:28:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[08:28:37] Result files:
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.aligned.fa
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam.bai
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bed
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.fa
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.subs.fa
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.csv
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.filt.vcf
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.gff
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.html
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.log
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.raw.vcf
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.subs.vcf
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.tab
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.txt
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz
[08:28:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz.csi
[08:28:37] Walltime used: 19 seconds
[08:28:37] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:28:37] Done.
[Tue Jun 16 08:28:37 2020]
Finished job 199.
141 of 206 steps (68%) done

[Tue Jun 16 08:28:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
    jobid: 106
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6210AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.892 sec; CPU: 21.621 sec
[samclip] Total SAM records 384381, removed 794, allowed 64, passed 383587
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:37] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:37] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:37] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63716 sequences (15905020 bp)...
[08:28:38] This is snippy 4.4.3
[08:28:38] Written by Torsten Seemann
[08:28:38] Obtained from https://github.com/tseemann/snippy
[08:28:38] Detected operating system: linux
[08:28:38] Enabling bundled linux tools.
[08:28:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:38] Found gzip - /usr/bin/gzip
[08:28:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:38] Marked 0 heterozygous sites with 'n'
[08:28:38] Creating extra output files: BED GFF CSV TXT HTML
[08:28:38] Identified 74 variants.
[08:28:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[08:28:38] Result files:
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.aligned.fa
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam.bai
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bed
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.fa
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.subs.fa
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.csv
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.filt.vcf
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.gff
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.html
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.log
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.raw.vcf
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.subs.vcf
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.tab
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.txt
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz
[08:28:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz.csi
[08:28:38] Walltime used: 19 seconds
[08:28:38] May the SNPs be with you.
[08:28:38] Done.
[Tue Jun 16 08:28:38 2020]
Finished job 95.
142 of 206 steps (69%) done

[Tue Jun 16 08:28:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
    jobid: 50
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB2744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
[08:28:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:38] Treating reference as 'fasta' format.
[08:28:38] Will use 8 CPU cores.
[08:28:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[08:28:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[08:28:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[08:28:38] Creating reference folder: reference
[08:28:38] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:38] Running: samtools index snps.bam 2>> snps.log
[08:28:38] Wrote 3 sequences to ref.fa
[08:28:38] Wrote 0 features to ref.gff
[08:28:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta into pseudo-reads
[08:28:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:39] This is snippy 4.4.3
[08:28:39] Written by Torsten Seemann
[08:28:39] Obtained from https://github.com/tseemann/snippy
[08:28:39] Detected operating system: linux
[08:28:39] Enabling bundled linux tools.
[08:28:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:39] Found gzip - /usr/bin/gzip
[08:28:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:39] Running: samtools index snps.bam 2>> snps.log
[08:28:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:39] Treating reference as 'fasta' format.
[08:28:39] Will use 8 CPU cores.
[08:28:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
[08:28:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[08:28:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[08:28:39] Creating reference folder: reference
[08:28:39] Extracting FASTA and GFF from reference.
[08:28:39] Running: samtools index snps.bam 2>> snps.log
[08:28:39] Wrote 3 sequences to ref.fa
[08:28:39] Wrote 0 features to ref.gff
[08:28:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta into pseudo-reads
[08:28:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.006 CPU sec, 2.533 real sec
[08:28:40] Marked 0 heterozygous sites with 'n'
[08:28:40] Creating extra output files: BED GFF CSV TXT HTML
[08:28:40] Identified 26 variants.
[08:28:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[08:28:40] Result files:
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.aligned.fa
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam.bai
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bed
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.fa
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.subs.fa
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.csv
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.filt.vcf
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.gff
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.html
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.log
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.raw.vcf
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.subs.vcf
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.tab
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.txt
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz
[08:28:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz.csi
[08:28:40] Walltime used: 18 seconds
[08:28:40] Wishing you a life free of homopolymer errors.
[08:28:40] Done.
[Tue Jun 16 08:28:40 2020]
Finished job 11.
143 of 206 steps (69%) done

[Tue Jun 16 08:28:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
    jobid: 155
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9562AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63716 reads in 3.592 CPU sec, 0.435 real sec
[samclip] Processed 200000 records...
[08:28:41] Wrote 384278 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:41] Using BAM RG (Read Group) ID: SAL_KB6210AA_AS.out
[08:28:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:41] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.000 sec; CPU: 22.174 sec
[samclip] Total SAM records 384046, removed 1464, allowed 120, passed 382582
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:41] This is snippy 4.4.3
[08:28:41] Written by Torsten Seemann
[08:28:41] Obtained from https://github.com/tseemann/snippy
[08:28:41] Detected operating system: linux
[08:28:41] Enabling bundled linux tools.
[08:28:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:41] Found gzip - /usr/bin/gzip
[08:28:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:28:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:41] Treating reference as 'fasta' format.
[08:28:41] Will use 8 CPU cores.
[08:28:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
[08:28:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:28:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
[08:28:41] Creating reference folder: reference
[08:28:41] Extracting FASTA and GFF from reference.

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1934
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:42] Wrote 384294 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:42] Using BAM RG (Read Group) ID: SAL_KB2744AA_AS.out
[08:28:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:42] Wrote 3 sequences to ref.fa
[08:28:42] Wrote 0 features to ref.gff
[08:28:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta into pseudo-reads
[08:28:42] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1897
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:28:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:28:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:28:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:43] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320200 sequences (80000492 bp)...
[M::process] read 64078 sequences (16019500 bp)...
[08:28:43] Running: samtools index snps.bam 2>> snps.log
[08:28:43] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320012 sequences (80000380 bp)...
[M::process] read 64282 sequences (16022514 bp)...
[08:28:44] Wrote 384058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:44] Using BAM RG (Read Group) ID: SAL_BB9562AA_AS.out
[08:28:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:44] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320200 reads in 17.827 CPU sec, 2.506 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64078 reads in 3.625 CPU sec, 0.422 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320012 reads in 17.405 CPU sec, 2.380 real sec
[08:28:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] Processed 300000 records...
[08:28:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:46] Marked 0 heterozygous sites with 'n'
[08:28:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 847
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:28:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:46] Creating extra output files: BED GFF CSV TXT HTML
[08:28:46] Identified 1934 variants.
[samclip] Processed 100000 records...
[08:28:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[08:28:46] Result files:
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.aligned.fa
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam.bai
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bed
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.fa
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.subs.fa
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.csv
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.filt.vcf
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.gff
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.html
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.log
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.raw.vcf
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.subs.vcf
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.tab
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.txt
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz
[08:28:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz.csi
[08:28:46] Walltime used: 19 seconds
[08:28:46] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:28:46] Done.
[Tue Jun 16 08:28:46 2020]
Finished job 193.
144 of 206 steps (70%) done

[Tue Jun 16 08:28:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
    jobid: 26
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1956AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.922 sec; CPU: 22.054 sec
[samclip] Total SAM records 384534, removed 690, allowed 104, passed 383844
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:47] Marked 0 heterozygous sites with 'n'
[08:28:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320068 sequences (80000456 bp)...
[08:28:47] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 64282 reads in 3.882 CPU sec, 0.445 real sec
[08:28:47] Identified 19 variants.
[08:28:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[08:28:47] Result files:
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.aligned.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam.bai
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bed
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.subs.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.csv
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.filt.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.gff
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.html
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.log
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.raw.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.subs.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.tab
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.txt
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz.csi
[08:28:47] Walltime used: 19 seconds
[08:28:47] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:28:47] Done.
[08:28:47] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[Tue Jun 16 08:28:47 2020]
Finished job 91.
145 of 206 steps (70%) done

[Tue Jun 16 08:28:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
    jobid: 102
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4524AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[08:28:47] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 63990 sequences (15953704 bp)...
[samclip] Processed 200000 records...
[08:28:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:47] Marked 0 heterozygous sites with 'n'
[08:28:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:47] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:47] Creating extra output files: BED GFF CSV TXT HTML
[08:28:47] Identified 1897 variants.
[08:28:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[08:28:47] Result files:
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.aligned.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam.bai
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bed
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.subs.fa
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.csv
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.filt.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.gff
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.html
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.log
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.raw.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.subs.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.tab
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.txt
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz
[08:28:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz.csi
[08:28:47] Walltime used: 19 seconds
[08:28:47] Questionable SNP? Try the --report option to see the alignments.
[08:28:47] Done.
[Tue Jun 16 08:28:47 2020]
Finished job 19.
146 of 206 steps (71%) done

[Tue Jun 16 08:28:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
    jobid: 148
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB8051AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[08:28:47] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:47] This is snippy 4.4.3
[08:28:47] Written by Torsten Seemann
[08:28:47] Obtained from https://github.com/tseemann/snippy
[08:28:47] Detected operating system: linux
[08:28:47] Enabling bundled linux tools.
[08:28:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.769 sec; CPU: 21.866 sec
[samclip] Total SAM records 384504, removed 583, allowed 58, passed 383921
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:47] Found gzip - /usr/bin/gzip
[08:28:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:47] This is snippy 4.4.3
[08:28:47] Written by Torsten Seemann
[08:28:47] Obtained from https://github.com/tseemann/snippy
[08:28:47] Detected operating system: linux
[08:28:47] Enabling bundled linux tools.
[08:28:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:47] Found gzip - /usr/bin/gzip
[08:28:47] Treating reference as 'fasta' format.
[08:28:47] Will use 8 CPU cores.
[08:28:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[08:28:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[08:28:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[08:28:47] Creating reference folder: reference
[08:28:47] Extracting FASTA and GFF from reference.
[08:28:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:48] Wrote 3 sequences to ref.fa
[08:28:48] Wrote 0 features to ref.gff
[08:28:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta into pseudo-reads
[08:28:48] This is snippy 4.4.3
[08:28:48] Written by Torsten Seemann
[08:28:48] Obtained from https://github.com/tseemann/snippy
[08:28:48] Detected operating system: linux
[08:28:48] Enabling bundled linux tools.
[08:28:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:48] Treating reference as 'fasta' format.
[08:28:48] Will use 8 CPU cores.
[08:28:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[08:28:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[08:28:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[08:28:48] Creating reference folder: reference
[08:28:48] Extracting FASTA and GFF from reference.
[08:28:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:48] Found gzip - /usr/bin/gzip
[08:28:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:48] Wrote 3 sequences to ref.fa
[08:28:48] Wrote 0 features to ref.gff
[08:28:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta into pseudo-reads
[08:28:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:48] Treating reference as 'fasta' format.
[08:28:48] Will use 8 CPU cores.
[08:28:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[08:28:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[08:28:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[08:28:48] Creating reference folder: reference
[08:28:48] Extracting FASTA and GFF from reference.
[08:28:48] Wrote 3 sequences to ref.fa
[08:28:48] Wrote 0 features to ref.gff
[08:28:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:48] Running: samtools index snps.bam 2>> snps.log
[08:28:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320068 reads in 17.553 CPU sec, 2.425 real sec
[08:28:49] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[08:28:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 63990 reads in 3.719 CPU sec, 0.429 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.809 sec; CPU: 21.847 sec
[samclip] Total SAM records 384273, removed 658, allowed 66, passed 383615
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:50] Wrote 384132 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:50] Using BAM RG (Read Group) ID: SAL_BB1956AA_AS.out
[08:28:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:50] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:50] Wrote 383942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:50] Using BAM RG (Read Group) ID: SAL_BB4524AA_AS.out
[08:28:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:51] Wrote 383886 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:51] Using BAM RG (Read Group) ID: SAL_FB8051AA_AS.out
[08:28:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:28:51] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:51] Creating extra output files: BED GFF CSV TXT HTML
[08:28:51] Identified 847 variants.
[08:28:51] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[08:28:51] Result files:
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.aligned.fa
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam.bai
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bed
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.fa
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.subs.fa
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.csv
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.filt.vcf
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.gff
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.html
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.log
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.raw.vcf
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.subs.vcf
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.tab
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.txt
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz
[08:28:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz.csi
[08:28:51] Walltime used: 19 seconds
[08:28:51] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:28:51] Done.
[Tue Jun 16 08:28:51 2020]
Finished job 63.
147 of 206 steps (71%) done

[Tue Jun 16 08:28:51 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
    jobid: 64
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB5062AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
[08:28:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:52] This is snippy 4.4.3
[08:28:52] Written by Torsten Seemann
[08:28:52] Obtained from https://github.com/tseemann/snippy
[08:28:52] Detected operating system: linux
[08:28:52] Enabling bundled linux tools.
[08:28:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:28:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:52] Found gzip - /usr/bin/gzip
[08:28:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:52] Running: samtools index snps.bam 2>> snps.log
[08:28:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:52] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:52] Running: rm -f fake_reads\.fq 2>> snps.log
[08:28:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:52] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:52] Treating reference as 'fasta' format.
[08:28:52] Will use 8 CPU cores.
[08:28:52] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
[08:28:52] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[08:28:52] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[08:28:52] Creating reference folder: reference
[08:28:52] Extracting FASTA and GFF from reference.
[08:28:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:28:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:52] Wrote 3 sequences to ref.fa
[08:28:52] Wrote 0 features to ref.gff
[08:28:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta into pseudo-reads
[08:28:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:28:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:28:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:28:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:28:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:53] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320012 sequences (80000380 bp)...
[08:28:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64120 sequences (15987614 bp)...
[M::process] read 320060 sequences (80000366 bp)...
[M::process] read 63826 sequences (15956500 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63942 sequences (15930326 bp)...
[08:28:55] Wrote 383068 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:28:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:28:55] Using BAM RG (Read Group) ID: SAL_BB5062AA_AS.out
[08:28:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:28:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 320012 reads in 17.100 CPU sec, 2.377 real sec

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0[08:28:55] Running: bwa index reference/ref.fa 2>> snps.log


       total no. variants normalized            : 4
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:28:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:28:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:28:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:28:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:28:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320060 reads in 17.933 CPU sec, 2.527 real sec
[08:28:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:28:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.024 CPU sec, 2.449 real sec
[08:28:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:28:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:28:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:28:56] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 64120 reads in 3.746 CPU sec, 0.443 real sec
[samclip] Processed 100000 records...
[08:28:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63826 reads in 4.235 CPU sec, 0.505 real sec
[M::mem_process_seqs] Processed 63942 reads in 3.663 CPU sec, 0.442 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.821 sec; CPU: 21.440 sec
[samclip] Total SAM records 384529, removed 962, allowed 111, passed 383567
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.932 sec; CPU: 22.715 sec
[samclip] Total SAM records 384144, removed 807, allowed 81, passed 383337
[samclip] Header contained 5 lines
[samclip] Done.
[08:28:56] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:57] Creating extra output files: BED GFF CSV TXT HTML
[08:28:57] Identified 24 variants.
[08:28:57] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[08:28:57] Result files:
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.aligned.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam.bai
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bed
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.subs.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.csv
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.filt.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.gff
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.html
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.log
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.raw.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.subs.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.tab
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.txt
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz.csi
[08:28:57] Walltime used: 19 seconds
[08:28:57] Questionable SNP? Try the --report option to see the alignments.
[08:28:57] Done.
[Tue Jun 16 08:28:57 2020]
Finished job 106.
148 of 206 steps (72%) done
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.917 sec; CPU: 21.291 sec
[samclip] Total SAM records 384262, removed 775, allowed 114, passed 383487
[samclip] Header contained 5 lines
[samclip] Done.

[Tue Jun 16 08:28:57 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
    jobid: 101
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB0053AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:28:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:28:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:28:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:28:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:28:57] Marked 0 heterozygous sites with 'n'
[08:28:57] Creating extra output files: BED GFF CSV TXT HTML
[08:28:57] Identified 22 variants.
[08:28:57] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[08:28:57] Result files:
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.aligned.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam.bai
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bed
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.subs.fa
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.csv
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.filt.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.gff
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.html
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.log
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.raw.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.subs.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.tab
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.txt
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz
[08:28:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz.csi
[08:28:57] Walltime used: 18 seconds
[08:28:57] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:28:57] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Tue Jun 16 08:28:57 2020]
Finished job 50.
149 of 206 steps (72%) done

[Tue Jun 16 08:28:57 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
    jobid: 181
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB6812AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63068 sequences (15720238 bp)...
[08:28:57] This is snippy 4.4.3
[08:28:57] Written by Torsten Seemann
[08:28:57] Obtained from https://github.com/tseemann/snippy
[08:28:57] Detected operating system: linux
[08:28:57] Enabling bundled linux tools.
[08:28:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:57] Found gzip - /usr/bin/gzip
[08:28:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:28:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:58] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:58] Treating reference as 'fasta' format.
[08:28:58] Will use 8 CPU cores.
[08:28:58] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[08:28:58] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[08:28:58] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[08:28:58] Creating reference folder: reference
[08:28:58] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:28:58] Wrote 3 sequences to ref.fa
[08:28:58] Wrote 0 features to ref.gff
[08:28:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta into pseudo-reads
[08:28:58] This is snippy 4.4.3
[08:28:58] Written by Torsten Seemann
[08:28:58] Obtained from https://github.com/tseemann/snippy
[08:28:58] Detected operating system: linux
[08:28:58] Enabling bundled linux tools.
[08:28:58] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:28:58] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:28:58] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:28:58] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:28:58] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:28:58] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:28:58] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:28:58] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:28:58] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:28:58] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:28:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:28:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:28:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:28:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:28:58] Found gzip - /usr/bin/gzip
[08:28:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:28:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:28:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:28:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:28:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:28:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:28:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:28:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:28:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:28:58] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:28:58] Treating reference as 'fasta' format.
[08:28:58] Will use 8 CPU cores.
[08:28:58] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[08:28:58] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[08:28:58] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[08:28:58] Creating reference folder: reference
[08:28:58] Extracting FASTA and GFF from reference.
[08:28:58] Running: samtools index snps.bam 2>> snps.log
[08:28:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:58] Wrote 3 sequences to ref.fa
[08:28:58] Wrote 0 features to ref.gff
[08:28:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta into pseudo-reads
[08:28:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:58] Running: samtools index snps.bam 2>> snps.log
[08:28:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:28:58] Running: samtools index snps.bam 2>> snps.log
[08:28:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:28:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:00] Marked 0 heterozygous sites with 'n'
[08:29:00] Creating extra output files: BED GFF CSV TXT HTML
[08:29:00] Identified 22 variants.
[08:29:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
[08:29:00] Result files:
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.aligned.fa
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam.bai
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bed
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.fa
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.subs.fa
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.csv
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.filt.vcf
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.gff
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.html
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.log
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.raw.vcf
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.subs.vcf
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.tab
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.txt
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz
[08:29:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz.csi
[08:29:00] Walltime used: 19 seconds
[08:29:00] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:29:00] Done.
[M::mem_process_seqs] Processed 320000 reads in 17.490 CPU sec, 2.497 real sec
[Tue Jun 16 08:29:00 2020]
Finished job 155.
150 of 206 steps (73%) done

[Tue Jun 16 08:29:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
    jobid: 172
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_VA4537AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63068 reads in 3.832 CPU sec, 0.456 real sec
[samclip] Processed 200000 records...
[08:29:00] Wrote 383198 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:01] Using BAM RG (Read Group) ID: SAL_CB0053AA_AS.out
[08:29:01] Running: samtools faidx reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:01] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out -t 8[samclip] Total SAM records 383216, removed 391, allowed 42, passed 382825
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.949 sec; CPU: 21.899 sec
[08:29:01] This is snippy 4.4.3
[08:29:01] Written by Torsten Seemann
[08:29:01] Obtained from https://github.com/tseemann/snippy
[08:29:01] Detected operating system: linux
[08:29:01] Enabling bundled linux tools.
[08:29:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:01] Found gzip - /usr/bin/gzip
[08:29:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:01] Wrote 382772 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:01] Using BAM RG (Read Group) ID: SAL_EB6812AA_AS.out
[08:29:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:01] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:01] Treating reference as 'fasta' format.
[08:29:01] Will use 8 CPU cores.
[08:29:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[08:29:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[08:29:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[08:29:01] Creating reference folder: reference
[08:29:01] Extracting FASTA and GFF from reference.
[08:29:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:01] Wrote 3 sequences to ref.fa
[08:29:01] Wrote 0 features to ref.gff
[08:29:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta into pseudo-reads
[08:29:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:02] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:02] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:02] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:02] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:02] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320030 sequences (80000202 bp)...
[M::process] read 63168 sequences (15744678 bp)...
[08:29:03] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:03] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:03] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:03] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:03] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:03] Running: samtools index snps.bam 2>> snps.log
[08:29:03] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320154 sequences (80000430 bp)...
[M::process] read 62618 sequences (15639390 bp)...
[08:29:04] Wrote 386146 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:04] Using BAM RG (Read Group) ID: SAL_VA4537AA_AS.out
[08:29:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:04] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320030 reads in 17.075 CPU sec, 2.333 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63168 reads in 3.810 CPU sec, 0.445 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320154 reads in 17.150 CPU sec, 2.426 real sec
[samclip] Processed 300000 records...
[08:29:06] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[08:29:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:06] Creating extra output files: BED GFF CSV TXT HTML
[08:29:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:06] Identified 29 variants.
[08:29:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[08:29:06] Result files:
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.aligned.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam.bai
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bed
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.subs.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.csv
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.filt.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.gff
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.html
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.log
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.raw.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.subs.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.tab
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.txt
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz.csi
[08:29:06] Walltime used: 19 seconds
[08:29:06] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:06] Done.
[08:29:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[Tue Jun 16 08:29:06 2020]
Finished job 26.
151 of 206 steps (73%) done

[Tue Jun 16 08:29:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
    jobid: 124
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA1940AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[08:29:06] Marked 0 heterozygous sites with 'n'
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 62618 reads in 3.416 CPU sec, 0.400 real sec

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 62
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:06] Creating extra output files: BED GFF CSV TXT HTML
[08:29:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:06] Identified 22 variants.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.708 sec; CPU: 21.437 sec
[samclip] Total SAM records 383409, removed 657, allowed 121, passed 382752
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[08:29:06] Result files:
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.aligned.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam.bai
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bed
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.subs.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.csv
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.filt.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.gff
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.html
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.log
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.raw.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.subs.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.tab
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.txt
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz.csi
[08:29:06] Walltime used: 18 seconds
[08:29:06] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:29:06] Done.
[08:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[Tue Jun 16 08:29:06 2020]
Finished job 148.
152 of 206 steps (74%) done

[Tue Jun 16 08:29:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
    jobid: 72
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB6250AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[08:29:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320090 sequences (80000322 bp)...
[08:29:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 66056 sequences (16510148 bp)...
[08:29:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:06] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[08:29:06] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:06] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:06] Creating extra output files: BED GFF CSV TXT HTML
[08:29:06] Identified 15 variants.
[08:29:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[08:29:06] Result files:
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.aligned.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam.bai
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bed
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.subs.fa
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.csv
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.filt.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.gff
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.html
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.log
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.raw.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.subs.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.tab
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.txt
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz
[08:29:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz.csi
[08:29:06] Walltime used: 19 seconds
[08:29:06] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:29:06] Done.
[Tue Jun 16 08:29:06 2020]
Finished job 102.
153 of 206 steps (74%) done

[Tue Jun 16 08:29:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
    jobid: 142
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PA3767AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.823 sec; CPU: 21.158 sec
[samclip] Total SAM records 383012, removed 642, allowed 66, passed 382370
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:07] This is snippy 4.4.3
[08:29:07] Written by Torsten Seemann
[08:29:07] Obtained from https://github.com/tseemann/snippy
[08:29:07] Detected operating system: linux
[08:29:07] Enabling bundled linux tools.
[08:29:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:07] Found gzip - /usr/bin/gzip
[08:29:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:07] This is snippy 4.4.3
[08:29:07] Written by Torsten Seemann
[08:29:07] Obtained from https://github.com/tseemann/snippy
[08:29:07] Detected operating system: linux
[08:29:07] Enabling bundled linux tools.
[08:29:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:07] Found gzip - /usr/bin/gzip
[08:29:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:07] Treating reference as 'fasta' format.
[08:29:07] Will use 8 CPU cores.
[08:29:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[08:29:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[08:29:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[08:29:07] Creating reference folder: reference
[08:29:07] Extracting FASTA and GFF from reference.
[08:29:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:07] Treating reference as 'fasta' format.
[08:29:07] Will use 8 CPU cores.
[08:29:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[08:29:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[08:29:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[08:29:07] Creating reference folder: reference
[08:29:07] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:07] Wrote 3 sequences to ref.fa
[08:29:07] Wrote 0 features to ref.gff
[08:29:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta into pseudo-reads
[08:29:07] Wrote 3 sequences to ref.fa
[08:29:07] Wrote 0 features to ref.gff
[08:29:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta into pseudo-reads
[08:29:07] This is snippy 4.4.3
[08:29:07] Written by Torsten Seemann
[08:29:07] Obtained from https://github.com/tseemann/snippy
[08:29:07] Detected operating system: linux
[08:29:07] Enabling bundled linux tools.
[08:29:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:07] Found gzip - /usr/bin/gzip
[08:29:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:07] Treating reference as 'fasta' format.
[08:29:07] Will use 8 CPU cores.
[08:29:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
[08:29:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[08:29:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[08:29:07] Creating reference folder: reference
[08:29:07] Extracting FASTA and GFF from reference.
[08:29:08] Wrote 3 sequences to ref.fa
[08:29:08] Wrote 0 features to ref.gff
[08:29:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:08] Running: samtools index snps.bam 2>> snps.log
[08:29:08] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:09] Running: samtools index snps.bam 2>> snps.log
[08:29:09] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320090 reads in 18.841 CPU sec, 2.511 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66056 reads in 3.971 CPU sec, 0.461 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 386415, removed 1281, allowed 219, passed 385134
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.896 sec; CPU: 23.366 sec
[08:29:10] Wrote 387290 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:10] Using BAM RG (Read Group) ID: SAL_FA1940AA_AS.out
[08:29:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:10] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:10] Wrote 382802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:10] Using BAM RG (Read Group) ID: SAL_CB6250AA_AS.out
[08:29:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:10] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:10] Wrote 385754 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:10] Using BAM RG (Read Group) ID: SAL_PA3767AA_AS.out
[08:29:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:10] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:11] Marked 0 heterozygous sites with 'n'
[08:29:11] Creating extra output files: BED GFF CSV TXT HTML
[08:29:11] Identified 62 variants.
[08:29:11] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[08:29:11] Result files:
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.aligned.fa
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam.bai
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bed
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.fa
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.subs.fa
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.csv
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.filt.vcf
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.gff
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.html
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.log
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.raw.vcf
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.subs.vcf
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.tab
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.txt
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz
[08:29:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz.csi
[08:29:11] Walltime used: 19 seconds
[08:29:11] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:29:11] Done.
[Tue Jun 16 08:29:11 2020]
Finished job 64.
154 of 206 steps (75%) done

[Tue Jun 16 08:29:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
    jobid: 97
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_GB0225AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:11] This is snippy 4.4.3
[08:29:11] Written by Torsten Seemann
[08:29:11] Obtained from https://github.com/tseemann/snippy
[08:29:11] Detected operating system: linux
[08:29:11] Enabling bundled linux tools.
[08:29:11] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:11] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:11] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:11] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:11] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:11] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:11] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:11] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:11] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:11] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:11] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:11] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:11] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:11] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:11] Found gzip - /usr/bin/gzip
[08:29:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:11] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:11] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:11] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:11] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:11] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:11] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:11] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:11] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:12] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:12] Treating reference as 'fasta' format.
[08:29:12] Will use 8 CPU cores.
[08:29:12] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[08:29:12] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[08:29:12] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[08:29:12] Creating reference folder: reference
[08:29:12] Extracting FASTA and GFF from reference.
[08:29:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:12] Wrote 3 sequences to ref.fa
[08:29:12] Wrote 0 features to ref.gff
[08:29:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta into pseudo-reads
[08:29:12] Running: samtools index snps.bam 2>> snps.log
[08:29:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:29:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:29:12] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:12] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:29:12] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:12] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:12] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 320084 sequences (80000418 bp)...
[08:29:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 67206 sequences (16796958 bp)...
[M::process] read 320016 sequences (80000024 bp)...
[M::process] read 62786 sequences (15639610 bp)...
[M::process] read 320114 sequences (80000118 bp)...
[M::process] read 65640 sequences (16400950 bp)...
[08:29:14] Wrote 381952 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:14] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:14] Using BAM RG (Read Group) ID: SAL_GB0225AA_AS.out
[08:29:14] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:14] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320016 reads in 16.815 CPU sec, 2.306 real sec
[M::mem_process_seqs] Processed 320084 reads in 18.658 CPU sec, 2.533 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 62786 reads in 3.617 CPU sec, 0.426 real sec
[08:29:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1781
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:29:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 67206 reads in 4.070 CPU sec, 0.475 real sec
[samclip] Processed 200000 records...
[08:29:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320114 reads in 19.773 CPU sec, 2.786 real sec
[08:29:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:29:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:29:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] Processed 100000 records...
[08:29:16] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.755 sec; CPU: 21.018 sec
[samclip] Total SAM records 382942, removed 640, allowed 72, passed 382302
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.937 sec; CPU: 23.281 sec
[samclip] Total SAM records 387568, removed 2133, allowed 398, passed 385435
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:16] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 65640 reads in 4.111 CPU sec, 0.472 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:16] Creating extra output files: BED GFF CSV TXT HTML
[08:29:16] Identified 29 variants.
[08:29:16] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[08:29:16] Result files:
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.aligned.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam.bai
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bed
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.subs.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.csv
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.filt.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.gff
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.html
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.log
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.raw.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.subs.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.tab
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.txt
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz.csi
[08:29:16] Walltime used: 19 seconds
[08:29:16] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:29:16] Done.
[Tue Jun 16 08:29:16 2020]
Finished job 101.
155 of 206 steps (75%) done

[Tue Jun 16 08:29:16 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
    jobid: 61
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:29:16] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:16] Marked 0 heterozygous sites with 'n'
[08:29:16] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:16] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:16] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:16] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:16] Creating extra output files: BED GFF CSV TXT HTML
[08:29:16] Identified 26 variants.
[08:29:16] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[08:29:16] Result files:
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.aligned.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam.bai
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bed
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.subs.fa
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.csv
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.filt.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.gff
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.html
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.log
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.raw.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.subs.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.tab
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.txt
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz
[08:29:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz.csi
[08:29:16] Walltime used: 18 seconds
[08:29:16] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:16] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.165 sec; CPU: 24.438 sec
[samclip] Total SAM records 385939, removed 1166, allowed 215, passed 384773
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 08:29:16 2020]
Finished job 181.
156 of 206 steps (76%) done

[Tue Jun 16 08:29:16 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
    jobid: 88
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OB6949AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:17] This is snippy 4.4.3
[08:29:17] Written by Torsten Seemann
[08:29:17] Obtained from https://github.com/tseemann/snippy
[08:29:17] Detected operating system: linux
[08:29:17] Enabling bundled linux tools.
[08:29:17] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:17] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:17] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:17] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:17] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:17] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:17] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:17] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:17] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:17] Found gzip - /usr/bin/gzip
[08:29:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320076 sequences (80000300 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 61876 sequences (15469000 bp)...
[08:29:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:17] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:17] Treating reference as 'fasta' format.
[08:29:17] Will use 8 CPU cores.
[08:29:17] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[08:29:17] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[08:29:17] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[08:29:17] Creating reference folder: reference
[08:29:17] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:17] Wrote 3 sequences to ref.fa
[08:29:17] Wrote 0 features to ref.gff
[08:29:17] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta into pseudo-reads
[08:29:17] This is snippy 4.4.3
[08:29:17] Written by Torsten Seemann
[08:29:17] Obtained from https://github.com/tseemann/snippy
[08:29:17] Detected operating system: linux
[08:29:17] Enabling bundled linux tools.
[08:29:17] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:17] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:17] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:17] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:17] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:17] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:17] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:17] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:17] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:17] Found gzip - /usr/bin/gzip
[08:29:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:17] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:17] Treating reference as 'fasta' format.
[08:29:17] Will use 8 CPU cores.
[08:29:17] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
[08:29:17] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[08:29:17] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[08:29:17] Creating reference folder: reference
[08:29:17] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:18] Wrote 3 sequences to ref.fa
[08:29:18] Wrote 0 features to ref.gff
[08:29:18] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta into pseudo-reads
[08:29:18] Running: samtools index snps.bam 2>> snps.log
[08:29:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:18] Running: samtools index snps.bam 2>> snps.log
[08:29:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:18] Running: samtools index snps.bam 2>> snps.log
[08:29:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320076 reads in 16.923 CPU sec, 2.417 real sec
[M::mem_process_seqs] Processed 61876 reads in 3.352 CPU sec, 0.418 real sec
[samclip] Processed 100000 records...
[08:29:20] Wrote 385818 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:20] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:20] Using BAM RG (Read Group) ID: SAL_CA4744AA_AS.out
[08:29:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:20] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:29:20] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:29:20] Creating extra output files: BED GFF CSV TXT HTML
[08:29:20] Identified 1781 variants.
[08:29:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[08:29:20] Result files:
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.aligned.fa
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam.bai
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bed
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.fa
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.subs.fa
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.csv
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.filt.vcf
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.gff
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.html
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.log
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.raw.vcf
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.subs.vcf
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.tab
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.txt
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz
[08:29:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz.csi
[08:29:20] Walltime used: 19 seconds
[08:29:20] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:20] Done.
[Tue Jun 16 08:29:20 2020]
Finished job 172.
157 of 206 steps (76%) done

[Tue Jun 16 08:29:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
    jobid: 47
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9330AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[08:29:20] Wrote 381814 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:20] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:20] Using BAM RG (Read Group) ID: SAL_OB6949AA_AS.out
[08:29:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:20] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.988 sec; CPU: 20.909 sec
[samclip] Total SAM records 382179, removed 672, allowed 60, passed 381507
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:21] This is snippy 4.4.3
[08:29:21] Written by Torsten Seemann
[08:29:21] Obtained from https://github.com/tseemann/snippy
[08:29:21] Detected operating system: linux
[08:29:21] Enabling bundled linux tools.
[08:29:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:21] Found gzip - /usr/bin/gzip
[08:29:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:21] Treating reference as 'fasta' format.
[08:29:21] Will use 8 CPU cores.
[08:29:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[08:29:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[08:29:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[08:29:21] Creating reference folder: reference
[08:29:21] Extracting FASTA and GFF from reference.
[08:29:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:21] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:21] Wrote 3 sequences to ref.fa
[08:29:21] Wrote 0 features to ref.gff
[08:29:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta into pseudo-reads
[08:29:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1889
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:29:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:22] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1818
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:29:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:22] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320062 sequences (80000348 bp)...
[08:29:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 65756 sequences (16430214 bp)...
[08:29:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:22] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:29:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:22] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:22] Running: samtools index snps.bam 2>> snps.log
[08:29:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 61814 sequences (15447022 bp)...
[08:29:24] Wrote 393650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:24] Using BAM RG (Read Group) ID: SAL_SA9330AA_AS.out
[08:29:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:24] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320062 reads in 17.409 CPU sec, 2.281 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65756 reads in 4.184 CPU sec, 0.484 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 19.005 CPU sec, 2.597 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.669 sec; CPU: 22.130 sec
[samclip] Total SAM records 386081, removed 1419, allowed 302, passed 384662
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:25] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:25] Creating extra output files: BED GFF CSV TXT HTML
[08:29:25] Identified 100 variants.
[08:29:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[08:29:25] Result files:
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.aligned.fa
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam.bai
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bed
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.fa
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.subs.fa
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.csv
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.filt.vcf
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.gff
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.html
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.log
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.raw.vcf
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.subs.vcf
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.tab
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.txt
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz
[08:29:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz.csi
[08:29:25] Walltime used: 18 seconds
[08:29:25] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:29:25] Done.
[08:29:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[Tue Jun 16 08:29:25 2020]
Finished job 72.
158 of 206 steps (77%) done

[Tue Jun 16 08:29:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
    jobid: 192
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB5221AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[08:29:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 61814 reads in 4.034 CPU sec, 0.466 real sec
[08:29:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[08:29:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:26] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[08:29:26] Marked 22 heterozygous sites with 'n'
[08:29:26] This is snippy 4.4.3
[08:29:26] Written by Torsten Seemann
[08:29:26] Obtained from https://github.com/tseemann/snippy
[08:29:26] Detected operating system: linux
[08:29:26] Enabling bundled linux tools.
[08:29:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:26] Creating extra output files: BED GFF CSV TXT HTML
[08:29:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:26] Identified 1889 variants.
[08:29:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[08:29:26] Result files:
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.aligned.fa
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam.bai
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bed
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.fa
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.subs.fa
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.csv
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.filt.vcf
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.gff
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.html
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.log
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.raw.vcf
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.subs.vcf
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.tab
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.txt
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz
[08:29:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz.csi
[08:29:26] Walltime used: 19 seconds
[08:29:26] May the SNPs be with you.
[08:29:26] Done.
[08:29:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:26] Found gzip - /usr/bin/gzip
[08:29:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[Tue Jun 16 08:29:26 2020]
Finished job 124.
159 of 206 steps (77%) done
[08:29:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report

[Tue Jun 16 08:29:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
    jobid: 191
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA1119AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
[08:29:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.975 sec; CPU: 23.600 sec
[samclip] Total SAM records 382038, removed 796, allowed 164, passed 381242
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320180 sequences (80000496 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::process] read 73470 sequences (18340998 bp)...
[08:29:26] Treating reference as 'fasta' format.
[08:29:26] Will use 8 CPU cores.
[08:29:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
[08:29:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[08:29:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[08:29:26] Creating reference folder: reference
[08:29:26] Extracting FASTA and GFF from reference.
[08:29:26] Marked 0 heterozygous sites with 'n'
[08:29:27] Wrote 3 sequences to ref.fa
[08:29:27] Wrote 0 features to ref.gff
[08:29:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta into pseudo-reads
[08:29:27] Creating extra output files: BED GFF CSV TXT HTML
[08:29:27] Identified 1818 variants.
[08:29:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[08:29:27] Result files:
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.aligned.fa
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam.bai
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bed
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.fa
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.subs.fa
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.csv
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.filt.vcf
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.gff
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.html
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.log
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.raw.vcf
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.subs.vcf
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.tab
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.txt
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz
[08:29:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz.csi
[08:29:27] Walltime used: 20 seconds
[08:29:27] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:27] Done.
[Tue Jun 16 08:29:27 2020]
Finished job 142.
160 of 206 steps (78%) done

[Tue Jun 16 08:29:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
    jobid: 43
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9246AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:27] This is snippy 4.4.3
[08:29:27] Written by Torsten Seemann
[08:29:27] Obtained from https://github.com/tseemann/snippy
[08:29:27] Detected operating system: linux
[08:29:27] Enabling bundled linux tools.
[08:29:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:27] Found gzip - /usr/bin/gzip
[08:29:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:27] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:27] Treating reference as 'fasta' format.
[08:29:27] Will use 8 CPU cores.
[08:29:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
[08:29:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[08:29:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[08:29:27] Creating reference folder: reference
[08:29:27] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:27] This is snippy 4.4.3
[08:29:27] Written by Torsten Seemann
[08:29:27] Obtained from https://github.com/tseemann/snippy
[08:29:27] Detected operating system: linux
[08:29:27] Enabling bundled linux tools.
[08:29:27] Running: samtools index snps.bam 2>> snps.log
[08:29:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:27] Wrote 3 sequences to ref.fa
[08:29:27] Wrote 0 features to ref.gff
[08:29:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta into pseudo-reads
[08:29:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:27] Found gzip - /usr/bin/gzip
[08:29:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:27] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:27] Treating reference as 'fasta' format.
[08:29:27] Will use 8 CPU cores.
[08:29:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
[08:29:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[08:29:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[08:29:27] Creating reference folder: reference
[08:29:27] Extracting FASTA and GFF from reference.
[08:29:28] Wrote 3 sequences to ref.fa
[08:29:28] Wrote 0 features to ref.gff
[08:29:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta into pseudo-reads
[08:29:28] Running: samtools index snps.bam 2>> snps.log
[08:29:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320180 reads in 17.838 CPU sec, 2.408 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 73470 reads in 4.351 CPU sec, 0.506 real sec
[08:29:29] Wrote 384312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:29] Using BAM RG (Read Group) ID: SAL_JB5221AA_AS.out
[08:29:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:29] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.926 sec; CPU: 22.756 sec
[samclip] Total SAM records 393741, removed 505, allowed 55, passed 393236
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:30] Marked 0 heterozygous sites with 'n'
[08:29:30] Creating extra output files: BED GFF CSV TXT HTML
[08:29:30] Identified 22 variants.
[08:29:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[08:29:30] Result files:
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.aligned.fa
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam.bai
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bed
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.fa
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.subs.fa
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.csv
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.filt.vcf
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.gff
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.html
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.log
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.raw.vcf
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.subs.vcf
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.tab
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.txt
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz
[08:29:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz.csi
[08:29:30] Walltime used: 19 seconds
[08:29:30] Wishing you a life free of homopolymer errors.
[08:29:30] Done.
[Tue Jun 16 08:29:30 2020]
Finished job 97.
161 of 206 steps (78%) done

[Tue Jun 16 08:29:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
    jobid: 127
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA0984AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[08:29:30] Wrote 385860 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:30] Wrote 386028 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:30] Using BAM RG (Read Group) ID: SAL_SA9246AA_AS.out
[08:29:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:30] Using BAM RG (Read Group) ID: SAL_KA1119AA_AS.out
[08:29:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:30] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:30] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1908
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:29:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:31] This is snippy 4.4.3
[08:29:31] Written by Torsten Seemann
[08:29:31] Obtained from https://github.com/tseemann/snippy
[08:29:31] Detected operating system: linux
[08:29:31] Enabling bundled linux tools.
[08:29:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:31] Found gzip - /usr/bin/gzip
[08:29:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:29:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:31] Treating reference as 'fasta' format.
[08:29:31] Will use 8 CPU cores.
[08:29:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[08:29:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[08:29:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[08:29:31] Creating reference folder: reference
[08:29:31] Extracting FASTA and GFF from reference.
[08:29:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:31] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:31] Wrote 3 sequences to ref.fa
[08:29:31] Wrote 0 features to ref.gff
[08:29:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta into pseudo-reads
[M::process] read 320032 sequences (80000340 bp)...
[08:29:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 64280 sequences (16070000 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1708
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:29:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:32] Running: samtools index snps.bam 2>> snps.log
[08:29:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:32] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:29:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:29:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320276 sequences (80000470 bp)...
[M::process] read 320236 sequences (80000442 bp)...
[M::process] read 65624 sequences (16391106 bp)...
[M::process] read 65752 sequences (16413928 bp)...
[08:29:34] Wrote 385598 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:34] Using BAM RG (Read Group) ID: SAL_KA0984AA_AS.out
[08:29:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:34] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320032 reads in 18.151 CPU sec, 2.827 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64280 reads in 4.035 CPU sec, 0.477 real sec
[08:29:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 116
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[08:29:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:29:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:35] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320236 reads in 17.522 CPU sec, 2.504 real sec
[M::mem_process_seqs] Processed 320276 reads in 18.051 CPU sec, 2.538 real sec
[08:29:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.358 sec; CPU: 22.803 sec
[samclip] Total SAM records 384410, removed 587, allowed 42, passed 383823
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[08:29:36] Marked 0 heterozygous sites with 'n'
[08:29:36] Creating extra output files: BED GFF CSV TXT HTML
[08:29:36] Identified 1908 variants.
[08:29:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[08:29:36] Result files:
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.aligned.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam.bai
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bed
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.subs.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.csv
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.filt.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.gff
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.html
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.log
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.raw.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.subs.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.tab
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.txt
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz.csi
[08:29:36] Walltime used: 19 seconds
[08:29:36] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:36] Done.
[Tue Jun 16 08:29:36 2020]
Finished job 61.
162 of 206 steps (79%) done

[Tue Jun 16 08:29:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
    jobid: 98
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA7932AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
[M::mem_process_seqs] Processed 65752 reads in 3.945 CPU sec, 0.458 real sec
[M::mem_process_seqs] Processed 65624 reads in 4.155 CPU sec, 0.483 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[08:29:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:36] Marked 0 heterozygous sites with 'n'
[M::process] read 320104 sequences (80000368 bp)...
[08:29:36] Creating extra output files: BED GFF CSV TXT HTML
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.897 sec; CPU: 22.234 sec
[samclip] Total SAM records 386177, removed 759, allowed 180, passed 385418
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:36] Identified 1708 variants.
[08:29:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[08:29:36] Result files:
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.aligned.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam.bai
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bed
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.subs.fa
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.csv
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.filt.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.gff
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.html
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.log
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.raw.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.subs.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.tab
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.txt
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz
[08:29:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz.csi
[08:29:36] Walltime used: 19 seconds
[08:29:36] May the SNPs be with you.
[08:29:36] Done.
[Tue Jun 16 08:29:36 2020]
Finished job 88.
163 of 206 steps (79%) done

[Tue Jun 16 08:29:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
    jobid: 27
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB3640AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.961 sec; CPU: 22.581 sec
[samclip] Total SAM records 386267, removed 676, allowed 238, passed 385591
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 65494 sequences (16362658 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:36] This is snippy 4.4.3
[08:29:36] Written by Torsten Seemann
[08:29:36] Obtained from https://github.com/tseemann/snippy
[08:29:36] Detected operating system: linux
[08:29:36] Enabling bundled linux tools.
[08:29:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:37] Found gzip - /usr/bin/gzip
[08:29:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:37] Treating reference as 'fasta' format.
[08:29:37] Will use 8 CPU cores.
[08:29:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
[08:29:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[08:29:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[08:29:37] Creating reference folder: reference
[08:29:37] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:37] Wrote 3 sequences to ref.fa
[08:29:37] Wrote 0 features to ref.gff
[08:29:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta into pseudo-reads
[08:29:37] This is snippy 4.4.3
[08:29:37] Written by Torsten Seemann
[08:29:37] Obtained from https://github.com/tseemann/snippy
[08:29:37] Detected operating system: linux
[08:29:37] Enabling bundled linux tools.
[08:29:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:37] Found gzip - /usr/bin/gzip
[08:29:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:37] Treating reference as 'fasta' format.
[08:29:37] Will use 8 CPU cores.
[08:29:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[08:29:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[08:29:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[08:29:37] Creating reference folder: reference
[08:29:37] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:37] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:37] Wrote 3 sequences to ref.fa
[08:29:37] Wrote 0 features to ref.gff
[08:29:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta into pseudo-reads
[08:29:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:38] Running: samtools index snps.bam 2>> snps.log
[08:29:38] Running: samtools index snps.bam 2>> snps.log
[08:29:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320104 reads in 16.462 CPU sec, 2.199 real sec
[M::mem_process_seqs] Processed 65494 reads in 3.523 CPU sec, 0.435 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:29:40] Marked 0 heterozygous sites with 'n'
[08:29:40] Creating extra output files: BED GFF CSV TXT HTML
[08:29:40] Identified 116 variants.
[08:29:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[08:29:40] Result files:
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.aligned.fa
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam.bai
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bed
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.fa
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.subs.fa
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.csv
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.filt.vcf
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.gff
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.html
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.log
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.raw.vcf
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.subs.vcf
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.tab
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.txt
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz
[08:29:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz.csi
[08:29:40] Walltime used: 19 seconds
[08:29:40] May the SNPs be with you.
[08:29:40] Done.
[08:29:40] Wrote 387022 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:40] Using BAM RG (Read Group) ID: SAL_BA7932AA_AS.out
[Tue Jun 16 08:29:40 2020]
Finished job 47.
164 of 206 steps (80%) done
[08:29:40] Running: samtools faidx reference/ref.fa 2>> snps.log

[Tue Jun 16 08:29:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
    jobid: 103
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA3156AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.768 sec; CPU: 20.615 sec
[samclip] Total SAM records 385989, removed 1810, allowed 301, passed 384179
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:40] Wrote 384090 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:40] Using BAM RG (Read Group) ID: SAL_KB3640AA_AS.out
[08:29:40] Running: samtools faidx reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:40] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 70
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:41] This is snippy 4.4.3
[08:29:41] Written by Torsten Seemann
[08:29:41] Obtained from https://github.com/tseemann/snippy
[08:29:41] Detected operating system: linux
[08:29:41] Enabling bundled linux tools.
[08:29:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:41] Found gzip - /usr/bin/gzip
[08:29:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:41] Treating reference as 'fasta' format.
[08:29:41] Will use 8 CPU cores.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
[08:29:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[08:29:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[08:29:41] Creating reference folder: reference
[08:29:41] Extracting FASTA and GFF from reference.
[08:29:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:41] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:41] Wrote 3 sequences to ref.fa
[08:29:41] Wrote 0 features to ref.gff
[08:29:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta into pseudo-reads
[08:29:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:29:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:29:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:42] Running: samtools index snps.bam 2>> snps.log
[08:29:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:42] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320016 sequences (80000392 bp)...
[08:29:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 67006 sequences (16751500 bp)...
[08:29:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 64090 sequences (16022500 bp)...
[08:29:44] Wrote 385394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:44] Using BAM RG (Read Group) ID: SAL_XA3156AA_AS.out
[08:29:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:44] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320016 reads in 17.436 CPU sec, 2.381 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67006 reads in 4.009 CPU sec, 0.467 real sec
[08:29:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] Processed 200000 records...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 320000 reads in 17.053 CPU sec, 2.399 real sec

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 2
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 234
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:45] Marked 0 heterozygous sites with 'n'
[08:29:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:45] Creating extra output files: BED GFF CSV TXT HTML
[08:29:45] Identified 70 variants.
[08:29:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[08:29:45] Result files:
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.aligned.fa
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam.bai
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bed
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.fa
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.subs.fa
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.csv
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.filt.vcf
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.gff
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.html
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.log
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.raw.vcf
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.subs.vcf
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.tab
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.txt
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz
[08:29:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz.csi
[08:29:45] Walltime used: 19 seconds
[08:29:45] Questionable SNP? Try the --report option to see the alignments.
[08:29:45] Done.
[08:29:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[Tue Jun 16 08:29:45 2020]
Finished job 192.
165 of 206 steps (80%) done

[Tue Jun 16 08:29:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
    jobid: 51
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2899AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
[samclip] Processed 300000 records...
[08:29:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[08:29:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::mem_process_seqs] Processed 64090 reads in 3.851 CPU sec, 0.445 real sec
[08:29:45] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.797 sec; CPU: 22.013 sec
[samclip] Total SAM records 387279, removed 2243, allowed 481, passed 385036
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[08:29:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[08:29:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:46] This is snippy 4.4.3
[08:29:46] Written by Torsten Seemann
[08:29:46] Obtained from https://github.com/tseemann/snippy
[08:29:46] Detected operating system: linux
[08:29:46] Enabling bundled linux tools.
[08:29:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:29:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:29:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:46] Found gzip - /usr/bin/gzip
[08:29:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.783 sec; CPU: 21.473 sec
[samclip] Total SAM records 384260, removed 823, allowed 90, passed 383437
[samclip] Header contained 5 lines
[samclip] Done.
[08:29:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:46] Marked 0 heterozygous sites with 'n'
[08:29:46] Creating extra output files: BED GFF CSV TXT HTML
[08:29:46] Marked 0 heterozygous sites with 'n'
[08:29:46] Identified 13 variants.
[08:29:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[08:29:46] Result files:
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.aligned.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam.bai
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bed
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.subs.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.csv
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.filt.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.gff
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.html
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.log
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.raw.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.subs.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.tab
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.txt
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz.csi
[08:29:46] Walltime used: 19 seconds
[08:29:46] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:29:46] Done.
[08:29:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[Tue Jun 16 08:29:46 2020]
Finished job 191.
166 of 206 steps (81%) done

[Tue Jun 16 08:29:46 2020]
[08:29:46] Treating reference as 'fasta' format.
[08:29:46] Will use 8 CPU cores.
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
    jobid: 150
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA5244AA_AS
    threads: 5

[08:29:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[08:29:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[08:29:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[08:29:46] Creating reference folder: reference
[08:29:46] Extracting FASTA and GFF from reference.
[08:29:46] Creating extra output files: BED GFF CSV TXT HTML
[08:29:46] Identified 21 variants.
[08:29:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[08:29:46] Result files:
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.aligned.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam.bai
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bed
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.subs.fa
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.csv
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.filt.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.gff
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.html
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.log
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.raw.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.subs.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.tab
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.txt
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz
[08:29:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz.csi
[08:29:46] Walltime used: 19 seconds
[08:29:46] Wishing you a life free of homopolymer errors.
[08:29:46] Done.
[Tue Jun 16 08:29:46 2020]
Finished job 43.
167 of 206 steps (81%) done

[Tue Jun 16 08:29:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
    jobid: 120
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB8607AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[M::process] read 320482 sequences (80000282 bp)...
[08:29:46] Wrote 3 sequences to ref.fa
[08:29:46] Wrote 0 features to ref.gff
[08:29:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta into pseudo-reads
[M::process] read 64912 sequences (16226712 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:47] This is snippy 4.4.3
[08:29:47] Written by Torsten Seemann
[08:29:47] Obtained from https://github.com/tseemann/snippy
[08:29:47] Detected operating system: linux
[08:29:47] Enabling bundled linux tools.
[08:29:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:47] Found gzip - /usr/bin/gzip
[08:29:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:47] This is snippy 4.4.3
[08:29:47] Written by Torsten Seemann
[08:29:47] Obtained from https://github.com/tseemann/snippy
[08:29:47] Detected operating system: linux
[08:29:47] Enabling bundled linux tools.
[08:29:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:47] Found gzip - /usr/bin/gzip
[08:29:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:47] Treating reference as 'fasta' format.
[08:29:47] Will use 8 CPU cores.
[08:29:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[08:29:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[08:29:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[08:29:47] Creating reference folder: reference
[08:29:47] Extracting FASTA and GFF from reference.
[08:29:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:47] Treating reference as 'fasta' format.
[08:29:47] Will use 8 CPU cores.
[08:29:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[08:29:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[08:29:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[08:29:47] Creating reference folder: reference
[08:29:47] Extracting FASTA and GFF from reference.
[08:29:47] Wrote 3 sequences to ref.fa
[08:29:47] Wrote 0 features to ref.gff
[08:29:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta into pseudo-reads
[08:29:47] Wrote 3 sequences to ref.fa
[08:29:47] Wrote 0 features to ref.gff
[08:29:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta into pseudo-reads
[08:29:47] Running: samtools index snps.bam 2>> snps.log
[08:29:47] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:48] Running: samtools index snps.bam 2>> snps.log
[08:29:48] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:48] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320482 reads in 17.973 CPU sec, 2.463 real sec
[samclip] Processed 100000 records...
[08:29:49] Wrote 380182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:49] Using BAM RG (Read Group) ID: SAL_BB2899AA_AS.out
[08:29:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:49] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 64912 reads in 3.864 CPU sec, 0.448 real sec
[samclip] Processed 200000 records...
[08:29:49] Marked 41 heterozygous sites with 'n'
[08:29:49] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 300000 records...
[08:29:49] Identified 234 variants.
[08:29:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[08:29:49] Result files:
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.aligned.fa
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam.bai
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bed
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.fa
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.subs.fa
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.csv
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.filt.vcf
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.gff
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.html
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.log
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.raw.vcf
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.subs.vcf
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.tab
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.txt
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz
[08:29:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz.csi
[08:29:49] Walltime used: 18 seconds
[08:29:49] Wishing you a life free of homopolymer errors.
[08:29:49] Done.
[Tue Jun 16 08:29:50 2020]
Finished job 127.
168 of 206 steps (82%) done

[Tue Jun 16 08:29:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
    jobid: 137
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_RA1578AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.939 sec; CPU: 22.426 sec
[samclip] Total SAM records 385802, removed 1041, allowed 135, passed 384761
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:50] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:50] Using BAM RG (Read Group) ID: SAL_KA5244AA_AS.out
[08:29:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:50] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:50] Wrote 379750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:51] Using BAM RG (Read Group) ID: SAL_KB8607AA_AS.out
[08:29:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:51] This is snippy 4.4.3
[08:29:51] Written by Torsten Seemann
[08:29:51] Obtained from https://github.com/tseemann/snippy
[08:29:51] Detected operating system: linux
[08:29:51] Enabling bundled linux tools.
[08:29:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:29:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:51] Found gzip - /usr/bin/gzip
[08:29:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:29:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:51] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:51] Treating reference as 'fasta' format.
[08:29:51] Will use 8 CPU cores.
[08:29:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[08:29:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[08:29:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[08:29:51] Creating reference folder: reference
[08:29:51] Extracting FASTA and GFF from reference.
[08:29:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:29:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:51] Wrote 3 sequences to ref.fa
[08:29:51] Wrote 0 features to ref.gff
[08:29:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta into pseudo-reads
[08:29:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[08:29:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 60182 sequences (15045500 bp)...
[08:29:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:51] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:52] Running: samtools index snps.bam 2>> snps.log
[08:29:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:29:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:29:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:29:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:29:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320220 sequences (80000454 bp)...
[M::process] read 64386 sequences (16095548 bp)...
[M::process] read 320006 sequences (80000192 bp)...
[M::process] read 59744 sequences (14936000 bp)...
[M::mem_process_seqs] Processed 320000 reads in 17.095 CPU sec, 2.497 real sec
[08:29:54] Wrote 384808 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:54] Using BAM RG (Read Group) ID: SAL_RA1578AA_AS.out
[08:29:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:54] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 60182 reads in 3.386 CPU sec, 0.408 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.020 sec; CPU: 21.117 sec
[samclip] Total SAM records 380347, removed 432, allowed 42, passed 379915
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:29:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:29:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:29:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320220 reads in 17.810 CPU sec, 2.483 real sec
[08:29:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:29:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:29:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:29:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:29:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:29:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:29:55] Marked 0 heterozygous sites with 'n'
[08:29:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:29:55] Running: rm -f fake_reads\.fq 2>> snps.log
[08:29:55] Creating extra output files: BED GFF CSV TXT HTML
[08:29:55] Identified 20 variants.
[08:29:55] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[08:29:55] Result files:
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.aligned.fa
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam.bai
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bed
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.fa
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.subs.fa
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.csv
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.filt.vcf
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.gff
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.html
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.log
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.raw.vcf
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.subs.vcf
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.tab
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.txt
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz
[08:29:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz.csi
[08:29:55] Walltime used: 19 seconds
[08:29:55] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:29:55] Done.
[samclip] Processed 100000 records...
[Tue Jun 16 08:29:55 2020]
Finished job 98.
169 of 206 steps (82%) done

[Tue Jun 16 08:29:55 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
    jobid: 14
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4431AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[M::mem_process_seqs] Processed 320006 reads in 18.639 CPU sec, 2.577 real sec
[08:29:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:29:56] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 64386 reads in 3.964 CPU sec, 0.460 real sec
[08:29:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:29:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] Processed 200000 records...
[08:29:56] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 100000 records...
[08:29:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:29:56] Identified 122 variants.
[08:29:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[08:29:56] Result files:
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.aligned.fa
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam.bai
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bed
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.fa
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.subs.fa
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.csv
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.filt.vcf
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.gff
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.html
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.log
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.raw.vcf
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.subs.vcf
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.tab
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.txt
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz
[08:29:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz.csi
[08:29:56] Walltime used: 19 seconds
[08:29:56] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:29:56] Done.
[08:29:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[Tue Jun 16 08:29:56 2020]
Finished job 27.
170 of 206 steps (83%) done

[Tue Jun 16 08:29:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
    jobid: 163
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JA4169AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[08:29:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 59744 reads in 3.580 CPU sec, 0.412 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320108 sequences (80000268 bp)...
[M::process] read 64700 sequences (16153866 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.875 sec; CPU: 22.338 sec
[samclip] Total SAM records 384768, removed 794, allowed 154, passed 383974
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[08:29:56] This is snippy 4.4.3
[08:29:56] Written by Torsten Seemann
[08:29:56] Obtained from https://github.com/tseemann/snippy
[08:29:56] Detected operating system: linux
[08:29:56] Enabling bundled linux tools.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:29:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:29:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:56] Found gzip - /usr/bin/gzip
[08:29:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:29:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:56] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:56] This is snippy 4.4.3
[08:29:56] Written by Torsten Seemann
[08:29:56] Obtained from https://github.com/tseemann/snippy
[08:29:56] Detected operating system: linux
[08:29:56] Enabling bundled linux tools.
[08:29:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:29:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:29:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 379993, removed 681, allowed 155, passed 379312
 bwa mem -Y[samclip] Header contained 5 lines
 -M -R[samclip] Done.
 @RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.944 sec; CPU: 22.799 sec
[08:29:56] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:29:56] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:56] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:29:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:29:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:29:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:29:56] Treating reference as 'fasta' format.
[08:29:56] Will use 8 CPU cores.
[08:29:56] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[08:29:56] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[08:29:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:29:56] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[08:29:56] Creating reference folder: reference
[08:29:56] Extracting FASTA and GFF from reference.
[08:29:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:29:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:29:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:29:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:29:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:29:56] Found gzip - /usr/bin/gzip
[08:29:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:29:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:29:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:29:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:29:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:29:56] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:29:57] Wrote 3 sequences to ref.fa
[08:29:57] Wrote 0 features to ref.gff
[08:29:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta into pseudo-reads
[08:29:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:29:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:29:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:29:57] Treating reference as 'fasta' format.
[08:29:57] Will use 8 CPU cores.
[08:29:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[08:29:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[08:29:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[08:29:57] Creating reference folder: reference
[08:29:57] Extracting FASTA and GFF from reference.
[08:29:57] Running: samtools index snps.bam 2>> snps.log
[08:29:57] Wrote 3 sequences to ref.fa
[08:29:57] Wrote 0 features to ref.gff
[08:29:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta into pseudo-reads
[08:29:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:29:58] Running: samtools index snps.bam 2>> snps.log
[08:29:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320108 reads in 16.677 CPU sec, 2.282 real sec
[08:29:58] Running: samtools index snps.bam 2>> snps.log
[08:29:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:29:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64700 reads in 4.021 CPU sec, 0.487 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:29:59] Wrote 380504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:59] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:59] Using BAM RG (Read Group) ID: SAL_BB4431AA_AS.out
[08:29:59] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:59] Running: bwa index reference/ref.fa 2>> snps.log
[08:29:59] Marked 0 heterozygous sites with 'n'
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y[samclip] Total SAM records 385138, removed 940, allowed 215, passed 384198
 -M -R[samclip] Header contained 5 lines
 @RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out[samclip] Done.
 -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.756 sec; CPU: 21.262 sec
[08:29:59] Wrote 384438 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:29:59] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:29:59] Using BAM RG (Read Group) ID: SAL_JA4169AA_AS.out
[08:29:59] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:29:59] Creating extra output files: BED GFF CSV TXT HTML
[08:29:59] Identified 28 variants.
[08:29:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[08:29:59] Result files:
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.aligned.fa
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam.bai
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bed
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.fa
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.subs.fa
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.csv
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.filt.vcf
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.gff
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.html
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.log
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.raw.vcf
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.subs.vcf
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.tab
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.txt
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz
[08:29:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz.csi
[08:29:59] Walltime used: 18 seconds
[08:29:59] Questionable SNP? Try the --report option to see the alignments.
[08:29:59] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Tue Jun 16 08:29:59 2020]
Finished job 103.
171 of 206 steps (83%) done

[Tue Jun 16 08:29:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
    jobid: 8
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5674AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[08:29:59] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:00] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:00] This is snippy 4.4.3
[08:30:00] Written by Torsten Seemann
[08:30:00] Obtained from https://github.com/tseemann/snippy
[08:30:00] Detected operating system: linux
[08:30:00] Enabling bundled linux tools.
[08:30:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:00] Found gzip - /usr/bin/gzip
[08:30:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:01] Treating reference as 'fasta' format.
[08:30:01] Will use 8 CPU cores.
[08:30:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[08:30:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[08:30:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[08:30:01] Creating reference folder: reference
[08:30:01] Extracting FASTA and GFF from reference.
[08:30:01] Wrote 3 sequences to ref.fa
[08:30:01] Wrote 0 features to ref.gff
[08:30:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta into pseudo-reads
[08:30:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[08:30:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:30:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:01] Running: samtools index snps.bam 2>> snps.log
[08:30:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320008 sequences (80000076 bp)...
[08:30:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::process] read 60496 sequences (15090634 bp)...
[08:30:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320056 sequences (80000472 bp)...
[08:30:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1674
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:30:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 64382 sequences (16063010 bp)...
[08:30:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:02] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:04] Wrote 380346 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:04] Using BAM RG (Read Group) ID: SAL_AB5674AA_AS.out
[08:30:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:04] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320008 reads in 16.239 CPU sec, 2.184 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320056 reads in 17.617 CPU sec, 2.477 real sec
[M::mem_process_seqs] Processed 60496 reads in 3.345 CPU sec, 0.389 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[08:30:04] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:30:04] Creating extra output files: BED GFF CSV TXT HTML
[08:30:04] Identified 16 variants.
[08:30:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[08:30:04] Result files:
[08:30:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.aligned.fa
[08:30:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam
[08:30:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam.bai
[08:30:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bed
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.fa
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.subs.fa
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.csv
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.filt.vcf
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.gff
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.html
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.log
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.raw.vcf
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.subs.vcf
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.tab
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.txt
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz
[08:30:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz.csi
[08:30:05] Walltime used: 19 seconds
[08:30:05] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:30:05] Done.
[M::mem_process_seqs] Processed 64382 reads in 3.945 CPU sec, 0.458 real sec
[Tue Jun 16 08:30:05 2020]
Finished job 51.
172 of 206 steps (83%) done

[Tue Jun 16 08:30:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
    jobid: 71
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_RA1599AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
[08:30:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 200000 records...
[08:30:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.554 sec; CPU: 20.137 sec
[samclip] Total SAM records 380712, removed 512, allowed 63, passed 380200
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[08:30:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:05] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.855 sec; CPU: 22.111 sec
[samclip] Total SAM records 384524, removed 316, allowed 111, passed 384208
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:05] This is snippy 4.4.3
[08:30:05] Written by Torsten Seemann
[08:30:05] Obtained from https://github.com/tseemann/snippy
[08:30:05] Detected operating system: linux
[08:30:05] Enabling bundled linux tools.
[08:30:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:30:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:30:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:05] Found gzip - /usr/bin/gzip
[08:30:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:06] Treating reference as 'fasta' format.
[08:30:06] Will use 8 CPU cores.
[08:30:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
[08:30:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[08:30:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[08:30:06] Creating reference folder: reference
[08:30:06] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320006 sequences (80000212 bp)...
[08:30:06] Wrote 3 sequences to ref.fa
[08:30:06] Wrote 0 features to ref.gff
[08:30:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta into pseudo-reads
[08:30:06] Marked 4 heterozygous sites with 'n'
[M::process] read 60340 sequences (15075616 bp)...
[08:30:06] Creating extra output files: BED GFF CSV TXT HTML
[08:30:06] Identified 10 variants.
[08:30:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[08:30:06] Result files:
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.aligned.fa
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam.bai
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bed
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.fa
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.subs.fa
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.csv
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.filt.vcf
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.gff
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.html
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.log
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.raw.vcf
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.subs.vcf
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.tab
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.txt
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz
[08:30:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz.csi
[08:30:06] Walltime used: 19 seconds
[08:30:06] Questionable SNP? Try the --report option to see the alignments.
[08:30:06] Done.
[Tue Jun 16 08:30:06 2020]
Finished job 150.
173 of 206 steps (84%) done

[Tue Jun 16 08:30:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
    jobid: 168
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB8331AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:06] Marked 0 heterozygous sites with 'n'
[08:30:07] Creating extra output files: BED GFF CSV TXT HTML
[08:30:07] Identified 1674 variants.
[08:30:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[08:30:07] Result files:
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.aligned.fa
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam.bai
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bed
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.fa
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.subs.fa
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.csv
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.filt.vcf
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.gff
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.html
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.log
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.raw.vcf
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.subs.vcf
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.tab
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.txt
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz
[08:30:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz.csi
[08:30:07] Walltime used: 20 seconds
[08:30:07] Wishing you a life free of homopolymer errors.
[08:30:07] Done.
[08:30:07] This is snippy 4.4.3
[08:30:07] Written by Torsten Seemann
[08:30:07] Obtained from https://github.com/tseemann/snippy
[08:30:07] Detected operating system: linux
[08:30:07] Enabling bundled linux tools.
[08:30:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[Tue Jun 16 08:30:07 2020]
Finished job 120.
174 of 206 steps (84%) done

[Tue Jun 16 08:30:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
    jobid: 75
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA1344AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[08:30:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:07] Found gzip - /usr/bin/gzip
[08:30:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:07] Running: samtools index snps.bam 2>> snps.log
[08:30:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:07] Treating reference as 'fasta' format.
[08:30:07] Will use 8 CPU cores.
[08:30:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[08:30:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[08:30:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[08:30:07] Creating reference folder: reference
[08:30:07] Extracting FASTA and GFF from reference.
[08:30:07] Wrote 3 sequences to ref.fa
[08:30:07] Wrote 0 features to ref.gff
[08:30:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta into pseudo-reads
[08:30:07] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:07] This is snippy 4.4.3
[08:30:07] Written by Torsten Seemann
[08:30:07] Obtained from https://github.com/tseemann/snippy
[08:30:07] Detected operating system: linux
[08:30:07] Enabling bundled linux tools.
[08:30:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:07] Found gzip - /usr/bin/gzip
[08:30:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:08] Treating reference as 'fasta' format.
[08:30:08] Will use 8 CPU cores.
[08:30:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[08:30:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[08:30:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[08:30:08] Creating reference folder: reference
[08:30:08] Extracting FASTA and GFF from reference.
[08:30:08] Wrote 3 sequences to ref.fa
[08:30:08] Wrote 0 features to ref.gff
[08:30:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320006 reads in 17.834 CPU sec, 2.467 real sec
[08:30:08] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:08] Using BAM RG (Read Group) ID: SAL_RA1599AA_AS.out
[08:30:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[08:30:08] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 60340 reads in 3.832 CPU sec, 0.442 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:30:09] Marked 0 heterozygous sites with 'n'
[08:30:09] Creating extra output files: BED GFF CSV TXT HTML
[08:30:09] Identified 19 variants.
[08:30:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[08:30:09] Result files:
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.aligned.fa
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam.bai
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bed
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.fa
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.subs.fa
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.csv
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.filt.vcf
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.gff
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.html
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.log
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.raw.vcf
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.subs.vcf
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.tab
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.txt
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz
[08:30:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz.csi
[08:30:09] Walltime used: 18 seconds
[08:30:09] May the SNPs be with you.
[08:30:09] Done.
[Tue Jun 16 08:30:09 2020]
Finished job 137.
175 of 206 steps (85%) done

[Tue Jun 16 08:30:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
    jobid: 196
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA2865AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y[samclip] Total SAM records 380570, removed 718, allowed 108, passed 379852
 -M -R @RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.841 sec; CPU: 22.236 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:10] Wrote 380542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:10] Using BAM RG (Read Group) ID: SAL_BB8331AA_AS.out
[08:30:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:10] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:30:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 32
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:10] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:10] This is snippy 4.4.3
[08:30:10] Written by Torsten Seemann
[08:30:10] Obtained from https://github.com/tseemann/snippy
[08:30:10] Detected operating system: linux
[08:30:10] Enabling bundled linux tools.
[08:30:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:30:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:30:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:10] Found gzip - /usr/bin/gzip
[08:30:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:10] Wrote 384188 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:10] Using BAM RG (Read Group) ID: SAL_SA1344AA_AS.out
[08:30:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:10] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:11] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:11] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:11] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:11] Treating reference as 'fasta' format.
[08:30:11] Will use 8 CPU cores.
[08:30:11] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[08:30:11] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[08:30:11] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[08:30:11] Creating reference folder: reference
[08:30:11] Extracting FASTA and GFF from reference.
[08:30:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:11] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320112 sequences (80000222 bp)...
[08:30:11] Wrote 3 sequences to ref.fa
[08:30:11] Wrote 0 features to ref.gff
[08:30:11] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta into pseudo-reads
[08:30:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64494 sequences (16109924 bp)...
[08:30:11] Running: samtools index snps.bam 2>> snps.log
[08:30:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320140 sequences (80000372 bp)...
[M::process] read 60402 sequences (15100500 bp)...
[08:30:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320152 sequences (80000390 bp)...
[M::process] read 64036 sequences (16006868 bp)...
[M::mem_process_seqs] Processed 320112 reads in 17.658 CPU sec, 2.520 real sec
[08:30:13] Wrote 383654 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:13] Using BAM RG (Read Group) ID: SAL_NA2865AA_AS.out
[08:30:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:13] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64494 reads in 3.757 CPU sec, 0.437 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.926 sec; CPU: 22.002 sec
[samclip] Total SAM records 384931, removed 1093, allowed 191, passed 383838
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 859
       total no. reference observed             : 0

Time elapsed: 0.01s

[08:30:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:14] Marked 0 heterozygous sites with 'n'
[08:30:15] Creating extra output files: BED GFF CSV TXT HTML
[08:30:15] Identified 17 variants.
[08:30:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[08:30:15] Result files:
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.aligned.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam.bai
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bed
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.subs.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.csv
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.filt.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.gff
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.html
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.log
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.raw.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.subs.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.tab
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.txt
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz.csi
[08:30:15] Walltime used: 19 seconds
[08:30:15] Questionable SNP? Try the --report option to see the alignments.
[08:30:15] Done.
[Tue Jun 16 08:30:15 2020]
Finished job 14.
176 of 206 steps (85%) done

[Tue Jun 16 08:30:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
    jobid: 24
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB1150AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[08:30:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320140 reads in 18.375 CPU sec, 3.026 real sec
[08:30:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:15] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:15] Marked 0 heterozygous sites with 'n'
[08:30:15] Creating extra output files: BED GFF CSV TXT HTML
[08:30:15] Identified 32 variants.
[08:30:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[08:30:15] Result files:
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.aligned.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam.bai
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bed
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.subs.fa
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.csv
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.filt.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.gff
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.html
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.log
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.raw.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.subs.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.tab
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.txt
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz
[08:30:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz.csi
[08:30:15] Walltime used: 19 seconds
[08:30:15] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:30:15] Done.
[Tue Jun 16 08:30:15 2020]
Finished job 163.
177 of 206 steps (86%) done

[Tue Jun 16 08:30:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
    jobid: 152
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB3409AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[08:30:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320152 reads in 17.504 CPU sec, 2.421 real sec
[08:30:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 60402 reads in 4.371 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[08:30:15] This is snippy 4.4.3
[08:30:15] Written by Torsten Seemann
[08:30:15] Obtained from https://github.com/tseemann/snippy
[08:30:15] Detected operating system: linux
[08:30:15] Enabling bundled linux tools.
[08:30:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:15] Found gzip - /usr/bin/gzip
[08:30:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 64036 reads in 3.600 CPU sec, 0.412 real sec
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320240 sequences (80000242 bp)...
[08:30:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:16] Treating reference as 'fasta' format.
[08:30:16] Will use 8 CPU cores.
[08:30:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[08:30:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[08:30:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[08:30:16] Creating reference folder: reference
[08:30:16] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[M::process] read 63414 sequences (15840838 bp)...
[08:30:16] This is snippy 4.4.3
[08:30:16] Written by Torsten Seemann
[08:30:16] Obtained from https://github.com/tseemann/snippy
[08:30:16] Detected operating system: linux
[08:30:16] Enabling bundled linux tools.
[08:30:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:16] Wrote 3 sequences to ref.fa
[08:30:16] Wrote 0 features to ref.gff
[08:30:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta into pseudo-reads
[08:30:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.404 sec; CPU: 23.287 sec
[samclip] Total SAM records 381164, removed 1853, allowed 265, passed 379311
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:16] Found gzip - /usr/bin/gzip
[08:30:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[08:30:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:16] Treating reference as 'fasta' format.
[08:30:16] Will use 8 CPU cores.
[08:30:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[08:30:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[08:30:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[08:30:16] Creating reference folder: reference
[08:30:16] Extracting FASTA and GFF from reference.
[08:30:16] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.807 sec; CPU: 21.688 sec
[samclip] Total SAM records 384466, removed 997, allowed 98, passed 383469
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:16] Wrote 3 sequences to ref.fa
[08:30:16] Wrote 0 features to ref.gff
[08:30:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:18] Running: samtools index snps.bam 2>> snps.log
[08:30:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320240 reads in 17.420 CPU sec, 2.428 real sec
[08:30:18] Running: samtools index snps.bam 2>> snps.log
[08:30:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[08:30:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:18] Wrote 380042 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:18] Using BAM RG (Read Group) ID: SAL_JB1150AA_AS.out
[08:30:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 63414 reads in 3.790 CPU sec, 0.436 real sec
[08:30:19] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[08:30:19] Wrote 378962 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:19] Using BAM RG (Read Group) ID: SAL_CB3409AA_AS.out
[08:30:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:19] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:19] Marked 0 heterozygous sites with 'n'
[08:30:19] Creating extra output files: BED GFF CSV TXT HTML
[08:30:19] Identified 859 variants.
[08:30:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[08:30:19] Result files:
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.aligned.fa
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam.bai
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bed
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.fa
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.subs.fa
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.csv
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.filt.vcf
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.gff
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.html
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.log
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.raw.vcf
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.subs.vcf
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.tab
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.txt
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz
[08:30:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz.csi
[08:30:19] Walltime used: 19 seconds
[08:30:19] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:19] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.836 sec; CPU: 21.797 sec
[samclip] Total SAM records 383807, removed 436, allowed 38, passed 383371
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 08:30:19 2020]
Finished job 8.
178 of 206 steps (86%) done

[Tue Jun 16 08:30:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
    jobid: 177
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:20] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:20] This is snippy 4.4.3
[08:30:20] Written by Torsten Seemann
[08:30:20] Obtained from https://github.com/tseemann/snippy
[08:30:20] Detected operating system: linux
[08:30:20] Enabling bundled linux tools.
[08:30:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:20] Found gzip - /usr/bin/gzip
[08:30:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:20] Treating reference as 'fasta' format.
[08:30:20] Will use 8 CPU cores.
[08:30:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[08:30:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[08:30:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[08:30:20] Creating reference folder: reference
[08:30:20] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:20] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:20] Wrote 3 sequences to ref.fa
[08:30:20] Wrote 0 features to ref.gff
[08:30:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta into pseudo-reads
[08:30:20] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:20] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:20] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:20] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320016 sequences (80000400 bp)...
[08:30:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 60026 sequences (14956226 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[08:30:21] Running: samtools index snps.bam 2>> snps.log
[M::process] read 58962 sequences (14740500 bp)...
[08:30:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:30:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2586
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:30:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:22] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:22] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:23] Wrote 380858 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:23] Using BAM RG (Read Group) ID: SAL_BB1066AA_AS.out
[08:30:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:23] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320016 reads in 19.459 CPU sec, 2.641 real sec
[M::mem_process_seqs] Processed 320000 reads in 16.432 CPU sec, 2.266 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 58962 reads in 3.648 CPU sec, 0.425 real sec
[M::mem_process_seqs] Processed 60026 reads in 4.177 CPU sec, 0.485 real sec
[08:30:24] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[08:30:24] Creating extra output files: BED GFF CSV TXT HTML
[08:30:24] Identified 18 variants.
[08:30:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[08:30:24] Result files:
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.aligned.fa
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam.bai
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bed
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.fa
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.subs.fa
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.csv
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.filt.vcf
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.gff
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.html
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.log
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.raw.vcf
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.subs.vcf
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.tab
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.txt
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz
[08:30:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz.csi
[08:30:24] Walltime used: 19 seconds
[08:30:24] May the SNPs be with you.
[08:30:24] Done.
[Tue Jun 16 08:30:24 2020]
Finished job 71.
179 of 206 steps (87%) done

[Tue Jun 16 08:30:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
    jobid: 57
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA0676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[08:30:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 380486, removed 1599, allowed 282, passed 378887

[main] Real time: 4.040 sec; CPU: 24.201 sec
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.662 sec; CPU: 20.667 sec
[samclip] Total SAM records 379448, removed 1280, allowed 130, passed 378168
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:25] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:25] This is snippy 4.4.3
[08:30:25] Written by Torsten Seemann
[08:30:25] Obtained from https://github.com/tseemann/snippy
[08:30:25] Detected operating system: linux
[08:30:25] Enabling bundled linux tools.
[08:30:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:25] Found gzip - /usr/bin/gzip
[08:30:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:25] Treating reference as 'fasta' format.
[08:30:25] Will use 8 CPU cores.
[08:30:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
[08:30:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[08:30:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[08:30:25] Creating reference folder: reference
[08:30:25] Extracting FASTA and GFF from reference.
[08:30:25] Wrote 3 sequences to ref.fa
[08:30:25] Wrote 0 features to ref.gff
[08:30:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta into pseudo-reads
[M::process] read 320024 sequences (80000386 bp)...
[M::process] read 60834 sequences (15204810 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:26] Marked 0 heterozygous sites with 'n'
[08:30:26] Marked 1 heterozygous sites with 'n'
[08:30:26] Creating extra output files: BED GFF CSV TXT HTML
[08:30:26] Identified 12 variants.
[08:30:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[08:30:26] Result files:
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.aligned.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam.bai
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bed
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.subs.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.csv
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.filt.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.gff
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.html
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.log
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.raw.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.subs.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.tab
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.txt
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz.csi
[08:30:26] Walltime used: 19 seconds
[08:30:26] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:26] Done.
[08:30:26] Creating extra output files: BED GFF CSV TXT HTML
[Tue Jun 16 08:30:26 2020]
Finished job 75.
180 of 206 steps (87%) done

[Tue Jun 16 08:30:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
    jobid: 29
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA5728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[08:30:26] Identified 2586 variants.
[08:30:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[08:30:26] Result files:
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.aligned.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam.bai
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bed
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.subs.fa
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.csv
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.filt.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.gff
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.html
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.log
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.raw.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.subs.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.tab
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.txt
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz
[08:30:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz.csi
[08:30:26] Walltime used: 19 seconds
[08:30:26] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:26] Done.
[Tue Jun 16 08:30:26 2020]
Finished job 168.
181 of 206 steps (88%) done

[Tue Jun 16 08:30:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
    jobid: 109
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1789AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
[08:30:26] Running: samtools index snps.bam 2>> snps.log
[08:30:26] Running: samtools index snps.bam 2>> snps.log
[08:30:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:27] This is snippy 4.4.3
[08:30:27] Written by Torsten Seemann
[08:30:27] Obtained from https://github.com/tseemann/snippy
[08:30:27] Detected operating system: linux
[08:30:27] Enabling bundled linux tools.
[08:30:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:27] Found gzip - /usr/bin/gzip
[08:30:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:27] This is snippy 4.4.3
[08:30:27] Written by Torsten Seemann
[08:30:27] Obtained from https://github.com/tseemann/snippy
[08:30:27] Detected operating system: linux
[08:30:27] Enabling bundled linux tools.
[08:30:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:27] Found gzip - /usr/bin/gzip
[08:30:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:27] Treating reference as 'fasta' format.
[08:30:27] Will use 8 CPU cores.
[08:30:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[08:30:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[08:30:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[08:30:27] Creating reference folder: reference
[08:30:27] Extracting FASTA and GFF from reference.
[08:30:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:27] Treating reference as 'fasta' format.
[08:30:27] Will use 8 CPU cores.
[08:30:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
[08:30:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[08:30:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[08:30:27] Creating reference folder: reference
[08:30:27] Extracting FASTA and GFF from reference.
[08:30:27] Wrote 3 sequences to ref.fa
[08:30:27] Wrote 0 features to ref.gff
[08:30:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta into pseudo-reads
[08:30:27] Wrote 3 sequences to ref.fa
[08:30:27] Wrote 0 features to ref.gff
[08:30:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320024 reads in 16.767 CPU sec, 2.311 real sec
[samclip] Processed 100000 records...
[08:30:28] Wrote 384394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:28] Using BAM RG (Read Group) ID: SAL_KA0676AA_AS.out
[08:30:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:28] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 60834 reads in 3.643 CPU sec, 0.425 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.671 sec; CPU: 20.953 sec
[samclip] Total SAM records 381031, removed 423, allowed 39, passed 380608
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:29] Marked 0 heterozygous sites with 'n'
[08:30:29] Creating extra output files: BED GFF CSV TXT HTML
[08:30:29] Identified 13 variants.
[08:30:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[08:30:29] Result files:
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.aligned.fa
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam.bai
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bed
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.fa
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.subs.fa
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.csv
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.filt.vcf
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.gff
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.html
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.log
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.raw.vcf
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.subs.vcf
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.tab
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.txt
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz
[08:30:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz.csi
[08:30:29] Walltime used: 19 seconds
[08:30:29] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:30:29] Done.
[Tue Jun 16 08:30:29 2020]
Finished job 196.
182 of 206 steps (88%) done

[Tue Jun 16 08:30:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
    jobid: 198
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA2841AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:29] This is snippy 4.4.3
[08:30:29] Written by Torsten Seemann
[08:30:29] Obtained from https://github.com/tseemann/snippy
[08:30:29] Detected operating system: linux
[08:30:29] Enabling bundled linux tools.
[08:30:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:30] Found gzip - /usr/bin/gzip
[08:30:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[08:30:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:30:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:30] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[08:30:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:30] Wrote 379942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:30] Using BAM RG (Read Group) ID: SAL_KB1789AA_AS.out
[08:30:30] Wrote 387300 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:30] Using BAM RG (Read Group) ID: SAL_NA5728AA_AS.out
[08:30:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:30] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:30] Running: bwa index reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 47
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 57

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 57
       total no. variants observed              : 3912
       total no. reference observed             : 0

Time elapsed: 0.04s

[08:30:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:30] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:30] Treating reference as 'fasta' format.
[08:30:30] Will use 8 CPU cores.
[08:30:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
[08:30:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[08:30:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[08:30:30] Creating reference folder: reference
[08:30:30] Extracting FASTA and GFF from reference.
[08:30:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:30] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320118 sequences (80000194 bp)...
[08:30:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:30] Wrote 3 sequences to ref.fa
[08:30:30] Wrote 0 features to ref.gff
[08:30:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta into pseudo-reads
[M::process] read 64276 sequences (16058486 bp)...
[08:30:30] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:30] Running: samtools index snps.bam 2>> snps.log
[08:30:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:31] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320082 sequences (80000274 bp)...
[M::process] read 67218 sequences (16796756 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 59942 sequences (14950530 bp)...
[M::mem_process_seqs] Processed 320118 reads in 17.672 CPU sec, 2.472 real sec
[08:30:33] Wrote 383460 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:33] Using BAM RG (Read Group) ID: SAL_WA2841AA_AS.out
[08:30:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[08:30:33] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 64276 reads in 3.601 CPU sec, 0.436 real sec
[samclip] Processed 200000 records...
[08:30:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 73
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[08:30:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out -t[samclip] Total SAM records 384690, removed 1014, allowed 244, passed 383676
 8 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.056 sec; CPU: 21.889 sec
[08:30:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:34] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:34] Marked 0 heterozygous sites with 'n'
[08:30:34] Creating extra output files: BED GFF CSV TXT HTML
[08:30:34] Identified 105 variants.
[08:30:34] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[08:30:34] Result files:
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.aligned.fa
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam.bai
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bed
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.fa
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.subs.fa
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.csv
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.filt.vcf
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.gff
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.html
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.log
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.raw.vcf
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.subs.vcf
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.tab
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.txt
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz
[08:30:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz.csi
[08:30:34] Walltime used: 18 seconds
[08:30:34] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[08:30:34] Done.
[Tue Jun 16 08:30:34 2020]
Finished job 152.
183 of 206 steps (89%) done

[Tue Jun 16 08:30:34 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
    jobid: 81
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9173AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[M::mem_process_seqs] Processed 320082 reads in 19.597 CPU sec, 2.663 real sec
[M::mem_process_seqs] Processed 320000 reads in 19.296 CPU sec, 2.630 real sec
[08:30:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:35] Marked 53 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[08:30:35] Creating extra output files: BED GFF CSV TXT HTML
[08:30:35] Identified 3912 variants.
[08:30:35] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[08:30:35] Result files:
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.aligned.fa
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam.bai
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bed
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.fa
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.subs.fa
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.csv
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.filt.vcf
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.gff
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.html
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.log
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.raw.vcf
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.subs.vcf
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.tab
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.txt
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz
[08:30:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz.csi
[08:30:35] Walltime used: 20 seconds
[08:30:35] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:35] Done.
[Tue Jun 16 08:30:35 2020]
Finished job 24.
184 of 206 steps (89%) done

[Tue Jun 16 08:30:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
    jobid: 147
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA1967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[samclip] Processed 100000 records...
[08:30:35] This is snippy 4.4.3
[08:30:35] Written by Torsten Seemann
[08:30:35] Obtained from https://github.com/tseemann/snippy
[08:30:35] Detected operating system: linux
[08:30:35] Enabling bundled linux tools.
[08:30:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:35] Found gzip - /usr/bin/gzip
[08:30:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 67218 reads in 4.016 CPU sec, 0.468 real sec
[08:30:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320192 sequences (80000106 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 59942 reads in 4.047 CPU sec, 0.473 real sec
[M::process] read 63268 sequences (15805028 bp)...
[samclip] Processed 200000 records...
[08:30:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:35] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:35] Treating reference as 'fasta' format.
[08:30:35] Will use 8 CPU cores.
[08:30:35] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[08:30:35] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[08:30:35] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[08:30:35] Creating reference folder: reference
[08:30:35] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[08:30:35] Wrote 3 sequences to ref.fa
[08:30:35] Wrote 0 features to ref.gff
[08:30:35] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[08:30:36] This is snippy 4.4.3
[08:30:36] Written by Torsten Seemann
[08:30:36] Obtained from https://github.com/tseemann/snippy
[08:30:36] Detected operating system: linux
[08:30:36] Enabling bundled linux tools.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.042 sec; CPU: 24.167 sec
[samclip] Total SAM records 387496, removed 1647, allowed 406, passed 385849
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:36] Running: samtools index snps.bam 2>> snps.log
[08:30:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[main] Version: 0.7.17-r1188
[main] CMD: bwa[samclip] Total SAM records 380645, removed 1858, allowed 207, passed 378787
 mem -Y -M[samclip] Header contained 5 lines
 -R[samclip] Done.
 @RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.010 sec; CPU: 23.901 sec
[08:30:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:36] Found gzip - /usr/bin/gzip
[08:30:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:36] Treating reference as 'fasta' format.
[08:30:36] Will use 8 CPU cores.
[08:30:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[08:30:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[08:30:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[08:30:36] Creating reference folder: reference
[08:30:36] Extracting FASTA and GFF from reference.
[08:30:36] Wrote 3 sequences to ref.fa
[08:30:36] Wrote 0 features to ref.gff
[08:30:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320192 reads in 15.786 CPU sec, 2.072 real sec
[samclip] Processed 100000 records...
[08:30:38] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 63268 reads in 3.616 CPU sec, 0.423 real sec
[08:30:38] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[08:30:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:38] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[08:30:38] Creating extra output files: BED GFF CSV TXT HTML
[08:30:38] Identified 73 variants.
[08:30:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[08:30:38] Result files:
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.aligned.fa
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam.bai
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bed
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.fa
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.subs.fa
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.csv
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.filt.vcf
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.gff
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.html
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.log
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.raw.vcf
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.subs.vcf
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.tab
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.txt
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz
[08:30:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz.csi
[08:30:38] Walltime used: 18 seconds
[08:30:38] May the SNPs be with you.
[08:30:38] Done.
[Tue Jun 16 08:30:38 2020]
Finished job 177.
185 of 206 steps (90%) done

[Tue Jun 16 08:30:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
    jobid: 55
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1733AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[08:30:38] Wrote 382446 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:38] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:38] Using BAM RG (Read Group) ID: SAL_SA9173AA_AS.out
[08:30:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:38] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.461 sec; CPU: 19.941 sec
[samclip] Total SAM records 383660, removed 620, allowed 53, passed 383040
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:39] Wrote 382468 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:39] Using BAM RG (Read Group) ID: SAL_TA1967AA_AS.out
[08:30:39] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:39] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:39] This is snippy 4.4.3
[08:30:39] Written by Torsten Seemann
[08:30:39] Obtained from https://github.com/tseemann/snippy
[08:30:39] Detected operating system: linux
[08:30:39] Enabling bundled linux tools.
[08:30:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:39] Found gzip - /usr/bin/gzip
[08:30:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:39] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:39] Treating reference as 'fasta' format.
[08:30:39] Will use 8 CPU cores.
[08:30:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[08:30:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[08:30:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[08:30:39] Creating reference folder: reference
[08:30:39] Extracting FASTA and GFF from reference.
[08:30:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:39] Wrote 3 sequences to ref.fa
[08:30:39] Wrote 0 features to ref.gff
[08:30:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta into pseudo-reads
[08:30:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:40] Running: samtools index snps.bam 2>> snps.log
[08:30:40] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320240 sequences (80000250 bp)...
[M::process] read 62206 sequences (15551500 bp)...
[08:30:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:41] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1807
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:30:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320190 sequences (80000004 bp)...
[08:30:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 62278 sequences (15552298 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2591
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:30:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:42] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:42] Wrote 383002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:42] Using BAM RG (Read Group) ID: SAL_XA1733AA_AS.out
[08:30:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:42] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320240 reads in 16.134 CPU sec, 2.148 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 62206 reads in 3.440 CPU sec, 0.403 real sec
[samclip] Processed 200000 records...
[08:30:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:43] Marked 0 heterozygous sites with 'n'
[08:30:43] Creating extra output files: BED GFF CSV TXT HTML
[08:30:43] Identified 13 variants.
[08:30:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[08:30:43] Result files:
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.aligned.fa
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam.bai
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bed
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.fa
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.subs.fa
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.csv
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.filt.vcf
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.gff
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.html
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.log
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.raw.vcf
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.subs.vcf
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.tab
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.txt
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz
[08:30:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz.csi
[08:30:43] Walltime used: 18 seconds
[08:30:43] Questionable SNP? Try the --report option to see the alignments.
[08:30:43] Done.
[Tue Jun 16 08:30:43 2020]
Finished job 57.
186 of 206 steps (90%) done

[Tue Jun 16 08:30:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
    jobid: 23
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA9385AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[08:30:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:30:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320190 reads in 17.727 CPU sec, 2.467 real sec
[08:30:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:44] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.519 sec; CPU: 20.116 sec
[samclip] Total SAM records 382546, removed 556, allowed 115, passed 381990
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 62278 reads in 3.966 CPU sec, 0.457 real sec
[08:30:44] This is snippy 4.4.3
[08:30:44] Written by Torsten Seemann
[08:30:44] Obtained from https://github.com/tseemann/snippy
[08:30:44] Detected operating system: linux
[08:30:44] Enabling bundled linux tools.
[08:30:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[samclip] Processed 200000 records...
[08:30:44] Found gzip - /usr/bin/gzip
[08:30:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320254 sequences (80000470 bp)...
[08:30:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 62748 sequences (15675344 bp)...
[08:30:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:44] Treating reference as 'fasta' format.
[08:30:44] Will use 8 CPU cores.
[08:30:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[08:30:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[08:30:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[08:30:44] Creating reference folder: reference
[08:30:44] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[08:30:45] Wrote 3 sequences to ref.fa
[08:30:45] Wrote 0 features to ref.gff
[08:30:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.832 sec; CPU: 22.254 sec
[samclip] Total SAM records 382578, removed 523, allowed 104, passed 382055
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:46] Running: samtools index snps.bam 2>> snps.log
[08:30:46] Marked 6 heterozygous sites with 'n'
[08:30:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:46] Creating extra output files: BED GFF CSV TXT HTML
[08:30:46] Identified 1807 variants.
[08:30:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[08:30:46] Result files:
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.aligned.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam.bai
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bed
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.subs.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.csv
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.filt.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.gff
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.html
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.log
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.raw.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.subs.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.tab
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.txt
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz.csi
[08:30:46] Walltime used: 19 seconds
[08:30:46] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:30:46] Done.
[08:30:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Tue Jun 16 08:30:46 2020]
Finished job 29.
187 of 206 steps (91%) done

[Tue Jun 16 08:30:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
    jobid: 104
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6663AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[08:30:46] Marked 1 heterozygous sites with 'n'
[08:30:46] Creating extra output files: BED GFF CSV TXT HTML
[08:30:46] Identified 2591 variants.
[08:30:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[08:30:46] Result files:
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.aligned.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam.bai
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bed
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.subs.fa
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.csv
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.filt.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.gff
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.html
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.log
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.raw.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.subs.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.tab
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.txt
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz
[08:30:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz.csi
[08:30:46] Walltime used: 19 seconds
[08:30:46] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[08:30:46] Done.
[Tue Jun 16 08:30:46 2020]
Finished job 109.
188 of 206 steps (91%) done

[Tue Jun 16 08:30:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
    jobid: 89
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB4651AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:47] This is snippy 4.4.3
[08:30:47] Written by Torsten Seemann
[08:30:47] Obtained from https://github.com/tseemann/snippy
[08:30:47] Detected operating system: linux
[08:30:47] Enabling bundled linux tools.
[08:30:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:47] Found gzip - /usr/bin/gzip
[08:30:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:47] Running: samtools index snps.bam 2>> snps.log
[08:30:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320254 reads in 17.674 CPU sec, 2.480 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:47] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:47] Treating reference as 'fasta' format.
[08:30:47] Will use 8 CPU cores.
[08:30:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[08:30:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[08:30:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[08:30:47] Creating reference folder: reference
[08:30:47] Extracting FASTA and GFF from reference.
[08:30:47] This is snippy 4.4.3
[08:30:47] Written by Torsten Seemann
[08:30:47] Obtained from https://github.com/tseemann/snippy
[08:30:47] Detected operating system: linux
[08:30:47] Enabling bundled linux tools.
[08:30:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[samclip] Processed 100000 records...
[08:30:47] Wrote 3 sequences to ref.fa
[08:30:47] Wrote 0 features to ref.gff
[08:30:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta into pseudo-reads
[08:30:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:47] Found gzip - /usr/bin/gzip
[08:30:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 62748 reads in 3.904 CPU sec, 0.450 real sec
[08:30:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:47] Wrote 381576 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:47] Using BAM RG (Read Group) ID: SAL_YA9385AA_AS.out
[08:30:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:30:47] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:47] Treating reference as 'fasta' format.
[08:30:47] Will use 8 CPU cores.
[08:30:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
[08:30:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[08:30:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[08:30:47] Creating reference folder: reference
[08:30:47] Extracting FASTA and GFF from reference.
[08:30:47] Wrote 3 sequences to ref.fa
[08:30:47] Wrote 0 features to ref.gff
[08:30:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.860 sec; CPU: 22.138 sec
[samclip] Total SAM records 383174, removed 683, allowed 38, passed 382491
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:48] Marked 0 heterozygous sites with 'n'
[08:30:48] Creating extra output files: BED GFF CSV TXT HTML
[08:30:48] Identified 19 variants.
[08:30:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[08:30:48] Result files:
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.aligned.fa
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam.bai
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bed
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.fa
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.subs.fa
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.csv
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.filt.vcf
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.gff
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.html
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.log
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.raw.vcf
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.subs.vcf
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.tab
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.txt
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz
[08:30:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz.csi
[08:30:48] Walltime used: 19 seconds
[08:30:48] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:48] Done.
[Tue Jun 16 08:30:48 2020]
Finished job 198.
189 of 206 steps (92%) done

[Tue Jun 16 08:30:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
    jobid: 36
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_VA1155AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[08:30:49] This is snippy 4.4.3
[08:30:49] Written by Torsten Seemann
[08:30:49] Obtained from https://github.com/tseemann/snippy
[08:30:49] Detected operating system: linux
[08:30:49] Enabling bundled linux tools.
[08:30:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:49] Found gzip - /usr/bin/gzip
[08:30:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 101
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:49] Treating reference as 'fasta' format.
[08:30:49] Will use 8 CPU cores.
[08:30:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
[08:30:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[08:30:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[08:30:49] Creating reference folder: reference
[08:30:49] Extracting FASTA and GFF from reference.
[08:30:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[08:30:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:30:49] Wrote 3 sequences to ref.fa
[08:30:49] Wrote 0 features to ref.gff
[08:30:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta into pseudo-reads
[08:30:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:49] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320140 sequences (80000490 bp)...
[M::process] read 61436 sequences (15348128 bp)...
[08:30:50] Running: samtools index snps.bam 2>> snps.log
[08:30:50] Wrote 381992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:50] Using BAM RG (Read Group) ID: SAL_YA6663AA_AS.out
[08:30:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:50] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:50] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:50] Wrote 377314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:51] Using BAM RG (Read Group) ID: SAL_KB4651AA_AS.out
[08:30:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:51] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320140 reads in 18.118 CPU sec, 2.477 real sec
[08:30:52] Wrote 380298 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:52] Using BAM RG (Read Group) ID: SAL_VA1155AA_AS.out
[08:30:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:52] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320452 sequences (80000068 bp)...
[M::process] read 61540 sequences (15359146 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61436 reads in 4.129 CPU sec, 0.480 real sec
[08:30:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[08:30:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320088 sequences (80000324 bp)...
[M::process] read 57226 sequences (14306500 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.870 sec; CPU: 22.816 sec
[samclip] Total SAM records 381934, removed 1047, allowed 230, passed 380887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 86
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:30:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:53] Marked 0 heterozygous sites with 'n'
[08:30:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:53] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:53] Creating extra output files: BED GFF CSV TXT HTML
[08:30:53] Identified 101 variants.
[08:30:53] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[08:30:53] Result files:
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.aligned.fa
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam.bai
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bed
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.fa
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.subs.fa
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.csv
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.filt.vcf
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.gff
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.html
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.log
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.raw.vcf
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.subs.vcf
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.tab
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.txt
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz
[08:30:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz.csi
[08:30:53] Walltime used: 18 seconds
[08:30:53] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:53] Done.
[Tue Jun 16 08:30:53 2020]
Finished job 81.
190 of 206 steps (92%) done

[Tue Jun 16 08:30:53 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
    jobid: 10
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6631AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[08:30:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:30:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320230 sequences (80000192 bp)...
[08:30:54] This is snippy 4.4.3
[08:30:54] Written by Torsten Seemann
[08:30:54] Obtained from https://github.com/tseemann/snippy
[08:30:54] Detected operating system: linux
[08:30:54] Enabling bundled linux tools.
[08:30:54] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:54] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:54] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:54] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:54] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:54] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:54] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:54] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:54] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:54] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:54] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:54] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:54] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:54] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:54] Found gzip - /usr/bin/gzip
[08:30:54] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:54] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:54] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::process] read 60068 sequences (15013292 bp)...
[08:30:54] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:54] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:54] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:54] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:54] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:54] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:54] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:54] Treating reference as 'fasta' format.
[08:30:54] Will use 8 CPU cores.
[08:30:54] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[08:30:54] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[08:30:54] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[08:30:54] Creating reference folder: reference
[08:30:54] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320452 reads in 17.694 CPU sec, 2.472 real sec
[08:30:55] Wrote 3 sequences to ref.fa
[08:30:55] Wrote 0 features to ref.gff
[08:30:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta into pseudo-reads
[08:30:55] Marked 0 heterozygous sites with 'n'
[08:30:55] Creating extra output files: BED GFF CSV TXT HTML
[08:30:55] Identified 98 variants.
[samclip] Processed 100000 records...
[08:30:55] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[08:30:55] Result files:
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.aligned.fa
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam.bai
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bed
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.fa
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.subs.fa
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.csv
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.filt.vcf
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.gff
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.html
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.log
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.raw.vcf
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.subs.vcf
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.tab
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.txt
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz
[08:30:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz.csi
[08:30:55] Walltime used: 19 seconds
[08:30:55] Questionable SNP? Try the --report option to see the alignments.
[08:30:55] Done.
[Tue Jun 16 08:30:55 2020]
Finished job 147.
191 of 206 steps (93%) done

[Tue Jun 16 08:30:55 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
    jobid: 153
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA5105AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[08:30:55] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 61540 reads in 3.792 CPU sec, 0.436 real sec
[08:30:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320088 reads in 20.713 CPU sec, 2.665 real sec
[08:30:55] This is snippy 4.4.3
[08:30:55] Written by Torsten Seemann
[08:30:55] Obtained from https://github.com/tseemann/snippy
[08:30:55] Detected operating system: linux
[08:30:55] Enabling bundled linux tools.
[08:30:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:56] Found gzip - /usr/bin/gzip
[08:30:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.890 sec; CPU: 22.054 sec
[samclip] Total SAM records 382173, removed 587, allowed 309, passed 381586
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:56] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[08:30:56] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:56] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:56] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:56] Treating reference as 'fasta' format.
[08:30:56] Will use 8 CPU cores.
[08:30:56] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[08:30:56] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[08:30:56] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[08:30:56] Creating reference folder: reference
[08:30:56] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 57226 reads in 3.755 CPU sec, 0.449 real sec
[08:30:56] Wrote 3 sequences to ref.fa
[08:30:56] Wrote 0 features to ref.gff
[08:30:56] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.102 sec; CPU: 25.031 sec
[samclip] Total SAM records 377664, removed 1635, allowed 449, passed 376029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320230 reads in 21.902 CPU sec, 2.945 real sec
[08:30:57] Wrote 381088 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:57] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:57] Using BAM RG (Read Group) ID: SAL_YA6631AA_AS.out
[08:30:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:57] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[08:30:57] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:58] Marked 0 heterozygous sites with 'n'
[08:30:58] Creating extra output files: BED GFF CSV TXT HTML
[08:30:58] Identified 86 variants.
[08:30:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[08:30:58] Result files:
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.aligned.fa
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam.bai
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bed
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.fa
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.subs.fa
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.csv
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.filt.vcf
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.gff
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.html
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.log
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.raw.vcf
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.subs.vcf
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.tab
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.txt
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz
[08:30:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz.csi
[08:30:58] Walltime used: 19 seconds
[08:30:58] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:30:58] Done.
[samclip] Processed 200000 records...
[08:30:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 60068 reads in 4.585 CPU sec, 0.532 real sec
[Tue Jun 16 08:30:58 2020]
Finished job 55.
192 of 206 steps (93%) done

[Tue Jun 16 08:30:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
    jobid: 136
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB5195AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[08:30:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.330 sec; CPU: 27.042 sec
[samclip] Total SAM records 380650, removed 1633, allowed 584, passed 379017
[samclip] Header contained 5 lines
[samclip] Done.
[08:30:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1701
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:30:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:30:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:30:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:30:59] Running: samtools index snps.bam 2>> snps.log
[08:30:59] This is snippy 4.4.3
[08:30:59] Written by Torsten Seemann
[08:30:59] Obtained from https://github.com/tseemann/snippy
[08:30:59] Detected operating system: linux
[08:30:59] Enabling bundled linux tools.
[08:30:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[08:30:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[08:30:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[08:30:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[08:30:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[08:30:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[08:30:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[08:30:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[08:30:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[08:30:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[08:30:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[08:30:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[08:30:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[08:30:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[08:30:59] Found gzip - /usr/bin/gzip
[08:30:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[08:30:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[08:30:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[08:30:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[08:30:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[08:30:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[08:30:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:30:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:30:59] Wrote 380120 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:30:59] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:30:59] Using BAM RG (Read Group) ID: SAL_BA5105AA_AS.out
[08:30:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:30:59] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:30:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[08:30:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:30:59] Running: bwa index reference/ref.fa 2>> snps.log
[08:30:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:30:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[08:30:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[08:30:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[08:30:59] Treating reference as 'fasta' format.
[08:30:59] Will use 8 CPU cores.
[08:30:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[08:30:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[08:30:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[08:30:59] Creating reference folder: reference
[08:30:59] Extracting FASTA and GFF from reference.
[08:30:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:30:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:30:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:30:59] Wrote 3 sequences to ref.fa
[08:30:59] Wrote 0 features to ref.gff
[08:30:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta into pseudo-reads
[08:30:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:30:59] Running: rm -f fake_reads\.fq 2>> snps.log
[08:30:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:30:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:30:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:30:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:30:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:30:59] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000428 bp)...
[M::process] read 61044 sequences (15249832 bp)...
[08:31:00] Running: samtools index snps.bam 2>> snps.log
[08:31:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:31:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:31:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 65
       total no. reference observed             : 0

[08:31:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
Time elapsed: 0.00s

[08:31:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:31:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:31:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:31:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:31:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[08:31:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:31:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:31:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320060 sequences (80000344 bp)...
[08:31:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:31:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 60060 sequences (15011480 bp)...
[08:31:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:01] Running: rm -f fake_reads\.fq 2>> snps.log
[08:31:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:31:02] Wrote 388682 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[08:31:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[08:31:02] Using BAM RG (Read Group) ID: SAL_JB5195AA_AS.out
[08:31:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[08:31:02] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320044 reads in 18.577 CPU sec, 2.587 real sec
[08:31:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 100000 records...

stats: biallelic
          no. left trimmed                      : 10
          no. right trimmed                     : 59
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 72

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 72
       total no. variants observed              : 6603
       total no. reference observed             : 0

Time elapsed: 0.08s

[08:31:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 61044 reads in 4.309 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[08:31:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:31:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:31:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:31:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:31:03] Marked 0 heterozygous sites with 'n'
[08:31:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.993 sec; CPU: 23.443 sec
[samclip] Total SAM records 382314, removed 2907, allowed 309, passed 379407
[samclip] Header contained 5 lines
[samclip] Done.
[08:31:03] Creating extra output files: BED GFF CSV TXT HTML
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:31:03] Identified 1701 variants.
[08:31:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[08:31:03] Result files:
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.aligned.fa
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam.bai
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bed
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.fa
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.subs.fa
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.csv
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.filt.vcf
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.gff
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.html
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.log
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.raw.vcf
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.subs.vcf
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.tab
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.txt
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz
[08:31:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz.csi
[08:31:03] Walltime used: 19 seconds
[08:31:03] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:31:03] Done.
[08:31:03] Running: rm -f fake_reads\.fq 2>> snps.log
[Tue Jun 16 08:31:03 2020]
Finished job 23.
193 of 206 steps (94%) done
[08:31:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320060 reads in 18.513 CPU sec, 2.536 real sec
[08:31:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[08:31:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[08:31:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[08:31:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[08:31:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[08:31:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320082 sequences (80000226 bp)...
[M::mem_process_seqs] Processed 60060 reads in 3.700 CPU sec, 0.428 real sec

stats: biallelic
          no. left trimmed                      : 11
          no. right trimmed                     : 62
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 78

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 78
       total no. variants observed              : 7174
       total no. reference observed             : 0

Time elapsed: 0.09s

[08:31:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 68600 sequences (17150000 bp)...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:31:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[08:31:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.913 sec; CPU: 22.769 sec
[samclip] Total SAM records 380432, removed 950, allowed 256, passed 379482
[samclip] Header contained 5 lines
[samclip] Done.
[08:31:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:31:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:31:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:31:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:05] Running: rm -f fake_reads\.fq 2>> snps.log
[08:31:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:31:05] Running: samtools index snps.bam 2>> snps.log
[08:31:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:31:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:31:05] Marked 0 heterozygous sites with 'n'
[08:31:05] Creating extra output files: BED GFF CSV TXT HTML
[08:31:05] Identified 65 variants.
[08:31:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[08:31:05] Result files:
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.aligned.fa
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam.bai
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bed
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.fa
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.subs.fa
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.csv
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.filt.vcf
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.gff
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.html
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.log
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.raw.vcf
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.subs.vcf
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.tab
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.txt
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz
[08:31:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz.csi
[08:31:05] Walltime used: 18 seconds
[08:31:05] May the SNPs be with you.
[08:31:05] Done.
[Tue Jun 16 08:31:05 2020]
Finished job 104.
194 of 206 steps (94%) done
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320082 reads in 17.018 CPU sec, 2.240 real sec
[samclip] Processed 100000 records...
[08:31:07] Running: samtools index snps.bam 2>> snps.log
[08:31:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 68600 reads in 3.703 CPU sec, 0.433 real sec
[08:31:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.621 sec; CPU: 21.283 sec
[samclip] Total SAM records 389159, removed 1713, allowed 88, passed 387446
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:31:07] Marked 2 heterozygous sites with 'n'
[08:31:07] Creating extra output files: BED GFF CSV TXT HTML
[08:31:08] Identified 6603 variants.
[08:31:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[08:31:08] Result files:
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.aligned.fa
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam.bai
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bed
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.fa
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.subs.fa
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.csv
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.filt.vcf
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.gff
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.html
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.log
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.raw.vcf
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.subs.vcf
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.tab
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.txt
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz
[08:31:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz.csi
[08:31:08] Walltime used: 21 seconds
[08:31:08] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[08:31:08] Done.
[Tue Jun 16 08:31:08 2020]
Finished job 89.
195 of 206 steps (95%) done
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[08:31:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 34
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 37

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 37
       total no. variants observed              : 2446
       total no. reference observed             : 0

Time elapsed: 0.03s

[08:31:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:31:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:31:09] Marked 10 heterozygous sites with 'n'
[08:31:09] Creating extra output files: BED GFF CSV TXT HTML
[08:31:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:09] Identified 7174 variants.
[08:31:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[08:31:09] Result files:
[08:31:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.aligned.fa
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam.bai
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bed
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.fa
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.subs.fa
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.csv
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.filt.vcf
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.gff
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.html
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.log
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.raw.vcf
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.subs.vcf
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.tab
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.txt
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz
[08:31:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz.csi
[08:31:09] Walltime used: 20 seconds
[08:31:09] May the SNPs be with you.
[08:31:09] Done.
[Tue Jun 16 08:31:09 2020]
Finished job 36.
196 of 206 steps (95%) done
[08:31:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:31:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:31:09] Running: samtools index snps.bam 2>> snps.log
[08:31:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:31:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:09] Running: rm -f fake_reads\.fq 2>> snps.log
[08:31:09] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[08:31:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[08:31:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:31:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1678
       total no. reference observed             : 0

Time elapsed: 0.02s

[08:31:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:31:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:31:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:31:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:31:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:31:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:31:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:10] Running: rm -f fake_reads\.fq 2>> snps.log
[08:31:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:31:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[08:31:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[08:31:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[08:31:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[08:31:12] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[08:31:12] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[08:31:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[08:31:12] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[08:31:12] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[08:31:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[08:31:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[08:31:12] Running: rm -f fake_reads\.fq 2>> snps.log
[08:31:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[08:31:13] Marked 0 heterozygous sites with 'n'
[08:31:13] Creating extra output files: BED GFF CSV TXT HTML
[08:31:13] Identified 2446 variants.
[08:31:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[08:31:13] Result files:
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.aligned.fa
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam.bai
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bed
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.fa
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.subs.fa
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.csv
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.filt.vcf
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.gff
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.html
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.log
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.raw.vcf
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.subs.vcf
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.tab
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.txt
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz
[08:31:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz.csi
[08:31:13] Walltime used: 19 seconds
[08:31:13] Questionable SNP? Try the --report option to see the alignments.
[08:31:13] Done.
[Tue Jun 16 08:31:13 2020]
Finished job 10.
197 of 206 steps (96%) done
[08:31:14] Marked 0 heterozygous sites with 'n'
[08:31:14] Creating extra output files: BED GFF CSV TXT HTML
[08:31:14] Identified 1678 variants.
[08:31:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[08:31:14] Result files:
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.aligned.fa
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam.bai
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bed
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.fa
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.subs.fa
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.csv
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.filt.vcf
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.gff
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.html
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.log
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.raw.vcf
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.subs.vcf
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.tab
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.txt
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz
[08:31:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz.csi
[08:31:14] Walltime used: 19 seconds
[08:31:14] Wishing you a life free of homopolymer errors.
[08:31:14] Done.
[Tue Jun 16 08:31:14 2020]
Finished job 153.
198 of 206 steps (96%) done
[08:31:16] Marked 0 heterozygous sites with 'n'
[08:31:17] Creating extra output files: BED GFF CSV TXT HTML
[08:31:17] Identified 126 variants.
[08:31:17] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[08:31:17] Result files:
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.aligned.fa
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam.bai
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bed
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.fa
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.subs.fa
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.csv
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.filt.vcf
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.gff
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.html
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.log
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.raw.vcf
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.subs.vcf
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.tab
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.txt
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz
[08:31:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz.csi
[08:31:17] Walltime used: 18 seconds
[08:31:17] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[08:31:17] Done.
[Tue Jun 16 08:31:17 2020]
Finished job 136.
199 of 206 steps (97%) done

[Tue Jun 16 08:31:17 2020]
rule snippy_core:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
    jobid: 205
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32


        snippy-core --prefix /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135 --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp  /Agona_200/snippyout/SG17-135/*.out
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
This is snippy-core 4.4.3
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools.
Found any2fasta - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/binaries/noarch/any2fasta
Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Found minimap2 - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/minimap2
Found bedtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bedtools
Found snp-sites - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snp-sites
Saving reference FASTA: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.ref.fa
This is any2fasta 0.4.2
Opening '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Detected FASTA format
Read 64410 lines from '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Wrote 3 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 3 sequences totalling 5152410 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
ERROR: Could not find .aligned.fa/.vcf in /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp
[Tue Jun 16 08:31:18 2020]
Error in rule snippy_core:
    jobid: 205
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
    conda-env: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
    shell:
        
        snippy-core --prefix /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135 --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp  /Agona_200/snippyout/SG17-135/*.out
        

Shutting down, this might take some time.
Exiting because a job execution failed. Look above for error message
Complete log: /data/malcummi/pipelord/snplord/.snakemake/log/2020-06-16T082133.882812.snakemake.log
['SAL_BB0648AA_AS', 'SAL_CB5376AA_AS', 'SAL_BB7197AA_AS', 'SAL_TA2587AA_AS', 'SAL_AB6160AA_AS', 'SAL_CB9822AA_AS', 'SAL_BA8052AA_AS', 'SAL_AB5674AA_AS', 'SAL_HB5660AA_AS', 'SAL_YA6631AA_AS', 'SAL_CB0088AA_AS', 'SAL_KB1136AA_AS', 'SAL_AB5642AA_AS', 'SAL_BB4431AA_AS', 'SAL_LA7782AA_AS', 'SAL_NA8627AA_AS', 'SAL_IB1406AA_AS', 'SAL_BB6687AA_AS', 'SAL_BA7945AA_AS', 'SAL_WA5465AA_AS', 'SAL_ZA0287AA_AS', 'SAL_BB2593AA_AS', 'SAL_YA9385AA_AS', 'SAL_JB1150AA_AS', 'SAL_BB2131AA_AS', 'SAL_BB1956AA_AS', 'SAL_KB3640AA_AS', 'SAL_AB5909AA_AS', 'SAL_NA5728AA_AS', 'SAL_IB9118AA_AS', 'SAL_IB6779AA_AS', 'SAL_EB5876AA_AS', 'SAL_EB2895AA_AS', 'SAL_KB6830AA_AS', 'SAL_CB1790AA_AS', 'SAL_VA1155AA_AS', 'SAL_HB6699AA_AS', 'SAL_NB6620AA_AS', 'SAL_ZA8731AA_AS', 'SAL_CB9243AA_AS', 'SAL_IB9302AA_AS', 'SAL_BB6441AA_AS', 'SAL_SA9246AA_AS', 'SAL_MB7066AA_AS', 'SAL_IB3115AA_AS', 'SAL_KB4026AA_AS', 'SAL_SA9330AA_AS', 'SAL_BB9086AA_AS', 'SAL_CB1153AA_AS', 'SAL_KB2744AA_AS', 'SAL_BB2899AA_AS', 'SAL_LA7787AA_AS', 'SAL_YA7748AA_AS', 'SAL_LB8076AA_AS', 'SAL_XA1733AA_AS', 'SAL_HB2219AA_AS', 'SAL_KA0676AA_AS', 'SAL_BB9988AA_AS', 'SAL_DB1444AA_AS', 'SAL_BB7261AA_AS', 'SAL_CA4744AA_AS', 'SAL_TA4227AA_AS', 'SAL_KB3375AA_AS', 'SAL_BB5062AA_AS', 'SAL_BB4921AA_AS', 'SAL_EA3229AA_AS', 'SAL_QA4878AA_AS', 'SAL_CB9835AA_AS', 'SAL_IB2995AA_AS', 'SAL_KA4888AA_AS', 'SAL_RA1599AA_AS', 'SAL_CB6250AA_AS', 'SAL_KA8881AA_AS', 'SAL_CB5379AA_AS', 'SAL_SA1344AA_AS', 'SAL_JB0953AA_AS', 'SAL_NB4129AA_AS', 'SAL_CB2598AA_AS', 'SAL_CB9820AA_AS', 'SAL_EB4083AA_AS', 'SAL_SA9173AA_AS', 'SAL_XA3268AA_AS', 'SAL_EB4088AA_AS', 'SAL_EB8845AA_AS', 'SAL_BB9821AA_AS', 'SAL_MB5439AA_AS', 'SAL_JB6580AA_AS', 'SAL_OB6949AA_AS', 'SAL_KB4651AA_AS', 'SAL_KB6773AA_AS', 'SAL_BB3127AA_AS', 'SAL_AB8884AA_AS', 'SAL_UA7989AA_AS', 'SAL_AB7534AA_AS', 'SAL_CB3497AA_AS', 'SAL_CB5468AA_AS', 'SAL_GB0225AA_AS', 'SAL_BA7932AA_AS', 'SAL_OA4072AA_AS', 'SAL_KB1826AA_AS', 'SAL_CB0053AA_AS', 'SAL_BB4524AA_AS', 'SAL_XA3156AA_AS', 'SAL_YA6663AA_AS', 'SAL_BB1371AA_AS', 'SAL_KB6210AA_AS', 'SAL_HB2237AA_AS', 'SAL_CB1324AA_AS', 'SAL_KB1789AA_AS', 'SAL_FB5769AA_AS', 'SAL_KB9523AA_AS', 'SAL_FA5706AA_AS', 'SAL_KB8676AA_AS', 'SAL_AB7634AA_AS', 'SAL_AB7588AA_AS', 'SAL_UA7988AA_AS', 'SAL_AB7542AA_AS', 'SAL_BB4937AA_AS', 'SAL_LB4034AA_AS', 'SAL_KB8607AA_AS', 'SAL_IB6801AA_AS', 'SAL_CA4728AA_AS', 'SAL_XA1782AA_AS', 'SAL_FA1940AA_AS', 'SAL_UA4307AA_AS', 'SAL_IB7996AA_AS', 'SAL_KA0984AA_AS', 'SAL_CB9988AA_AS', 'SAL_EB1045AA_AS', 'SAL_WA9926AA_AS', 'SAL_BB7947AA_AS', 'SAL_MB2521AA_AS', 'SAL_BB1915AA_AS', 'SAL_CB0612AA_AS', 'SAL_LB7623AA_AS', 'SAL_JB5195AA_AS', 'SAL_RA1578AA_AS', 'SAL_WA6251AA_AS', 'SAL_YA6602AA_AS', 'SAL_BB5050AA_AS', 'SAL_HB2224AA_AS', 'SAL_PA3767AA_AS', 'SAL_KB6734AA_AS', 'SAL_BB2970AA_AS', 'SAL_FA2493AA_AS', 'SAL_TA7615AA_AS', 'SAL_TA1967AA_AS', 'SAL_FB8051AA_AS', 'SAL_EB1026AA_AS', 'SAL_KA5244AA_AS', 'SAL_YA6600AA_AS', 'SAL_CB3409AA_AS', 'SAL_BA5105AA_AS', 'SAL_MB7965AA_AS', 'SAL_BB9562AA_AS', 'SAL_BB2967AA_AS', 'SAL_ZA5298AA_AS', 'SAL_JB4414AA_AS', 'SAL_WA5013AA_AS', 'SAL_XA1299AA_AS', 'SAL_IB7540AA_AS', 'SAL_AB9321AA_AS', 'SAL_JA4169AA_AS', 'SAL_PB8418AA_AS', 'SAL_FB7879AA_AS', 'SAL_BB7027AA_AS', 'SAL_CA4803AA_AS', 'SAL_BB8331AA_AS', 'SAL_LA4572AA_AS', 'SAL_SA2453AA_AS', 'SAL_BB1424AA_AS', 'SAL_VA4537AA_AS', 'SAL_TA6324AA_AS', 'SAL_PB5476AA_AS', 'SAL_QA5436AA_AS', 'SAL_JB9710AA_AS', 'SAL_BB1066AA_AS', 'SAL_OA4067AA_AS', 'SAL_CB2372AA_AS', 'SAL_CB2669AA_AS', 'SAL_EB6812AA_AS', 'SAL_SA1324AA_AS', 'SAL_GB5373AA_AS', 'SAL_UA6621AA_AS', 'SAL_CB9389AA_AS', 'SAL_TA1544AA_AS', 'SAL_WA5463AA_AS', 'SAL_CB5243AA_AS', 'SAL_AB5906AA_AS', 'SAL_BB1353AA_AS', 'SAL_KA1119AA_AS', 'SAL_JB5221AA_AS', 'SAL_IA5065AA_AS', 'SAL_BB8135AA_AS', 'SAL_UA4237AA_AS', 'SAL_NA2865AA_AS', 'SAL_JB9521AA_AS', 'SAL_WA2841AA_AS', 'SAL_MA3067AA_AS']
['SG17-135']
