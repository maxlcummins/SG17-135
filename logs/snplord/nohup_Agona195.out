Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 36
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	fasttree
	1	gubbins
	1	snippy_clean
	1	snippy_core
	194	snippy_run
	1	snp_dists
	1	snp_sites
	201

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out
    jobid: 153
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_ZA5298AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out
    jobid: 172
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB9710AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out
    jobid: 44
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_MB7066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out
    jobid: 170
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_PB5476AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out
    jobid: 67
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_QA4878AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out
    jobid: 161
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FB7879AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta

[Fri Jun 19 11:02:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out
    jobid: 103
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB1371AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:15] This is snippy 4.4.3
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Detected operating system: linux
[11:02:15] This is snippy 4.4.3
[11:02:15] Enabling bundled linux tools.
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Detected operating system: linux
[11:02:15] Enabling bundled linux tools.
[11:02:15] This is snippy 4.4.3
[11:02:15] This is snippy 4.4.3
[11:02:15] This is snippy 4.4.3
[11:02:15] Written by Torsten Seemann
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Detected operating system: linux
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] This is snippy 4.4.3
[11:02:15] Detected operating system: linux
[11:02:15] Detected operating system: linux
[11:02:15] Enabling bundled linux tools.
[11:02:15] Enabling bundled linux tools.
[11:02:15] Enabling bundled linux tools.
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Detected operating system: linux
[11:02:15] Enabling bundled linux tools.
[11:02:15] This is snippy 4.4.3
[11:02:15] Written by Torsten Seemann
[11:02:15] Obtained from https://github.com/tseemann/snippy
[11:02:15] Detected operating system: linux
[11:02:15] Enabling bundled linux tools.
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found gzip - /usr/bin/gzip
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out
[11:02:15] Treating reference as 'fasta' format.
[11:02:15] Will use 8 CPU cores.
[11:02:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[11:02:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out
[11:02:15] Creating reference folder: reference
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out
[11:02:15] Creating reference folder: reference
[11:02:15] Creating reference folder: reference
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out
[11:02:15] Creating reference folder: reference
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Creating reference folder: reference
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out
[11:02:15] Creating reference folder: reference
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out
[11:02:15] Creating reference folder: reference
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Extracting FASTA and GFF from reference.
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta into pseudo-reads
[11:02:15] Wrote 3 sequences to ref.fa
[11:02:15] Wrote 0 features to ref.gff
[11:02:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta into pseudo-reads
[11:02:19] Wrote 406412 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_ZA5298AA_AS.out
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Wrote 406056 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Wrote 413060 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Wrote 406280 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Wrote 410630 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_BB1371AA_AS.out
[11:02:19] Wrote 410326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_QA4878AA_AS.out
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_JB9710AA_AS.out
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_MB7066AA_AS.out
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Wrote 414490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_PB5476AA_AS.out
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:19] Using BAM RG (Read Group) ID: SAL_FB7879AA_AS.out
[11:02:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:02:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320004 sequences (80000188 bp)...
[M::process] read 86280 sequences (21535684 bp)...
[M::process] read 86408 sequences (21602000 bp)...
[M::process] read 320084 sequences (80000076 bp)...
[M::process] read 320090 sequences (80000262 bp)...
[M::process] read 320224 sequences (80000224 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 92836 sequences (23202520 bp)...
[M::process] read 90630 sequences (22628860 bp)...
[M::process] read 90236 sequences (22559000 bp)...
[M::process] read 86056 sequences (21495038 bp)...
[M::process] read 94406 sequences (23596172 bp)...
[M::mem_process_seqs] Processed 320224 reads in 18.884 CPU sec, 3.318 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320004 reads in 18.695 CPU sec, 3.855 real sec
[M::mem_process_seqs] Processed 320090 reads in 18.825 CPU sec, 4.015 real sec
[M::mem_process_seqs] Processed 92836 reads in 5.341 CPU sec, 0.643 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86408 reads in 4.666 CPU sec, 0.590 real sec
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 18.048 CPU sec, 4.244 real sec
[M::mem_process_seqs] Processed 320000 reads in 19.227 CPU sec, 4.349 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 90236 reads in 4.883 CPU sec, 0.591 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.058 sec; CPU: 24.810 sec
[samclip] Total SAM records 413310, removed 2191, allowed 165, passed 411119
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 19.191 CPU sec, 5.100 real sec
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 86056 reads in 5.246 CPU sec, 0.641 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 90630 reads in 5.192 CPU sec, 0.658 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320084 reads in 20.750 CPU sec, 5.186 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.838 sec; CPU: 24.012 sec
[samclip] Total SAM records 406715, removed 1929, allowed 105, passed 404786
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 400000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.741 sec; CPU: 24.307 sec
[samclip] Total SAM records 410862, removed 2313, allowed 84, passed 408549
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86280 reads in 4.996 CPU sec, 0.603 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.924 sec; CPU: 23.892 sec
[samclip] Total SAM records 406245, removed 1464, allowed 88, passed 404781
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.127 sec; CPU: 25.046 sec
[samclip] Total SAM records 410973, removed 1976, allowed 116, passed 408997
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 94406 reads in 6.729 CPU sec, 0.783 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.700 sec; CPU: 24.788 sec
[samclip] Total SAM records 406763, removed 2268, allowed 107, passed 404495
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.689 sec; CPU: 27.967 sec
[samclip] Total SAM records 415359, removed 5083, allowed 375, passed 410276
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:28] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:29] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:29] Running: samtools index snps.bam 2>> snps.log
[11:02:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:29] Running: samtools index snps.bam 2>> snps.log
[11:02:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:29] Running: samtools index snps.bam 2>> snps.log
[11:02:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:30] Running: samtools index snps.bam 2>> snps.log
[11:02:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:30] Running: samtools index snps.bam 2>> snps.log
[11:02:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 459
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:02:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 383
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:02:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:32] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:33] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 341
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:33] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 392
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:34] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:34] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2232
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:02:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:35] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:37] Marked 441 heterozygous sites with 'n'
[11:02:37] Creating extra output files: BED GFF CSV TXT HTML
[11:02:37] Identified 459 variants.
[11:02:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out
[11:02:37] Result files:
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.aligned.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam.bai
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bed
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.subs.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.csv
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.filt.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.gff
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.html
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.log
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.raw.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.subs.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.tab
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.txt
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz.csi
[11:02:37] Walltime used: 22 seconds
[11:02:37] Wishing you a life free of homopolymer errors.
[11:02:37] Done.
[Fri Jun 19 11:02:37 2020]
Finished job 67.
1 of 201 steps (0.50%) done

[Fri Jun 19 11:02:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out
    jobid: 183
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA5463AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[11:02:37] Marked 150 heterozygous sites with 'n'
[11:02:37] Creating extra output files: BED GFF CSV TXT HTML
[11:02:37] Identified 383 variants.
[11:02:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out
[11:02:37] Result files:
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.aligned.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam.bai
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bed
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.subs.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.csv
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.filt.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.gff
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.html
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.log
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.raw.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.subs.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.tab
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.txt
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz.csi
[11:02:37] Walltime used: 22 seconds
[11:02:37] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:02:37] Done.
[11:02:37] Marked 188 heterozygous sites with 'n'
[Fri Jun 19 11:02:37 2020]
Finished job 170.
2 of 201 steps (1.00%) done

[Fri Jun 19 11:02:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out
    jobid: 72
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA8881AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
[11:02:37] Creating extra output files: BED GFF CSV TXT HTML
[11:02:37] Identified 398 variants.
[11:02:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[11:02:37] Result files:
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.aligned.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam.bai
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bed
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.subs.fa
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.csv
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.filt.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.gff
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.html
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.log
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.raw.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.subs.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.tab
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.txt
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz
[11:02:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz.csi
[11:02:37] Walltime used: 22 seconds
[11:02:37] May the SNPs be with you.
[11:02:37] Done.
[Fri Jun 19 11:02:37 2020]
Finished job 153.
3 of 201 steps (1%) done

[Fri Jun 19 11:02:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out
    jobid: 157
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB7540AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:37] This is snippy 4.4.3
[11:02:37] Written by Torsten Seemann
[11:02:37] Obtained from https://github.com/tseemann/snippy
[11:02:37] Detected operating system: linux
[11:02:37] Enabling bundled linux tools.
[11:02:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:37] Found gzip - /usr/bin/gzip
[11:02:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:37] Marked 432 heterozygous sites with 'n'
[11:02:38] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:38] Creating extra output files: BED GFF CSV TXT HTML
[11:02:38] Identified 341 variants.
[11:02:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out
[11:02:38] Result files:
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.aligned.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam.bai
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bed
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.subs.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.csv
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.filt.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.gff
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.html
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.log
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.raw.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.subs.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.tab
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.txt
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz.csi
[11:02:38] Walltime used: 23 seconds
[11:02:38] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:02:38] Done.
[Fri Jun 19 11:02:38 2020]
Finished job 103.
4 of 201 steps (2%) done

[Fri Jun 19 11:02:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out
    jobid: 39
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_ZA8731AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[11:02:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:38] Treating reference as 'fasta' format.
[11:02:38] Will use 8 CPU cores.
[11:02:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[11:02:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out
[11:02:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out
[11:02:38] Creating reference folder: reference
[11:02:38] Extracting FASTA and GFF from reference.
[11:02:38] This is snippy 4.4.3
[11:02:38] Written by Torsten Seemann
[11:02:38] Obtained from https://github.com/tseemann/snippy
[11:02:38] Detected operating system: linux
[11:02:38] Enabling bundled linux tools.
[11:02:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:38] Found gzip - /usr/bin/gzip
[11:02:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:38] This is snippy 4.4.3
[11:02:38] Written by Torsten Seemann
[11:02:38] Obtained from https://github.com/tseemann/snippy
[11:02:38] Detected operating system: linux
[11:02:38] Enabling bundled linux tools.
[11:02:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:38] Marked 199 heterozygous sites with 'n'
[11:02:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:38] Found gzip - /usr/bin/gzip
[11:02:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:38] Creating extra output files: BED GFF CSV TXT HTML
[11:02:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:38] Wrote 3 sequences to ref.fa
[11:02:38] Wrote 0 features to ref.gff
[11:02:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta into pseudo-reads
[11:02:38] Identified 401 variants.
[11:02:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out
[11:02:38] Result files:
[11:02:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.aligned.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam.bai
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bed
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.subs.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.csv
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.filt.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.gff
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.html
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.log
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.raw.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.subs.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.tab
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.txt
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz.csi
[11:02:38] Walltime used: 23 seconds
[11:02:38] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:02:38] Done.
[11:02:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[Fri Jun 19 11:02:38 2020]
Finished job 44.
5 of 201 steps (2%) done

[Fri Jun 19 11:02:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out
    jobid: 127
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB1045AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[11:02:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:38] Treating reference as 'fasta' format.
[11:02:38] Will use 8 CPU cores.
[11:02:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
[11:02:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out
[11:02:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out
[11:02:38] Creating reference folder: reference
[11:02:38] Extracting FASTA and GFF from reference.
[11:02:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:38] Treating reference as 'fasta' format.
[11:02:38] Will use 8 CPU cores.
[11:02:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
[11:02:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out
[11:02:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out
[11:02:38] Creating reference folder: reference
[11:02:38] Extracting FASTA and GFF from reference.
[11:02:38] Wrote 3 sequences to ref.fa
[11:02:38] Wrote 0 features to ref.gff
[11:02:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:38] Wrote 3 sequences to ref.fa
[11:02:38] Wrote 0 features to ref.gff
[11:02:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta into pseudo-reads
[11:02:38] Marked 198 heterozygous sites with 'n'
[11:02:38] Creating extra output files: BED GFF CSV TXT HTML
[11:02:38] Identified 392 variants.
[11:02:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out
[11:02:38] Result files:
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.aligned.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam.bai
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bed
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.subs.fa
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.csv
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.filt.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.gff
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.html
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.log
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.raw.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.subs.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.tab
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.txt
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz
[11:02:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz.csi
[11:02:38] Walltime used: 23 seconds
[11:02:38] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:02:38] Done.
[Fri Jun 19 11:02:38 2020]
Finished job 172.
6 of 201 steps (3%) done

[Fri Jun 19 11:02:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out
    jobid: 1
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB0648AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
[11:02:38] This is snippy 4.4.3
[11:02:38] Written by Torsten Seemann
[11:02:38] Obtained from https://github.com/tseemann/snippy
[11:02:38] Detected operating system: linux
[11:02:38] Enabling bundled linux tools.
[11:02:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:38] Found gzip - /usr/bin/gzip
[11:02:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:39] This is snippy 4.4.3
[11:02:39] Written by Torsten Seemann
[11:02:39] Obtained from https://github.com/tseemann/snippy
[11:02:39] Detected operating system: linux
[11:02:39] Enabling bundled linux tools.
[11:02:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:39] Treating reference as 'fasta' format.
[11:02:39] Will use 8 CPU cores.
[11:02:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[11:02:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[11:02:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[11:02:39] Creating reference folder: reference
[11:02:39] Extracting FASTA and GFF from reference.
[11:02:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:39] Found gzip - /usr/bin/gzip
[11:02:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:39] Wrote 3 sequences to ref.fa
[11:02:39] Wrote 0 features to ref.gff
[11:02:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:39] Treating reference as 'fasta' format.
[11:02:39] Will use 8 CPU cores.
[11:02:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[11:02:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out
[11:02:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out
[11:02:39] Creating reference folder: reference
[11:02:39] Extracting FASTA and GFF from reference.
[11:02:39] This is snippy 4.4.3
[11:02:39] Written by Torsten Seemann
[11:02:39] Obtained from https://github.com/tseemann/snippy
[11:02:39] Detected operating system: linux
[11:02:39] Enabling bundled linux tools.
[11:02:39] Wrote 3 sequences to ref.fa
[11:02:39] Wrote 0 features to ref.gff
[11:02:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta into pseudo-reads
[11:02:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:39] Found gzip - /usr/bin/gzip
[11:02:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:39] Treating reference as 'fasta' format.
[11:02:39] Will use 8 CPU cores.
[11:02:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
[11:02:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out
[11:02:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out
[11:02:39] Creating reference folder: reference
[11:02:39] Extracting FASTA and GFF from reference.
[11:02:39] Wrote 3 sequences to ref.fa
[11:02:39] Wrote 0 features to ref.gff
[11:02:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta into pseudo-reads
[11:02:40] Marked 169 heterozygous sites with 'n'
[11:02:40] Creating extra output files: BED GFF CSV TXT HTML
[11:02:40] Identified 2232 variants.
[11:02:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out
[11:02:40] Result files:
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.aligned.fa
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam.bai
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bed
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.fa
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.subs.fa
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.csv
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.filt.vcf
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.gff
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.html
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.log
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.raw.vcf
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.subs.vcf
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.tab
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.txt
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz
[11:02:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz.csi
[11:02:40] Walltime used: 25 seconds
[11:02:40] Questionable SNP? Try the --report option to see the alignments.
[11:02:40] Done.
[Fri Jun 19 11:02:40 2020]
Finished job 161.
7 of 201 steps (3%) done

[Fri Jun 19 11:02:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out
    jobid: 155
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA5013AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:41] Wrote 410514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:41] Using BAM RG (Read Group) ID: SAL_WA5463AA_AS.out
[11:02:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:41] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:41] Wrote 413214 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:41] Using BAM RG (Read Group) ID: SAL_KA8881AA_AS.out
[11:02:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:41] Wrote 405032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:41] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:41] Using BAM RG (Read Group) ID: SAL_IB7540AA_AS.out
[11:02:41] This is snippy 4.4.3
[11:02:41] Written by Torsten Seemann
[11:02:41] Obtained from https://github.com/tseemann/snippy
[11:02:41] Detected operating system: linux
[11:02:41] Enabling bundled linux tools.
[11:02:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:41] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:41] Found gzip - /usr/bin/gzip
[11:02:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:42] Wrote 404780 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:42] Treating reference as 'fasta' format.
[11:02:42] Will use 8 CPU cores.
[11:02:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:42] Using BAM RG (Read Group) ID: SAL_ZA8731AA_AS.out
[11:02:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
[11:02:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out
[11:02:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out
[11:02:42] Creating reference folder: reference
[11:02:42] Extracting FASTA and GFF from reference.
[11:02:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:42] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:42] Wrote 404984 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:42] Using BAM RG (Read Group) ID: SAL_EB1045AA_AS.out
[11:02:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:42] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:42] Wrote 3 sequences to ref.fa
[11:02:42] Wrote 0 features to ref.gff
[11:02:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta into pseudo-reads
[11:02:43] Wrote 406206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:43] Using BAM RG (Read Group) ID: SAL_BB0648AA_AS.out
[11:02:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:02:43] Running: bwa index reference/ref.fa 2>> snps.log
[11:02:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:02:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320132 sequences (80000022 bp)...
[M::process] read 85032 sequences (21258000 bp)...
[M::process] read 90382 sequences (22584208 bp)...
[M::process] read 320186 sequences (80000468 bp)...
[M::process] read 93028 sequences (23245926 bp)...
[11:02:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:02:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 84984 sequences (21244752 bp)...
[11:02:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:45] Wrote 409500 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:02:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:02:45] Using BAM RG (Read Group) ID: SAL_WA5013AA_AS.out
[11:02:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:02:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 84780 sequences (21192786 bp)...
[11:02:45] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320116 sequences (80000194 bp)...
[M::process] read 86090 sequences (21522500 bp)...
[M::mem_process_seqs] Processed 320000 reads in 19.094 CPU sec, 3.113 real sec
[M::mem_process_seqs] Processed 320186 reads in 18.413 CPU sec, 2.986 real sec
[11:02:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:02:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:02:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:02:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:02:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 100000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 85032 reads in 4.958 CPU sec, 0.617 real sec
[M::process] read 320370 sequences (80000034 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 93028 reads in 5.924 CPU sec, 0.719 real sec
[samclip] Processed 200000 records...
[M::process] read 89130 sequences (22267784 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 18.751 CPU sec, 3.514 real sec
[M::mem_process_seqs] Processed 320000 reads in 20.036 CPU sec, 3.681 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 405377, removed 2030, allowed 118, passed 403347

[main] Real time: 4.899 sec; CPU: 24.710 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.831 sec; CPU: 24.940 sec
[samclip] Total SAM records 413454, removed 2921, allowed 296, passed 410533
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 84984 reads in 4.644 CPU sec, 0.581 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320132 reads in 21.398 CPU sec, 5.012 real sec
[M::mem_process_seqs] Processed 84780 reads in 5.019 CPU sec, 0.622 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 90382 reads in 5.398 CPU sec, 0.630 real sec
[M::mem_process_seqs] Processed 320116 reads in 19.626 CPU sec, 3.847 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.302 sec; CPU: 24.058 sec
[samclip] Total SAM records 405367, removed 2039, allowed 122, passed 403328
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.457 sec; CPU: 25.645 sec
[samclip] Total SAM records 405148, removed 2630, allowed 279, passed 402518
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 411033, removed 3773, allowed 393, passed 407260

[main] Real time: 6.545 sec; CPU: 27.349 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 86090 reads in 5.214 CPU sec, 0.611 real sec
[samclip] Processed 300000 records...
[11:02:50] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.294 sec; CPU: 25.363 sec
[samclip] Total SAM records 406412, removed 1570, allowed 112, passed 404842
[samclip] Header contained 5 lines
[samclip] Done.
[11:02:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320370 reads in 20.241 CPU sec, 3.030 real sec
[11:02:50] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 89130 reads in 5.889 CPU sec, 0.691 real sec
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:51] Running: samtools index snps.bam 2>> snps.log
[11:02:51] Running: samtools index snps.bam 2>> snps.log
[11:02:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[11:02:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.587 sec; CPU: 26.675 sec
[samclip] Total SAM records 409939, removed 3495, allowed 278, passed 406444
[samclip] Header contained 5 lines
[samclip] Done.
[11:02:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:52] Running: samtools index snps.bam 2>> snps.log
[11:02:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:52] Running: samtools index snps.bam 2>> snps.log
[11:02:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:02:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 715
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:54] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:54] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:54] Running: samtools index snps.bam 2>> snps.log
[11:02:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:02:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:02:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:55] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:02:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 26
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:02:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:02:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2007
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:02:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:55] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:56] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 338
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:02:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:57] Running: rm -f fake_reads\.fq 2>> snps.log
[11:02:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:58] Marked 224 heterozygous sites with 'n'
[11:02:58] Creating extra output files: BED GFF CSV TXT HTML
[11:02:58] Identified 398 variants.
[11:02:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out
[11:02:58] Result files:
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.aligned.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam.bai
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bed
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.subs.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.csv
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.filt.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.gff
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.html
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.log
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.raw.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.subs.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.tab
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.txt
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz.csi
[11:02:58] Walltime used: 20 seconds
[11:02:58] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:02:58] Done.
[Fri Jun 19 11:02:58 2020]
Finished job 157.
8 of 201 steps (4%) done

[Fri Jun 19 11:02:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out
    jobid: 22
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB2593AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[11:02:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:02:58] Marked 374 heterozygous sites with 'n'

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 27
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 1987
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:02:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:02:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:02:58] Creating extra output files: BED GFF CSV TXT HTML
[11:02:58] Identified 715 variants.
[11:02:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out
[11:02:58] Result files:
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.aligned.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam.bai
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bed
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.subs.fa
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.csv
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.filt.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.gff
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.html
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.log
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.raw.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.subs.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.tab
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.txt
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz
[11:02:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz.csi
[11:02:58] Walltime used: 20 seconds
[11:02:58] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:02:58] Done.
[Fri Jun 19 11:02:58 2020]
Finished job 72.
9 of 201 steps (4%) done

[Fri Jun 19 11:02:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out
    jobid: 182
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA1544AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
[11:02:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:02:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:02:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:02:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:02:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:02:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:02:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:02:59] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:02:59] This is snippy 4.4.3
[11:02:59] Written by Torsten Seemann
[11:02:59] Obtained from https://github.com/tseemann/snippy
[11:02:59] Detected operating system: linux
[11:02:59] Enabling bundled linux tools.
[11:02:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:59] Found gzip - /usr/bin/gzip
[11:02:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:02:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:59] This is snippy 4.4.3
[11:02:59] Written by Torsten Seemann
[11:02:59] Obtained from https://github.com/tseemann/snippy
[11:02:59] Detected operating system: linux
[11:02:59] Enabling bundled linux tools.
[11:02:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:02:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:02:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:02:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:02:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:02:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:02:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:02:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:02:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:02:59] Treating reference as 'fasta' format.
[11:02:59] Will use 8 CPU cores.
[11:02:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[11:02:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out
[11:02:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out
[11:02:59] Creating reference folder: reference
[11:02:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:02:59] Extracting FASTA and GFF from reference.
[11:02:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:02:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:02:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:02:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:02:59] Found gzip - /usr/bin/gzip
[11:02:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:02:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:02:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:02:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:02:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:02:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:02:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:02:59] Marked 236 heterozygous sites with 'n'
[11:02:59] Wrote 3 sequences to ref.fa
[11:02:59] Wrote 0 features to ref.gff
[11:02:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta into pseudo-reads
[11:02:59] Creating extra output files: BED GFF CSV TXT HTML
[11:02:59] Identified 401 variants.
[11:02:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out
[11:02:59] Result files:
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.aligned.fa
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam.bai
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bed
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.fa
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.subs.fa
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.csv
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.filt.vcf
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.gff
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.html
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.log
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.raw.vcf
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.subs.vcf
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.tab
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.txt
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz
[11:02:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz.csi
[11:02:59] Walltime used: 20 seconds
[11:02:59] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:02:59] Done.
[Fri Jun 19 11:02:59 2020]
Finished job 127.
10 of 201 steps (5%) done

[Fri Jun 19 11:02:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out
    jobid: 141
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FA2493AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[11:02:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:02:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:02:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:02:59] Treating reference as 'fasta' format.
[11:02:59] Will use 8 CPU cores.
[11:02:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
[11:02:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out
[11:02:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out
[11:02:59] Creating reference folder: reference
[11:02:59] Extracting FASTA and GFF from reference.
[11:02:59] Wrote 3 sequences to ref.fa
[11:02:59] Wrote 0 features to ref.gff
[11:02:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:00] Marked 169 heterozygous sites with 'n'
[11:03:00] Creating extra output files: BED GFF CSV TXT HTML
[11:03:00] Identified 2000 variants.
[11:03:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[11:03:00] Result files:
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.aligned.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam.bai
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bed
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.subs.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.csv
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.filt.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.gff
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.html
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.log
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.raw.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.subs.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.tab
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.txt
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz.csi
[11:03:00] Walltime used: 22 seconds
[11:03:00] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:03:00] Done.
[Fri Jun 19 11:03:00 2020]
Finished job 39.
11 of 201 steps (5%) done

[Fri Jun 19 11:03:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out
    jobid: 88
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB6773AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[11:03:00] This is snippy 4.4.3
[11:03:00] Written by Torsten Seemann
[11:03:00] Obtained from https://github.com/tseemann/snippy
[11:03:00] Detected operating system: linux
[11:03:00] Enabling bundled linux tools.
[11:03:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:00] Found gzip - /usr/bin/gzip
[11:03:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:00] Marked 189 heterozygous sites with 'n'
[11:03:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:00] Treating reference as 'fasta' format.
[11:03:00] Will use 8 CPU cores.
[11:03:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[11:03:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out
[11:03:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out
[11:03:00] Creating reference folder: reference
[11:03:00] Extracting FASTA and GFF from reference.
[11:03:00] Creating extra output files: BED GFF CSV TXT HTML
[11:03:00] Identified 2007 variants.
[11:03:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out
[11:03:00] Result files:
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.aligned.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam.bai
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bed
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.subs.fa
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.csv
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.filt.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.gff
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.html
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.log
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.raw.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.subs.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.tab
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.txt
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz
[11:03:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz.csi
[11:03:00] Walltime used: 23 seconds
[11:03:00] May the SNPs be with you.
[11:03:00] Done.
[Fri Jun 19 11:03:00 2020]
Finished job 183.
12 of 201 steps (6%) done

[Fri Jun 19 11:03:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out
    jobid: 52
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_LA7787AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[11:03:00] Wrote 3 sequences to ref.fa
[11:03:00] Wrote 0 features to ref.gff
[11:03:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:00] This is snippy 4.4.3
[11:03:00] Written by Torsten Seemann
[11:03:00] Obtained from https://github.com/tseemann/snippy
[11:03:00] Detected operating system: linux
[11:03:00] Enabling bundled linux tools.
[11:03:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:01] Found gzip - /usr/bin/gzip
[11:03:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:01] Marked 430 heterozygous sites with 'n'
[11:03:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:01] Treating reference as 'fasta' format.
[11:03:01] Will use 8 CPU cores.
[11:03:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[11:03:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out
[11:03:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out
[11:03:01] Creating reference folder: reference
[11:03:01] Extracting FASTA and GFF from reference.
[11:03:01] Creating extra output files: BED GFF CSV TXT HTML
[11:03:01] Identified 338 variants.
[11:03:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out
[11:03:01] Result files:
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.aligned.fa
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam.bai
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bed
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.fa
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.subs.fa
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.csv
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.filt.vcf
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.gff
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.html
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.log
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.raw.vcf
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.subs.vcf
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.tab
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.txt
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz
[11:03:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz.csi
[11:03:01] Walltime used: 22 seconds
[11:03:01] May the SNPs be with you.
[11:03:01] Done.
[Fri Jun 19 11:03:01 2020]
Finished job 1.
13 of 201 steps (6%) done

[Fri Jun 19 11:03:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out
    jobid: 150
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_MB7965AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[11:03:01] This is snippy 4.4.3
[11:03:01] Written by Torsten Seemann
[11:03:01] Obtained from https://github.com/tseemann/snippy
[11:03:01] Detected operating system: linux
[11:03:01] Enabling bundled linux tools.
[11:03:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:01] Found gzip - /usr/bin/gzip
[11:03:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:01] Wrote 3 sequences to ref.fa
[11:03:01] Wrote 0 features to ref.gff
[11:03:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta into pseudo-reads
[11:03:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:01] Treating reference as 'fasta' format.
[11:03:01] Will use 8 CPU cores.
[11:03:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[11:03:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out
[11:03:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out
[11:03:01] Creating reference folder: reference
[11:03:01] Extracting FASTA and GFF from reference.
[11:03:01] Wrote 3 sequences to ref.fa
[11:03:01] Wrote 0 features to ref.gff
[11:03:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:01] This is snippy 4.4.3
[11:03:01] Written by Torsten Seemann
[11:03:01] Obtained from https://github.com/tseemann/snippy
[11:03:01] Detected operating system: linux
[11:03:01] Enabling bundled linux tools.
[11:03:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:01] Found gzip - /usr/bin/gzip
[11:03:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:02] Treating reference as 'fasta' format.
[11:03:02] Will use 8 CPU cores.
[11:03:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[11:03:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out
[11:03:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out
[11:03:02] Creating reference folder: reference
[11:03:02] Extracting FASTA and GFF from reference.
[11:03:02] Wrote 3 sequences to ref.fa
[11:03:02] Wrote 0 features to ref.gff
[11:03:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta into pseudo-reads
[11:03:02] Wrote 407900 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:02] Using BAM RG (Read Group) ID: SAL_TA1544AA_AS.out
[11:03:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:02] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:02] Wrote 405698 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:02] Using BAM RG (Read Group) ID: SAL_BB2593AA_AS.out
[11:03:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:02] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:03] Marked 153 heterozygous sites with 'n'
[11:03:03] Creating extra output files: BED GFF CSV TXT HTML
[11:03:03] Identified 1987 variants.
[11:03:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out
[11:03:03] Result files:
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.aligned.fa
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam.bai
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bed
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.fa
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.subs.fa
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.csv
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.filt.vcf
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.gff
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.html
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.log
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.raw.vcf
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.subs.vcf
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.tab
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.txt
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz
[11:03:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz.csi
[11:03:03] Walltime used: 22 seconds
[11:03:03] Wishing you a life free of homopolymer errors.
[11:03:03] Done.
[Fri Jun 19 11:03:03 2020]
Finished job 155.
14 of 201 steps (7%) done

[Fri Jun 19 11:03:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out
    jobid: 142
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA7615AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
[11:03:03] Wrote 410746 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:03] Using BAM RG (Read Group) ID: SAL_FA2493AA_AS.out
[11:03:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:03] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:04] Wrote 407344 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:04] Using BAM RG (Read Group) ID: SAL_KB6773AA_AS.out
[11:03:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:04] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:04] Wrote 408542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:04] Using BAM RG (Read Group) ID: SAL_LA7787AA_AS.out
[11:03:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:04] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:04] This is snippy 4.4.3
[11:03:04] Written by Torsten Seemann
[11:03:04] Obtained from https://github.com/tseemann/snippy
[11:03:04] Detected operating system: linux
[11:03:04] Enabling bundled linux tools.
[11:03:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:04] Found gzip - /usr/bin/gzip
[11:03:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:03:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320000 sequences (80000000 bp)...
[11:03:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:04] Treating reference as 'fasta' format.
[11:03:04] Will use 8 CPU cores.
[11:03:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
[11:03:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out
[11:03:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out
[11:03:04] Creating reference folder: reference
[11:03:04] Extracting FASTA and GFF from reference.
[M::process] read 87900 sequences (21975000 bp)...
[11:03:05] Wrote 3 sequences to ref.fa
[11:03:05] Wrote 0 features to ref.gff
[11:03:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta into pseudo-reads
[M::process] read 320008 sequences (80000064 bp)...
[M::process] read 85690 sequences (21422500 bp)...
[11:03:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:05] Wrote 404884 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:05] Using BAM RG (Read Group) ID: SAL_MB7965AA_AS.out
[11:03:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:05] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320582 sequences (80000206 bp)...
[M::process] read 90164 sequences (22499880 bp)...
[11:03:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:03:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320040 sequences (80000138 bp)...
[M::process] read 320148 sequences (80000262 bp)...
[M::process] read 87304 sequences (21826000 bp)...
[11:03:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320000 reads in 20.265 CPU sec, 2.811 real sec
[M::process] read 320126 sequences (80000292 bp)...
[11:03:07] Wrote 406744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:07] Using BAM RG (Read Group) ID: SAL_TA7615AA_AS.out
[11:03:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:07] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320008 reads in 19.159 CPU sec, 2.954 real sec
[samclip] Processed 100000 records...
[M::process] read 84758 sequences (21189500 bp)...
[M::mem_process_seqs] Processed 87900 reads in 5.791 CPU sec, 0.714 real sec
[M::process] read 88394 sequences (22098500 bp)...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 85690 reads in 5.626 CPU sec, 0.685 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320582 reads in 19.529 CPU sec, 3.327 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out[samclip] Total SAM records 408288, removed 2066, allowed 153, passed 406222
 -t 8[samclip] Header contained 5 lines
 reference/ref.fa[samclip] Done.
 fake_reads.fq
[main] Real time: 4.637 sec; CPU: 26.643 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.792 sec; CPU: 25.364 sec
[samclip] Total SAM records 405987, removed 2166, allowed 277, passed 403821
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 90164 reads in 5.649 CPU sec, 0.677 real sec
[11:03:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320138 sequences (80000040 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.922 sec; CPU: 25.736 sec
[samclip] Total SAM records 411023, removed 3956, allowed 144, passed 407067
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 86606 sequences (21651500 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320040 reads in 18.974 CPU sec, 3.547 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320126 reads in 18.512 CPU sec, 2.874 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320148 reads in 20.483 CPU sec, 4.237 real sec
[M::mem_process_seqs] Processed 87304 reads in 5.781 CPU sec, 0.761 real sec
[11:03:11] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 84758 reads in 4.908 CPU sec, 0.633 real sec
[samclip] Processed 200000 records...
[11:03:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 200000 records...
[11:03:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[11:03:11] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[11:03:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 88394 reads in 5.920 CPU sec, 0.697 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out -t[samclip] Total SAM records 407629, removed 2177, allowed 226, passed 405452
 8 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 5.400 sec; CPU: 25.341 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.665 sec; CPU: 24.045 sec
[samclip] Total SAM records 405031, removed 687, allowed 84, passed 404344
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.813 sec; CPU: 26.924 sec
[samclip] Total SAM records 409091, removed 3332, allowed 310, passed 405759
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:12] Running: samtools index snps.bam 2>> snps.log
[11:03:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320138 reads in 19.561 CPU sec, 3.038 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86606 reads in 5.987 CPU sec, 0.744 real sec
[11:03:14] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[11:03:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:14] Running: samtools index snps.bam 2>> snps.log
[11:03:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[11:03:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:14] Running: samtools index snps.bam 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 395
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.810 sec; CPU: 26.130 sec
[samclip] Total SAM records 407133, removed 2739, allowed 331, passed 404394
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:15] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1980
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 11
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 11

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 11
       total no. variants observed              : 231
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:15] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:16] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:16] Running: samtools index snps.bam 2>> snps.log
[11:03:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 15
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 265
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:17] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:17] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2027
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:18] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:19] Marked 228 heterozygous sites with 'n'
[11:03:19] Creating extra output files: BED GFF CSV TXT HTML
[11:03:19] Identified 395 variants.
[11:03:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out
[11:03:19] Result files:
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.aligned.fa
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam.bai
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bed
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.fa
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.subs.fa
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.csv
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.filt.vcf
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.gff
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.html
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.log
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.raw.vcf
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.subs.vcf
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.tab
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.txt
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz
[11:03:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz.csi
[11:03:19] Walltime used: 20 seconds
[11:03:19] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:03:19] Done.
[Fri Jun 19 11:03:19 2020]
Finished job 182.
15 of 201 steps (7%) done

[Fri Jun 19 11:03:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out
    jobid: 113
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB7588AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:20] Marked 151 heterozygous sites with 'n'
[11:03:20] This is snippy 4.4.3
[11:03:20] Written by Torsten Seemann
[11:03:20] Obtained from https://github.com/tseemann/snippy
[11:03:20] Detected operating system: linux
[11:03:20] Enabling bundled linux tools.
[11:03:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:20] Creating extra output files: BED GFF CSV TXT HTML
[11:03:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:20] Identified 1980 variants.
[11:03:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out
[11:03:20] Result files:
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.aligned.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam.bai
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bed
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.subs.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.csv
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.filt.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.gff
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.html
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.log
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.raw.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.subs.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.tab
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.txt
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz.csi
[11:03:20] Walltime used: 21 seconds
[11:03:20] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:03:20] Done.
[11:03:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[Fri Jun 19 11:03:20 2020]
Finished job 22.
16 of 201 steps (8%) done
[11:03:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader

[Fri Jun 19 11:03:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out
    jobid: 16
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_NA8627AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[11:03:20] Found gzip - /usr/bin/gzip
[11:03:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:20] Marked 12 heterozygous sites with 'n'
[11:03:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:20] Creating extra output files: BED GFF CSV TXT HTML
[11:03:20] Identified 231 variants.
[11:03:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out
[11:03:20] Result files:
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.aligned.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam.bai
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bed
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.subs.fa
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.csv
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.filt.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.gff
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.html
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.log
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.raw.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.subs.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.tab
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.txt
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz
[11:03:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz.csi
[11:03:20] Walltime used: 20 seconds
[11:03:20] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:03:20] Done.
[Fri Jun 19 11:03:20 2020]
Finished job 141.
17 of 201 steps (8%) done

[Fri Jun 19 11:03:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out
    jobid: 49
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB1153AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
[11:03:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:20] Treating reference as 'fasta' format.
[11:03:20] Will use 8 CPU cores.
[11:03:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
[11:03:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out
[11:03:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out
[11:03:20] Creating reference folder: reference
[11:03:20] Extracting FASTA and GFF from reference.

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 24
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2004
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:03:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:20] Wrote 3 sequences to ref.fa
[11:03:20] Wrote 0 features to ref.gff
[11:03:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta into pseudo-reads
[11:03:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:20] This is snippy 4.4.3
[11:03:20] Written by Torsten Seemann
[11:03:20] Obtained from https://github.com/tseemann/snippy
[11:03:20] Detected operating system: linux
[11:03:20] Enabling bundled linux tools.
[11:03:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:20] Found gzip - /usr/bin/gzip
[11:03:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:21] This is snippy 4.4.3
[11:03:21] Written by Torsten Seemann
[11:03:21] Obtained from https://github.com/tseemann/snippy
[11:03:21] Detected operating system: linux
[11:03:21] Enabling bundled linux tools.
[11:03:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:21] Found gzip - /usr/bin/gzip
[11:03:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:21] Treating reference as 'fasta' format.
[11:03:21] Will use 8 CPU cores.
[11:03:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[11:03:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out
[11:03:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out
[11:03:21] Creating reference folder: reference
[11:03:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:21] Extracting FASTA and GFF from reference.
[11:03:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:21] Treating reference as 'fasta' format.
[11:03:21] Will use 8 CPU cores.
[11:03:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
[11:03:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out
[11:03:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out
[11:03:21] Creating reference folder: reference
[11:03:21] Extracting FASTA and GFF from reference.
[11:03:21] Wrote 3 sequences to ref.fa
[11:03:21] Wrote 0 features to ref.gff
[11:03:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta into pseudo-reads
[11:03:21] Wrote 3 sequences to ref.fa
[11:03:21] Wrote 0 features to ref.gff
[11:03:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta into pseudo-reads
[11:03:21] Marked 0 heterozygous sites with 'n'
[11:03:21] Creating extra output files: BED GFF CSV TXT HTML
[11:03:21] Identified 20 variants.
[11:03:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out
[11:03:21] Result files:
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.aligned.fa
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam.bai
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bed
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.fa
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.subs.fa
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.csv
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.filt.vcf
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.gff
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.html
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.log
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.raw.vcf
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.subs.vcf
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.tab
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.txt
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz
[11:03:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz.csi
[11:03:21] Walltime used: 20 seconds
[11:03:21] May the SNPs be with you.
[11:03:21] Done.
[Fri Jun 19 11:03:21 2020]
Finished job 150.
18 of 201 steps (9%) done

[Fri Jun 19 11:03:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out
    jobid: 53
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA7748AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[11:03:22] Marked 654 heterozygous sites with 'n'
[11:03:22] Creating extra output files: BED GFF CSV TXT HTML
[11:03:22] Identified 265 variants.
[11:03:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out
[11:03:22] Result files:
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.aligned.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam.bai
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bed
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.subs.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.csv
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.filt.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.gff
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.html
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.log
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.raw.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.subs.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.tab
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.txt
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz.csi
[11:03:22] Walltime used: 22 seconds
[11:03:22] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:03:22] Done.
[Fri Jun 19 11:03:22 2020]
Finished job 88.
19 of 201 steps (9%) done

[Fri Jun 19 11:03:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out
    jobid: 33
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB2895AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:22] This is snippy 4.4.3
[11:03:22] Written by Torsten Seemann
[11:03:22] Obtained from https://github.com/tseemann/snippy
[11:03:22] Detected operating system: linux
[11:03:22] Enabling bundled linux tools.
[11:03:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:22] Found gzip - /usr/bin/gzip
[11:03:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:22] Marked 69 heterozygous sites with 'n'
[11:03:22] Creating extra output files: BED GFF CSV TXT HTML
[11:03:22] Identified 2027 variants.
[11:03:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out
[11:03:22] Result files:
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.aligned.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam.bai
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bed
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.subs.fa
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.csv
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.filt.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.gff
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.html
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.log
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.raw.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.subs.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.tab
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.txt
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz
[11:03:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz.csi
[11:03:22] Walltime used: 21 seconds
[11:03:22] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:03:22] Done.
[11:03:22] This is snippy 4.4.3
[11:03:22] Written by Torsten Seemann
[11:03:22] Obtained from https://github.com/tseemann/snippy
[11:03:22] Detected operating system: linux
[11:03:22] Enabling bundled linux tools.
[11:03:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[Fri Jun 19 11:03:22 2020]
Finished job 52.
20 of 201 steps (10%) done
[11:03:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:22] Checking version: bwa is >= 7.12 - ok, have 7.17

[Fri Jun 19 11:03:22 2020]
[11:03:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out
    jobid: 20
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA5465AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
[11:03:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:22] Treating reference as 'fasta' format.
[11:03:22] Will use 8 CPU cores.
[11:03:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[11:03:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out
[11:03:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out
[11:03:22] Creating reference folder: reference
[11:03:22] Extracting FASTA and GFF from reference.
[11:03:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:22] Found gzip - /usr/bin/gzip
[11:03:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:23] Wrote 3 sequences to ref.fa
[11:03:23] Wrote 0 features to ref.gff
[11:03:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta into pseudo-reads
[11:03:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:23] Treating reference as 'fasta' format.
[11:03:23] Will use 8 CPU cores.
[11:03:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
[11:03:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out
[11:03:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out
[11:03:23] Creating reference folder: reference
[11:03:23] Extracting FASTA and GFF from reference.
[11:03:23] Wrote 403046 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:23] Using BAM RG (Read Group) ID: SAL_AB7588AA_AS.out
[11:03:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:23] Wrote 3 sequences to ref.fa
[11:03:23] Wrote 0 features to ref.gff
[11:03:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta into pseudo-reads
[11:03:23] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:23] This is snippy 4.4.3
[11:03:23] Written by Torsten Seemann
[11:03:23] Obtained from https://github.com/tseemann/snippy
[11:03:23] Detected operating system: linux
[11:03:23] Enabling bundled linux tools.
[11:03:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:23] Found gzip - /usr/bin/gzip
[11:03:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:24] Wrote 407736 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:24] Using BAM RG (Read Group) ID: SAL_NA8627AA_AS.out
[11:03:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:24] Treating reference as 'fasta' format.
[11:03:24] Will use 8 CPU cores.
[11:03:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
[11:03:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out
[11:03:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out
[11:03:24] Creating reference folder: reference
[11:03:24] Extracting FASTA and GFF from reference.
[11:03:24] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:24] Wrote 402534 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:24] Using BAM RG (Read Group) ID: SAL_CB1153AA_AS.out
[11:03:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:24] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:24] Wrote 3 sequences to ref.fa
[11:03:24] Wrote 0 features to ref.gff
[11:03:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta into pseudo-reads
[11:03:25] Marked 95 heterozygous sites with 'n'
[11:03:25] Creating extra output files: BED GFF CSV TXT HTML
[11:03:25] Identified 2004 variants.
[11:03:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out
[11:03:25] Result files:
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.aligned.fa
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam.bai
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bed
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.fa
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.subs.fa
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.csv
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.filt.vcf
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.gff
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.html
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.log
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.raw.vcf
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.subs.vcf
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.tab
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.txt
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz
[11:03:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz.csi
[11:03:25] Walltime used: 21 seconds
[11:03:25] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:03:25] Done.
[Fri Jun 19 11:03:25 2020]
Finished job 142.
21 of 201 steps (10%) done

[Fri Jun 19 11:03:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out
    jobid: 158
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB9321AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[11:03:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 83046 sequences (20734284 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:25] Wrote 405610 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:25] Using BAM RG (Read Group) ID: SAL_YA7748AA_AS.out
[11:03:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:25] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:03:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:26] This is snippy 4.4.3
[11:03:26] Written by Torsten Seemann
[11:03:26] Obtained from https://github.com/tseemann/snippy
[11:03:26] Detected operating system: linux
[11:03:26] Enabling bundled linux tools.
[11:03:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:26] Wrote 404570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:26] Using BAM RG (Read Group) ID: SAL_EB2895AA_AS.out
[11:03:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:26] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:26] Found gzip - /usr/bin/gzip
[11:03:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:26] Treating reference as 'fasta' format.
[11:03:26] Will use 8 CPU cores.
[11:03:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[11:03:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out
[11:03:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out
[11:03:26] Creating reference folder: reference
[11:03:26] Extracting FASTA and GFF from reference.
[M::process] read 320356 sequences (80000092 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 87380 sequences (21841040 bp)...
[M::process] read 82534 sequences (20616314 bp)...
[11:03:26] Wrote 3 sequences to ref.fa
[11:03:26] Wrote 0 features to ref.gff
[11:03:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta into pseudo-reads
[11:03:27] Wrote 405876 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:27] Using BAM RG (Read Group) ID: SAL_WA5465AA_AS.out
[11:03:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:27] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.714 CPU sec, 2.515 real sec
[11:03:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 100000 records...
[11:03:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320092 sequences (80000466 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 83046 reads in 5.331 CPU sec, 0.619 real sec
[M::process] read 320278 sequences (80000248 bp)...
[M::process] read 85518 sequences (21375596 bp)...
[M::process] read 84292 sequences (21073000 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.056 sec; CPU: 24.616 sec
[samclip] Total SAM records 403383, removed 1599, allowed 139, passed 401784
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 19.962 CPU sec, 2.828 real sec
[11:03:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:29] Wrote 402154 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:29] Using BAM RG (Read Group) ID: SAL_AB9321AA_AS.out
[11:03:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:29] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320356 reads in 21.658 CPU sec, 3.089 real sec
[samclip] Processed 100000 records...
[M::process] read 320220 sequences (80000068 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 82534 reads in 4.978 CPU sec, 0.603 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 87380 reads in 5.239 CPU sec, 0.634 real sec
[M::process] read 85656 sequences (21413362 bp)...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem[samclip] Total SAM records 402828, removed 1466, allowed 132, passed 401362
 -Y -M -R[samclip] Header contained 5 lines
 @RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out[samclip] Done.
 -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.513 sec; CPU: 25.538 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.853 sec; CPU: 27.498 sec
[samclip] Total SAM records 407929, removed 1519, allowed 106, passed 406410
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320092 reads in 18.288 CPU sec, 2.730 real sec
[11:03:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:31] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320278 reads in 19.495 CPU sec, 2.793 real sec
[11:03:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[11:03:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 85518 reads in 5.794 CPU sec, 0.711 real sec
[samclip] Processed 200000 records...
[M::process] read 82154 sequences (20501814 bp)...
[M::mem_process_seqs] Processed 84292 reads in 5.344 CPU sec, 0.637 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.541 sec; CPU: 24.669 sec
[samclip] Total SAM records 405840, removed 1509, allowed 205, passed 404331
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[11:03:32] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.424 sec; CPU: 25.447 sec
[samclip] Total SAM records 404840, removed 868, allowed 67, passed 403972
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:33] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320220 reads in 20.204 CPU sec, 3.423 real sec
[11:03:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 85656 reads in 4.712 CPU sec, 0.606 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 406397, removed 2896, allowed 341, passed 403501
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 5.250 sec; CPU: 25.580 sec
[11:03:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:34] Running: samtools index snps.bam 2>> snps.log
[11:03:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:35] Running: samtools index snps.bam 2>> snps.log
[11:03:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.763 CPU sec, 3.345 real sec
[11:03:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:35] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 82154 reads in 4.977 CPU sec, 0.759 real sec
[samclip] Processed 200000 records...
[11:03:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 351
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[11:03:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.147 sec; CPU: 23.312 sec
[samclip] Total SAM records 402607, removed 1844, allowed 140, passed 400763
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 333
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:36] Running: samtools index snps.bam 2>> snps.log
[11:03:36] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:37] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1803
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 35
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:38] Running: samtools index snps.bam 2>> snps.log
[11:03:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:03:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:38] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:38] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:39] Marked 216 heterozygous sites with 'n'
[11:03:39] Creating extra output files: BED GFF CSV TXT HTML
[11:03:39] Identified 345 variants.
[11:03:39] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out
[11:03:39] Result files:
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.aligned.fa
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam.bai
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bed
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.fa
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.subs.fa
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.csv
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.filt.vcf
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.gff
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.html
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.log
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.raw.vcf
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.subs.vcf
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.tab
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.txt
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz
[11:03:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz.csi
[11:03:39] Walltime used: 19 seconds
[11:03:39] Wishing you a life free of homopolymer errors.
[11:03:39] Done.
[Fri Jun 19 11:03:39 2020]
Finished job 113.
22 of 201 steps (11%) done

[Fri Jun 19 11:03:39 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out
    jobid: 147
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA6600AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:40] This is snippy 4.4.3
[11:03:40] Written by Torsten Seemann
[11:03:40] Obtained from https://github.com/tseemann/snippy
[11:03:40] Detected operating system: linux
[11:03:40] Enabling bundled linux tools.
[11:03:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:40] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:40] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:40] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:40] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:40] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:40] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:40] Found gzip - /usr/bin/gzip
[11:03:40] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:40] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:40] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:40] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:40] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:40] Treating reference as 'fasta' format.
[11:03:40] Will use 8 CPU cores.
[11:03:40] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
[11:03:40] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out
[11:03:40] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out
[11:03:40] Creating reference folder: reference
[11:03:40] Extracting FASTA and GFF from reference.
[11:03:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:40] Wrote 3 sequences to ref.fa
[11:03:40] Wrote 0 features to ref.gff
[11:03:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta into pseudo-reads
[11:03:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:41] Marked 216 heterozygous sites with 'n'
[11:03:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:41] Creating extra output files: BED GFF CSV TXT HTML
[11:03:41] Identified 351 variants.
[11:03:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out
[11:03:41] Result files:
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.aligned.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam.bai
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bed
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.subs.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.csv
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.filt.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.gff
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.html
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.log
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.raw.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.subs.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.tab
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.txt
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz.csi
[11:03:41] Walltime used: 20 seconds
[11:03:41] Questionable SNP? Try the --report option to see the alignments.
[11:03:41] Done.
[Fri Jun 19 11:03:41 2020]
Finished job 49.
23 of 201 steps (11%) done

[Fri Jun 19 11:03:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out
    jobid: 110
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FA5706AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[11:03:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:41] Marked 431 heterozygous sites with 'n'
[11:03:41] Creating extra output files: BED GFF CSV TXT HTML
[11:03:41] Identified 333 variants.
[11:03:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out
[11:03:41] Result files:
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.aligned.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam.bai
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bed
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.subs.fa
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.csv
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.filt.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.gff
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.html
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.log
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.raw.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.subs.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.tab
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.txt
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz
[11:03:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz.csi
[11:03:41] Walltime used: 21 seconds
[11:03:41] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:03:41] Done.
[Fri Jun 19 11:03:41 2020]
Finished job 16.
24 of 201 steps (12%) done

[Fri Jun 19 11:03:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out
    jobid: 121
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_XA1782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:41] This is snippy 4.4.3
[11:03:41] Written by Torsten Seemann
[11:03:41] Obtained from https://github.com/tseemann/snippy
[11:03:41] Detected operating system: linux
[11:03:41] Enabling bundled linux tools.
[11:03:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:41] Found gzip - /usr/bin/gzip
[11:03:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:42] Treating reference as 'fasta' format.
[11:03:42] Will use 8 CPU cores.
[11:03:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[11:03:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out
[11:03:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out
[11:03:42] Creating reference folder: reference
[11:03:42] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:42] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:42] Wrote 3 sequences to ref.fa
[11:03:42] Wrote 0 features to ref.gff
[11:03:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta into pseudo-reads
[11:03:42] This is snippy 4.4.3
[11:03:42] Written by Torsten Seemann
[11:03:42] Obtained from https://github.com/tseemann/snippy
[11:03:42] Detected operating system: linux
[11:03:42] Enabling bundled linux tools.
[11:03:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:42] Found gzip - /usr/bin/gzip
[11:03:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:42] Treating reference as 'fasta' format.
[11:03:42] Will use 8 CPU cores.
[11:03:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
[11:03:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out
[11:03:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out
[11:03:42] Creating reference folder: reference
[11:03:42] Extracting FASTA and GFF from reference.
[11:03:42] Wrote 3 sequences to ref.fa
[11:03:42] Wrote 0 features to ref.gff
[11:03:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta into pseudo-reads
[11:03:42] Marked 0 heterozygous sites with 'n'
[11:03:43] Creating extra output files: BED GFF CSV TXT HTML
[11:03:43] Identified 35 variants.
[11:03:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out
[11:03:43] Result files:
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.aligned.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam.bai
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bed
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.subs.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.csv
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.filt.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.gff
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.html
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.log
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.raw.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.subs.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.tab
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.txt
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz.csi
[11:03:43] Walltime used: 21 seconds
[11:03:43] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:03:43] Done.
[Fri Jun 19 11:03:43 2020]
Finished job 33.
25 of 201 steps (12%) done

[Fri Jun 19 11:03:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out
    jobid: 15
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_LA7782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[11:03:43] Marked 0 heterozygous sites with 'n'
[11:03:43] Creating extra output files: BED GFF CSV TXT HTML
[11:03:43] Identified 1803 variants.
[11:03:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out
[11:03:43] Result files:
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.aligned.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam.bai
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bed
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.subs.fa
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.csv
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.filt.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.gff
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.html
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.log
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.raw.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.subs.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.tab
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.txt
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz
[11:03:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz.csi
[11:03:43] Walltime used: 21 seconds
[11:03:43] Questionable SNP? Try the --report option to see the alignments.
[11:03:43] Done.
[Fri Jun 19 11:03:43 2020]
Finished job 53.
26 of 201 steps (13%) done

[Fri Jun 19 11:03:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out
    jobid: 135
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA6602AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[11:03:43] Wrote 404506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:43] Using BAM RG (Read Group) ID: SAL_YA6600AA_AS.out
[11:03:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:43] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:43] This is snippy 4.4.3
[11:03:43] Written by Torsten Seemann
[11:03:43] Obtained from https://github.com/tseemann/snippy
[11:03:43] Detected operating system: linux
[11:03:43] Enabling bundled linux tools.
[11:03:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:43] Found gzip - /usr/bin/gzip
[11:03:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:44] This is snippy 4.4.3
[11:03:44] Written by Torsten Seemann
[11:03:44] Obtained from https://github.com/tseemann/snippy
[11:03:44] Detected operating system: linux
[11:03:44] Enabling bundled linux tools.
[11:03:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:44] Found gzip - /usr/bin/gzip
[11:03:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:44] Treating reference as 'fasta' format.
[11:03:44] Will use 8 CPU cores.
[11:03:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[11:03:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out
[11:03:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out
[11:03:44] Creating reference folder: reference
[11:03:44] Extracting FASTA and GFF from reference.
[11:03:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:44] Treating reference as 'fasta' format.
[11:03:44] Will use 8 CPU cores.
[11:03:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[11:03:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out
[11:03:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out
[11:03:44] Creating reference folder: reference
[11:03:44] Extracting FASTA and GFF from reference.
[11:03:44] Wrote 3 sequences to ref.fa
[11:03:44] Wrote 0 features to ref.gff
[11:03:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta into pseudo-reads
[11:03:44] Wrote 3 sequences to ref.fa
[11:03:44] Wrote 0 features to ref.gff
[11:03:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta into pseudo-reads
[11:03:45] Wrote 404550 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:45] Using BAM RG (Read Group) ID: SAL_FA5706AA_AS.out
[11:03:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:45] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:45] Marked 117 heterozygous sites with 'n'
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:45] Creating extra output files: BED GFF CSV TXT HTML
[11:03:45] Identified 2000 variants.
[11:03:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out
[11:03:45] Result files:
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.aligned.fa
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam.bai
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bed
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.fa
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.subs.fa
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.csv
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.filt.vcf
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.gff
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.html
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.log
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.raw.vcf
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.subs.vcf
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.tab
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.txt
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz
[11:03:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz.csi
[11:03:45] Walltime used: 22 seconds
[11:03:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:03:45] Done.
[Fri Jun 19 11:03:45 2020]
Finished job 20.
27 of 201 steps (13%) done

[Fri Jun 19 11:03:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out
    jobid: 131
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB1915AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
[M::process] read 320054 sequences (80000362 bp)...
[11:03:45] Wrote 405058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:45] Using BAM RG (Read Group) ID: SAL_XA1782AA_AS.out
[11:03:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:45] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 84452 sequences (21101846 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:46] This is snippy 4.4.3
[11:03:46] Written by Torsten Seemann
[11:03:46] Obtained from https://github.com/tseemann/snippy
[11:03:46] Detected operating system: linux
[11:03:46] Enabling bundled linux tools.
[11:03:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:46] Found gzip - /usr/bin/gzip
[11:03:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:03:46] Marked 224 heterozygous sites with 'n'
[11:03:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:46] Creating extra output files: BED GFF CSV TXT HTML
[11:03:46] Treating reference as 'fasta' format.
[11:03:46] Will use 8 CPU cores.
[11:03:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
[11:03:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out
[11:03:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out
[11:03:46] Creating reference folder: reference
[11:03:46] Extracting FASTA and GFF from reference.
[11:03:46] Identified 345 variants.
[11:03:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out
[11:03:46] Result files:
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.aligned.fa
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam.bai
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bed
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.fa
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.subs.fa
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.csv
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.filt.vcf
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.gff
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.html
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.log
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.raw.vcf
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.subs.vcf
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.tab
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.txt
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz
[11:03:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz.csi
[11:03:46] Walltime used: 20 seconds
[11:03:46] May the SNPs be with you.
[11:03:46] Done.
[Fri Jun 19 11:03:46 2020]
Finished job 158.
28 of 201 steps (14%) done

[Fri Jun 19 11:03:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out
    jobid: 94
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB5468AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[11:03:46] Wrote 3 sequences to ref.fa
[11:03:46] Wrote 0 features to ref.gff
[11:03:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta into pseudo-reads
[11:03:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:47] Running: ln -sf reference/ref.fa . 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:03:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:47] Wrote 405414 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:47] Using BAM RG (Read Group) ID: SAL_LA7782AA_AS.out
[11:03:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:47] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:47] Wrote 404406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:47] Using BAM RG (Read Group) ID: SAL_YA6602AA_AS.out
[11:03:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:47] Running: bwa index reference/ref.fa 2>> snps.log
[11:03:47] This is snippy 4.4.3
[11:03:47] Written by Torsten Seemann
[11:03:47] Obtained from https://github.com/tseemann/snippy
[11:03:47] Detected operating system: linux
[11:03:47] Enabling bundled linux tools.
[11:03:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:03:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:03:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:03:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:03:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:03:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:03:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:03:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:03:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:03:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:03:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:03:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:03:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:03:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:03:47] Found gzip - /usr/bin/gzip
[11:03:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:03:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:03:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:03:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:03:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:03:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:03:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320054 sequences (80000082 bp)...
[11:03:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 84496 sequences (21118820 bp)...
[11:03:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:03:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:03:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:03:47] Treating reference as 'fasta' format.
[11:03:47] Will use 8 CPU cores.
[11:03:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[11:03:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out
[11:03:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out
[11:03:47] Creating reference folder: reference
[11:03:47] Extracting FASTA and GFF from reference.
[11:03:47] Wrote 3 sequences to ref.fa
[11:03:47] Wrote 0 features to ref.gff
[11:03:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320054 reads in 18.562 CPU sec, 2.449 real sec
[M::process] read 320182 sequences (80000392 bp)...
[M::process] read 84876 sequences (21209724 bp)...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 84452 reads in 5.693 CPU sec, 0.665 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 404993, removed 3185, allowed 439, passed 401808

[main] Real time: 3.870 sec; CPU: 24.755 sec
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:03:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:49] Wrote 400510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:49] Using BAM RG (Read Group) ID: SAL_BB1915AA_AS.out
[11:03:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:03:49] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320080 sequences (80000452 bp)...
[M::process] read 320150 sequences (80000310 bp)...
[M::process] read 85334 sequences (21318726 bp)...
[M::process] read 84256 sequences (21053322 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320054 reads in 19.130 CPU sec, 2.764 real sec
[11:03:50] Wrote 399890 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:03:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:03:50] Using BAM RG (Read Group) ID: SAL_CB5468AA_AS.out
[11:03:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320182 reads in 18.810 CPU sec, 2.708 real sec
[11:03:50] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[11:03:51] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 84496 reads in 6.747 CPU sec, 0.818 real sec
[11:03:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:03:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:03:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 200000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:03:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 84876 reads in 6.405 CPU sec, 0.763 real sec
[samclip] Processed 300000 records...
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.515 sec; CPU: 26.427 sec
[samclip] Total SAM records 404881, removed 2154, allowed 357, passed 402727
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.275 sec; CPU: 25.744 sec
[samclip] Total SAM records 405367, removed 2700, allowed 170, passed 402667
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320080 reads in 19.956 CPU sec, 2.976 real sec
[11:03:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:03:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:03:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:03:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320150 reads in 19.713 CPU sec, 3.234 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320032 sequences (80000134 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 85334 reads in 5.842 CPU sec, 0.702 real sec
[samclip] Processed 100000 records...
[M::process] read 79858 sequences (19922496 bp)...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 84256 reads in 5.997 CPU sec, 0.723 real sec
[samclip] Processed 200000 records...
[M::process] read 80510 sequences (20127500 bp)...
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.600 sec; CPU: 26.342 sec
[samclip] Total SAM records 405778, removed 2756, allowed 243, passed 403022
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:53] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:54] Running: samtools index snps.bam 2>> snps.log
[11:03:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.898 sec; CPU: 26.278 sec
[samclip] Total SAM records 404746, removed 3172, allowed 410, passed 401574
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 25
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2099
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:03:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:03:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.100 CPU sec, 3.546 real sec
[11:03:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:55] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 80510 reads in 4.829 CPU sec, 0.596 real sec
[samclip] Processed 200000 records...
[11:03:56] Running: samtools index snps.bam 2>> snps.log
[11:03:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[11:03:56] Running: samtools index snps.bam 2>> snps.log
[11:03:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320032 reads in 18.446 CPU sec, 3.478 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.253 sec; CPU: 23.526 sec
[samclip] Total SAM records 400671, removed 744, allowed 46, passed 399927
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 79858 reads in 4.060 CPU sec, 0.556 real sec
[samclip] Processed 100000 records...
[11:03:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 130
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:03:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1842
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:03:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:03:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:57] Running: rm -f fake_reads\.fq 2>> snps.log
[11:03:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:03:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:03:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:03:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:03:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:03:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:03:57] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.335 sec; CPU: 23.165 sec
[samclip] Total SAM records 400217, removed 960, allowed 90, passed 399257
[samclip] Header contained 5 lines
[samclip] Done.
[11:03:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:58] Running: samtools index snps.bam 2>> snps.log
[11:03:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:03:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:03:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:03:59] Marked 96 heterozygous sites with 'n'

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 2010
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:59] Creating extra output files: BED GFF CSV TXT HTML
[11:03:59] Identified 2099 variants.
[11:03:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out
[11:03:59] Result files:
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.aligned.fa
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam.bai
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bed
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.fa
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.subs.fa
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.csv
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.filt.vcf
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.gff
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.html
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.log
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.raw.vcf
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.subs.vcf
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.tab
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.txt
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz
[11:03:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz.csi
[11:03:59] Walltime used: 19 seconds
[11:03:59] Questionable SNP? Try the --report option to see the alignments.
[11:03:59] Done.
[Fri Jun 19 11:03:59 2020]
Finished job 147.
29 of 201 steps (14%) done

[Fri Jun 19 11:03:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out
    jobid: 62
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA4227AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[11:03:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:03:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 26
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 2097
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:03:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:03:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:03:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:03:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:00] Running: samtools index snps.bam 2>> snps.log
[11:04:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:04:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:00] This is snippy 4.4.3
[11:04:00] Written by Torsten Seemann
[11:04:00] Obtained from https://github.com/tseemann/snippy
[11:04:00] Detected operating system: linux
[11:04:00] Enabling bundled linux tools.
[11:04:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:00] Found gzip - /usr/bin/gzip
[11:04:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:00] Treating reference as 'fasta' format.
[11:04:00] Will use 8 CPU cores.
[11:04:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[11:04:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out
[11:04:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out
[11:04:00] Creating reference folder: reference
[11:04:00] Extracting FASTA and GFF from reference.
[11:04:00] Wrote 3 sequences to ref.fa
[11:04:00] Wrote 0 features to ref.gff
[11:04:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta into pseudo-reads
[11:04:01] Marked 3 heterozygous sites with 'n'
[11:04:01] Creating extra output files: BED GFF CSV TXT HTML
[11:04:01] Identified 130 variants.
[11:04:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out
[11:04:01] Result files:
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.aligned.fa
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam.bai
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bed
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.fa
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.subs.fa
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.csv
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.filt.vcf
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.gff
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.html
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.log
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.raw.vcf
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.subs.vcf
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.tab
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.txt
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz
[11:04:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz.csi
[11:04:01] Walltime used: 19 seconds
[11:04:01] Wishing you a life free of homopolymer errors.
[11:04:01] Done.
[Fri Jun 19 11:04:01 2020]
Finished job 121.
30 of 201 steps (15%) done

[Fri Jun 19 11:04:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out
    jobid: 134
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA6251AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[11:04:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:02] Marked 7 heterozygous sites with 'n'
[11:04:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:02] Creating extra output files: BED GFF CSV TXT HTML
[11:04:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:02] Identified 1842 variants.
[11:04:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out
[11:04:02] Result files:
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.aligned.fa
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam.bai
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bed
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.fa
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.subs.fa
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.csv
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.filt.vcf
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.gff
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.html
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.log
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.raw.vcf
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.subs.vcf
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.tab
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.txt
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz
[11:04:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz.csi
[11:04:02] Walltime used: 21 seconds
[11:04:02] May the SNPs be with you.
[11:04:02] Done.
[Fri Jun 19 11:04:02 2020]
Finished job 110.
31 of 201 steps (15%) done

[Fri Jun 19 11:04:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out
    jobid: 4
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA2587AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[11:04:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:02] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:02] This is snippy 4.4.3
[11:04:02] Written by Torsten Seemann
[11:04:02] Obtained from https://github.com/tseemann/snippy
[11:04:02] Detected operating system: linux
[11:04:02] Enabling bundled linux tools.
[11:04:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:02] Found gzip - /usr/bin/gzip
[11:04:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:02] Treating reference as 'fasta' format.
[11:04:02] Will use 8 CPU cores.
[11:04:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[11:04:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out
[11:04:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out
[11:04:02] Creating reference folder: reference
[11:04:02] Extracting FASTA and GFF from reference.
[11:04:02] This is snippy 4.4.3
[11:04:02] Written by Torsten Seemann
[11:04:02] Obtained from https://github.com/tseemann/snippy
[11:04:02] Detected operating system: linux
[11:04:02] Enabling bundled linux tools.
[11:04:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:03] Found gzip - /usr/bin/gzip
[11:04:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:03] Wrote 3 sequences to ref.fa
[11:04:03] Wrote 0 features to ref.gff
[11:04:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta into pseudo-reads
[11:04:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:03] Treating reference as 'fasta' format.
[11:04:03] Will use 8 CPU cores.
[11:04:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[11:04:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out
[11:04:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out
[11:04:03] Creating reference folder: reference
[11:04:03] Extracting FASTA and GFF from reference.
[11:04:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:03] Wrote 3 sequences to ref.fa
[11:04:03] Wrote 0 features to ref.gff
[11:04:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta into pseudo-reads
[11:04:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:03] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:03] Wrote 403620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:03] Using BAM RG (Read Group) ID: SAL_TA4227AA_AS.out
[11:04:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:03] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:04] Marked 9 heterozygous sites with 'n'
[11:04:04] Creating extra output files: BED GFF CSV TXT HTML
[11:04:04] Identified 2010 variants.
[11:04:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out
[11:04:04] Result files:
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.aligned.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam.bai
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bed
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.subs.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.csv
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.filt.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.gff
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.html
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.log
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.raw.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.subs.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.tab
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.txt
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz.csi
[11:04:04] Walltime used: 21 seconds
[11:04:04] May the SNPs be with you.
[11:04:04] Done.
[Fri Jun 19 11:04:04 2020]
Finished job 15.
32 of 201 steps (16%) done

[Fri Jun 19 11:04:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out
    jobid: 54
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_LB8076AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[11:04:04] Marked 95 heterozygous sites with 'n'
[11:04:04] Creating extra output files: BED GFF CSV TXT HTML
[11:04:04] Identified 2097 variants.
[11:04:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out
[11:04:04] Result files:
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.aligned.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam.bai
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bed
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.subs.fa
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.csv
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.filt.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.gff
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.html
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.log
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.raw.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.subs.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.tab
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.txt
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz
[11:04:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz.csi
[11:04:04] Walltime used: 20 seconds
[11:04:04] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:04:04] Done.
[Fri Jun 19 11:04:04 2020]
Finished job 135.
33 of 201 steps (16%) done

[Fri Jun 19 11:04:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out
    jobid: 171
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_QA5436AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:05] This is snippy 4.4.3
[11:04:05] Written by Torsten Seemann
[11:04:05] Obtained from https://github.com/tseemann/snippy
[11:04:05] Detected operating system: linux
[11:04:05] Enabling bundled linux tools.
[11:04:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:05] Found gzip - /usr/bin/gzip
[11:04:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:04:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:04:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:05] This is snippy 4.4.3
[11:04:05] Written by Torsten Seemann
[11:04:05] Obtained from https://github.com/tseemann/snippy
[11:04:05] Detected operating system: linux
[11:04:05] Enabling bundled linux tools.
[11:04:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:05] Treating reference as 'fasta' format.
[11:04:05] Will use 8 CPU cores.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[11:04:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[11:04:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out
[11:04:05] Creating reference folder: reference
[11:04:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:05] Extracting FASTA and GFF from reference.
[11:04:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:05] Found gzip - /usr/bin/gzip
[11:04:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:05] Wrote 3 sequences to ref.fa
[11:04:05] Wrote 0 features to ref.gff
[11:04:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta into pseudo-reads
[M::process] read 320186 sequences (80000138 bp)...
[11:04:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:05] Treating reference as 'fasta' format.
[11:04:05] Will use 8 CPU cores.
[11:04:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
[11:04:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out
[11:04:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out
[11:04:05] Creating reference folder: reference
[11:04:05] Extracting FASTA and GFF from reference.
[11:04:05] Wrote 405514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[M::process] read 83434 sequences (20847472 bp)...
[11:04:05] Using BAM RG (Read Group) ID: SAL_WA6251AA_AS.out
[11:04:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:06] Wrote 3 sequences to ref.fa
[11:04:06] Wrote 0 features to ref.gff
[11:04:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta into pseudo-reads
[11:04:06] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:06] Wrote 403896 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:06] Marked 0 heterozygous sites with 'n'
[11:04:06] Creating extra output files: BED GFF CSV TXT HTML
[11:04:06] Identified 19 variants.
[11:04:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out
[11:04:06] Result files:
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.aligned.fa
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam.bai
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bed
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.fa
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.subs.fa
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.csv
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.filt.vcf
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.gff
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.html
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.log
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.raw.vcf
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.subs.vcf
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.tab
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.txt
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz
[11:04:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz.csi
[11:04:06] Walltime used: 20 seconds
[11:04:06] Questionable SNP? Try the --report option to see the alignments.
[11:04:06] Done.
[11:04:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:06] Using BAM RG (Read Group) ID: SAL_TA2587AA_AS.out
[11:04:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[Fri Jun 19 11:04:06 2020]
Finished job 131.
34 of 201 steps (17%) done

[Fri Jun 19 11:04:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out
    jobid: 65
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB4921AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[11:04:06] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:07] This is snippy 4.4.3
[11:04:07] Written by Torsten Seemann
[11:04:07] Obtained from https://github.com/tseemann/snippy
[11:04:07] Detected operating system: linux
[11:04:07] Enabling bundled linux tools.
[11:04:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:07] Found gzip - /usr/bin/gzip
[11:04:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:07] Treating reference as 'fasta' format.
[11:04:07] Will use 8 CPU cores.
[11:04:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[11:04:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out
[11:04:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out
[11:04:07] Creating reference folder: reference
[11:04:07] Extracting FASTA and GFF from reference.
[11:04:07] Wrote 3 sequences to ref.fa
[11:04:07] Wrote 0 features to ref.gff
[11:04:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta into pseudo-reads
[11:04:07] Marked 0 heterozygous sites with 'n'
[11:04:07] Creating extra output files: BED GFF CSV TXT HTML
[11:04:07] Identified 25 variants.
[11:04:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out
[11:04:07] Result files:
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.aligned.fa
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam.bai
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bed
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.fa
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.subs.fa
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.csv
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.filt.vcf
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.gff
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.html
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.log
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.raw.vcf
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.subs.vcf
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.tab
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.txt
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz
[11:04:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz.csi
[11:04:07] Walltime used: 20 seconds
[11:04:07] May the SNPs be with you.
[11:04:07] Done.
[Fri Jun 19 11:04:07 2020]
Finished job 94.
35 of 201 steps (17%) done

[Fri Jun 19 11:04:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out
    jobid: 184
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB5243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
[11:04:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320166 sequences (80000378 bp)...
[11:04:08] Wrote 399724 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:08] Using BAM RG (Read Group) ID: SAL_LB8076AA_AS.out
[11:04:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:08] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320186 reads in 19.999 CPU sec, 2.704 real sec
[M::process] read 85348 sequences (21329224 bp)...
[M::process] read 320232 sequences (80000328 bp)...
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 83664 sequences (20911040 bp)...
[11:04:08] Wrote 403504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:08] Using BAM RG (Read Group) ID: SAL_QA5436AA_AS.out
[11:04:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:08] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[11:04:09] This is snippy 4.4.3
[11:04:09] Written by Torsten Seemann
[11:04:09] Obtained from https://github.com/tseemann/snippy
[11:04:09] Detected operating system: linux
[11:04:09] Enabling bundled linux tools.
[11:04:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:09] Found gzip - /usr/bin/gzip
[11:04:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 83434 reads in 5.528 CPU sec, 0.636 real sec
[11:04:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 300000 records...
[11:04:09] Treating reference as 'fasta' format.
[11:04:09] Will use 8 CPU cores.
[11:04:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
[11:04:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out
[11:04:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out
[11:04:09] Creating reference folder: reference
[11:04:09] Extracting FASTA and GFF from reference.
[11:04:09] Wrote 3 sequences to ref.fa
[11:04:09] Wrote 0 features to ref.gff
[11:04:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta into pseudo-reads
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.135 sec; CPU: 26.061 sec
[samclip] Total SAM records 403869, removed 2657, allowed 178, passed 401212
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:10] Wrote 397582 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:10] Using BAM RG (Read Group) ID: SAL_BB4921AA_AS.out
[11:04:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:10] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320116 sequences (80000394 bp)...
[M::process] read 79608 sequences (19902000 bp)...
[M::mem_process_seqs] Processed 320166 reads in 18.817 CPU sec, 2.489 real sec
[11:04:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320232 reads in 18.838 CPU sec, 2.521 real sec
[M::process] read 320164 sequences (80000414 bp)...
[M::mem_process_seqs] Processed 85348 reads in 4.755 CPU sec, 0.566 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::process] read 83340 sequences (20806156 bp)...
[11:04:11] Running: samtools index snps.bam 2>> snps.log
[11:04:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 83664 reads in 5.421 CPU sec, 0.630 real sec
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.054 sec; CPU: 24.131 sec
[samclip] Total SAM records 405808, removed 2367, allowed 207, passed 403441
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:12] Wrote 398166 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:12] Using BAM RG (Read Group) ID: SAL_CB5243AA_AS.out
[11:04:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:12] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.018 sec; CPU: 24.811 sec
[samclip] Total SAM records 404132, removed 2606, allowed 194, passed 401526
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 77582 sequences (19392188 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320116 reads in 17.978 CPU sec, 2.768 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320164 reads in 17.590 CPU sec, 2.715 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 79608 reads in 5.111 CPU sec, 0.601 real sec
[11:04:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:04:14] Running: samtools index snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[11:04:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[11:04:14] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 200000 records...
[11:04:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 83340 reads in 5.374 CPU sec, 0.641 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out -t[samclip] Total SAM records 400362, removed 2981, allowed 142, passed 397381
 8 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.389 sec; CPU: 23.623 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 669
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:04:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 78166 sequences (19480154 bp)...
[11:04:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 400000 records...
[11:04:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.245 sec; CPU: 23.491 sec
[samclip] Total SAM records 403759, removed 2662, allowed 189, passed 401097
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:15] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 19.418 CPU sec, 3.023 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 77582 reads in 4.844 CPU sec, 0.592 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[11:04:16] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.650 sec; CPU: 24.853 sec
[samclip] Total SAM records 397955, removed 1774, allowed 218, passed 396181
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:04:17] Running: samtools index snps.bam 2>> snps.log
[11:04:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.614 CPU sec, 3.017 real sec
[11:04:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 317
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 687
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:04:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:18] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[11:04:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 78166 reads in 4.751 CPU sec, 0.553 real sec
[11:04:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:18] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.423 sec; CPU: 23.896 sec
[samclip] Total SAM records 398723, removed 1507, allowed 93, passed 397216
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:19] Running: samtools index snps.bam 2>> snps.log
[11:04:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:19] Marked 381 heterozygous sites with 'n'
[11:04:19] Creating extra output files: BED GFF CSV TXT HTML
[11:04:19] Identified 669 variants.
[11:04:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out
[11:04:19] Result files:
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.aligned.fa
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam.bai
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bed
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.fa
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.subs.fa
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.csv
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.filt.vcf
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.gff
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.html
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.log
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.raw.vcf
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.subs.vcf
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.tab
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.txt
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz
[11:04:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz.csi
[11:04:19] Walltime used: 19 seconds
[11:04:19] Questionable SNP? Try the --report option to see the alignments.
[11:04:19] Done.
[Fri Jun 19 11:04:19 2020]
Finished job 62.
36 of 201 steps (18%) done

[Fri Jun 19 11:04:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out
    jobid: 69
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA4888AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[11:04:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 388
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 672
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:20] This is snippy 4.4.3
[11:04:20] Written by Torsten Seemann
[11:04:20] Obtained from https://github.com/tseemann/snippy
[11:04:20] Detected operating system: linux
[11:04:20] Enabling bundled linux tools.
[11:04:20] Running: samtools index snps.bam 2>> snps.log
[11:04:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:20] Found gzip - /usr/bin/gzip
[11:04:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:04:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:20] Treating reference as 'fasta' format.
[11:04:20] Will use 8 CPU cores.
[11:04:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[11:04:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out
[11:04:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out
[11:04:20] Creating reference folder: reference
[11:04:20] Extracting FASTA and GFF from reference.
[11:04:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:21] Wrote 3 sequences to ref.fa
[11:04:21] Wrote 0 features to ref.gff
[11:04:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta into pseudo-reads
[11:04:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:22] Marked 638 heterozygous sites with 'n'
[11:04:22] Creating extra output files: BED GFF CSV TXT HTML
[11:04:22] Identified 317 variants.
[11:04:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out
[11:04:22] Result files:
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.aligned.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam.bai
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bed
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.subs.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.csv
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.filt.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.gff
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.html
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.log
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.raw.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.subs.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.tab
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.txt
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz.csi
[11:04:22] Walltime used: 20 seconds
[11:04:22] Wishing you a life free of homopolymer errors.
[11:04:22] Done.
[Fri Jun 19 11:04:22 2020]
Finished job 134.
37 of 201 steps (18%) done

[Fri Jun 19 11:04:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out
    jobid: 123
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_UA4307AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
[11:04:22] Marked 380 heterozygous sites with 'n'
[11:04:22] Creating extra output files: BED GFF CSV TXT HTML
[11:04:22] Identified 687 variants.
[11:04:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out
[11:04:22] Result files:
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.aligned.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam.bai
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bed
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.subs.fa
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.csv
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.filt.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.gff
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.html
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.log
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.raw.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.subs.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.tab
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.txt
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz
[11:04:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz.csi
[11:04:22] Walltime used: 20 seconds
[11:04:22] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:04:22] Done.
[Fri Jun 19 11:04:22 2020]
Finished job 4.
38 of 201 steps (19%) done

[Fri Jun 19 11:04:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out
    jobid: 76
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_NB4129AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[11:04:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1932
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:04:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:23] This is snippy 4.4.3
[11:04:23] Written by Torsten Seemann
[11:04:23] Obtained from https://github.com/tseemann/snippy
[11:04:23] Detected operating system: linux
[11:04:23] Enabling bundled linux tools.
[11:04:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:23] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:23] Found gzip - /usr/bin/gzip
[11:04:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:23] This is snippy 4.4.3
[11:04:23] Written by Torsten Seemann
[11:04:23] Obtained from https://github.com/tseemann/snippy
[11:04:23] Detected operating system: linux
[11:04:23] Enabling bundled linux tools.
[11:04:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:23] Treating reference as 'fasta' format.
[11:04:23] Will use 8 CPU cores.
[11:04:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
[11:04:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out
[11:04:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out
[11:04:23] Creating reference folder: reference
[11:04:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:23] Extracting FASTA and GFF from reference.
[11:04:23] Found gzip - /usr/bin/gzip
[11:04:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:23] Wrote 3 sequences to ref.fa
[11:04:23] Wrote 0 features to ref.gff
[11:04:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta into pseudo-reads
[11:04:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:23] Treating reference as 'fasta' format.
[11:04:23] Will use 8 CPU cores.
[11:04:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[11:04:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out
[11:04:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out
[11:04:23] Creating reference folder: reference
[11:04:23] Extracting FASTA and GFF from reference.
[11:04:23] Wrote 3 sequences to ref.fa
[11:04:23] Wrote 0 features to ref.gff
[11:04:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta into pseudo-reads
[11:04:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:23] Wrote 401826 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:23] Using BAM RG (Read Group) ID: SAL_KA4888AA_AS.out
[11:04:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:23] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:24] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:24] Marked 0 heterozygous sites with 'n'
[11:04:24] Creating extra output files: BED GFF CSV TXT HTML
[11:04:24] Identified 388 variants.
[11:04:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out
[11:04:24] Result files:
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.aligned.fa
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam.bai
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bed
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.fa
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.subs.fa
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.csv
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.filt.vcf
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.gff
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.html
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.log
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.raw.vcf
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.subs.vcf
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.tab
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.txt
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz
[11:04:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz.csi
[11:04:24] Walltime used: 19 seconds
[11:04:24] May the SNPs be with you.
[11:04:24] Done.
[Fri Jun 19 11:04:24 2020]
Finished job 54.
39 of 201 steps (19%) done

[Fri Jun 19 11:04:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out
    jobid: 35
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB1790AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:25] Marked 364 heterozygous sites with 'n'
[11:04:25] Creating extra output files: BED GFF CSV TXT HTML
[11:04:25] Identified 672 variants.
[11:04:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out
[11:04:25] Result files:
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.aligned.fa
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam.bai
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bed
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.fa
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.subs.fa
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.csv
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.filt.vcf
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.gff
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.html
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.log
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.raw.vcf
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.subs.vcf
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.tab
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.txt
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz
[11:04:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz.csi
[11:04:25] Walltime used: 20 seconds
[11:04:25] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:04:25] Done.
[Fri Jun 19 11:04:25 2020]
Finished job 171.
40 of 201 steps (20%) done

[Fri Jun 19 11:04:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out
    jobid: 130
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_MB2521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
[11:04:25] This is snippy 4.4.3
[11:04:25] Written by Torsten Seemann
[11:04:25] Obtained from https://github.com/tseemann/snippy
[11:04:25] Detected operating system: linux
[11:04:25] Enabling bundled linux tools.
[11:04:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:25] Found gzip - /usr/bin/gzip
[11:04:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:25] Treating reference as 'fasta' format.
[11:04:25] Will use 8 CPU cores.
[11:04:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
[11:04:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out
[11:04:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out
[11:04:25] Creating reference folder: reference
[11:04:25] Extracting FASTA and GFF from reference.
[11:04:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:25] Wrote 3 sequences to ref.fa
[11:04:25] Wrote 0 features to ref.gff
[11:04:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta into pseudo-reads
[11:04:26] This is snippy 4.4.3
[11:04:26] Written by Torsten Seemann
[11:04:26] Obtained from https://github.com/tseemann/snippy
[11:04:26] Detected operating system: linux
[11:04:26] Enabling bundled linux tools.
[11:04:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::process] read 320224 sequences (80000284 bp)...
[11:04:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:26] Found gzip - /usr/bin/gzip
[11:04:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::process] read 81602 sequences (20383156 bp)...
[11:04:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:26] Wrote 401744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:26] Using BAM RG (Read Group) ID: SAL_UA4307AA_AS.out
[11:04:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:26] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:26] Wrote 395494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:26] Using BAM RG (Read Group) ID: SAL_NB4129AA_AS.out
[11:04:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:26] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:26] Treating reference as 'fasta' format.
[11:04:26] Will use 8 CPU cores.
[11:04:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
[11:04:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out
[11:04:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out
[11:04:26] Creating reference folder: reference
[11:04:26] Extracting FASTA and GFF from reference.
[11:04:26] Wrote 3 sequences to ref.fa
[11:04:26] Wrote 0 features to ref.gff
[11:04:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta into pseudo-reads
[11:04:27] Marked 0 heterozygous sites with 'n'
[11:04:27] Creating extra output files: BED GFF CSV TXT HTML
[11:04:27] Identified 1932 variants.
[11:04:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out
[11:04:27] Result files:
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.aligned.fa
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam.bai
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bed
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.fa
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.subs.fa
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.csv
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.filt.vcf
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.gff
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.html
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.log
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.raw.vcf
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.subs.vcf
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.tab
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.txt
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz
[11:04:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz.csi
[11:04:27] Walltime used: 20 seconds
[11:04:27] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:04:27] Done.
[Fri Jun 19 11:04:27 2020]
Finished job 65.
41 of 201 steps (20%) done

[Fri Jun 19 11:04:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out
    jobid: 98
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB1826AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:28] This is snippy 4.4.3
[11:04:28] Written by Torsten Seemann
[11:04:28] Obtained from https://github.com/tseemann/snippy
[11:04:28] Detected operating system: linux
[11:04:28] Enabling bundled linux tools.
[11:04:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:28] Found gzip - /usr/bin/gzip
[11:04:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:28] Marked 0 heterozygous sites with 'n'
[11:04:28] Treating reference as 'fasta' format.
[11:04:28] Will use 8 CPU cores.
[11:04:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
[11:04:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out
[11:04:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out
[11:04:28] Creating reference folder: reference
[11:04:28] Extracting FASTA and GFF from reference.
[11:04:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:28] Creating extra output files: BED GFF CSV TXT HTML
[11:04:28] Wrote 3 sequences to ref.fa
[11:04:28] Wrote 0 features to ref.gff
[11:04:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta into pseudo-reads
[11:04:28] Identified 21 variants.
[11:04:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out
[11:04:28] Result files:
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.aligned.fa
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam.bai
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bed
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.fa
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.subs.fa
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.csv
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.filt.vcf
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.gff
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.html
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.log
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.raw.vcf
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.subs.vcf
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.tab
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.txt
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz
[11:04:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz.csi
[11:04:28] Walltime used: 19 seconds
[11:04:28] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:04:28] Done.
[11:04:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[Fri Jun 19 11:04:28 2020]
Finished job 184.
42 of 201 steps (21%) done

[Fri Jun 19 11:04:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out
    jobid: 68
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9835AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320132 sequences (80000216 bp)...
[11:04:28] Wrote 396332 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:28] Using BAM RG (Read Group) ID: SAL_CB1790AA_AS.out
[11:04:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320224 reads in 18.394 CPU sec, 2.535 real sec
[11:04:28] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 81612 sequences (20380304 bp)...
[samclip] Processed 100000 records...
[M::process] read 320018 sequences (80000346 bp)...
[M::process] read 75476 sequences (18869000 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[11:04:29] This is snippy 4.4.3
[11:04:29] Written by Torsten Seemann
[11:04:29] Obtained from https://github.com/tseemann/snippy
[11:04:29] Detected operating system: linux
[11:04:29] Enabling bundled linux tools.
[11:04:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[M::mem_process_seqs] Processed 81602 reads in 5.759 CPU sec, 0.676 real sec
[11:04:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:29] Found gzip - /usr/bin/gzip
[11:04:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[11:04:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:29] Wrote 395948 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:29] Using BAM RG (Read Group) ID: SAL_MB2521AA_AS.out
[11:04:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:29] Treating reference as 'fasta' format.
[11:04:29] Will use 8 CPU cores.
[11:04:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
[11:04:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out
[11:04:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out
[11:04:29] Creating reference folder: reference
[11:04:29] Extracting FASTA and GFF from reference.
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.051 sec; CPU: 24.685 sec
[samclip] Total SAM records 402122, removed 1283, allowed 212, passed 400839
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:29] Wrote 3 sequences to ref.fa
[11:04:29] Wrote 0 features to ref.gff
[11:04:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320046 sequences (80000154 bp)...
[M::mem_process_seqs] Processed 320132 reads in 18.123 CPU sec, 2.363 real sec
[M::process] read 76286 sequences (19045174 bp)...
[samclip] Processed 100000 records...
[11:04:31] Wrote 395606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:31] Using BAM RG (Read Group) ID: SAL_KB1826AA_AS.out
[11:04:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:31] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 200000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320018 reads in 19.302 CPU sec, 2.619 real sec
[M::mem_process_seqs] Processed 81612 reads in 4.964 CPU sec, 0.582 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::process] read 320000 sequences (80000000 bp)...
[11:04:31] Running: samtools index snps.bam 2>> snps.log
[M::process] read 75948 sequences (18967186 bp)...
[11:04:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 400000 records...
[11:04:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.772 sec; CPU: 23.596 sec
[samclip] Total SAM records 401984, removed 2467, allowed 193, passed 399517
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 75476 reads in 4.647 CPU sec, 0.541 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.083 sec; CPU: 24.525 sec
[samclip] Total SAM records 395722, removed 1343, allowed 191, passed 394379
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:32] Wrote 394846 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:32] Using BAM RG (Read Group) ID: SAL_CB9835AA_AS.out
[11:04:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:32] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320046 reads in 18.014 CPU sec, 2.498 real sec
[M::process] read 320140 sequences (80000052 bp)...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 75466 sequences (18860340 bp)...
[M::mem_process_seqs] Processed 76286 reads in 5.031 CPU sec, 0.594 real sec
[samclip] Processed 200000 records...
[11:04:34] Running: samtools index snps.bam 2>> snps.log
[11:04:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.547 CPU sec, 2.487 real sec
[samclip] Processed 100000 records...
[11:04:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.161 sec; CPU: 23.603 sec
[samclip] Total SAM records 396567, removed 730, allowed 71, passed 395837
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:34] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 75948 reads in 4.600 CPU sec, 0.550 real sec
[11:04:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[11:04:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 37
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320152 sequences (80000310 bp)...
[samclip] Processed 300000 records...
[11:04:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 74694 sequences (18673500 bp)...
[11:04:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.078 sec; CPU: 22.706 sec
[samclip] Total SAM records 396515, removed 2385, allowed 111, passed 394130
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:35] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320140 reads in 18.700 CPU sec, 3.100 real sec
[11:04:36] Running: samtools index snps.bam 2>> snps.log
[11:04:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[11:04:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 75466 reads in 4.321 CPU sec, 0.515 real sec
[11:04:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 200000 records...

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 666
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:04:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:04:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320152 reads in 17.936 CPU sec, 2.468 real sec
[11:04:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:37] Running: samtools index snps.bam 2>> snps.log
[11:04:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:37] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.613 sec; CPU: 23.585 sec
[samclip] Total SAM records 395965, removed 1616, allowed 126, passed 394349
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 74694 reads in 4.893 CPU sec, 0.580 real sec
[samclip] Processed 200000 records...
[11:04:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1823
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:04:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[11:04:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 395104, removed 1437, allowed 126, passed 393667

[main] Real time: 3.961 sec; CPU: 23.394 sec
[samclip] Header contained 5 lines
[samclip] Done.
[11:04:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:38] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:39] Marked 0 heterozygous sites with 'n'
[11:04:39] Running: samtools index snps.bam 2>> snps.log
[11:04:39] Creating extra output files: BED GFF CSV TXT HTML
[11:04:39] Identified 37 variants.
[11:04:39] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out
[11:04:39] Result files:
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.aligned.fa
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam.bai
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bed
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.fa
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.subs.fa
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.csv
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.filt.vcf
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.gff
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.html
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.log
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.raw.vcf
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.subs.vcf
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.tab
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.txt
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz
[11:04:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz.csi
[11:04:39] Walltime used: 19 seconds
[11:04:39] May the SNPs be with you.
[11:04:39] Done.
[Fri Jun 19 11:04:39 2020]
Finished job 69.
43 of 201 steps (21%) done

[Fri Jun 19 11:04:39 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out
    jobid: 192
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB9521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[11:04:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 30
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:04:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:40] This is snippy 4.4.3
[11:04:40] Written by Torsten Seemann
[11:04:40] Obtained from https://github.com/tseemann/snippy
[11:04:40] Detected operating system: linux
[11:04:40] Enabling bundled linux tools.
[11:04:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:40] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:40] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:40] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:40] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:40] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:40] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:40] Found gzip - /usr/bin/gzip
[11:04:40] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:40] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:40] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:40] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:40] Running: samtools index snps.bam 2>> snps.log
[11:04:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 260
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:40] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:40] Treating reference as 'fasta' format.
[11:04:40] Will use 8 CPU cores.
[11:04:40] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[11:04:40] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out
[11:04:40] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out
[11:04:40] Creating reference folder: reference
[11:04:40] Extracting FASTA and GFF from reference.
[11:04:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:04:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:40] Wrote 3 sequences to ref.fa
[11:04:40] Wrote 0 features to ref.gff
[11:04:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta into pseudo-reads
[11:04:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:42] Marked 382 heterozygous sites with 'n'
[11:04:42] Creating extra output files: BED GFF CSV TXT HTML
[11:04:42] Identified 666 variants.
[11:04:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out
[11:04:42] Result files:
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.aligned.fa
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam.bai
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bed
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.fa
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.subs.fa
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.csv
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.filt.vcf
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.gff
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.html
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.log
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.raw.vcf
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.subs.vcf
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.tab
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.txt
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz
[11:04:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz.csi
[11:04:42] Walltime used: 19 seconds
[11:04:42] May the SNPs be with you.
[11:04:42] Done.
[Fri Jun 19 11:04:42 2020]
Finished job 123.
44 of 201 steps (22%) done

[Fri Jun 19 11:04:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out
    jobid: 75
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB0953AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:42] This is snippy 4.4.3
[11:04:42] Written by Torsten Seemann
[11:04:42] Obtained from https://github.com/tseemann/snippy
[11:04:42] Detected operating system: linux
[11:04:42] Enabling bundled linux tools.
[11:04:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:42] Found gzip - /usr/bin/gzip
[11:04:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:42] Marked 0 heterozygous sites with 'n'
[11:04:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:43] Creating extra output files: BED GFF CSV TXT HTML
[11:04:43] Identified 1823 variants.
[11:04:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out
[11:04:43] Result files:
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.aligned.fa
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam.bai
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bed
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.fa
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.subs.fa
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.csv
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.filt.vcf
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.gff
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.html
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.log
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.raw.vcf
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.subs.vcf
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.tab
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.txt
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz
[11:04:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz.csi
[11:04:43] Walltime used: 20 seconds
[11:04:43] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:04:43] Done.
[Fri Jun 19 11:04:43 2020]
Finished job 76.
45 of 201 steps (22%) done

[Fri Jun 19 11:04:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out
    jobid: 13
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB5642AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[11:04:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:43] Treating reference as 'fasta' format.
[11:04:43] Will use 8 CPU cores.
[11:04:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
[11:04:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out
[11:04:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out
[11:04:43] Creating reference folder: reference
[11:04:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:04:43] Extracting FASTA and GFF from reference.
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 467
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:04:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:43] Wrote 3 sequences to ref.fa
[11:04:43] Wrote 0 features to ref.gff
[11:04:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta into pseudo-reads
[11:04:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:43] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:43] Wrote 394794 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:43] Using BAM RG (Read Group) ID: SAL_JB9521AA_AS.out
[11:04:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:43] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:43] This is snippy 4.4.3
[11:04:43] Written by Torsten Seemann
[11:04:43] Obtained from https://github.com/tseemann/snippy
[11:04:43] Detected operating system: linux
[11:04:43] Enabling bundled linux tools.
[11:04:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:43] Found gzip - /usr/bin/gzip
[11:04:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 490
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:04:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:44] Treating reference as 'fasta' format.
[11:04:44] Will use 8 CPU cores.
[11:04:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[11:04:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out
[11:04:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out
[11:04:44] Creating reference folder: reference
[11:04:44] Extracting FASTA and GFF from reference.
[11:04:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:44] Wrote 3 sequences to ref.fa
[11:04:44] Wrote 0 features to ref.gff
[11:04:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta into pseudo-reads
[11:04:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:44] Marked 0 heterozygous sites with 'n'
[11:04:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:44] Creating extra output files: BED GFF CSV TXT HTML
[11:04:44] Identified 30 variants.
[11:04:44] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out
[11:04:44] Result files:
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.aligned.fa
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam.bai
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bed
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.fa
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.subs.fa
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.csv
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.filt.vcf
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.gff
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.html
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.log
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.raw.vcf
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.subs.vcf
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.tab
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.txt
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz
[11:04:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz.csi
[11:04:44] Walltime used: 19 seconds
[11:04:44] May the SNPs be with you.
[11:04:44] Done.
[Fri Jun 19 11:04:44 2020]
Finished job 35.
46 of 201 steps (23%) done

[Fri Jun 19 11:04:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out
    jobid: 152
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB2967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[11:04:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:45] This is snippy 4.4.3
[11:04:45] Written by Torsten Seemann
[11:04:45] Obtained from https://github.com/tseemann/snippy
[11:04:45] Detected operating system: linux
[11:04:45] Enabling bundled linux tools.
[11:04:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:45] Found gzip - /usr/bin/gzip
[11:04:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:45] Marked 0 heterozygous sites with 'n'
[11:04:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:45] Creating extra output files: BED GFF CSV TXT HTML
[11:04:45] Identified 260 variants.
[11:04:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out
[11:04:45] Result files:
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.aligned.fa
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam.bai
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bed
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.fa
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.subs.fa
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.csv
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.filt.vcf
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.gff
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.html
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.log
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.raw.vcf
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.subs.vcf
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.tab
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.txt
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz
[11:04:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz.csi
[11:04:45] Walltime used: 19 seconds
[11:04:45] May the SNPs be with you.
[11:04:45] Done.
[11:04:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[Fri Jun 19 11:04:45 2020]
Finished job 130.
47 of 201 steps (23%) done
[11:04:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log

[Fri Jun 19 11:04:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out
    jobid: 40
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
[11:04:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:04:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:45] Treating reference as 'fasta' format.
[11:04:45] Will use 8 CPU cores.
[11:04:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[11:04:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out
[11:04:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out
[11:04:45] Creating reference folder: reference
[11:04:45] Extracting FASTA and GFF from reference.
[11:04:45] Wrote 3 sequences to ref.fa
[11:04:45] Wrote 0 features to ref.gff
[11:04:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta into pseudo-reads
[M::process] read 320196 sequences (80000406 bp)...
[M::process] read 74598 sequences (18601214 bp)...
[11:04:46] Wrote 398246 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:46] Using BAM RG (Read Group) ID: SAL_JB0953AA_AS.out
[11:04:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:46] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:46] This is snippy 4.4.3
[11:04:46] Written by Torsten Seemann
[11:04:46] Obtained from https://github.com/tseemann/snippy
[11:04:46] Detected operating system: linux
[11:04:46] Enabling bundled linux tools.
[11:04:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:46] Found gzip - /usr/bin/gzip
[11:04:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:46] Treating reference as 'fasta' format.
[11:04:46] Will use 8 CPU cores.
[11:04:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
[11:04:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out
[11:04:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out
[11:04:46] Creating reference folder: reference
[11:04:46] Extracting FASTA and GFF from reference.
[11:04:46] Wrote 3 sequences to ref.fa
[11:04:46] Wrote 0 features to ref.gff
[11:04:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta into pseudo-reads
[11:04:47] Wrote 394490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:47] Using BAM RG (Read Group) ID: SAL_AB5642AA_AS.out
[11:04:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:47] Running: bwa index reference/ref.fa 2>> snps.log
[11:04:47] Marked 0 heterozygous sites with 'n'
[11:04:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:47] Creating extra output files: BED GFF CSV TXT HTML
[11:04:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:04:47] Identified 467 variants.
[11:04:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out
[11:04:47] Result files:
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.aligned.fa
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam.bai
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bed
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.fa
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.subs.fa
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.csv
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.filt.vcf
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.gff
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.html
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.log
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.raw.vcf
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.subs.vcf
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.tab
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.txt
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz
[11:04:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz.csi
[11:04:47] Walltime used: 19 seconds
[11:04:47] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:04:47] Done.
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[Fri Jun 19 11:04:47 2020]
Finished job 98.
48 of 201 steps (24%) done

[Fri Jun 19 11:04:47 2020]
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out
    jobid: 42
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB6441AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320008 sequences (80000424 bp)...
[M::mem_process_seqs] Processed 320196 reads in 18.270 CPU sec, 2.519 real sec
[M::process] read 78238 sequences (19559500 bp)...
[11:04:48] Wrote 394170 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:48] Using BAM RG (Read Group) ID: SAL_BB2967AA_AS.out
[11:04:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:48] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[11:04:48] This is snippy 4.4.3
[11:04:48] Written by Torsten Seemann
[11:04:48] Obtained from https://github.com/tseemann/snippy
[11:04:48] Detected operating system: linux
[11:04:48] Enabling bundled linux tools.
[11:04:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:48] Marked 0 heterozygous sites with 'n'
[11:04:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:48] Found gzip - /usr/bin/gzip
[11:04:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[11:04:48] Creating extra output files: BED GFF CSV TXT HTML
[11:04:48] Identified 490 variants.
[11:04:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out
[11:04:48] Result files:
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.aligned.fa
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam.bai
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bed
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.fa
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.subs.fa
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.csv
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.filt.vcf
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.gff
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.html
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.log
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.raw.vcf
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.subs.vcf
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.tab
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.txt
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz
[11:04:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz.csi
[11:04:48] Walltime used: 19 seconds
[11:04:48] May the SNPs be with you.
[11:04:48] Done.
[M::mem_process_seqs] Processed 74598 reads in 5.054 CPU sec, 0.587 real sec
[Fri Jun 19 11:04:48 2020]
Finished job 68.
49 of 201 steps (24%) done

[Fri Jun 19 11:04:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out
    jobid: 156
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_XA1299AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
[11:04:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:49] Treating reference as 'fasta' format.
[11:04:49] Will use 8 CPU cores.
[11:04:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[11:04:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out
[11:04:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out
[11:04:49] Creating reference folder: reference
[11:04:49] Extracting FASTA and GFF from reference.
[11:04:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[11:04:49] Wrote 3 sequences to ref.fa
[11:04:49] Wrote 0 features to ref.gff
[11:04:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.994 sec; CPU: 23.864 sec
[samclip] Total SAM records 395069, removed 883, allowed 95, passed 394186
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320160 sequences (80000364 bp)...
[11:04:49] Wrote 393608 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:49] Using BAM RG (Read Group) ID: SAL_CB9243AA_AS.out
[11:04:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:49] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 74330 sequences (18582500 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:04:49] This is snippy 4.4.3
[11:04:49] Written by Torsten Seemann
[11:04:49] Obtained from https://github.com/tseemann/snippy
[11:04:49] Detected operating system: linux
[11:04:49] Enabling bundled linux tools.
[11:04:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:04:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:04:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:04:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:04:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:04:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:04:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:04:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:04:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:04:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:04:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:04:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:04:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:04:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:04:49] Found gzip - /usr/bin/gzip
[11:04:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:04:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:04:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:04:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:04:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:04:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:04:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:04:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:04:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:04:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:04:50] Treating reference as 'fasta' format.
[11:04:50] Will use 8 CPU cores.
[11:04:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
[11:04:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out
[11:04:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out
[11:04:50] Creating reference folder: reference
[11:04:50] Extracting FASTA and GFF from reference.
[11:04:50] Wrote 3 sequences to ref.fa
[11:04:50] Wrote 0 features to ref.gff
[11:04:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta into pseudo-reads
[11:04:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320008 reads in 18.507 CPU sec, 2.429 real sec
[M::process] read 320016 sequences (80000230 bp)...
[M::process] read 74154 sequences (18463210 bp)...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 78238 reads in 5.410 CPU sec, 0.623 real sec
[11:04:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:51] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[11:04:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.835 sec; CPU: 24.418 sec
[samclip] Total SAM records 398486, removed 1292, allowed 243, passed 397194
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320140 sequences (80000152 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 73468 sequences (18367000 bp)...
[11:04:52] Wrote 394306 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::mem_process_seqs] Processed 320160 reads in 18.415 CPU sec, 2.610 real sec
[11:04:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:52] Using BAM RG (Read Group) ID: SAL_BB6441AA_AS.out
[11:04:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:52] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74330 reads in 4.414 CPU sec, 0.532 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:04:53] Wrote 397540 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:04:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:04:53] Using BAM RG (Read Group) ID: SAL_XA1299AA_AS.out
[11:04:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:04:53] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.154 sec; CPU: 23.428 sec
[samclip] Total SAM records 394735, removed 1211, allowed 74, passed 393524
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320016 reads in 16.650 CPU sec, 2.595 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[11:04:53] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 74154 reads in 4.794 CPU sec, 0.561 real sec
[11:04:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320140 reads in 16.519 CPU sec, 2.199 real sec
[11:04:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 394473, removed 1082, allowed 98, passed 393391
 -R @RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out -t[samclip] Header contained 5 lines
 8[samclip] Done.
 reference/ref.fa fake_reads.fq
[main] Real time: 4.024 sec; CPU: 21.970 sec
[M::mem_process_seqs] Processed 73468 reads in 3.947 CPU sec, 0.465 real sec
[M::process] read 320138 sequences (80000338 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::process] read 74168 sequences (18517842 bp)...
[11:04:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 64
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[11:04:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:04:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:04:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:04:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:04:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:04:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:55] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.601 sec; CPU: 21.000 sec
[samclip] Total SAM records 393980, removed 1071, allowed 135, passed 392909
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:04:55] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320158 sequences (80000292 bp)...
[11:04:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::process] read 77382 sequences (19326182 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:56] Running: samtools index snps.bam 2>> snps.log
[11:04:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320138 reads in 17.309 CPU sec, 2.675 real sec
[11:04:57] Running: samtools index snps.bam 2>> snps.log
[11:04:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 17
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 1797
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:04:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:04:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:04:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:04:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:04:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::mem_process_seqs] Processed 74168 reads in 5.080 CPU sec, 0.620 real sec
[11:04:57] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[11:04:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320158 reads in 17.414 CPU sec, 2.794 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.298 sec; CPU: 22.959 sec
[samclip] Total SAM records 394628, removed 1210, allowed 135, passed 393418
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 163
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[11:04:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 77382 reads in 5.481 CPU sec, 0.654 real sec
[11:04:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:04:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:04:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:04:58] Running: rm -f fake_reads\.fq 2>> snps.log
[11:04:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.356 sec; CPU: 23.449 sec
[samclip] Total SAM records 398069, removed 1650, allowed 237, passed 396419
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:04:59] Marked 0 heterozygous sites with 'n'
[11:04:59] Creating extra output files: BED GFF CSV TXT HTML
[11:04:59] Identified 64 variants.
[11:04:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out
[11:04:59] Result files:
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.aligned.fa
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam.bai
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bed
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.fa
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.subs.fa
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.csv
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.filt.vcf
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.gff
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.html
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.log
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.raw.vcf
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.subs.vcf
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.tab
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.txt
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz
[11:04:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz.csi
[11:04:59] Walltime used: 19 seconds
[11:04:59] Questionable SNP? Try the --report option to see the alignments.
[11:04:59] Done.
[Fri Jun 19 11:04:59 2020]
Finished job 192.
50 of 201 steps (25%) done

[Fri Jun 19 11:04:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out
    jobid: 48
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB9086AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
[11:04:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 51
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:04:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:04:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:04:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:04:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:04:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:04:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:04:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:00] This is snippy 4.4.3
[11:05:00] Written by Torsten Seemann
[11:05:00] Obtained from https://github.com/tseemann/snippy
[11:05:00] Detected operating system: linux
[11:05:00] Enabling bundled linux tools.
[11:05:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:00] Found gzip - /usr/bin/gzip
[11:05:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:00] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:00] Treating reference as 'fasta' format.
[11:05:00] Will use 8 CPU cores.
[11:05:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
[11:05:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out
[11:05:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out
[11:05:00] Creating reference folder: reference
[11:05:00] Extracting FASTA and GFF from reference.
[11:05:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:00] Wrote 3 sequences to ref.fa
[11:05:00] Wrote 0 features to ref.gff
[11:05:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta into pseudo-reads
[11:05:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:01] Running: samtools index snps.bam 2>> snps.log
[11:05:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:01] Marked 78 heterozygous sites with 'n'
[11:05:01] Creating extra output files: BED GFF CSV TXT HTML
[11:05:01] Identified 1797 variants.
[11:05:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out
[11:05:01] Result files:
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.aligned.fa
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam.bai
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bed
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.fa
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.subs.fa
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.csv
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.filt.vcf
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.gff
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.html
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.log
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.raw.vcf
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.subs.vcf
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.tab
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.txt
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz
[11:05:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz.csi
[11:05:01] Walltime used: 19 seconds
[11:05:01] Questionable SNP? Try the --report option to see the alignments.
[11:05:01] Done.
[Fri Jun 19 11:05:01 2020]
Finished job 75.
51 of 201 steps (25%) done

[Fri Jun 19 11:05:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out
    jobid: 111
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB8676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:02] This is snippy 4.4.3
[11:05:02] Written by Torsten Seemann
[11:05:02] Obtained from https://github.com/tseemann/snippy
[11:05:02] Detected operating system: linux
[11:05:02] Enabling bundled linux tools.
[11:05:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:02] Found gzip - /usr/bin/gzip
[11:05:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:02] Treating reference as 'fasta' format.
[11:05:02] Will use 8 CPU cores.
[11:05:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
[11:05:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out
[11:05:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out
[11:05:02] Creating reference folder: reference
[11:05:02] Extracting FASTA and GFF from reference.
[11:05:03] Wrote 3 sequences to ref.fa
[11:05:03] Wrote 0 features to ref.gff
[11:05:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta into pseudo-reads
[11:05:03] Marked 0 heterozygous sites with 'n'
[11:05:03] Creating extra output files: BED GFF CSV TXT HTML
[11:05:03] Identified 163 variants.
[11:05:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out
[11:05:03] Result files:
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.aligned.fa
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam.bai
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bed
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.fa
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.subs.fa
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.csv
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.filt.vcf
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.gff
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.html
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.log
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.raw.vcf
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.subs.vcf
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.tab
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.txt
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz
[11:05:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz.csi
[11:05:03] Walltime used: 20 seconds
[11:05:03] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:05:03] Done.
[Fri Jun 19 11:05:03 2020]
Finished job 13.
52 of 201 steps (26%) done

[Fri Jun 19 11:05:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out
    jobid: 92
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB7534AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[11:05:03] Wrote 393026 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:03] Using BAM RG (Read Group) ID: SAL_BB9086AA_AS.out
[11:05:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:03] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 132
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:03] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:04] This is snippy 4.4.3
[11:05:04] Written by Torsten Seemann
[11:05:04] Obtained from https://github.com/tseemann/snippy
[11:05:04] Detected operating system: linux
[11:05:04] Enabling bundled linux tools.
[11:05:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:04] Found gzip - /usr/bin/gzip
[11:05:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:04] Treating reference as 'fasta' format.
[11:05:04] Will use 8 CPU cores.
[11:05:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[11:05:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out
[11:05:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out
[11:05:04] Creating reference folder: reference
[11:05:04] Extracting FASTA and GFF from reference.
[11:05:04] Marked 0 heterozygous sites with 'n'
[11:05:04] Creating extra output files: BED GFF CSV TXT HTML
[11:05:04] Identified 51 variants.
[11:05:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out
[11:05:04] Result files:
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.aligned.fa
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam.bai
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bed
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.fa
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.subs.fa
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.csv
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.filt.vcf
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.gff
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.html
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.log
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.raw.vcf
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.subs.vcf
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.tab
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.txt
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz
[11:05:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz.csi
[11:05:04] Walltime used: 19 seconds
[11:05:04] Wishing you a life free of homopolymer errors.
[11:05:04] Done.
[11:05:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[Fri Jun 19 11:05:04 2020]
Finished job 152.

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 053 of 201 steps (26%) done

          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s


[Fri Jun 19 11:05:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out
    jobid: 81
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_XA3268AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[11:05:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:04] Wrote 3 sequences to ref.fa
[11:05:04] Wrote 0 features to ref.gff
[11:05:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta into pseudo-reads
[11:05:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:04] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:04] Marked 0 heterozygous sites with 'n'
[11:05:05] Creating extra output files: BED GFF CSV TXT HTML
[11:05:05] Identified 22 variants.
[11:05:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out
[11:05:05] Result files:
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.aligned.fa
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam.bai
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bed
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.fa
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.subs.fa
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.csv
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.filt.vcf
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.gff
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.html
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.log
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.raw.vcf
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.subs.vcf
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.tab
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.txt
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz
[11:05:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz.csi
[11:05:05] Walltime used: 19 seconds
[11:05:05] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:05] Done.
[Fri Jun 19 11:05:05 2020]
Finished job 40.
54 of 201 steps (27%) done

[Fri Jun 19 11:05:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out
    jobid: 83
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB8845AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[11:05:05] This is snippy 4.4.3
[11:05:05] Written by Torsten Seemann
[11:05:05] Obtained from https://github.com/tseemann/snippy
[11:05:05] Detected operating system: linux
[11:05:05] Enabling bundled linux tools.
[11:05:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:05] Found gzip - /usr/bin/gzip
[11:05:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:05] Treating reference as 'fasta' format.
[11:05:05] Will use 8 CPU cores.
[11:05:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[11:05:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out
[11:05:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out
[11:05:05] Creating reference folder: reference
[11:05:05] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:05] Wrote 3 sequences to ref.fa
[11:05:05] Wrote 0 features to ref.gff
[11:05:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta into pseudo-reads
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 73026 sequences (18200700 bp)...
[11:05:05] Wrote 392172 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:05] Using BAM RG (Read Group) ID: SAL_KB8676AA_AS.out
[11:05:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:05] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:05] This is snippy 4.4.3
[11:05:05] Written by Torsten Seemann
[11:05:05] Obtained from https://github.com/tseemann/snippy
[11:05:05] Detected operating system: linux
[11:05:05] Enabling bundled linux tools.
[11:05:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:05] Found gzip - /usr/bin/gzip
[11:05:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:06] Treating reference as 'fasta' format.
[11:05:06] Will use 8 CPU cores.
[11:05:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[11:05:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out
[11:05:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out
[11:05:06] Creating reference folder: reference
[11:05:06] Extracting FASTA and GFF from reference.
[11:05:06] Wrote 3 sequences to ref.fa
[11:05:06] Wrote 0 features to ref.gff
[11:05:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta into pseudo-reads
[11:05:07] Wrote 393274 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:07] Using BAM RG (Read Group) ID: SAL_AB7534AA_AS.out
[11:05:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:07] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:08] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320000 reads in 17.651 CPU sec, 2.425 real sec
[M::process] read 320128 sequences (80000194 bp)...
[11:05:08] Creating extra output files: BED GFF CSV TXT HTML
[M::process] read 72044 sequences (18011000 bp)...
[11:05:08] Identified 132 variants.
[11:05:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out
[11:05:08] Result files:
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.aligned.fa
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam.bai
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bed
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.fa
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.subs.fa
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.csv
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.filt.vcf
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.gff
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.html
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.log
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.raw.vcf
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.subs.vcf
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.tab
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.txt
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz
[11:05:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz.csi
[11:05:08] Walltime used: 20 seconds
[11:05:08] May the SNPs be with you.
[11:05:08] Done.
[Fri Jun 19 11:05:08 2020]
Finished job 42.
55 of 201 steps (27%) done

[Fri Jun 19 11:05:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out
    jobid: 21
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_ZA0287AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[samclip] Processed 100000 records...
[11:05:08] Wrote 397176 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:08] Using BAM RG (Read Group) ID: SAL_XA3268AA_AS.out
[11:05:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:08] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 73026 reads in 4.738 CPU sec, 0.545 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:05:08] Marked 31 heterozygous sites with 'n'
[11:05:09] Wrote 393052 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:09] Using BAM RG (Read Group) ID: SAL_EB8845AA_AS.out
[11:05:09] Creating extra output files: BED GFF CSV TXT HTML
[11:05:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:09] Identified 27 variants.
[11:05:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out
[11:05:09] Result files:
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.aligned.fa
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam.bai
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bed
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.fa
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.subs.fa
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.csv
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.filt.vcf
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.gff
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.html
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.log
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.raw.vcf
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.subs.vcf
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.tab
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.txt
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz
[11:05:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz.csi
[11:05:09] Walltime used: 20 seconds
[11:05:09] Wishing you a life free of homopolymer errors.
[11:05:09] Done.
[Fri Jun 19 11:05:09 2020]
Finished job 156.
56 of 201 steps (28%) done

[Fri Jun 19 11:05:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out
    jobid: 137
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_HB2224AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[11:05:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 393328, removed 872, allowed 140, passed 392456

[main] Real time: 3.856 sec; CPU: 22.954 sec
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:09] This is snippy 4.4.3
[11:05:09] Written by Torsten Seemann
[11:05:09] Obtained from https://github.com/tseemann/snippy
[11:05:09] Detected operating system: linux
[11:05:09] Enabling bundled linux tools.
[11:05:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:05:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:09] Found gzip - /usr/bin/gzip
[11:05:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:09] Treating reference as 'fasta' format.
[11:05:09] Will use 8 CPU cores.
[11:05:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[11:05:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[11:05:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[11:05:09] Creating reference folder: reference
[11:05:09] Extracting FASTA and GFF from reference.
[M::process] read 320000 sequences (80000000 bp)...
[11:05:09] Wrote 3 sequences to ref.fa
[11:05:09] Wrote 0 features to ref.gff
[11:05:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta into pseudo-reads
[M::process] read 73274 sequences (18271504 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:09] This is snippy 4.4.3
[11:05:09] Written by Torsten Seemann
[11:05:09] Obtained from https://github.com/tseemann/snippy
[11:05:09] Detected operating system: linux
[11:05:09] Enabling bundled linux tools.
[11:05:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:09] Found gzip - /usr/bin/gzip
[11:05:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:10] Treating reference as 'fasta' format.
[11:05:10] Will use 8 CPU cores.
[11:05:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[11:05:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out
[11:05:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out
[11:05:10] Creating reference folder: reference
[11:05:10] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:10] Wrote 3 sequences to ref.fa
[11:05:10] Wrote 0 features to ref.gff
[11:05:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta into pseudo-reads
[11:05:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320362 sequences (80000096 bp)...
[M::mem_process_seqs] Processed 320128 reads in 18.856 CPU sec, 2.555 real sec
[M::process] read 76814 sequences (19186104 bp)...
[samclip] Processed 100000 records...
[11:05:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:11] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 72044 reads in 4.335 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[11:05:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320212 sequences (80000078 bp)...
[M::process] read 72840 sequences (18210000 bp)...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.001 sec; CPU: 23.762 sec
[samclip] Total SAM records 392256, removed 966, allowed 100, passed 391290
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 17.993 CPU sec, 2.676 real sec
[11:05:12] Wrote 394326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:12] Using BAM RG (Read Group) ID: SAL_ZA0287AA_AS.out
[11:05:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:12] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 73274 reads in 4.271 CPU sec, 0.538 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:12] Wrote 392296 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:13] Using BAM RG (Read Group) ID: SAL_HB2224AA_AS.out
[11:05:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:13] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320362 reads in 18.035 CPU sec, 2.560 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.412 sec; CPU: 22.928 sec
[samclip] Total SAM records 393670, removed 1211, allowed 78, passed 392459
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320212 reads in 17.164 CPU sec, 2.352 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 76814 reads in 4.810 CPU sec, 0.565 real sec
[11:05:13] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[11:05:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 72840 reads in 4.058 CPU sec, 0.474 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.970 sec; CPU: 23.382 sec
[samclip] Total SAM records 397271, removed 743, allowed 79, passed 396528
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:05:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[11:05:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 393465, removed 1178, allowed 128, passed 392287

[main] Real time: 3.745 sec; CPU: 21.761 sec
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320096 sequences (80000188 bp)...
[11:05:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:14] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 74230 sequences (18552290 bp)...
[11:05:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 72296 sequences (18038458 bp)...
[11:05:15] Running: samtools index snps.bam 2>> snps.log
[11:05:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:16] Running: samtools index snps.bam 2>> snps.log
[11:05:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:16] Running: samtools index snps.bam 2>> snps.log
[11:05:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 318
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:17] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320096 reads in 19.180 CPU sec, 2.777 real sec
[11:05:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 74230 reads in 4.078 CPU sec, 0.542 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.431 CPU sec, 3.260 real sec
[11:05:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[11:05:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 72296 reads in 4.309 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[11:05:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.661 sec; CPU: 23.904 sec
[samclip] Total SAM records 394998, removed 7111, allowed 443, passed 387887
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:19] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:19] Marked 236 heterozygous sites with 'n'
[11:05:19] Creating extra output files: BED GFF CSV TXT HTML
[11:05:19] Identified 20 variants.
[11:05:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out
[11:05:19] Result files:
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.aligned.fa
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam.bai
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bed
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.fa
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.subs.fa
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.csv
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.filt.vcf
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.gff
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.html
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.log
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.raw.vcf
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.subs.vcf
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.tab
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.txt
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz
[11:05:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz.csi
[11:05:19] Walltime used: 19 seconds
[11:05:19] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:19] Done.
[11:05:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[Fri Jun 19 11:05:19 2020]
Finished job 48.
57 of 201 steps (28%) done

[Fri Jun 19 11:05:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out
    jobid: 165
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_LA4572AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[11:05:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.658 sec; CPU: 22.291 sec
[samclip] Total SAM records 392637, removed 954, allowed 181, passed 391683
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:19] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:19] This is snippy 4.4.3
[11:05:19] Written by Torsten Seemann
[11:05:19] Obtained from https://github.com/tseemann/snippy
[11:05:19] Detected operating system: linux
[11:05:19] Enabling bundled linux tools.
[11:05:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:19] Found gzip - /usr/bin/gzip
[11:05:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:20] Treating reference as 'fasta' format.
[11:05:20] Will use 8 CPU cores.
[11:05:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[11:05:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out
[11:05:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out
[11:05:20] Creating reference folder: reference
[11:05:20] Extracting FASTA and GFF from reference.
[11:05:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:20] Wrote 3 sequences to ref.fa
[11:05:20] Wrote 0 features to ref.gff
[11:05:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta into pseudo-reads
[11:05:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:21] Running: samtools index snps.bam 2>> snps.log
[11:05:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:21] Running: samtools index snps.bam 2>> snps.log
[11:05:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:21] Marked 40 heterozygous sites with 'n'
[11:05:21] Creating extra output files: BED GFF CSV TXT HTML
[11:05:21] Identified 318 variants.
[11:05:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out
[11:05:21] Result files:
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.aligned.fa
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam.bai
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bed
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.fa
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.subs.fa
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.csv
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.filt.vcf
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.gff
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.html
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.log
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.raw.vcf
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.subs.vcf
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.tab
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.txt
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz
[11:05:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz.csi
[11:05:21] Walltime used: 19 seconds
[11:05:21] Wishing you a life free of homopolymer errors.
[11:05:21] Done.
[Fri Jun 19 11:05:21 2020]
Finished job 111.
58 of 201 steps (29%) done

[Fri Jun 19 11:05:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out
    jobid: 117
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_LB4034AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:22] This is snippy 4.4.3
[11:05:22] Written by Torsten Seemann
[11:05:22] Obtained from https://github.com/tseemann/snippy
[11:05:22] Detected operating system: linux
[11:05:22] Enabling bundled linux tools.
[11:05:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:22] Found gzip - /usr/bin/gzip
[11:05:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:23] Wrote 396758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:23] Treating reference as 'fasta' format.
[11:05:23] Will use 8 CPU cores.
[11:05:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
[11:05:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out
[11:05:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out
[11:05:23] Using BAM RG (Read Group) ID: SAL_LA4572AA_AS.out
[11:05:23] Creating reference folder: reference
[11:05:23] Extracting FASTA and GFF from reference.
[11:05:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:23] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:23] Wrote 3 sequences to ref.fa
[11:05:23] Wrote 0 features to ref.gff
[11:05:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta into pseudo-reads
[11:05:23] Marked 68 heterozygous sites with 'n'
[11:05:23] Creating extra output files: BED GFF CSV TXT HTML
[11:05:23] Identified 15 variants.
[11:05:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out
[11:05:23] Result files:
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.aligned.fa
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam.bai
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bed
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.fa
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.subs.fa
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.csv
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.filt.vcf
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.gff
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.html
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.log
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.raw.vcf
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.subs.vcf
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.tab
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.txt
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz
[11:05:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz.csi
[11:05:23] Walltime used: 19 seconds
[11:05:23] Questionable SNP? Try the --report option to see the alignments.
[11:05:23] Done.
[Fri Jun 19 11:05:23 2020]
Finished job 92.
59 of 201 steps (29%) done

[Fri Jun 19 11:05:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out
    jobid: 185
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB5906AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[11:05:23] Marked 0 heterozygous sites with 'n'
[11:05:23] Creating extra output files: BED GFF CSV TXT HTML
[11:05:23] Identified 100 variants.
[11:05:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out
[11:05:24] Result files:
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.aligned.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam.bai
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bed
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.subs.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.csv
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.filt.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.gff
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.html
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.log
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.raw.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.subs.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.tab
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.txt
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz.csi
[11:05:24] Walltime used: 19 seconds
[11:05:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:24] Done.
[Fri Jun 19 11:05:24 2020]
Finished job 81.
60 of 201 steps (30%) done

[Fri Jun 19 11:05:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out
    jobid: 90
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB8884AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:24] This is snippy 4.4.3
[11:05:24] Written by Torsten Seemann
[11:05:24] Obtained from https://github.com/tseemann/snippy
[11:05:24] Detected operating system: linux
[11:05:24] Enabling bundled linux tools.
[11:05:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:24] Found gzip - /usr/bin/gzip
[11:05:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:24] Marked 1 heterozygous sites with 'n'
[11:05:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:24] Creating extra output files: BED GFF CSV TXT HTML
[11:05:24] Identified 22 variants.
[11:05:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out
[11:05:24] Result files:
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.aligned.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam.bai
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bed
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.subs.fa
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.csv
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.filt.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.gff
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.html
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.log
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.raw.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.subs.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.tab
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.txt
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz
[11:05:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz.csi
[11:05:24] Walltime used: 19 seconds
[11:05:24] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:05:24] Done.
[Fri Jun 19 11:05:24 2020]
Finished job 83.
61 of 201 steps (30%) done

[Fri Jun 19 11:05:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out
    jobid: 108
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FB5769AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[11:05:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:05:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:24] Treating reference as 'fasta' format.
[11:05:24] Will use 8 CPU cores.
[11:05:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[11:05:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out
[11:05:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out
[11:05:24] Creating reference folder: reference
[11:05:24] Extracting FASTA and GFF from reference.

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1883
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:05:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 23
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:24] Wrote 3 sequences to ref.fa
[11:05:24] Wrote 0 features to ref.gff
[11:05:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta into pseudo-reads
[11:05:24] This is snippy 4.4.3
[11:05:24] Written by Torsten Seemann
[11:05:24] Obtained from https://github.com/tseemann/snippy
[11:05:24] Detected operating system: linux
[11:05:24] Enabling bundled linux tools.
[11:05:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:24] Found gzip - /usr/bin/gzip
[11:05:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:05:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:24] Treating reference as 'fasta' format.
[11:05:24] Will use 8 CPU cores.
[11:05:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
[11:05:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out
[11:05:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out
[11:05:24] Creating reference folder: reference
[11:05:24] Extracting FASTA and GFF from reference.
[11:05:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:24] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:25] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:25] Wrote 3 sequences to ref.fa
[11:05:25] Wrote 0 features to ref.gff
[11:05:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta into pseudo-reads
[11:05:25] This is snippy 4.4.3
[11:05:25] Written by Torsten Seemann
[11:05:25] Obtained from https://github.com/tseemann/snippy
[11:05:25] Detected operating system: linux
[11:05:25] Enabling bundled linux tools.
[11:05:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:25] Found gzip - /usr/bin/gzip
[11:05:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320068 sequences (80000128 bp)...
[11:05:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 76690 sequences (19135790 bp)...
[11:05:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:25] Treating reference as 'fasta' format.
[11:05:25] Will use 8 CPU cores.
[11:05:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[11:05:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out
[11:05:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out
[11:05:25] Creating reference folder: reference
[11:05:25] Extracting FASTA and GFF from reference.
[11:05:25] Wrote 3 sequences to ref.fa
[11:05:25] Wrote 0 features to ref.gff
[11:05:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta into pseudo-reads
[11:05:26] Wrote 391912 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:26] Using BAM RG (Read Group) ID: SAL_LB4034AA_AS.out
[11:05:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:26] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:27] Wrote 390314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:27] Using BAM RG (Read Group) ID: SAL_AB5906AA_AS.out
[11:05:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:27] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320068 reads in 18.438 CPU sec, 2.558 real sec
[11:05:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:27] Wrote 391628 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:27] Using BAM RG (Read Group) ID: SAL_AB8884AA_AS.out
[11:05:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:27] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[M::process] read 320018 sequences (80000480 bp)...
[11:05:28] Wrote 390122 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:28] Using BAM RG (Read Group) ID: SAL_FB5769AA_AS.out
[11:05:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::process] read 71894 sequences (17973500 bp)...
[11:05:28] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 76690 reads in 5.136 CPU sec, 0.596 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 396933, removed 880, allowed 169, passed 396053
 -R[samclip] Header contained 5 lines
 @RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out[samclip] Done.
 -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.993 sec; CPU: 24.126 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:29] Marked 0 heterozygous sites with 'n'
[11:05:29] Creating extra output files: BED GFF CSV TXT HTML
[11:05:29] Identified 23 variants.
[11:05:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out
[11:05:29] Result files:
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.aligned.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam.bai
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bed
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.subs.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.csv
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.filt.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.gff
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.html
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.log
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.raw.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.subs.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.tab
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.txt
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz.csi
[11:05:29] Walltime used: 20 seconds
[11:05:29] May the SNPs be with you.
[11:05:29] Done.
[Fri Jun 19 11:05:29 2020]
Finished job 137.
62 of 201 steps (31%) done

[Fri Jun 19 11:05:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out
    jobid: 38
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_NB6620AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[11:05:29] Marked 0 heterozygous sites with 'n'
[11:05:29] Creating extra output files: BED GFF CSV TXT HTML
[11:05:29] Identified 1883 variants.
[11:05:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[11:05:29] Result files:
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.aligned.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam.bai
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bed
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.subs.fa
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.csv
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.filt.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.gff
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.html
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.log
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.raw.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.subs.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.tab
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.txt
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz
[11:05:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz.csi
[11:05:29] Walltime used: 20 seconds
[11:05:29] Wishing you a life free of homopolymer errors.
[11:05:29] Done.
[Fri Jun 19 11:05:29 2020]
Finished job 21.
63 of 201 steps (31%) done

[Fri Jun 19 11:05:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out
    jobid: 136
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB5050AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[11:05:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:05:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 70314 sequences (17547474 bp)...
[11:05:29] This is snippy 4.4.3
[11:05:29] Written by Torsten Seemann
[11:05:29] Obtained from https://github.com/tseemann/snippy
[11:05:29] Detected operating system: linux
[11:05:29] Enabling bundled linux tools.
[11:05:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:29] Found gzip - /usr/bin/gzip
[11:05:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:30] This is snippy 4.4.3
[11:05:30] Written by Torsten Seemann
[11:05:30] Obtained from https://github.com/tseemann/snippy
[11:05:30] Detected operating system: linux
[11:05:30] Enabling bundled linux tools.
[11:05:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:30] Found gzip - /usr/bin/gzip
[11:05:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:30] Treating reference as 'fasta' format.
[11:05:30] Will use 8 CPU cores.
[11:05:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[11:05:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out
[11:05:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out
[11:05:30] Creating reference folder: reference
[11:05:30] Extracting FASTA and GFF from reference.
[M::process] read 320072 sequences (80000244 bp)...
[11:05:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::process] read 71556 sequences (17889000 bp)...
[11:05:30] Treating reference as 'fasta' format.
[11:05:30] Will use 8 CPU cores.
[11:05:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[11:05:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out
[11:05:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out
[11:05:30] Creating reference folder: reference
[11:05:30] Extracting FASTA and GFF from reference.
[11:05:30] Wrote 3 sequences to ref.fa
[11:05:30] Wrote 0 features to ref.gff
[11:05:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta into pseudo-reads
[11:05:30] Wrote 3 sequences to ref.fa
[11:05:30] Wrote 0 features to ref.gff
[11:05:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta into pseudo-reads
[M::process] read 320022 sequences (80000370 bp)...
[M::process] read 70100 sequences (17509008 bp)...
[M::mem_process_seqs] Processed 320018 reads in 19.140 CPU sec, 2.636 real sec
[11:05:30] Running: samtools index snps.bam 2>> snps.log
[11:05:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 71894 reads in 4.615 CPU sec, 0.555 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.264 sec; CPU: 24.346 sec
[samclip] Total SAM records 392199, removed 1061, allowed 175, passed 391138
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 18.132 CPU sec, 3.089 real sec
[M::mem_process_seqs] Processed 320072 reads in 18.189 CPU sec, 2.821 real sec
[11:05:33] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 100000 records...
[11:05:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:33] Using BAM RG (Read Group) ID: SAL_NB6620AA_AS.out
[11:05:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[11:05:33] Wrote 390662 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:33] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:33] Using BAM RG (Read Group) ID: SAL_BB5050AA_AS.out
[11:05:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:33] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 70314 reads in 4.549 CPU sec, 0.537 real sec
[M::mem_process_seqs] Processed 320022 reads in 18.301 CPU sec, 2.854 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 71556 reads in 4.563 CPU sec, 0.532 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 70100 reads in 4.389 CPU sec, 0.502 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.574 sec; CPU: 23.274 sec
[samclip] Total SAM records 390431, removed 709, allowed 60, passed 389722
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 136
       total no. reference observed             : 0

Time elapsed: 0.00s

[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.249 sec; CPU: 23.288 sec
[samclip] Total SAM records 391994, removed 1043, allowed 151, passed 390951
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:05:34] Running: samtools index snps.bam 2>> snps.log
[11:05:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.266 sec; CPU: 23.255 sec
[samclip] Total SAM records 390554, removed 1191, allowed 124, passed 389363
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:34] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 70182 sequences (17512214 bp)...
[M::process] read 320196 sequences (80000214 bp)...
[M::process] read 70466 sequences (17591806 bp)...
[11:05:35] Running: samtools index snps.bam 2>> snps.log
[11:05:36] Running: samtools index snps.bam 2>> snps.log
[11:05:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:36] Running: samtools index snps.bam 2>> snps.log
[11:05:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1716
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:05:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:38] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 17.318 CPU sec, 3.268 real sec
[11:05:38] Marked 0 heterozygous sites with 'n'
[11:05:38] Creating extra output files: BED GFF CSV TXT HTML
[11:05:38] Identified 136 variants.
[11:05:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out
[11:05:38] Result files:
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.aligned.fa
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam.bai
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bed
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.fa
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.subs.fa
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.csv
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.filt.vcf
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.gff
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.html
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.log
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.raw.vcf
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.subs.vcf
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.tab
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.txt
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz
[11:05:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz.csi
[11:05:38] Walltime used: 19 seconds
[11:05:38] May the SNPs be with you.
[11:05:38] Done.
[Fri Jun 19 11:05:38 2020]
Finished job 165.
64 of 201 steps (32%) done
[M::mem_process_seqs] Processed 320196 reads in 17.605 CPU sec, 3.304 real sec

[Fri Jun 19 11:05:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out
    jobid: 84
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_MB5439AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[samclip] Processed 100000 records...
[11:05:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 201
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 49
       total no. reference observed             : 0

Time elapsed: 0.00s

[M::mem_process_seqs] Processed 70182 reads in 4.347 CPU sec, 0.510 real sec
[11:05:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:05:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 70466 reads in 4.134 CPU sec, 0.492 real sec
[11:05:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:39] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:05:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] Processed 300000 records...
[11:05:39] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:39] This is snippy 4.4.3
[11:05:39] Written by Torsten Seemann
[11:05:39] Obtained from https://github.com/tseemann/snippy
[11:05:39] Detected operating system: linux
[11:05:39] Enabling bundled linux tools.
[11:05:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:39] Found gzip - /usr/bin/gzip
[11:05:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[11:05:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 390419, removed 721, allowed 60, passed 389698
 -R @RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.771 sec; CPU: 22.243 sec
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:39] Treating reference as 'fasta' format.
[11:05:39] Will use 8 CPU cores.
[11:05:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[11:05:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out
[11:05:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out
[11:05:39] Creating reference folder: reference
[11:05:39] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.852 sec; CPU: 22.334 sec
[samclip] Total SAM records 390961, removed 904, allowed 84, passed 390057
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:40] Wrote 3 sequences to ref.fa
[11:05:40] Wrote 0 features to ref.gff
[11:05:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta into pseudo-reads
[11:05:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:41] Running: samtools index snps.bam 2>> snps.log
[11:05:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:42] Running: samtools index snps.bam 2>> snps.log
[11:05:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:42] Marked 0 heterozygous sites with 'n'
[11:05:42] Creating extra output files: BED GFF CSV TXT HTML
[11:05:42] Identified 1716 variants.
[11:05:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out
[11:05:42] Result files:
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.aligned.fa
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam.bai
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bed
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.fa
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.subs.fa
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.csv
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.filt.vcf
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.gff
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.html
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.log
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.raw.vcf
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.subs.vcf
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.tab
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.txt
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz
[11:05:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz.csi
[11:05:42] Walltime used: 20 seconds
[11:05:42] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:42] Done.
[Fri Jun 19 11:05:42 2020]
Finished job 117.
65 of 201 steps (32%) done

[Fri Jun 19 11:05:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out
    jobid: 124
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB7996AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[11:05:43] Wrote 389178 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:43] Using BAM RG (Read Group) ID: SAL_MB5439AA_AS.out
[11:05:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:43] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:43] This is snippy 4.4.3
[11:05:43] Written by Torsten Seemann
[11:05:43] Obtained from https://github.com/tseemann/snippy
[11:05:43] Detected operating system: linux
[11:05:43] Enabling bundled linux tools.
[11:05:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:43] Found gzip - /usr/bin/gzip
[11:05:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:43] Treating reference as 'fasta' format.
[11:05:43] Will use 8 CPU cores.
[11:05:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[11:05:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out
[11:05:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out
[11:05:43] Creating reference folder: reference
[11:05:43] Extracting FASTA and GFF from reference.
[11:05:43] Marked 0 heterozygous sites with 'n'
[11:05:43] Wrote 3 sequences to ref.fa
[11:05:43] Wrote 0 features to ref.gff
[11:05:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta into pseudo-reads
[11:05:43] Marked 0 heterozygous sites with 'n'
[11:05:43] Creating extra output files: BED GFF CSV TXT HTML
[11:05:43] Identified 201 variants.
[11:05:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out
[11:05:43] Result files:
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.aligned.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam.bai
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bed
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.subs.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.csv
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.filt.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.gff
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.html
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.log
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.raw.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.subs.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.tab
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.txt
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz.csi
[11:05:43] Walltime used: 19 seconds
[11:05:43] Wishing you a life free of homopolymer errors.
[11:05:43] Done.
[Fri Jun 19 11:05:43 2020]
Finished job 185.
66 of 201 steps (33%) done

[Fri Jun 19 11:05:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out
    jobid: 178
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[11:05:43] Creating extra output files: BED GFF CSV TXT HTML
[11:05:43] Identified 49 variants.
[11:05:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out
[11:05:43] Result files:
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.aligned.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam.bai
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bed
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.subs.fa
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.csv
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.filt.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.gff
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.html
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.log
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.raw.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.subs.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.tab
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.txt
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz
[11:05:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz.csi
[11:05:43] Walltime used: 19 seconds
[11:05:43] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:05:43] Done.
[Fri Jun 19 11:05:43 2020]
Finished job 90.
67 of 201 steps (33%) done

[Fri Jun 19 11:05:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out
    jobid: 34
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB6830AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:44] Marked 0 heterozygous sites with 'n'
[11:05:44] Creating extra output files: BED GFF CSV TXT HTML
[11:05:44] Identified 19 variants.
[11:05:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out
[11:05:44] Result files:
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.aligned.fa
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam.bai
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bed
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.fa
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.subs.fa
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.csv
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.filt.vcf
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.gff
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.html
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.log
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.raw.vcf
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.subs.vcf
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.tab
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.txt
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz
[11:05:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz.csi
[11:05:44] Walltime used: 19 seconds
[11:05:44] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:44] Done.
[Fri Jun 19 11:05:44 2020]
Finished job 108.
68 of 201 steps (34%) done

[Fri Jun 19 11:05:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out
    jobid: 115
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB7542AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[11:05:44] This is snippy 4.4.3
[11:05:44] Written by Torsten Seemann
[11:05:44] Obtained from https://github.com/tseemann/snippy
[11:05:44] Detected operating system: linux
[11:05:44] Enabling bundled linux tools.
[11:05:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:44] This is snippy 4.4.3
[11:05:44] Written by Torsten Seemann
[11:05:44] Obtained from https://github.com/tseemann/snippy
[11:05:44] Detected operating system: linux
[11:05:44] Enabling bundled linux tools.
[11:05:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:44] Found gzip - /usr/bin/gzip
[11:05:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:44] Found gzip - /usr/bin/gzip
[11:05:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:44] Treating reference as 'fasta' format.
[11:05:44] Will use 8 CPU cores.
[11:05:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[11:05:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out
[11:05:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out
[11:05:44] Creating reference folder: reference
[11:05:44] Extracting FASTA and GFF from reference.
[11:05:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:05:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:44] Treating reference as 'fasta' format.
[11:05:44] Will use 8 CPU cores.
[11:05:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
[11:05:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out
[11:05:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out
[11:05:44] Creating reference folder: reference
[11:05:44] Extracting FASTA and GFF from reference.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:44] Wrote 3 sequences to ref.fa
[11:05:44] Wrote 0 features to ref.gff
[11:05:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta into pseudo-reads
[11:05:45] Wrote 3 sequences to ref.fa
[11:05:45] Wrote 0 features to ref.gff
[11:05:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta into pseudo-reads
[11:05:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:05:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:45] This is snippy 4.4.3
[11:05:45] Written by Torsten Seemann
[11:05:45] Obtained from https://github.com/tseemann/snippy
[11:05:45] Detected operating system: linux
[11:05:45] Enabling bundled linux tools.
[11:05:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[M::process] read 69178 sequences (17293548 bp)...
[11:05:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:45] Found gzip - /usr/bin/gzip
[11:05:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:45] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:45] Treating reference as 'fasta' format.
[11:05:45] Will use 8 CPU cores.
[11:05:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[11:05:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out
[11:05:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out
[11:05:45] Creating reference folder: reference
[11:05:45] Extracting FASTA and GFF from reference.
[11:05:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:45] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:45] Wrote 3 sequences to ref.fa
[11:05:45] Wrote 0 features to ref.gff
[11:05:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta into pseudo-reads
[11:05:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:46] Wrote 390506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:46] Using BAM RG (Read Group) ID: SAL_IB7996AA_AS.out
[11:05:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:46] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.532 CPU sec, 2.639 real sec
[11:05:47] Wrote 393742 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:47] Wrote 390082 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:47] Using BAM RG (Read Group) ID: SAL_SA1324AA_AS.out
[11:05:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:47] Using BAM RG (Read Group) ID: SAL_KB6830AA_AS.out
[11:05:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:47] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:47] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69178 reads in 4.504 CPU sec, 0.521 real sec
[samclip] Processed 200000 records...
[11:05:48] Wrote 390342 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:48] Using BAM RG (Read Group) ID: SAL_AB7542AA_AS.out
[11:05:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:48] Running: bwa index reference/ref.fa 2>> snps.log
[11:05:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.035 sec; CPU: 24.585 sec
[samclip] Total SAM records 389353, removed 1107, allowed 184, passed 388246
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320292 sequences (80000104 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 70214 sequences (17551350 bp)...
[11:05:49] Marked 0 heterozygous sites with 'n'
[11:05:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:49] Creating extra output files: BED GFF CSV TXT HTML
[11:05:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:49] Identified 18 variants.
[11:05:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out
[11:05:49] Result files:
[11:05:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.aligned.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam.bai
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bed
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.subs.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.csv
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.filt.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.gff
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.html
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.log
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.raw.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.subs.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.tab
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.txt
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz.csi
[11:05:49] Walltime used: 20 seconds
[11:05:49] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:05:49] Done.
[11:05:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[Fri Jun 19 11:05:49 2020]
Finished job 38.
69 of 201 steps (34%) done

[Fri Jun 19 11:05:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out
    jobid: 58
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[11:05:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:05:49] Marked 0 heterozygous sites with 'n'
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:49] Creating extra output files: BED GFF CSV TXT HTML
[11:05:49] Identified 27 variants.
[11:05:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out
[11:05:49] Result files:
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.aligned.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam.bai
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bed
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.subs.fa
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.csv
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.filt.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.gff
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.html
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.log
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.raw.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.subs.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.tab
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.txt
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz
[11:05:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz.csi
[11:05:49] Walltime used: 19 seconds
[11:05:49] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:05:49] Done.
[Fri Jun 19 11:05:49 2020]
Finished job 136.
70 of 201 steps (35%) done

[Fri Jun 19 11:05:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out
    jobid: 31
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB6779AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320008 sequences (80000410 bp)...
[M::process] read 320118 sequences (80000122 bp)...
[M::process] read 70074 sequences (17518500 bp)...
[M::process] read 73624 sequences (18390972 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:05:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:50] This is snippy 4.4.3
[11:05:50] Written by Torsten Seemann
[11:05:50] Obtained from https://github.com/tseemann/snippy
[11:05:50] Detected operating system: linux
[11:05:50] Enabling bundled linux tools.
[11:05:50] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:50] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:50] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:50] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:50] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:50] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:50] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:50] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:50] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:50] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:50] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:50] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:50] Found gzip - /usr/bin/gzip
[11:05:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:50] This is snippy 4.4.3
[11:05:50] Written by Torsten Seemann
[11:05:50] Obtained from https://github.com/tseemann/snippy
[11:05:50] Detected operating system: linux
[11:05:50] Enabling bundled linux tools.
[11:05:50] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:05:50] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:05:50] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:05:50] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:05:50] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:05:50] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:05:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:50] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:05:50] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:05:50] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:05:50] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:05:50] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:05:50] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:05:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:05:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:05:50] Found gzip - /usr/bin/gzip
[11:05:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:05:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:05:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:05:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:05:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:05:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:05:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:05:50] Treating reference as 'fasta' format.
[11:05:50] Will use 8 CPU cores.
[11:05:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[11:05:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out
[11:05:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out
[11:05:50] Creating reference folder: reference
[11:05:50] Extracting FASTA and GFF from reference.
[M::process] read 320000 sequences (80000000 bp)...
[11:05:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:05:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:05:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:05:50] Treating reference as 'fasta' format.
[11:05:50] Will use 8 CPU cores.
[11:05:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[11:05:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out
[11:05:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out
[11:05:50] Creating reference folder: reference
[11:05:50] Extracting FASTA and GFF from reference.
[M::process] read 70342 sequences (17519162 bp)...
[11:05:50] Wrote 3 sequences to ref.fa
[11:05:50] Wrote 0 features to ref.gff
[11:05:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta into pseudo-reads
[11:05:50] Running: samtools index snps.bam 2>> snps.log
[11:05:50] Wrote 3 sequences to ref.fa
[11:05:50] Wrote 0 features to ref.gff
[11:05:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta into pseudo-reads
[11:05:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320292 reads in 17.296 CPU sec, 2.606 real sec
[M::mem_process_seqs] Processed 70214 reads in 3.820 CPU sec, 0.465 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320008 reads in 18.506 CPU sec, 2.658 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.281 sec; CPU: 21.785 sec
[samclip] Total SAM records 390743, removed 795, allowed 71, passed 389948
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320118 reads in 17.697 CPU sec, 3.010 real sec
[M::mem_process_seqs] Processed 70074 reads in 4.482 CPU sec, 0.529 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 73624 reads in 4.489 CPU sec, 0.522 real sec
[M::mem_process_seqs] Processed 320000 reads in 17.303 CPU sec, 2.884 real sec
[11:05:53] Wrote 389596 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 200000 records...
[11:05:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:53] Using BAM RG (Read Group) ID: SAL_BB9988AA_AS.out
[11:05:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:53] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.102 sec; CPU: 23.534 sec
[samclip] Total SAM records 390268, removed 1175, allowed 164, passed 389093
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:53] Wrote 389130 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:05:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:05:53] Using BAM RG (Read Group) ID: SAL_IB6779AA_AS.out
[samclip] Processed 300000 records...
[11:05:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:05:53] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 70342 reads in 4.102 CPU sec, 0.477 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.462 sec; CPU: 22.758 sec
[samclip] Total SAM records 393923, removed 902, allowed 133, passed 393021
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1809
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:05:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 300000 records...
[11:05:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.279 sec; CPU: 21.954 sec
[samclip] Total SAM records 391084, removed 1808, allowed 278, passed 389276
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:54] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:54] Running: samtools index snps.bam 2>> snps.log
[11:05:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:05:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:05:55] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:05:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:05:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:05:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::process] read 69596 sequences (17394542 bp)...
[11:05:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:05:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:05:56] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320016 sequences (80000232 bp)...
[11:05:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:56] Running: samtools index snps.bam 2>> snps.log
[11:05:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:05:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:05:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:58] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 69114 sequences (17274708 bp)...
[M::mem_process_seqs] Processed 320000 reads in 16.978 CPU sec, 3.047 real sec
[samclip] Processed 100000 records...
[11:05:59] Marked 0 heterozygous sites with 'n'
[11:05:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 1799
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:05:59] Creating extra output files: BED GFF CSV TXT HTML
[11:05:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:59] Identified 1809 variants.
[11:05:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out
[11:05:59] Result files:
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.aligned.fa
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam.bai
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bed
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.fa
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.subs.fa
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.csv
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.filt.vcf
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.gff
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.html
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.log
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.raw.vcf
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.subs.vcf
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.tab
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.txt
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz
[11:05:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz.csi
[11:05:59] Walltime used: 20 seconds
[11:05:59] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:05:59] Done.
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[Fri Jun 19 11:05:59 2020]
Finished job 84.
71 of 201 steps (35%) done

[Fri Jun 19 11:05:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out
    jobid: 176
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB2669AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
[M::mem_process_seqs] Processed 69596 reads in 3.989 CPU sec, 0.468 real sec
[11:05:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:05:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:05:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:05:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:05:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:05:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:05:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:05:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:05:59] Running: rm -f fake_reads\.fq 2>> snps.log
[11:05:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:05:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:05:59] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:05:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:05:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:05:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.460 sec; CPU: 21.500 sec
[samclip] Total SAM records 389928, removed 961, allowed 81, passed 388967
[samclip] Header contained 5 lines
[samclip] Done.
[11:05:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:00] This is snippy 4.4.3
[11:06:00] Written by Torsten Seemann
[11:06:00] Obtained from https://github.com/tseemann/snippy
[11:06:00] Detected operating system: linux
[11:06:00] Enabling bundled linux tools.
[11:06:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:00] Found gzip - /usr/bin/gzip
[11:06:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:00] Treating reference as 'fasta' format.
[11:06:00] Will use 8 CPU cores.
[11:06:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
[11:06:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out
[11:06:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out
[11:06:00] Creating reference folder: reference
[11:06:00] Extracting FASTA and GFF from reference.
[11:06:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320016 reads in 18.928 CPU sec, 4.046 real sec
[11:06:00] Wrote 3 sequences to ref.fa
[11:06:00] Wrote 0 features to ref.gff
[11:06:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69114 reads in 4.560 CPU sec, 0.522 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.406 sec; CPU: 24.031 sec
[samclip] Total SAM records 389354, removed 1595, allowed 224, passed 387759
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:01] Running: samtools index snps.bam 2>> snps.log
[11:06:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:02] Marked 0 heterozygous sites with 'n'
[11:06:02] Creating extra output files: BED GFF CSV TXT HTML
[11:06:02] Identified 20 variants.
[11:06:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out
[11:06:02] Result files:
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.aligned.fa
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam.bai
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bed
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.fa
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.subs.fa
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.csv
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.filt.vcf
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.gff
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.html
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.log
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.raw.vcf
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.subs.vcf
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.tab
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.txt
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz
[11:06:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz.csi
[11:06:02] Walltime used: 19 seconds
[11:06:02] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:06:02] Done.
[Fri Jun 19 11:06:02 2020]
Finished job 124.
72 of 201 steps (36%) done

[Fri Jun 19 11:06:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out
    jobid: 77
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB2598AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[11:06:03] Wrote 390114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:03] Using BAM RG (Read Group) ID: SAL_CB2669AA_AS.out
[11:06:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:03] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:03] Running: samtools index snps.bam 2>> snps.log
[11:06:03] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:03] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:03] This is snippy 4.4.3
[11:06:03] Written by Torsten Seemann
[11:06:03] Obtained from https://github.com/tseemann/snippy
[11:06:03] Detected operating system: linux
[11:06:03] Enabling bundled linux tools.
[11:06:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:03] Found gzip - /usr/bin/gzip
[11:06:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:03] Marked 11 heterozygous sites with 'n'
[11:06:03] Treating reference as 'fasta' format.
[11:06:03] Will use 8 CPU cores.
[11:06:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[11:06:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out
[11:06:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out
[11:06:03] Creating reference folder: reference
[11:06:03] Extracting FASTA and GFF from reference.
[11:06:03] Creating extra output files: BED GFF CSV TXT HTML
[11:06:03] Marked 224 heterozygous sites with 'n'
[11:06:03] Identified 1799 variants.
[11:06:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out
[11:06:03] Result files:
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.aligned.fa
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam.bai
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bed
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.fa
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.subs.fa
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.csv
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.filt.vcf
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.gff
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.html
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.log
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.raw.vcf
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.subs.vcf
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.tab
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.txt
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz
[11:06:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz.csi
[11:06:03] Walltime used: 19 seconds
[11:06:03] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:06:03] Done.
[Fri Jun 19 11:06:03 2020]
Finished job 34.
73 of 201 steps (36%) done

[Fri Jun 19 11:06:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out
    jobid: 119
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB6801AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[11:06:04] Creating extra output files: BED GFF CSV TXT HTML
[11:06:04] Identified 24 variants.
[11:06:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out
[11:06:04] Result files:
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.aligned.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam.bai
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bed
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.subs.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.csv
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.filt.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.gff
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.html
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.log
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.raw.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.subs.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.tab
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.txt
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz.csi
[11:06:04] Walltime used: 20 seconds
[11:06:04] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:06:04] Done.
[Fri Jun 19 11:06:04 2020]
Finished job 178.
74 of 201 steps (37%) done
[11:06:04] Wrote 3 sequences to ref.fa
[11:06:04] Wrote 0 features to ref.gff
[11:06:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta into pseudo-reads

[Fri Jun 19 11:06:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out
    jobid: 106
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
[11:06:04] Marked 0 heterozygous sites with 'n'
[11:06:04] Creating extra output files: BED GFF CSV TXT HTML
[11:06:04] Identified 27 variants.
[11:06:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out
[11:06:04] Result files:
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.aligned.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam.bai
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bed
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.subs.fa
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.csv
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.filt.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.gff
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.html
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.log
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.raw.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.subs.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.tab
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.txt
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz
[11:06:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz.csi
[11:06:04] Walltime used: 19 seconds
[11:06:04] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:06:04] Done.
[Fri Jun 19 11:06:04 2020]
Finished job 115.
75 of 201 steps (37%) done

[Fri Jun 19 11:06:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out
    jobid: 140
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB2970AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:04] This is snippy 4.4.3
[11:06:04] Written by Torsten Seemann
[11:06:04] Obtained from https://github.com/tseemann/snippy
[11:06:04] Detected operating system: linux
[11:06:04] Enabling bundled linux tools.
[11:06:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:04] Found gzip - /usr/bin/gzip
[11:06:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:04] This is snippy 4.4.3
[11:06:04] Written by Torsten Seemann
[11:06:04] Obtained from https://github.com/tseemann/snippy
[11:06:04] Detected operating system: linux
[11:06:04] Enabling bundled linux tools.
[11:06:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:04] Found gzip - /usr/bin/gzip
[11:06:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:04] Treating reference as 'fasta' format.
[11:06:04] Will use 8 CPU cores.
[11:06:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[11:06:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out
[11:06:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out
[11:06:04] Creating reference folder: reference
[11:06:04] Extracting FASTA and GFF from reference.
[11:06:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:04] Treating reference as 'fasta' format.
[11:06:04] Will use 8 CPU cores.
[11:06:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
[11:06:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out
[11:06:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out
[11:06:04] Creating reference folder: reference
[11:06:04] Extracting FASTA and GFF from reference.
[11:06:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 42
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:05] This is snippy 4.4.3
[11:06:05] Written by Torsten Seemann
[11:06:05] Obtained from https://github.com/tseemann/snippy
[11:06:05] Detected operating system: linux
[11:06:05] Enabling bundled linux tools.
[11:06:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:05] Wrote 3 sequences to ref.fa
[11:06:05] Wrote 0 features to ref.gff
[11:06:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta into pseudo-reads
[11:06:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:05] Found gzip - /usr/bin/gzip
[11:06:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:05] Wrote 3 sequences to ref.fa
[11:06:05] Wrote 0 features to ref.gff
[11:06:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta into pseudo-reads
[11:06:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:06:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:05] Treating reference as 'fasta' format.
[11:06:05] Will use 8 CPU cores.
[11:06:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
[11:06:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out
[11:06:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out
[11:06:05] Creating reference folder: reference
[11:06:05] Extracting FASTA and GFF from reference.
[11:06:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 70114 sequences (17460752 bp)...
[11:06:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:05] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:05] Wrote 3 sequences to ref.fa
[11:06:05] Wrote 0 features to ref.gff
[11:06:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta into pseudo-reads
[11:06:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:06:06] Wrote 389850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:06] Using BAM RG (Read Group) ID: SAL_CB2598AA_AS.out
[11:06:06] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 2003
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:06:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:06] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:07] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:07] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:07] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:07] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:07] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 17.465 CPU sec, 2.404 real sec
[11:06:07] Wrote 389442 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:07] Using BAM RG (Read Group) ID: SAL_IB6801AA_AS.out
[11:06:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:07] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:07] Wrote 389650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 100000 records...
[11:06:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:07] Using BAM RG (Read Group) ID: SAL_CB1324AA_AS.out
[11:06:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:08] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 70114 reads in 4.277 CPU sec, 0.494 real sec
[samclip] Processed 200000 records...
[11:06:08] Wrote 391206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 300000 records...
[11:06:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:08] Using BAM RG (Read Group) ID: SAL_BB2970AA_AS.out
[11:06:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:08] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.797 sec; CPU: 22.316 sec
[samclip] Total SAM records 390411, removed 831, allowed 90, passed 389580
[samclip] Header contained 5 lines
[samclip] Done.
[11:06:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 69850 sequences (17398288 bp)...
[11:06:09] Marked 0 heterozygous sites with 'n'
[11:06:09] Creating extra output files: BED GFF CSV TXT HTML
[11:06:09] Identified 42 variants.
[11:06:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out
[11:06:09] Result files:
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.aligned.fa
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam.bai
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bed
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.fa
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.subs.fa
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.csv
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.filt.vcf
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.gff
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.html
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.log
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.raw.vcf
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.subs.vcf
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.tab
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.txt
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz
[11:06:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz.csi
[11:06:09] Walltime used: 19 seconds
[11:06:09] May the SNPs be with you.
[11:06:09] Done.
[Fri Jun 19 11:06:09 2020]
Finished job 58.
76 of 201 steps (38%) done

[Fri Jun 19 11:06:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out
    jobid: 25
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB2131AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320040 sequences (80000230 bp)...
[11:06:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 69402 sequences (17313044 bp)...
[11:06:10] This is snippy 4.4.3
[11:06:10] Written by Torsten Seemann
[11:06:10] Obtained from https://github.com/tseemann/snippy
[11:06:10] Detected operating system: linux
[11:06:10] Enabling bundled linux tools.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:10] Found gzip - /usr/bin/gzip
[11:06:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320020 sequences (80000364 bp)...
[11:06:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[M::process] read 69630 sequences (17337020 bp)...
[11:06:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:10] Treating reference as 'fasta' format.
[11:06:10] Will use 8 CPU cores.
[11:06:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[11:06:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out
[11:06:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out
[11:06:10] Creating reference folder: reference
[11:06:10] Extracting FASTA and GFF from reference.
[M::process] read 320386 sequences (80000080 bp)...
[11:06:10] Running: samtools index snps.bam 2>> snps.log
[11:06:10] Wrote 3 sequences to ref.fa
[11:06:10] Wrote 0 features to ref.gff
[11:06:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta into pseudo-reads
[M::process] read 70820 sequences (17705000 bp)...
[11:06:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:11] Marked 0 heterozygous sites with 'n'
[11:06:11] Creating extra output files: BED GFF CSV TXT HTML
[11:06:11] Identified 2003 variants.
[11:06:11] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out
[11:06:11] Result files:
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.aligned.fa
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam.bai
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bed
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.fa
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.subs.fa
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.csv
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.filt.vcf
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.gff
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.html
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.log
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.raw.vcf
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.subs.vcf
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.tab
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.txt
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz
[11:06:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz.csi
[11:06:11] Walltime used: 21 seconds
[11:06:11] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:06:11] Done.
[Fri Jun 19 11:06:11 2020]
Finished job 31.
77 of 201 steps (38%) done

[Fri Jun 19 11:06:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out
    jobid: 139
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB6734AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 17.733 CPU sec, 3.023 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[11:06:12] This is snippy 4.4.3
[11:06:12] Written by Torsten Seemann
[11:06:12] Obtained from https://github.com/tseemann/snippy
[11:06:12] Detected operating system: linux
[11:06:12] Enabling bundled linux tools.
[11:06:12] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:12] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:12] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:12] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:12] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:12] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:12] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:12] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:12] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:12] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:12] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:12] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:12] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:12] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:12] Found gzip - /usr/bin/gzip
[11:06:12] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:12] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:12] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:12] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:12] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:12] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 69850 reads in 4.011 CPU sec, 0.478 real sec
[11:06:12] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[11:06:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:12] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:12] Treating reference as 'fasta' format.
[11:06:12] Will use 8 CPU cores.
[11:06:12] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
[11:06:12] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out
[11:06:12] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out
[11:06:12] Creating reference folder: reference
[11:06:12] Extracting FASTA and GFF from reference.
[11:06:12] Wrote 3 sequences to ref.fa
[11:06:12] Wrote 0 features to ref.gff
[11:06:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390229, removed 1109, allowed 119, passed 389120

[main] Real time: 4.455 sec; CPU: 22.330 sec
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320020 reads in 17.442 CPU sec, 2.743 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320386 reads in 17.293 CPU sec, 2.589 real sec
[M::mem_process_seqs] Processed 320040 reads in 17.445 CPU sec, 3.247 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[11:06:13] Wrote 390266 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:13] Using BAM RG (Read Group) ID: SAL_BB2131AA_AS.out
[11:06:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 69630 reads in 3.992 CPU sec, 0.486 real sec
[11:06:13] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70820 reads in 4.954 CPU sec, 0.603 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69402 reads in 4.004 CPU sec, 0.486 real sec
[11:06:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:06:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[11:06:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:14] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.299 sec; CPU: 22.019 sec
[samclip] Total SAM records 390070, removed 1171, allowed 134, passed 388899
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.123 sec; CPU: 22.818 sec
[samclip] Total SAM records 391641, removed 1206, allowed 106, passed 390435
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.756 sec; CPU: 22.037 sec
[samclip] Total SAM records 389685, removed 716, allowed 60, passed 388969
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:15] Running: samtools index snps.bam 2>> snps.log
[11:06:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320024 sequences (80000176 bp)...
[M::process] read 70242 sequences (17560500 bp)...
[11:06:16] Wrote 387804 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:16] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:16] Using BAM RG (Read Group) ID: SAL_KB6734AA_AS.out
[11:06:16] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:16] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:16] Running: samtools index snps.bam 2>> snps.log
[11:06:16] Running: samtools index snps.bam 2>> snps.log
[11:06:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:16] Running: samtools index snps.bam 2>> snps.log
[11:06:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:18] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000476 bp)...
[11:06:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:18] Marked 0 heterozygous sites with 'n'
[11:06:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 67760 sequences (16940000 bp)...
[11:06:18] Creating extra output files: BED GFF CSV TXT HTML
[11:06:18] Identified 17 variants.
[11:06:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out
[11:06:18] Result files:
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.aligned.fa
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam.bai
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bed
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.fa
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.subs.fa
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.csv
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.filt.vcf
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.gff
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.html
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.log
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.raw.vcf
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.subs.vcf
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.tab
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.txt
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz
[11:06:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz.csi
[11:06:18] Walltime used: 18 seconds
[11:06:18] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:06:18] Done.
[Fri Jun 19 11:06:18 2020]
Finished job 176.
78 of 201 steps (39%) done

[Fri Jun 19 11:06:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out
    jobid: 73
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB5379AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
[11:06:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:19] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320024 reads in 16.933 CPU sec, 3.240 real sec
[11:06:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:06:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false

stats: biallelic
         [d] debug                                                     no. left trimmed                      : false
         [r] reference FASTA file                            0reference/ref.fa

          no. right trimmed                     : 
5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:19] This is snippy 4.4.3
[11:06:19] Written by Torsten Seemann
[11:06:19] Obtained from https://github.com/tseemann/snippy
[11:06:19] Detected operating system: linux
[11:06:19] Enabling bundled linux tools.
[11:06:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[samclip] Processed 100000 records...
[11:06:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:19] Found gzip - /usr/bin/gzip
[11:06:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 70242 reads in 3.989 CPU sec, 0.479 real sec
[11:06:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:19] Treating reference as 'fasta' format.
[11:06:19] Will use 8 CPU cores.
[11:06:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
[11:06:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out
[11:06:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out
[11:06:19] Creating reference folder: reference
[11:06:19] Extracting FASTA and GFF from reference.
[11:06:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 200000 records...
[11:06:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 41
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:19] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:19] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:19] Wrote 3 sequences to ref.fa
[11:06:19] Wrote 0 features to ref.gff
[11:06:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta into pseudo-reads
[11:06:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:06:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.806 sec; CPU: 21.529 sec
[samclip] Total SAM records 390573, removed 982, allowed 240, passed 389591
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320044 reads in 17.524 CPU sec, 2.465 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67760 reads in 3.841 CPU sec, 0.445 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 387938, removed 504, allowed 38, passed 387434

[main] Real time: 3.866 sec; CPU: 21.966 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:22] Running: samtools index snps.bam 2>> snps.log
[11:06:22] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:22] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:22] Wrote 388498 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:22] Using BAM RG (Read Group) ID: SAL_CB5379AA_AS.out
[11:06:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:22] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:23] Marked 0 heterozygous sites with 'n'
[11:06:23] Creating extra output files: BED GFF CSV TXT HTML
[11:06:23] Identified 29 variants.
[11:06:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out
[11:06:23] Result files:
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.aligned.fa
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam.bai
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bed
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.fa
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.subs.fa
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.csv
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.filt.vcf
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.gff
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.html
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.log
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.raw.vcf
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.subs.vcf
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.tab
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.txt
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz
[11:06:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz.csi
[11:06:23] Walltime used: 20 seconds
[11:06:23] Wishing you a life free of homopolymer errors.
[11:06:23] Done.
[Fri Jun 19 11:06:23 2020]
Finished job 77.
79 of 201 steps (39%) done

[Fri Jun 19 11:06:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out
    jobid: 56
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_HB2219AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[11:06:23] Running: samtools index snps.bam 2>> snps.log
[11:06:24] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:24] Marked 0 heterozygous sites with 'n'
[11:06:24] Marked 0 heterozygous sites with 'n'
[11:06:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:24] Creating extra output files: BED GFF CSV TXT HTML
[11:06:24] Identified 17 variants.
[11:06:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out
[11:06:24] Result files:
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.aligned.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam.bai
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bed
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.subs.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.csv
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.filt.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.gff
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.html
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.log
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.raw.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.subs.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.tab
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.txt
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz.csi
[11:06:24] Walltime used: 19 seconds
[11:06:24] Questionable SNP? Try the --report option to see the alignments.
[11:06:24] Done.
[11:06:24] Creating extra output files: BED GFF CSV TXT HTML
[Fri Jun 19 11:06:24 2020]
Finished job 140.
80 of 201 steps (40%) done

[Fri Jun 19 11:06:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out
    jobid: 45
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB3115AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[11:06:24] Identified 19 variants.
[11:06:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out
[11:06:24] Result files:
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.aligned.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam.bai
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bed
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.subs.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.csv
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.filt.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.gff
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.html
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.log
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.raw.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.subs.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.tab
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.txt
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz.csi
[11:06:24] Walltime used: 20 seconds
[11:06:24] Questionable SNP? Try the --report option to see the alignments.
[11:06:24] Done.
[Fri Jun 19 11:06:24 2020]
Finished job 106.
81 of 201 steps (40%) done

[Fri Jun 19 11:06:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out
    jobid: 30
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB9118AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
[11:06:24] Marked 0 heterozygous sites with 'n'
[11:06:24] Creating extra output files: BED GFF CSV TXT HTML
[11:06:24] Identified 41 variants.
[11:06:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out
[11:06:24] Result files:
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.aligned.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam.bai
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bed
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.subs.fa
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.csv
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.filt.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.gff
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.html
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.log
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.raw.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.subs.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.tab
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.txt
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz
[11:06:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz.csi
[11:06:24] Walltime used: 20 seconds
[11:06:24] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:06:24] Done.
[Fri Jun 19 11:06:24 2020]
Finished job 119.
82 of 201 steps (41%) done

[Fri Jun 19 11:06:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out
    jobid: 120
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CA4728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[11:06:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320000 sequences (80000000 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 68498 sequences (17108608 bp)...
[11:06:25] This is snippy 4.4.3
[11:06:25] Written by Torsten Seemann
[11:06:25] Obtained from https://github.com/tseemann/snippy
[11:06:25] Detected operating system: linux
[11:06:25] Enabling bundled linux tools.
[11:06:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:25] This is snippy 4.4.3
[11:06:25] Written by Torsten Seemann
[11:06:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:25] Obtained from https://github.com/tseemann/snippy
[11:06:25] Detected operating system: linux
[11:06:25] Enabling bundled linux tools.
[11:06:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:25] This is snippy 4.4.3
[11:06:25] Written by Torsten Seemann
[11:06:25] Obtained from https://github.com/tseemann/snippy
[11:06:25] Detected operating system: linux
[11:06:25] Enabling bundled linux tools.
[11:06:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:25] Found gzip - /usr/bin/gzip
[11:06:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:25] Found gzip - /usr/bin/gzip
[11:06:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:25] Found gzip - /usr/bin/gzip
[11:06:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:25] This is snippy 4.4.3
[11:06:25] Written by Torsten Seemann
[11:06:25] Obtained from https://github.com/tseemann/snippy
[11:06:25] Detected operating system: linux
[11:06:25] Enabling bundled linux tools.
[11:06:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:25] Found gzip - /usr/bin/gzip
[11:06:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:25] Treating reference as 'fasta' format.
[11:06:25] Will use 8 CPU cores.
[11:06:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[11:06:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out
[11:06:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out
[11:06:25] Creating reference folder: reference
[11:06:25] Extracting FASTA and GFF from reference.
[11:06:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:25] Treating reference as 'fasta' format.
[11:06:25] Will use 8 CPU cores.
[11:06:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
[11:06:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out
[11:06:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out
[11:06:25] Creating reference folder: reference
[11:06:25] Extracting FASTA and GFF from reference.
[11:06:25] Treating reference as 'fasta' format.
[11:06:25] Will use 8 CPU cores.
[11:06:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[11:06:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out
[11:06:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out
[11:06:25] Creating reference folder: reference
[11:06:25] Extracting FASTA and GFF from reference.
[11:06:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:25] Treating reference as 'fasta' format.
[11:06:25] Will use 8 CPU cores.
[11:06:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[11:06:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out
[11:06:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out
[11:06:25] Creating reference folder: reference
[11:06:25] Extracting FASTA and GFF from reference.
[11:06:25] Wrote 3 sequences to ref.fa
[11:06:25] Wrote 0 features to ref.gff
[11:06:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta into pseudo-reads
[11:06:25] Wrote 3 sequences to ref.fa
[11:06:25] Wrote 0 features to ref.gff
[11:06:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta into pseudo-reads
[11:06:25] Wrote 3 sequences to ref.fa
[11:06:25] Wrote 0 features to ref.gff
[11:06:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta into pseudo-reads
[11:06:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:25] Wrote 3 sequences to ref.fa
[11:06:25] Wrote 0 features to ref.gff
[11:06:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta into pseudo-reads
[11:06:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:25] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.131 CPU sec, 2.542 real sec
[11:06:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:27] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:27] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:27] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:27] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:27] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:27] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[11:06:27] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 68498 reads in 3.810 CPU sec, 0.439 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.910 sec; CPU: 22.497 sec
[samclip] Total SAM records 388916, removed 1029, allowed 78, passed 387887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:28] Wrote 388312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:28] Using BAM RG (Read Group) ID: SAL_HB2219AA_AS.out
[11:06:28] Wrote 387684 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:28] Wrote 388058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:28] Using BAM RG (Read Group) ID: SAL_IB9118AA_AS.out
[11:06:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:28] Using BAM RG (Read Group) ID: SAL_IB3115AA_AS.out
[11:06:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:28] Wrote 392448 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:28] Using BAM RG (Read Group) ID: SAL_CA4728AA_AS.out
[11:06:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:28] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:30] Marked 0 heterozygous sites with 'n'
[11:06:30] Creating extra output files: BED GFF CSV TXT HTML
[11:06:30] Identified 29 variants.
[11:06:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out
[11:06:30] Result files:
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.aligned.fa
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam.bai
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bed
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.fa
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.subs.fa
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.csv
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.filt.vcf
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.gff
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.html
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.log
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.raw.vcf
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.subs.vcf
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.tab
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.txt
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz
[11:06:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz.csi
[11:06:30] Walltime used: 20 seconds
[11:06:30] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:06:30] Done.
[Fri Jun 19 11:06:30 2020]
Finished job 25.
83 of 201 steps (41%) done

[Fri Jun 19 11:06:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out
    jobid: 163
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CA4803AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[11:06:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:30] Running: samtools index snps.bam 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:06:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 320094 sequences (80000328 bp)...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:30] This is snippy 4.4.3
[11:06:30] Written by Torsten Seemann
[11:06:30] Obtained from https://github.com/tseemann/snippy
[11:06:30] Detected operating system: linux
[11:06:30] Enabling bundled linux tools.
[11:06:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:30] Found gzip - /usr/bin/gzip
[11:06:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::process] read 67590 sequences (16897500 bp)...
[11:06:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320062 sequences (80000346 bp)...
[11:06:31] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:31] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:31] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:31] Treating reference as 'fasta' format.
[11:06:31] Will use 8 CPU cores.
[11:06:31] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[11:06:31] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out
[11:06:31] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out
[11:06:31] Creating reference folder: reference
[11:06:31] Extracting FASTA and GFF from reference.
[M::process] read 320100 sequences (80000048 bp)...
[M::process] read 67996 sequences (16962818 bp)...
[M::process] read 320024 sequences (80000272 bp)...
[11:06:31] Wrote 3 sequences to ref.fa
[11:06:31] Wrote 0 features to ref.gff
[11:06:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta into pseudo-reads
[11:06:31] Marked 0 heterozygous sites with 'n'
[11:06:31] Creating extra output files: BED GFF CSV TXT HTML
[11:06:31] Identified 105 variants.
[11:06:31] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out
[11:06:31] Result files:
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.aligned.fa
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam.bai
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bed
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.fa
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.subs.fa
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.csv
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.filt.vcf
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.gff
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.html
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.log
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.raw.vcf
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.subs.vcf
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.tab
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.txt
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz
[11:06:31] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz.csi
[11:06:31] Walltime used: 19 seconds
[11:06:31] Wishing you a life free of homopolymer errors.
[11:06:31] Done.
[M::process] read 72348 sequences (18083964 bp)...
[Fri Jun 19 11:06:31 2020]
Finished job 139.
84 of 201 steps (42%) done

[Fri Jun 19 11:06:31 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out
    jobid: 154
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB4414AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[M::process] read 68288 sequences (17043056 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:32] This is snippy 4.4.3
[11:06:32] Written by Torsten Seemann
[11:06:32] Obtained from https://github.com/tseemann/snippy
[11:06:32] Detected operating system: linux
[11:06:32] Enabling bundled linux tools.
[11:06:32] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:32] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:32] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:32] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:32] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:32] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:32] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:32] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:32] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:32] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:32] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:32] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:32] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:32] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:32] Found gzip - /usr/bin/gzip
[11:06:32] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:32] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:32] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:32] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:33] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:33] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:33] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:33] Treating reference as 'fasta' format.
[11:06:33] Will use 8 CPU cores.
[11:06:33] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[11:06:33] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out
[11:06:33] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out
[11:06:33] Creating reference folder: reference
[11:06:33] Extracting FASTA and GFF from reference.
[11:06:33] Wrote 3 sequences to ref.fa
[11:06:33] Wrote 0 features to ref.gff
[11:06:33] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta into pseudo-reads
[11:06:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320062 reads in 18.908 CPU sec, 2.715 real sec
[11:06:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:34] Wrote 392020 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:34] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:34] Using BAM RG (Read Group) ID: SAL_CA4803AA_AS.out
[11:06:34] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[11:06:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:34] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320094 reads in 17.637 CPU sec, 3.225 real sec
[11:06:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:34] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320024 reads in 17.075 CPU sec, 3.000 real sec
[11:06:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320100 reads in 18.394 CPU sec, 3.129 real sec
[M::mem_process_seqs] Processed 67996 reads in 4.250 CPU sec, 0.515 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67590 reads in 3.926 CPU sec, 0.484 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 68288 reads in 3.722 CPU sec, 0.446 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 72348 reads in 4.819 CPU sec, 0.572 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 388474, removed 1480, allowed 193, passed 386994
[main] CMD: bwa[samclip] Header contained 5 lines
 mem -Y[samclip] Done.
 -M -R @RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.197 sec; CPU: 23.717 sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.778 sec; CPU: 22.171 sec
[samclip] Total SAM records 387893, removed 737, allowed 98, passed 387156
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.517 sec; CPU: 21.416 sec
[samclip] Total SAM records 388641, removed 826, allowed 90, passed 387815
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.690 sec; CPU: 23.802 sec
[samclip] Total SAM records 392624, removed 994, allowed 114, passed 391630
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:36] Wrote 387532 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:36] Using BAM RG (Read Group) ID: SAL_JB4414AA_AS.out
[11:06:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::process] read 320018 sequences (80000222 bp)...
[11:06:36] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 72002 sequences (17989846 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:36] Running: samtools index snps.bam 2>> snps.log
[11:06:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:37] Running: samtools index snps.bam 2>> snps.log
[11:06:37] Running: samtools index snps.bam 2>> snps.log
[11:06:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:37] Running: samtools index snps.bam 2>> snps.log
[11:06:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:37] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:37] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:38] Marked 0 heterozygous sites with 'n'
[11:06:38] Creating extra output files: BED GFF CSV TXT HTML
[M::process] read 320096 sequences (80000392 bp)...
[11:06:38] Identified 13 variants.
[11:06:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out
[11:06:38] Result files:
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.aligned.fa
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam.bai
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bed
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.fa
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.subs.fa
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.csv
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.filt.vcf
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.gff
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.html
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.log
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.raw.vcf
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.subs.vcf
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.tab
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.txt
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz
[11:06:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz.csi
[11:06:38] Walltime used: 19 seconds
[11:06:38] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:06:38] Done.
[Fri Jun 19 11:06:38 2020]
Finished job 73.
85 of 201 steps (42%) done

[Fri Jun 19 11:06:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out
    jobid: 116
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB4937AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:39] This is snippy 4.4.3
[11:06:39] Written by Torsten Seemann
[11:06:39] Obtained from https://github.com/tseemann/snippy
[11:06:39] Detected operating system: linux
[11:06:39] Enabling bundled linux tools.
[11:06:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:39] Found gzip - /usr/bin/gzip
[11:06:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:39] Treating reference as 'fasta' format.
[11:06:39] Will use 8 CPU cores.
[11:06:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
[11:06:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out
[11:06:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out
[11:06:39] Creating reference folder: reference
[11:06:39] Extracting FASTA and GFF from reference.
[11:06:39] Wrote 3 sequences to ref.fa
[11:06:39] Wrote 0 features to ref.gff
[11:06:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta into pseudo-reads
[M::process] read 67436 sequences (16851378 bp)...
[11:06:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1697
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:06:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320018 reads in 19.303 CPU sec, 4.208 real sec
[11:06:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 185
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 120
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:06:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:06:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:06:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 72002 reads in 4.841 CPU sec, 0.556 real sec
[11:06:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.616 sec; CPU: 24.690 sec
[samclip] Total SAM records 392443, removed 2978, allowed 329, passed 389465
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320096 reads in 18.133 CPU sec, 3.465 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67436 reads in 4.199 CPU sec, 0.485 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:06:42] Wrote 388660 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:42] Using BAM RG (Read Group) ID: SAL_BB4937AA_AS.out
[11:06:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:42] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.868 sec; CPU: 22.890 sec
[samclip] Total SAM records 387882, removed 1240, allowed 78, passed 386642
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:43] Running: samtools index snps.bam 2>> snps.log
[11:06:43] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:43] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:44] Marked 4 heterozygous sites with 'n'
[11:06:44] Running: samtools index snps.bam 2>> snps.log
[11:06:44] Marked 0 heterozygous sites with 'n'
[11:06:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:45] Creating extra output files: BED GFF CSV TXT HTML
[11:06:45] Identified 185 variants.
[11:06:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out
[11:06:45] Result files:
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.aligned.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam.bai
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bed
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.subs.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.csv
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.filt.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.gff
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.html
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.log
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.raw.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.subs.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.tab
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.txt
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz.csi
[11:06:45] Walltime used: 20 seconds
[11:06:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:06:45] Done.
[11:06:45] Marked 0 heterozygous sites with 'n'
[11:06:45] Creating extra output files: BED GFF CSV TXT HTML
[11:06:45] Identified 17 variants.
[11:06:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out
[11:06:45] Result files:
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.aligned.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam.bai
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bed
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.subs.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.csv
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.filt.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.gff
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.html
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.log
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.raw.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.subs.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.tab
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.txt
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz.csi
[11:06:45] Walltime used: 20 seconds
[11:06:45] May the SNPs be with you.
[11:06:45] Done.
[Fri Jun 19 11:06:45 2020]
Finished job 30.
86 of 201 steps (43%) done

[Fri Jun 19 11:06:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out
    jobid: 181
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9389AA_AS
    threads: 5

[11:06:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[11:06:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[Fri Jun 19 11:06:45 2020]
Finished job 56.
87 of 201 steps (43%) done
[11:06:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log

[Fri Jun 19 11:06:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out
    jobid: 17
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB1406AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:06:45] Creating extra output files: BED GFF CSV TXT HTML
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:45] Identified 1697 variants.
[11:06:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out
[11:06:45] Result files:
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.aligned.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam.bai
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bed
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.subs.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.csv
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.filt.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.gff
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.html
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.log
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.raw.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.subs.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.tab
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.txt
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz.csi
[11:06:45] Walltime used: 20 seconds
[11:06:45] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:06:45] Done.
[11:06:45] Marked 1 heterozygous sites with 'n'
[11:06:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Fri Jun 19 11:06:45 2020]
Finished job 45.
88 of 201 steps (44%) done

[Fri Jun 19 11:06:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out
    jobid: 46
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB4026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
[11:06:45] Creating extra output files: BED GFF CSV TXT HTML
[11:06:45] Identified 120 variants.
[11:06:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out
[11:06:45] Result files:
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.aligned.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam.bai
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bed
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.subs.fa
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.csv
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.filt.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.gff
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.html
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.log
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.raw.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.subs.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.tab
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.txt
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz
[11:06:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz.csi
[11:06:45] Walltime used: 20 seconds
[11:06:45] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:06:45] Done.
[Fri Jun 19 11:06:45 2020]
Finished job 120.
89 of 201 steps (44%) done

[Fri Jun 19 11:06:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out
    jobid: 28
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB5909AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[M::process] read 320226 sequences (80000298 bp)...
[M::process] read 68434 sequences (17060382 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:45] This is snippy 4.4.3
[11:06:45] Written by Torsten Seemann
[11:06:45] Obtained from https://github.com/tseemann/snippy
[11:06:45] Detected operating system: linux
[11:06:45] Enabling bundled linux tools.
[11:06:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:45] This is snippy 4.4.3
[11:06:45] Written by Torsten Seemann
[11:06:45] Obtained from https://github.com/tseemann/snippy
[11:06:45] Detected operating system: linux
[11:06:45] Enabling bundled linux tools.
[11:06:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:45] Found gzip - /usr/bin/gzip
[11:06:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:45] Found gzip - /usr/bin/gzip
[11:06:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:45] This is snippy 4.4.3
[11:06:45] Written by Torsten Seemann
[11:06:45] Obtained from https://github.com/tseemann/snippy
[11:06:45] Detected operating system: linux
[11:06:45] Enabling bundled linux tools.
[11:06:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:45] This is snippy 4.4.3
[11:06:45] Written by Torsten Seemann
[11:06:45] Obtained from https://github.com/tseemann/snippy
[11:06:45] Detected operating system: linux
[11:06:45] Enabling bundled linux tools.
[11:06:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:45] Found gzip - /usr/bin/gzip
[11:06:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:46] Treating reference as 'fasta' format.
[11:06:46] Will use 8 CPU cores.
[11:06:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[11:06:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out
[11:06:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out
[11:06:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:46] Creating reference folder: reference
[11:06:46] Extracting FASTA and GFF from reference.
[11:06:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:46] Found gzip - /usr/bin/gzip
[11:06:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:46] Treating reference as 'fasta' format.
[11:06:46] Will use 8 CPU cores.
[11:06:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[11:06:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out
[11:06:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out
[11:06:46] Creating reference folder: reference
[11:06:46] Extracting FASTA and GFF from reference.
[11:06:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:46] Wrote 3 sequences to ref.fa
[11:06:46] Wrote 0 features to ref.gff
[11:06:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta into pseudo-reads
[11:06:46] Treating reference as 'fasta' format.
[11:06:46] Will use 8 CPU cores.
[11:06:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
[11:06:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out
[11:06:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out
[11:06:46] Creating reference folder: reference
[11:06:46] Extracting FASTA and GFF from reference.
[11:06:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:46] Wrote 3 sequences to ref.fa
[11:06:46] Wrote 0 features to ref.gff
[11:06:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta into pseudo-reads
[11:06:46] Treating reference as 'fasta' format.
[11:06:46] Will use 8 CPU cores.
[11:06:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[11:06:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out
[11:06:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out
[11:06:46] Creating reference folder: reference
[11:06:46] Extracting FASTA and GFF from reference.
[11:06:46] Wrote 3 sequences to ref.fa
[11:06:46] Wrote 0 features to ref.gff
[11:06:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta into pseudo-reads
[11:06:46] Wrote 3 sequences to ref.fa
[11:06:46] Wrote 0 features to ref.gff
[11:06:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta into pseudo-reads
[11:06:46] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1902
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:06:46] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:47] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:47] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:06:47] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:47] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:47] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:47] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:47] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:47] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320226 reads in 17.013 CPU sec, 2.374 real sec
[11:06:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[11:06:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 68434 reads in 4.637 CPU sec, 0.536 real sec
[11:06:48] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:48] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:48] Running: rm -f fake_reads\.fq 2>> snps.log
[11:06:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.813 sec; CPU: 22.218 sec
[samclip] Total SAM records 389113, removed 1279, allowed 151, passed 387834
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:49] Wrote 387434 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:49] Using BAM RG (Read Group) ID: SAL_CB9389AA_AS.out
[11:06:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:49] Wrote 387620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:49] Using BAM RG (Read Group) ID: SAL_IB1406AA_AS.out
[11:06:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:49] Wrote 388648 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:49] Using BAM RG (Read Group) ID: SAL_KB4026AA_AS.out
[11:06:49] Wrote 386744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:49] Using BAM RG (Read Group) ID: SAL_AB5909AA_AS.out
[11:06:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:49] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:50] Running: samtools index snps.bam 2>> snps.log
[11:06:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:06:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:51] Marked 0 heterozygous sites with 'n'
[M::process] read 320060 sequences (80000232 bp)...
[11:06:51] Creating extra output files: BED GFF CSV TXT HTML
[11:06:51] Identified 1902 variants.
[11:06:51] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out
[11:06:51] Result files:
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.aligned.fa
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam.bai
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bed
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.fa
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.subs.fa
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.csv
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.filt.vcf
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.gff
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.html
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.log
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.raw.vcf
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.subs.vcf
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.tab
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.txt
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz
[11:06:51] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz.csi
[11:06:51] Walltime used: 21 seconds
[11:06:51] May the SNPs be with you.
[11:06:51] Done.
[Fri Jun 19 11:06:51 2020]
Finished job 163.
90 of 201 steps (45%) done

[Fri Jun 19 11:06:51 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out
    jobid: 9
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_HB5660AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[M::process] read 67560 sequences (16890000 bp)...
[M::process] read 320028 sequences (80000470 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 66716 sequences (16679000 bp)...
[11:06:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 67434 sequences (16826322 bp)...
[11:06:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320132 sequences (80000104 bp)...
[11:06:52] This is snippy 4.4.3
[11:06:52] Written by Torsten Seemann
[11:06:52] Obtained from https://github.com/tseemann/snippy
[11:06:52] Detected operating system: linux
[11:06:52] Enabling bundled linux tools.
[11:06:52] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:52] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:52] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:52] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:52] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:52] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:52] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:52] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:52] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:52] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:52] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:52] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:52] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:52] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:52] Found gzip - /usr/bin/gzip
[11:06:52] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:52] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:52] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:52] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:52] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:52] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:52] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:52] Marked 0 heterozygous sites with 'n'
[11:06:52] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:52] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:52] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:52] Creating extra output files: BED GFF CSV TXT HTML
[11:06:52] Identified 122 variants.
[11:06:52] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out
[11:06:52] Result files:
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.aligned.fa
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam.bai
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bed
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.fa
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.subs.fa
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.csv
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.filt.vcf
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.gff
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.html
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.log
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.raw.vcf
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.subs.vcf
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.tab
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.txt
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz
[11:06:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz.csi
[11:06:52] Walltime used: 20 seconds
[11:06:52] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:06:52] Done.
[11:06:52] Treating reference as 'fasta' format.
[11:06:52] Will use 8 CPU cores.
[11:06:52] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[11:06:52] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out
[11:06:52] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out
[11:06:52] Creating reference folder: reference
[11:06:52] Extracting FASTA and GFF from reference.
[Fri Jun 19 11:06:52 2020]
Finished job 154.
91 of 201 steps (45%) done

[Fri Jun 19 11:06:52 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out
    jobid: 7
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BA8052AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[11:06:52] Wrote 3 sequences to ref.fa
[11:06:52] Wrote 0 features to ref.gff
[11:06:52] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta into pseudo-reads
[M::process] read 68516 sequences (17114840 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:53] This is snippy 4.4.3
[11:06:53] Written by Torsten Seemann
[11:06:53] Obtained from https://github.com/tseemann/snippy
[11:06:53] Detected operating system: linux
[11:06:53] Enabling bundled linux tools.
[11:06:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:53] Found gzip - /usr/bin/gzip
[11:06:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:06:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:06:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:06:53] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:06:53] Treating reference as 'fasta' format.
[11:06:53] Will use 8 CPU cores.
[11:06:53] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[11:06:53] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out
[11:06:53] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out
[11:06:53] Creating reference folder: reference
[11:06:53] Extracting FASTA and GFF from reference.
[11:06:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:06:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:06:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:06:54] Wrote 3 sequences to ref.fa
[11:06:54] Wrote 0 features to ref.gff
[11:06:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta into pseudo-reads
[11:06:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:06:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:06:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:06:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.331 CPU sec, 2.504 real sec
[11:06:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:06:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:06:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:06:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:06:54] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320060 reads in 17.902 CPU sec, 2.905 real sec
[11:06:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320028 reads in 17.754 CPU sec, 2.959 real sec
[M::mem_process_seqs] Processed 67434 reads in 3.811 CPU sec, 0.456 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67560 reads in 4.027 CPU sec, 0.473 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 66716 reads in 4.076 CPU sec, 0.471 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320132 reads in 17.658 CPU sec, 3.088 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 387789, removed 947, allowed 69, passed 386842

[main] Real time: 4.034 sec; CPU: 21.743 sec
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.364 sec; CPU: 22.510 sec
[samclip] Total SAM records 387912, removed 862, allowed 124, passed 387050
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:55] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:55] Using BAM RG (Read Group) ID: SAL_HB5660AA_AS.out
[11:06:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:55] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.376 sec; CPU: 22.408 sec
[samclip] Total SAM records 386819, removed 459, allowed 82, passed 386360
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 68516 reads in 4.304 CPU sec, 0.497 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.527 sec; CPU: 22.537 sec
[samclip] Total SAM records 389838, removed 2946, allowed 93, passed 386892
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:56] Wrote 392016 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:06:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:06:56] Using BAM RG (Read Group) ID: SAL_BA8052AA_AS.out
[11:06:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:06:56] Running: bwa index reference/ref.fa 2>> snps.log
[11:06:57] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:06:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:57] Running: samtools index snps.bam 2>> snps.log
[11:06:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:57] Running: samtools index snps.bam 2>> snps.log
[11:06:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:06:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320038 sequences (80000204 bp)...
[11:06:58] Running: samtools index snps.bam 2>> snps.log
[11:06:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::process] read 66598 sequences (16649500 bp)...
[11:06:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:06:58] Marked 0 heterozygous sites with 'n'
[11:06:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:06:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:06:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:06:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:06:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:06:58] Creating extra output files: BED GFF CSV TXT HTML
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[11:06:58] Identified 28 variants.
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:06:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out
[11:06:58] Result files:
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.aligned.fa
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam.bai
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bed
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.fa
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.subs.fa
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.csv
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.filt.vcf
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.gff
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.html
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.log
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.raw.vcf
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.subs.vcf
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.tab
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.txt
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz
[11:06:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz.csi
[11:06:58] Walltime used: 19 seconds
[11:06:58] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:06:58] Done.
[Fri Jun 19 11:06:58 2020]
Finished job 116.
92 of 201 steps (46%) done

[Fri Jun 19 11:06:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out
    jobid: 37
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_HB6699AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
[M::process] read 320294 sequences (80000080 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:06:59] This is snippy 4.4.3
[11:06:59] Written by Torsten Seemann
[11:06:59] Obtained from https://github.com/tseemann/snippy
[11:06:59] Detected operating system: linux
[11:06:59] Enabling bundled linux tools.
[11:06:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:06:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:06:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:06:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:06:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:06:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:06:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:06:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:06:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:06:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:06:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:06:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:06:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:06:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:06:59] Found gzip - /usr/bin/gzip
[11:06:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:06:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:06:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:06:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:06:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:06:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:06:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:00] Treating reference as 'fasta' format.
[11:07:00] Will use 8 CPU cores.
[11:07:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
[11:07:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out
[11:07:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out
[11:07:00] Creating reference folder: reference
[11:07:00] Extracting FASTA and GFF from reference.
[11:07:00] Wrote 3 sequences to ref.fa
[11:07:00] Wrote 0 features to ref.gff
[11:07:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta into pseudo-reads
[11:07:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 71722 sequences (17913654 bp)...
[11:07:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 36
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:07:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 127
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 124
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320038 reads in 18.202 CPU sec, 3.599 real sec
[11:07:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:01] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[11:07:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320294 reads in 17.069 CPU sec, 3.157 real sec
[M::mem_process_seqs] Processed 66598 reads in 3.821 CPU sec, 0.437 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 71722 reads in 3.980 CPU sec, 0.468 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.993 sec; CPU: 22.594 sec
[samclip] Total SAM records 386765, removed 664, allowed 86, passed 386101
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:07:03] Wrote 387752 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:03] Using BAM RG (Read Group) ID: SAL_HB6699AA_AS.out
[11:07:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:03] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.590 sec; CPU: 21.623 sec
[samclip] Total SAM records 392343, removed 1246, allowed 371, passed 391097
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:04] Running: samtools index snps.bam 2>> snps.log
[11:07:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:05] Marked 0 heterozygous sites with 'n'
[11:07:05] Creating extra output files: BED GFF CSV TXT HTML
[11:07:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:05] Identified 27 variants.
[11:07:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out
[11:07:05] Result files:
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.aligned.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam.bai
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bed
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.subs.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.csv
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.filt.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.gff
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.html
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.log
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.raw.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.subs.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.tab
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.txt
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz.csi
[11:07:05] Walltime used: 20 seconds
[11:07:05] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:07:05] Done.
[11:07:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[Fri Jun 19 11:07:05 2020]
Finished job 181.
93 of 201 steps (46%) done

[Fri Jun 19 11:07:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out
    jobid: 167
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB1424AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[11:07:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:05] Running: samtools index snps.bam 2>> snps.log
[11:07:05] Marked 0 heterozygous sites with 'n'
[11:07:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:05] Marked 0 heterozygous sites with 'n'
[11:07:05] Creating extra output files: BED GFF CSV TXT HTML
[11:07:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:05] Identified 36 variants.
[11:07:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out
[11:07:05] Result files:
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.aligned.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam.bai
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bed
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.subs.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.csv
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.filt.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.gff
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.html
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.log
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.raw.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.subs.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.tab
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.txt
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz.csi
[11:07:05] Walltime used: 20 seconds
[11:07:05] May the SNPs be with you.
[11:07:05] Done.
[Fri Jun 19 11:07:05 2020]
Finished job 17.
94 of 201 steps (47%) done

[Fri Jun 19 11:07:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out
    jobid: 179
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_GB5373AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
[11:07:05] Creating extra output files: BED GFF CSV TXT HTML
[11:07:05] Identified 127 variants.
[11:07:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out
[11:07:05] Result files:
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.aligned.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam.bai
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bed
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.subs.fa
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.csv
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.filt.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.gff
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.html
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.log
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.raw.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.subs.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.tab
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.txt
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz
[11:07:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz.csi
[11:07:05] Walltime used: 20 seconds
[11:07:05] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:07:05] Done.
[Fri Jun 19 11:07:05 2020]
Finished job 28.
95 of 201 steps (47%) done

[Fri Jun 19 11:07:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out
    jobid: 105
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_HB2237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 67752 sequences (16917538 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:05] This is snippy 4.4.3
[11:07:05] Written by Torsten Seemann
[11:07:05] Obtained from https://github.com/tseemann/snippy
[11:07:05] Detected operating system: linux
[11:07:05] Enabling bundled linux tools.
[11:07:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:05] Found gzip - /usr/bin/gzip
[11:07:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:06] Marked 24 heterozygous sites with 'n'
[11:07:06] This is snippy 4.4.3
[11:07:06] Written by Torsten Seemann
[11:07:06] Obtained from https://github.com/tseemann/snippy
[11:07:06] Detected operating system: linux
[11:07:06] Enabling bundled linux tools.
[11:07:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:06] Treating reference as 'fasta' format.
[11:07:06] Will use 8 CPU cores.
[11:07:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[11:07:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out
[11:07:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out
[11:07:06] Creating reference folder: reference
[11:07:06] Extracting FASTA and GFF from reference.
[11:07:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:06] Found gzip - /usr/bin/gzip
[11:07:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:06] Creating extra output files: BED GFF CSV TXT HTML
[11:07:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:06] This is snippy 4.4.3
[11:07:06] Written by Torsten Seemann
[11:07:06] Obtained from https://github.com/tseemann/snippy
[11:07:06] Detected operating system: linux
[11:07:06] Enabling bundled linux tools.
[11:07:06] Identified 124 variants.
[11:07:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out
[11:07:06] Result files:
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.aligned.fa
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam.bai
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bed
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.fa
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.subs.fa
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.csv
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.filt.vcf
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.gff
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.html
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.log
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.raw.vcf
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.subs.vcf
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.tab
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.txt
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz
[11:07:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz.csi
[11:07:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:06] Walltime used: 21 seconds
[11:07:06] May the SNPs be with you.
[11:07:06] Done.
[11:07:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[Fri Jun 19 11:07:06 2020]
Finished job 46.
96 of 201 steps (48%) done
[11:07:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel

[Fri Jun 19 11:07:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out
    jobid: 129
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB7947AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[11:07:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:06] Found gzip - /usr/bin/gzip
[11:07:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:06] Wrote 3 sequences to ref.fa
[11:07:06] Wrote 0 features to ref.gff
[11:07:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta into pseudo-reads
[11:07:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:06] Treating reference as 'fasta' format.
[11:07:06] Will use 8 CPU cores.
[11:07:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
[11:07:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out
[11:07:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out
[11:07:06] Creating reference folder: reference
[11:07:06] Extracting FASTA and GFF from reference.
[11:07:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:06] Treating reference as 'fasta' format.
[11:07:06] Will use 8 CPU cores.
[11:07:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[11:07:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out
[11:07:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out
[11:07:06] Creating reference folder: reference
[11:07:06] Extracting FASTA and GFF from reference.
[11:07:06] Wrote 3 sequences to ref.fa
[11:07:06] Wrote 0 features to ref.gff
[11:07:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta into pseudo-reads
[11:07:06] Wrote 3 sequences to ref.fa
[11:07:06] Wrote 0 features to ref.gff
[11:07:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:06] This is snippy 4.4.3
[11:07:06] Written by Torsten Seemann
[11:07:06] Obtained from https://github.com/tseemann/snippy
[11:07:06] Detected operating system: linux
[11:07:06] Enabling bundled linux tools.
[11:07:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:06] Found gzip - /usr/bin/gzip
[11:07:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:07] Treating reference as 'fasta' format.
[11:07:07] Will use 8 CPU cores.
[11:07:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[11:07:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out
[11:07:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out
[11:07:07] Creating reference folder: reference
[11:07:07] Extracting FASTA and GFF from reference.
[11:07:07] Wrote 3 sequences to ref.fa
[11:07:07] Wrote 0 features to ref.gff
[11:07:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta into pseudo-reads
[11:07:07] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 320000 reads in 17.335 CPU sec, 2.412 real sec

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 13
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:07] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[11:07:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:08] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 67752 reads in 4.073 CPU sec, 0.473 real sec
[11:07:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[11:07:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:08] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[11:07:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.788 sec; CPU: 21.955 sec
[samclip] Total SAM records 388223, removed 1114, allowed 173, passed 387109
[samclip] Header contained 5 lines
[samclip] Done.
[11:07:08] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:08] Using BAM RG (Read Group) ID: SAL_BB1424AA_AS.out
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:09] Wrote 386850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:09] Using BAM RG (Read Group) ID: SAL_GB5373AA_AS.out
[11:07:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:09] Wrote 386690 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:09] Using BAM RG (Read Group) ID: SAL_HB2237AA_AS.out
[11:07:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:09] Wrote 386696 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:09] Using BAM RG (Read Group) ID: SAL_BB7947AA_AS.out
[11:07:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:10] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:10] Running: samtools index snps.bam 2>> snps.log
[11:07:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:07:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320072 sequences (80000370 bp)...
[M::process] read 66778 sequences (16694500 bp)...
[M::process] read 320062 sequences (80000134 bp)...
[M::process] read 320022 sequences (80000134 bp)...
[M::process] read 66628 sequences (16657000 bp)...
[11:07:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 66614 sequences (16649802 bp)...
[11:07:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320154 sequences (80000082 bp)...
[11:07:12] Marked 0 heterozygous sites with 'n'
[11:07:12] Creating extra output files: BED GFF CSV TXT HTML
[11:07:12] Identified 126 variants.
[11:07:12] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out
[11:07:12] Result files:
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.aligned.fa
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam.bai
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bed
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.fa
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.subs.fa
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.csv
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.filt.vcf
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.gff
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.html
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.log
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.raw.vcf
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.subs.vcf
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.tab
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.txt
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz
[11:07:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz.csi
[11:07:12] Walltime used: 20 seconds
[11:07:12] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:07:12] Done.
[Fri Jun 19 11:07:12 2020]
Finished job 9.
97 of 201 steps (48%) done

[Fri Jun 19 11:07:12 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out
    jobid: 2
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB5376AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[11:07:13] Marked 0 heterozygous sites with 'n'
[11:07:13] Creating extra output files: BED GFF CSV TXT HTML
[11:07:13] Identified 17 variants.
[11:07:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out
[11:07:13] Result files:
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.aligned.fa
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam.bai
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bed
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.fa
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.subs.fa
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.csv
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.filt.vcf
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.gff
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.html
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.log
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.raw.vcf
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.subs.vcf
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.tab
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.txt
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz
[11:07:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz.csi
[11:07:13] Walltime used: 20 seconds
[11:07:13] Wishing you a life free of homopolymer errors.
[11:07:13] Done.
[Fri Jun 19 11:07:13 2020]
Finished job 7.
98 of 201 steps (49%) done

[Fri Jun 19 11:07:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out
    jobid: 5
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB6160AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:13] This is snippy 4.4.3
[11:07:13] Written by Torsten Seemann
[11:07:13] Obtained from https://github.com/tseemann/snippy
[11:07:13] Detected operating system: linux
[11:07:13] Enabling bundled linux tools.
[11:07:13] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:13] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:13] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:13] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:13] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:13] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:13] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:13] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:13] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:13] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:13] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:13] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:13] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:13] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:13] Found gzip - /usr/bin/gzip
[11:07:13] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:13] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:13] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:13] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:13] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:13] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:13] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320062 reads in 16.606 CPU sec, 2.253 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:13] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:13] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:13] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:13] Treating reference as 'fasta' format.
[11:07:13] Will use 8 CPU cores.
[11:07:13] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[11:07:13] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out
[11:07:13] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out
[11:07:13] Creating reference folder: reference
[11:07:13] Extracting FASTA and GFF from reference.
[M::process] read 66542 sequences (16623902 bp)...
[M::mem_process_seqs] Processed 320022 reads in 15.877 CPU sec, 2.443 real sec
[11:07:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 53
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:14] Wrote 3 sequences to ref.fa
[11:07:14] Wrote 0 features to ref.gff
[11:07:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta into pseudo-reads
[11:07:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[11:07:14] This is snippy 4.4.3
[11:07:14] Written by Torsten Seemann
[11:07:14] Obtained from https://github.com/tseemann/snippy
[11:07:14] Detected operating system: linux
[11:07:14] Enabling bundled linux tools.
[11:07:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::mem_process_seqs] Processed 320072 reads in 17.922 CPU sec, 2.717 real sec
[11:07:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:14] Found gzip - /usr/bin/gzip
[11:07:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[M::mem_process_seqs] Processed 66628 reads in 3.711 CPU sec, 0.452 real sec
[11:07:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[11:07:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:14] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 66614 reads in 3.608 CPU sec, 0.438 real sec
[11:07:14] Treating reference as 'fasta' format.
[11:07:14] Will use 8 CPU cores.
[11:07:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
[11:07:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out
[11:07:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out
[11:07:14] Creating reference folder: reference
[11:07:14] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[11:07:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:14] Wrote 3 sequences to ref.fa
[11:07:14] Wrote 0 features to ref.gff
[11:07:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 66778 reads in 3.795 CPU sec, 0.452 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.708 sec; CPU: 20.886 sec
[samclip] Total SAM records 386963, removed 1362, allowed 123, passed 385601
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out[samclip] Total SAM records 386760, removed 436, allowed 46, passed 386324
 -t 8 reference/ref.fa[samclip] Header contained 5 lines
 fake_reads.fq[samclip] Done.

[main] Real time: 3.971 sec; CPU: 20.060 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.184 sec; CPU: 22.298 sec
[samclip] Total SAM records 387159, removed 1332, allowed 117, passed 385827
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320154 reads in 16.693 CPU sec, 3.253 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 66542 reads in 3.780 CPU sec, 0.444 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.649 sec; CPU: 21.030 sec
[samclip] Total SAM records 386970, removed 1115, allowed 55, passed 385855
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:16] Wrote 386032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:16] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:16] Using BAM RG (Read Group) ID: SAL_CB5376AA_AS.out
[11:07:16] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:16] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:16] Running: samtools index snps.bam 2>> snps.log
[11:07:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:17] Running: samtools index snps.bam 2>> snps.log
[11:07:17] Running: samtools index snps.bam 2>> snps.log
[11:07:17] Wrote 386002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:17] Using BAM RG (Read Group) ID: SAL_AB6160AA_AS.out
[11:07:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:17] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:18] Running: samtools index snps.bam 2>> snps.log
[11:07:18] Marked 4 heterozygous sites with 'n'
[11:07:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:18] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:07:18] Creating extra output files: BED GFF CSV TXT HTML
[11:07:18] Identified 53 variants.
[11:07:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out
[11:07:18] Result files:
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.aligned.fa
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam.bai
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bed
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.fa
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.subs.fa
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.csv
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.filt.vcf
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.gff
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.html
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.log
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.raw.vcf
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.subs.vcf
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.tab
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.txt
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz
[11:07:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz.csi
[11:07:18] Walltime used: 19 seconds
[11:07:18] Wishing you a life free of homopolymer errors.
[11:07:18] Done.
[11:07:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[Fri Jun 19 11:07:18 2020]
Finished job 37.
99 of 201 steps (49%) done

[Fri Jun 19 11:07:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out
    jobid: 85
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB6580AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
[11:07:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320006 sequences (80000324 bp)...
[11:07:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 66026 sequences (16506500 bp)...
[11:07:19] This is snippy 4.4.3
[11:07:19] Written by Torsten Seemann
[11:07:19] Obtained from https://github.com/tseemann/snippy
[11:07:19] Detected operating system: linux
[11:07:19] Enabling bundled linux tools.
[11:07:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[M::process] read 320006 sequences (80000340 bp)...
[11:07:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:19] Found gzip - /usr/bin/gzip
[11:07:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:19] Treating reference as 'fasta' format.
[11:07:19] Will use 8 CPU cores.
[11:07:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
[11:07:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out
[11:07:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out
[11:07:19] Creating reference folder: reference
[11:07:19] Extracting FASTA and GFF from reference.
[11:07:20] Wrote 3 sequences to ref.fa
[11:07:20] Wrote 0 features to ref.gff
[11:07:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta into pseudo-reads
[M::process] read 65996 sequences (16499000 bp)...
[11:07:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 816
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:07:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 818
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:07:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 160
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320006 reads in 16.973 CPU sec, 2.718 real sec
[11:07:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[11:07:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:22] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320006 reads in 17.003 CPU sec, 2.586 real sec
[M::mem_process_seqs] Processed 66026 reads in 3.993 CPU sec, 0.463 real sec
[11:07:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 65996 reads in 4.049 CPU sec, 0.466 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.105 sec; CPU: 21.515 sec
[samclip] Total SAM records 386389, removed 1059, allowed 97, passed 385330
[samclip] Header contained 5 lines
[samclip] Done.
[11:07:22] Wrote 386996 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:22] Using BAM RG (Read Group) ID: SAL_JB6580AA_AS.out
[11:07:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:22] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 386357, removed 1270, allowed 143, passed 385087

[main] Real time: 3.985 sec; CPU: 21.630 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:24] Running: samtools index snps.bam 2>> snps.log
[11:07:24] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:07:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:24] Marked 0 heterozygous sites with 'n'
[11:07:24] Marked 0 heterozygous sites with 'n'
[11:07:24] Creating extra output files: BED GFF CSV TXT HTML
[11:07:24] Identified 20 variants.
[11:07:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out
[11:07:24] Result files:
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.aligned.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam.bai
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bed
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.subs.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.csv
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.filt.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.gff
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.html
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.log
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.raw.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.subs.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.tab
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.txt
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz.csi
[11:07:24] Walltime used: 19 seconds
[11:07:24] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:07:24] Done.
[M::process] read 66996 sequences (16687816 bp)...
[11:07:24] Creating extra output files: BED GFF CSV TXT HTML
[11:07:24] Identified 816 variants.
[11:07:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out
[11:07:24] Result files:
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.aligned.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam.bai
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bed
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.subs.fa
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.csv
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.filt.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.gff
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.html
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.log
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.raw.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.subs.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.tab
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.txt
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz
[11:07:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz.csi
[Fri Jun 19 11:07:24 2020]
[11:07:24] Walltime used: 18 seconds
Finished job 167.
[11:07:24] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:07:24] Done.
100 of 201 steps (50%) done

[Fri Jun 19 11:07:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out
    jobid: 169
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA6324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
[Fri Jun 19 11:07:24 2020]
Finished job 105.
101 of 201 steps (50%) done

[Fri Jun 19 11:07:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out
    jobid: 190
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_UA4237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[11:07:25] Marked 0 heterozygous sites with 'n'
[11:07:25] Running: samtools index snps.bam 2>> snps.log
[11:07:25] Creating extra output files: BED GFF CSV TXT HTML
[11:07:25] Identified 818 variants.
[11:07:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out
[11:07:25] Result files:
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.aligned.fa
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam.bai
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bed
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.fa
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.subs.fa
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.csv
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.filt.vcf
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.gff
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.html
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.log
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.raw.vcf
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.subs.vcf
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.tab
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.txt
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz
[11:07:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz.csi
[11:07:25] Walltime used: 19 seconds
[11:07:25] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:07:25] Done.
[Fri Jun 19 11:07:25 2020]
Finished job 179.
102 of 201 steps (51%) done

[Fri Jun 19 11:07:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out
    jobid: 41
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IB9302AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
[11:07:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:25] This is snippy 4.4.3
[11:07:25] Written by Torsten Seemann
[11:07:25] Obtained from https://github.com/tseemann/snippy
[11:07:25] Detected operating system: linux
[11:07:25] Enabling bundled linux tools.
[11:07:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:25] This is snippy 4.4.3
[11:07:25] Written by Torsten Seemann
[11:07:25] Obtained from https://github.com/tseemann/snippy
[11:07:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:25] Detected operating system: linux
[11:07:25] Enabling bundled linux tools.
[11:07:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:25] Found gzip - /usr/bin/gzip
[11:07:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:25] Found gzip - /usr/bin/gzip
[11:07:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:25] This is snippy 4.4.3
[11:07:25] Written by Torsten Seemann
[11:07:25] Obtained from https://github.com/tseemann/snippy
[11:07:25] Detected operating system: linux
[11:07:25] Enabling bundled linux tools.
[11:07:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:25] Found gzip - /usr/bin/gzip
[11:07:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:26] Treating reference as 'fasta' format.
[11:07:26] Will use 8 CPU cores.
[11:07:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
[11:07:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out
[11:07:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out
[11:07:26] Creating reference folder: reference
[11:07:26] Treating reference as 'fasta' format.
[11:07:26] Will use 8 CPU cores.
[11:07:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[11:07:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out
[11:07:26] Extracting FASTA and GFF from reference.
[11:07:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out
[11:07:26] Creating reference folder: reference
[11:07:26] Extracting FASTA and GFF from reference.
[11:07:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:26] Treating reference as 'fasta' format.
[11:07:26] Will use 8 CPU cores.
[11:07:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
[11:07:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out
[11:07:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out
[11:07:26] Creating reference folder: reference
[11:07:26] Extracting FASTA and GFF from reference.
[11:07:26] Wrote 3 sequences to ref.fa
[11:07:26] Wrote 0 features to ref.gff
[11:07:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta into pseudo-reads
[11:07:26] Wrote 3 sequences to ref.fa
[11:07:26] Wrote 0 features to ref.gff
[11:07:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta into pseudo-reads
[11:07:26] Marked 1 heterozygous sites with 'n'
[11:07:26] Wrote 3 sequences to ref.fa
[11:07:26] Wrote 0 features to ref.gff
[11:07:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta into pseudo-reads
[11:07:26] Creating extra output files: BED GFF CSV TXT HTML
[11:07:26] Identified 160 variants.
[11:07:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out
[11:07:26] Result files:
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.aligned.fa
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam.bai
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bed
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.fa
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.subs.fa
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.csv
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.filt.vcf
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.gff
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.html
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.log
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.raw.vcf
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.subs.vcf
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.tab
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.txt
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz
[11:07:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz.csi
[11:07:26] Walltime used: 20 seconds
[11:07:26] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:07:26] Done.
[Fri Jun 19 11:07:26 2020]
Finished job 129.
103 of 201 steps (51%) done

[Fri Jun 19 11:07:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out
    jobid: 145
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB1026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:27] This is snippy 4.4.3
[11:07:27] Written by Torsten Seemann
[11:07:27] Obtained from https://github.com/tseemann/snippy
[11:07:27] Detected operating system: linux
[11:07:27] Enabling bundled linux tools.
[11:07:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:27] Found gzip - /usr/bin/gzip
[11:07:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320000 reads in 17.671 CPU sec, 2.436 real sec
[11:07:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:27] Treating reference as 'fasta' format.
[11:07:27] Will use 8 CPU cores.
[11:07:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
[11:07:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out
[11:07:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out
[11:07:27] Creating reference folder: reference
[11:07:27] Extracting FASTA and GFF from reference.
[11:07:27] Wrote 3 sequences to ref.fa
[11:07:27] Wrote 0 features to ref.gff
[11:07:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66996 reads in 4.040 CPU sec, 0.468 real sec
[11:07:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[11:07:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:27] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:07:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 123
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.828 sec; CPU: 22.267 sec
[samclip] Total SAM records 387265, removed 654, allowed 75, passed 386611
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:29] Wrote 389494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:29] Wrote 389584 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:29] Using BAM RG (Read Group) ID: SAL_TA6324AA_AS.out
[11:07:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:29] Using BAM RG (Read Group) ID: SAL_UA4237AA_AS.out
[11:07:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:29] Wrote 386730 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:29] Using BAM RG (Read Group) ID: SAL_IB9302AA_AS.out
[11:07:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:29] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:30] Wrote 386242 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:30] Using BAM RG (Read Group) ID: SAL_EB1026AA_AS.out
[11:07:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:30] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:30] Running: samtools index snps.bam 2>> snps.log
[11:07:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:07:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:07:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[11:07:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320106 sequences (80000138 bp)...
[M::process] read 320064 sequences (80000266 bp)...
[M::process] read 320082 sequences (80000060 bp)...
[M::process] read 69478 sequences (17359898 bp)...
[M::process] read 69430 sequences (17349116 bp)...
[11:07:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 66648 sequences (16662000 bp)...
[11:07:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:32] Marked 0 heterozygous sites with 'n'
[11:07:32] Creating extra output files: BED GFF CSV TXT HTML
[11:07:32] Identified 25 variants.
[11:07:32] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out
[11:07:32] Result files:
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.aligned.fa
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam.bai
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bed
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.fa
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.subs.fa
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.csv
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.filt.vcf
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.gff
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.html
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.log
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.raw.vcf
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.subs.vcf
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.tab
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.txt
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz
[11:07:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz.csi
[11:07:32] Walltime used: 19 seconds
[11:07:32] Questionable SNP? Try the --report option to see the alignments.
[11:07:32] Done.
[Fri Jun 19 11:07:32 2020]
Finished job 2.
104 of 201 steps (52%) done

[Fri Jun 19 11:07:32 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out
    jobid: 174
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_OA4067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[M::process] read 320070 sequences (80000452 bp)...
[11:07:32] Marked 0 heterozygous sites with 'n'
[11:07:32] Creating extra output files: BED GFF CSV TXT HTML
[11:07:33] Identified 123 variants.
[11:07:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out
[11:07:33] Result files:
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.aligned.fa
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam.bai
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bed
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.fa
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.subs.fa
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.csv
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.filt.vcf
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.gff
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.html
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.log
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.raw.vcf
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.subs.vcf
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.tab
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.txt
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz
[11:07:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz.csi
[11:07:33] Walltime used: 19 seconds
[11:07:33] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:07:33] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Fri Jun 19 11:07:33 2020]
Finished job 5.
105 of 201 steps (52%) done

[Fri Jun 19 11:07:33 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out
    jobid: 60
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB7261AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[M::process] read 66172 sequences (16527628 bp)...
[11:07:33] This is snippy 4.4.3
[11:07:33] Written by Torsten Seemann
[11:07:33] Obtained from https://github.com/tseemann/snippy
[11:07:33] Detected operating system: linux
[11:07:33] Enabling bundled linux tools.
[11:07:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:33] Found gzip - /usr/bin/gzip
[11:07:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:33] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:33] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:33] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:33] Treating reference as 'fasta' format.
[11:07:33] Will use 8 CPU cores.
[11:07:33] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[11:07:33] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out
[11:07:33] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out
[11:07:33] Creating reference folder: reference
[11:07:33] Extracting FASTA and GFF from reference.
[11:07:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:33] Wrote 3 sequences to ref.fa
[11:07:33] Wrote 0 features to ref.gff
[11:07:33] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta into pseudo-reads
[11:07:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:33] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:33] This is snippy 4.4.3
[11:07:33] Written by Torsten Seemann
[11:07:33] Obtained from https://github.com/tseemann/snippy
[11:07:33] Detected operating system: linux
[11:07:33] Enabling bundled linux tools.
[11:07:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:33] Found gzip - /usr/bin/gzip
[11:07:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:34] Treating reference as 'fasta' format.
[11:07:34] Will use 8 CPU cores.
[11:07:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[11:07:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out
[11:07:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out
[11:07:34] Creating reference folder: reference
[11:07:34] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320064 reads in 18.532 CPU sec, 2.569 real sec
[11:07:34] Wrote 3 sequences to ref.fa
[11:07:34] Wrote 0 features to ref.gff
[11:07:34] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320082 reads in 17.387 CPU sec, 2.606 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69430 reads in 4.621 CPU sec, 0.544 real sec
[M::mem_process_seqs] Processed 66648 reads in 4.157 CPU sec, 0.494 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320106 reads in 19.741 CPU sec, 3.315 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320070 reads in 16.906 CPU sec, 2.659 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.063 sec; CPU: 23.739 sec
[samclip] Total SAM records 389663, removed 1036, allowed 184, passed 388627
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 69478 reads in 4.308 CPU sec, 0.509 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out[samclip] Total SAM records 387142, removed 1082, allowed 126, passed 386060
 -t 8 reference/ref.fa[samclip] Header contained 5 lines
 fake_reads.fq[samclip] Done.

[main] Real time: 4.191 sec; CPU: 22.154 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 66172 reads in 3.836 CPU sec, 0.447 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 389774, removed 1167, allowed 287, passed 388607
[samclip] Header contained 5 lines

[main] Real time: 4.767 sec; CPU: 24.620 sec
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 386598, removed 843, allowed 136, passed 385755
 bwa[samclip] Header contained 5 lines
 mem[samclip] Done.
 -Y -M -R @RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.066 sec; CPU: 21.300 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:36] Wrote 390044 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:36] Using BAM RG (Read Group) ID: SAL_OA4067AA_AS.out
[11:07:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:36] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:36] Wrote 386562 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:36] Using BAM RG (Read Group) ID: SAL_BB7261AA_AS.out
[11:07:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:36] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:37] Running: samtools index snps.bam 2>> snps.log
[11:07:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:37] Running: samtools index snps.bam 2>> snps.log
[11:07:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:37] Marked 0 heterozygous sites with 'n'
[11:07:37] Running: samtools index snps.bam 2>> snps.log
[11:07:38] Creating extra output files: BED GFF CSV TXT HTML
[11:07:38] Identified 16 variants.
[11:07:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out
[11:07:38] Result files:
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.aligned.fa
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam.bai
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bed
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.fa
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.subs.fa
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.csv
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.filt.vcf
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.gff
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.html
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.log
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.raw.vcf
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.subs.vcf
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.tab
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.txt
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz
[11:07:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz.csi
[11:07:38] Walltime used: 19 seconds
[11:07:38] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:07:38] Done.
[Fri Jun 19 11:07:38 2020]
Finished job 85.
106 of 201 steps (53%) done

[Fri Jun 19 11:07:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out
    jobid: 78
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9820AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
[11:07:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:38] Running: samtools index snps.bam 2>> snps.log
[11:07:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:07:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320132 sequences (80000202 bp)...
[11:07:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:38] This is snippy 4.4.3
[11:07:38] Written by Torsten Seemann
[11:07:38] Obtained from https://github.com/tseemann/snippy
[11:07:38] Detected operating system: linux
[11:07:38] Enabling bundled linux tools.
[11:07:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:07:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:07:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:38] Found gzip - /usr/bin/gzip
[11:07:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::process] read 320170 sequences (80000294 bp)...
[11:07:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:39] Treating reference as 'fasta' format.
[11:07:39] Will use 8 CPU cores.
[11:07:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
[11:07:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out
[11:07:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out
[11:07:39] Creating reference folder: reference
[11:07:39] Extracting FASTA and GFF from reference.
[11:07:39] Wrote 3 sequences to ref.fa
[11:07:39] Wrote 0 features to ref.gff
[11:07:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta into pseudo-reads
[M::process] read 66392 sequences (16598000 bp)...
[11:07:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69912 sequences (17453658 bp)...
[11:07:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:07:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 1806
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:07:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:07:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1796
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:07:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:42] Wrote 385396 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:42] Using BAM RG (Read Group) ID: SAL_CB9820AA_AS.out
[11:07:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:42] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320170 reads in 17.395 CPU sec, 2.994 real sec
[M::mem_process_seqs] Processed 320132 reads in 17.911 CPU sec, 3.619 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66392 reads in 3.976 CPU sec, 0.456 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69912 reads in 4.443 CPU sec, 0.513 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.405 sec; CPU: 21.944 sec
[samclip] Total SAM records 386977, removed 1091, allowed 73, passed 385886
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.004 sec; CPU: 22.900 sec
[samclip] Total SAM records 390296, removed 893, allowed 191, passed 389403
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65396 sequences (16349000 bp)...
[11:07:45] Marked 0 heterozygous sites with 'n'
[11:07:45] Creating extra output files: BED GFF CSV TXT HTML
[11:07:45] Identified 27 variants.
[11:07:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out
[11:07:45] Result files:
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.aligned.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam.bai
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bed
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.subs.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.csv
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.filt.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.gff
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.html
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.log
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.raw.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.subs.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.tab
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.txt
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz.csi
[11:07:45] Walltime used: 20 seconds
[11:07:45] May the SNPs be with you.
[11:07:45] Done.
[Fri Jun 19 11:07:45 2020]
Finished job 41.
107 of 201 steps (53%) done

[Fri Jun 19 11:07:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out
    jobid: 112
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB7634AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
[11:07:45] Running: samtools index snps.bam 2>> snps.log
[11:07:45] Running: samtools index snps.bam 2>> snps.log
[11:07:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:45] Marked 0 heterozygous sites with 'n'
[11:07:45] Creating extra output files: BED GFF CSV TXT HTML
[11:07:45] Identified 1806 variants.
[11:07:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out
[11:07:45] Result files:
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.aligned.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam.bai
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bed
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.subs.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.csv
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.filt.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.gff
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.html
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.log
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.raw.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.subs.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.tab
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.txt
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz.csi
[11:07:45] Walltime used: 20 seconds
[11:07:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:07:45] Done.
[Fri Jun 19 11:07:45 2020]
Finished job 169.
108 of 201 steps (54%) done

[Fri Jun 19 11:07:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out
    jobid: 180
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_UA6621AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:45] Marked 0 heterozygous sites with 'n'
[11:07:45] Creating extra output files: BED GFF CSV TXT HTML
[11:07:45] Identified 12 variants.
[11:07:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out
[11:07:45] Result files:
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.aligned.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam.bai
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bed
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.subs.fa
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.csv
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.filt.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.gff
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.html
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.log
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.raw.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.subs.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.tab
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.txt
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz
[11:07:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz.csi
[11:07:45] Walltime used: 18 seconds
[11:07:45] Questionable SNP? Try the --report option to see the alignments.
[11:07:45] Done.
[Fri Jun 19 11:07:45 2020]
Finished job 145.
109 of 201 steps (54%) done

[Fri Jun 19 11:07:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out
    jobid: 3
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB7197AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[11:07:45] This is snippy 4.4.3
[11:07:45] Written by Torsten Seemann
[11:07:45] Obtained from https://github.com/tseemann/snippy
[11:07:45] Detected operating system: linux
[11:07:45] Enabling bundled linux tools.
[11:07:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:46] Found gzip - /usr/bin/gzip
[11:07:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:46] Marked 0 heterozygous sites with 'n'
[11:07:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:46] Creating extra output files: BED GFF CSV TXT HTML
[11:07:46] Treating reference as 'fasta' format.
[11:07:46] Will use 8 CPU cores.
[11:07:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
[11:07:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out
[11:07:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out
[11:07:46] Creating reference folder: reference
[11:07:46] Extracting FASTA and GFF from reference.
[11:07:46] Identified 1796 variants.
[11:07:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out
[11:07:46] Result files:
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.aligned.fa
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam.bai
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bed
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.fa
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.subs.fa
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.csv
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.filt.vcf
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.gff
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.html
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.log
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.raw.vcf
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.subs.vcf
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.tab
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.txt
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz
[11:07:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz.csi
[11:07:46] Walltime used: 21 seconds
[11:07:46] May the SNPs be with you.
[11:07:46] Done.
[Fri Jun 19 11:07:46 2020]
Finished job 190.
110 of 201 steps (55%) done

[Fri Jun 19 11:07:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out
    jobid: 66
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EA3229AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[11:07:46] This is snippy 4.4.3
[11:07:46] Written by Torsten Seemann
[11:07:46] Obtained from https://github.com/tseemann/snippy
[11:07:46] Detected operating system: linux
[11:07:46] Enabling bundled linux tools.
[11:07:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:46] Found gzip - /usr/bin/gzip
[11:07:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:46] Wrote 3 sequences to ref.fa
[11:07:46] Wrote 0 features to ref.gff
[11:07:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:46] Treating reference as 'fasta' format.
[11:07:46] Will use 8 CPU cores.
[11:07:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
[11:07:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out
[11:07:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out
[11:07:46] Creating reference folder: reference
[11:07:46] Extracting FASTA and GFF from reference.
[11:07:46] This is snippy 4.4.3
[11:07:46] Written by Torsten Seemann
[11:07:46] Obtained from https://github.com/tseemann/snippy
[11:07:46] Detected operating system: linux
[11:07:46] Enabling bundled linux tools.
[11:07:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:46] Found gzip - /usr/bin/gzip
[11:07:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 320000 reads in 16.803 CPU sec, 2.293 real sec
[11:07:46] Wrote 3 sequences to ref.fa
[11:07:46] Wrote 0 features to ref.gff
[11:07:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta into pseudo-reads
[11:07:46] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:46] Treating reference as 'fasta' format.
[11:07:46] Will use 8 CPU cores.
[11:07:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[11:07:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out
[11:07:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out
[11:07:46] Creating reference folder: reference
[11:07:46] Extracting FASTA and GFF from reference.
[11:07:46] This is snippy 4.4.3
[11:07:46] Written by Torsten Seemann
[11:07:46] Obtained from https://github.com/tseemann/snippy
[11:07:46] Detected operating system: linux
[11:07:46] Enabling bundled linux tools.
[11:07:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[samclip] Processed 100000 records...
[11:07:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:46] Found gzip - /usr/bin/gzip
[11:07:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:46] Wrote 3 sequences to ref.fa
[11:07:46] Wrote 0 features to ref.gff
[11:07:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta into pseudo-reads
[11:07:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 65396 reads in 3.949 CPU sec, 0.458 real sec
[11:07:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:47] Treating reference as 'fasta' format.
[11:07:47] Will use 8 CPU cores.
[11:07:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[11:07:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out
[11:07:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out
[11:07:47] Creating reference folder: reference
[11:07:47] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[11:07:47] Wrote 3 sequences to ref.fa
[11:07:47] Wrote 0 features to ref.gff
[11:07:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.671 sec; CPU: 21.287 sec
[samclip] Total SAM records 385665, removed 767, allowed 60, passed 384898
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:48] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:07:48] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:48] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:48] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:48] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:48] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:07:49] Wrote 385520 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:49] Using BAM RG (Read Group) ID: SAL_AB7634AA_AS.out
[11:07:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:49] Wrote 389570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:49] Using BAM RG (Read Group) ID: SAL_UA6621AA_AS.out
[11:07:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:49] Running: samtools index snps.bam 2>> snps.log
[11:07:49] Wrote 386790 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:49] Using BAM RG (Read Group) ID: SAL_BB7197AA_AS.out
[11:07:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:50] Wrote 389758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:50] Using BAM RG (Read Group) ID: SAL_EA3229AA_AS.out
[11:07:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:50] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65520 sequences (16365686 bp)...
[11:07:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 320054 sequences (80000000 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 69516 sequences (17369250 bp)...
[11:07:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320016 sequences (80000308 bp)...
[M::process] read 66774 sequences (16651596 bp)...
[M::process] read 320092 sequences (80000166 bp)...
[11:07:52] Marked 1 heterozygous sites with 'n'
[11:07:52] Creating extra output files: BED GFF CSV TXT HTML
[11:07:52] Identified 19 variants.
[11:07:52] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out
[11:07:52] Result files:
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.aligned.fa
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam.bai
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bed
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.fa
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.subs.fa
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.csv
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.filt.vcf
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.gff
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.html
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.log
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.raw.vcf
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.subs.vcf
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.tab
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.txt
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz
[11:07:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz.csi
[11:07:52] Walltime used: 19 seconds
[11:07:52] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:07:52] Done.
[M::process] read 69666 sequences (17412620 bp)...
[11:07:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[Fri Jun 19 11:07:52 2020]
Finished job 60.
111 of 201 steps (55%) done

[Fri Jun 19 11:07:52 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out
    jobid: 128
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA9926AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:07:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:07:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:07:53] Marked 0 heterozygous sites with 'n'
[11:07:53] Creating extra output files: BED GFF CSV TXT HTML
[11:07:53] Identified 18 variants.
[11:07:53] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out
[11:07:53] Result files:
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.aligned.fa
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam.bai
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bed
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.fa
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.subs.fa
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.csv
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.filt.vcf
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.gff
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.html
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.log
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.raw.vcf
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.subs.vcf
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.tab
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.txt
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz
[11:07:53] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz.csi
[11:07:53] Walltime used: 20 seconds
[11:07:53] Wishing you a life free of homopolymer errors.
[11:07:53] Done.
[11:07:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[Fri Jun 19 11:07:53 2020]
Finished job 174.
112 of 201 steps (56%) done

[Fri Jun 19 11:07:53 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out
    jobid: 97
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_OA4072AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[11:07:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:07:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:07:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:07:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:07:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:07:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:07:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:07:53] Running: rm -f fake_reads\.fq 2>> snps.log
[11:07:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:53] This is snippy 4.4.3
[11:07:53] Written by Torsten Seemann
[11:07:53] Obtained from https://github.com/tseemann/snippy
[11:07:53] Detected operating system: linux
[11:07:53] Enabling bundled linux tools.
[11:07:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:53] Found gzip - /usr/bin/gzip
[11:07:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:53] This is snippy 4.4.3
[11:07:53] Written by Torsten Seemann
[11:07:53] Obtained from https://github.com/tseemann/snippy
[11:07:53] Detected operating system: linux
[11:07:53] Enabling bundled linux tools.
[11:07:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:53] Found gzip - /usr/bin/gzip
[11:07:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:53] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:53] Treating reference as 'fasta' format.
[11:07:53] Will use 8 CPU cores.
[11:07:53] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
[11:07:53] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out
[11:07:53] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out
[11:07:53] Creating reference folder: reference
[11:07:53] Extracting FASTA and GFF from reference.
[11:07:54] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:54] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:54] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:54] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:54] Wrote 3 sequences to ref.fa
[11:07:54] Wrote 0 features to ref.gff
[11:07:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta into pseudo-reads
[11:07:54] Treating reference as 'fasta' format.
[11:07:54] Will use 8 CPU cores.
[11:07:54] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[11:07:54] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out
[11:07:54] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out
[11:07:54] Creating reference folder: reference
[11:07:54] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320000 reads in 17.639 CPU sec, 2.738 real sec
[M::mem_process_seqs] Processed 320054 reads in 19.079 CPU sec, 2.554 real sec
[11:07:54] Wrote 3 sequences to ref.fa
[11:07:54] Wrote 0 features to ref.gff
[11:07:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65520 reads in 3.968 CPU sec, 0.476 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320016 reads in 17.499 CPU sec, 2.619 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69516 reads in 4.580 CPU sec, 0.542 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 66774 reads in 4.270 CPU sec, 0.495 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 385694, removed 562, allowed 45, passed 385132
[samclip] Header contained 5 lines

[main] Real time: 4.263 sec; CPU: 22.229 sec
[samclip] Done.
[M::mem_process_seqs] Processed 320092 reads in 18.943 CPU sec, 2.959 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.053 sec; CPU: 24.240 sec
[samclip] Total SAM records 389757, removed 1287, allowed 188, passed 388470
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.010 sec; CPU: 22.329 sec
[samclip] Total SAM records 387008, removed 613, allowed 54, passed 386395
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69666 reads in 4.644 CPU sec, 0.537 real sec
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.337 sec; CPU: 24.108 sec
[samclip] Total SAM records 389981, removed 1621, allowed 403, passed 388360
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:56] Wrote 389852 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:56] Using BAM RG (Read Group) ID: SAL_WA9926AA_AS.out
[11:07:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:57] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:57] Wrote 390014 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:07:57] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:07:57] Using BAM RG (Read Group) ID: SAL_OA4072AA_AS.out
[11:07:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:07:57] Running: bwa index reference/ref.fa 2>> snps.log
[11:07:57] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:07:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:57] Running: samtools index snps.bam 2>> snps.log
[11:07:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:57] Marked 0 heterozygous sites with 'n'
[11:07:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:57] Creating extra output files: BED GFF CSV TXT HTML
[11:07:57] Identified 22 variants.
[11:07:57] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out
[11:07:57] Result files:
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.aligned.fa
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam.bai
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bed
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.fa
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.subs.fa
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.csv
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.filt.vcf
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.gff
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.html
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.log
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.raw.vcf
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.subs.vcf
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.tab
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.txt
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz
[11:07:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz.csi
[11:07:57] Walltime used: 19 seconds
[11:07:57] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:07:57] Done.
[Fri Jun 19 11:07:57 2020]
Finished job 78.
113 of 201 steps (56%) done

[Fri Jun 19 11:07:57 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out
    jobid: 160
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_PB8418AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[11:07:57] Running: samtools index snps.bam 2>> snps.log
[11:07:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:07:58] Running: samtools index snps.bam 2>> snps.log
[11:07:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:07:58] This is snippy 4.4.3
[11:07:58] Written by Torsten Seemann
[11:07:58] Obtained from https://github.com/tseemann/snippy
[11:07:58] Detected operating system: linux
[11:07:58] Enabling bundled linux tools.
[11:07:58] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:07:58] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:07:58] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:07:58] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:07:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:07:58] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:07:58] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:07:58] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:07:58] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:07:58] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:07:58] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:07:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:07:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:07:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:07:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:07:58] Found gzip - /usr/bin/gzip
[11:07:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:07:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:07:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:07:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:07:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:07:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:07:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:07:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:07:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:07:58] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:07:58] Treating reference as 'fasta' format.
[11:07:58] Will use 8 CPU cores.
[11:07:58] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[11:07:58] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out
[11:07:58] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out
[11:07:58] Creating reference folder: reference
[11:07:58] Extracting FASTA and GFF from reference.
[11:07:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:07:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:07:58] Wrote 3 sequences to ref.fa
[11:07:58] Wrote 0 features to ref.gff
[11:07:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta into pseudo-reads
[11:07:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:07:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:07:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:07:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320172 sequences (80000152 bp)...
[M::process] read 320208 sequences (80000248 bp)...
[11:08:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69680 sequences (17397876 bp)...
[M::process] read 69806 sequences (17445592 bp)...
[11:08:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:00] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1801
       total no. reference observed             : 0

Time elapsed: 0.02s


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:01] Wrote 385894 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:01] Using BAM RG (Read Group) ID: SAL_PB8418AA_AS.out
[11:08:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:01] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1918
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320172 reads in 17.736 CPU sec, 3.245 real sec
[11:08:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:02] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320208 reads in 17.849 CPU sec, 3.175 real sec
[11:08:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69680 reads in 3.997 CPU sec, 0.460 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69806 reads in 4.381 CPU sec, 0.506 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.623 sec; CPU: 22.285 sec
[samclip] Total SAM records 390278, removed 1126, allowed 137, passed 389152
[samclip] Header contained 5 lines
[samclip] Done.
[11:08:03] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:03] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:03] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:03] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:03] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390269, removed 1087, allowed 146, passed 389182

[main] Real time: 4.567 sec; CPU: 22.777 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65894 sequences (16464040 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:05] Marked 0 heterozygous sites with 'n'
[11:08:05] Creating extra output files: BED GFF CSV TXT HTML
[11:08:05] Identified 16 variants.
[11:08:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out
[11:08:05] Result files:
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.aligned.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam.bai
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bed
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.subs.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.csv
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.filt.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.gff
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.html
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.log
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.raw.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.subs.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.tab
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.txt
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz.csi
[11:08:05] Walltime used: 20 seconds
[11:08:05] Questionable SNP? Try the --report option to see the alignments.
[11:08:05] Done.
[Fri Jun 19 11:08:05 2020]
Finished job 112.
114 of 201 steps (57%) done

[Fri Jun 19 11:08:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out
    jobid: 175
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB2372AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[11:08:05] Running: samtools index snps.bam 2>> snps.log
[11:08:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:05] Running: samtools index snps.bam 2>> snps.log
[11:08:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:05] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:05] Creating extra output files: BED GFF CSV TXT HTML
[11:08:05] Identified 24 variants.
[11:08:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out
[11:08:05] Result files:
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.aligned.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam.bai
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bed
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.subs.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.csv
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.filt.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.gff
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.html
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.log
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.raw.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.subs.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.tab
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.txt
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz.csi
[11:08:05] Walltime used: 19 seconds
[11:08:05] Questionable SNP? Try the --report option to see the alignments.
[11:08:05] Done.
[11:08:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:05] Marked 0 heterozygous sites with 'n'
[Fri Jun 19 11:08:05 2020]
Finished job 3.
115 of 201 steps (57%) done

[Fri Jun 19 11:08:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out
    jobid: 189
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB8135AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[11:08:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:05] Creating extra output files: BED GFF CSV TXT HTML
[11:08:05] Identified 1801 variants.
[11:08:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out
[11:08:05] Result files:
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.aligned.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam.bai
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bed
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.subs.fa
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.csv
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.filt.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.gff
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.html
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.log
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.raw.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.subs.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.tab
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.txt
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz
[11:08:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz.csi
[11:08:05] Walltime used: 19 seconds
[11:08:05] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:08:05] Done.
[Fri Jun 19 11:08:05 2020]
Finished job 180.
116 of 201 steps (58%) done

[Fri Jun 19 11:08:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out
    jobid: 12
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB1136AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
[11:08:05] This is snippy 4.4.3
[11:08:05] Written by Torsten Seemann
[11:08:05] Obtained from https://github.com/tseemann/snippy
[11:08:05] Detected operating system: linux
[11:08:05] Enabling bundled linux tools.
[11:08:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:05] Found gzip - /usr/bin/gzip
[11:08:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:06] Treating reference as 'fasta' format.
[11:08:06] Will use 8 CPU cores.
[11:08:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[11:08:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out
[11:08:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out
[11:08:06] Creating reference folder: reference
[11:08:06] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:06] Wrote 3 sequences to ref.fa
[11:08:06] Wrote 0 features to ref.gff
[11:08:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320000 reads in 18.361 CPU sec, 2.501 real sec
[11:08:06] This is snippy 4.4.3
[11:08:06] Written by Torsten Seemann
[11:08:06] Obtained from https://github.com/tseemann/snippy
[11:08:06] Detected operating system: linux
[11:08:06] Enabling bundled linux tools.
[11:08:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:06] Found gzip - /usr/bin/gzip
[11:08:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:06] This is snippy 4.4.3
[11:08:06] Written by Torsten Seemann
[11:08:06] Obtained from https://github.com/tseemann/snippy
[11:08:06] Detected operating system: linux
[11:08:06] Enabling bundled linux tools.
[11:08:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:06] Found gzip - /usr/bin/gzip
[11:08:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:06] Marked 0 heterozygous sites with 'n'
[11:08:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:06] Treating reference as 'fasta' format.
[11:08:06] Will use 8 CPU cores.
[11:08:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[11:08:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out
[11:08:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out
[11:08:06] Creating reference folder: reference
[11:08:06] Extracting FASTA and GFF from reference.
[11:08:06] Creating extra output files: BED GFF CSV TXT HTML
[11:08:06] Identified 1918 variants.
[11:08:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out
[11:08:06] Result files:
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.aligned.fa
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam.bai
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bed
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.fa
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.subs.fa
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.csv
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.filt.vcf
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.gff
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.html
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.log
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.raw.vcf
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.subs.vcf
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.tab
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.txt
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz
[11:08:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz.csi
[11:08:06] Walltime used: 20 seconds
[11:08:06] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:08:06] Done.
[Fri Jun 19 11:08:06 2020]
Finished job 66.
117 of 201 steps (58%) done

[Fri Jun 19 11:08:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out
    jobid: 162
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB7027AA_AS
    threads: 5

[samclip] Processed 100000 records...
snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[11:08:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:06] Treating reference as 'fasta' format.
[11:08:06] Will use 8 CPU cores.
[11:08:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
[11:08:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out
[11:08:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out
[11:08:06] Creating reference folder: reference
[11:08:06] Extracting FASTA and GFF from reference.
[11:08:06] Wrote 3 sequences to ref.fa
[11:08:06] Wrote 0 features to ref.gff
[11:08:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 65894 reads in 4.087 CPU sec, 0.482 real sec
[11:08:06] Wrote 3 sequences to ref.fa
[11:08:06] Wrote 0 features to ref.gff
[11:08:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:08:07] This is snippy 4.4.3
[11:08:07] Written by Torsten Seemann
[11:08:07] Obtained from https://github.com/tseemann/snippy
[11:08:07] Detected operating system: linux
[11:08:07] Enabling bundled linux tools.
[11:08:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:07] Found gzip - /usr/bin/gzip
[11:08:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.947 sec; CPU: 23.015 sec
[samclip] Total SAM records 386153, removed 1352, allowed 154, passed 384801
[samclip] Header contained 5 lines
[samclip] Done.
[11:08:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:07] Treating reference as 'fasta' format.
[11:08:07] Will use 8 CPU cores.
[11:08:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[11:08:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out
[11:08:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out
[11:08:07] Creating reference folder: reference
[11:08:07] Extracting FASTA and GFF from reference.
[11:08:07] Wrote 3 sequences to ref.fa
[11:08:07] Wrote 0 features to ref.gff
[11:08:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:08] Wrote 386116 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:08] Using BAM RG (Read Group) ID: SAL_CB2372AA_AS.out
[11:08:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:08] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:09] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:09] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:09] Running: samtools index snps.bam 2>> snps.log
[11:08:09] Wrote 385784 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:09] Using BAM RG (Read Group) ID: SAL_BB8135AA_AS.out
[11:08:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:09] Wrote 385248 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:09] Using BAM RG (Read Group) ID: SAL_KB1136AA_AS.out
[11:08:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:09] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:10] Wrote 385918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:10] Using BAM RG (Read Group) ID: SAL_BB7027AA_AS.out
[11:08:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:10] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 66116 sequences (16515168 bp)...
[11:08:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:08:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:08:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320026 sequences (80000438 bp)...
[M::process] read 320066 sequences (80000238 bp)...
[M::process] read 65758 sequences (16399466 bp)...
[M::process] read 65182 sequences (16295500 bp)...
[11:08:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[11:08:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::process] read 65918 sequences (16444206 bp)...
[11:08:13] Marked 0 heterozygous sites with 'n'
[11:08:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:13] Creating extra output files: BED GFF CSV TXT HTML
[11:08:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:13] Identified 27 variants.
[11:08:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out
[11:08:13] Result files:
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.aligned.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam.bai
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bed
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.subs.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.csv
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.filt.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.gff
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.html
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.log
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.raw.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.subs.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.tab
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.txt
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz.csi
[11:08:13] Walltime used: 20 seconds
[11:08:13] Wishing you a life free of homopolymer errors.
[11:08:13] Done.
[Fri Jun 19 11:08:13 2020]
Finished job 128.
118 of 201 steps (59%) done

[Fri Jun 19 11:08:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out
    jobid: 82
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB4088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[11:08:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:13] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:13] Marked 1 heterozygous sites with 'n'
[11:08:13] Creating extra output files: BED GFF CSV TXT HTML
[11:08:13] Identified 18 variants.
[11:08:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out
[11:08:13] Result files:
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.aligned.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam.bai
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bed
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.subs.fa
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.csv
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.filt.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.gff
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.html
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.log
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.raw.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.subs.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.tab
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.txt
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz
[11:08:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz.csi
[11:08:13] Walltime used: 20 seconds
[11:08:13] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:08:13] Done.
[11:08:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[Fri Jun 19 11:08:13 2020]
Finished job 97.
119 of 201 steps (59%) done

[Fri Jun 19 11:08:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out
    jobid: 6
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9822AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 18.227 CPU sec, 2.602 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:14] This is snippy 4.4.3
[11:08:14] Written by Torsten Seemann
[11:08:14] Obtained from https://github.com/tseemann/snippy
[11:08:14] Detected operating system: linux
[11:08:14] Enabling bundled linux tools.
[11:08:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[M::mem_process_seqs] Processed 66116 reads in 4.290 CPU sec, 0.499 real sec
[11:08:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[M::mem_process_seqs] Processed 320026 reads in 17.218 CPU sec, 2.459 real sec
[11:08:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:14] Found gzip - /usr/bin/gzip
[11:08:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[11:08:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:14] This is snippy 4.4.3
[11:08:14] Written by Torsten Seemann
[11:08:14] Obtained from https://github.com/tseemann/snippy
[11:08:14] Detected operating system: linux
[11:08:14] Enabling bundled linux tools.
[11:08:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:14] Found gzip - /usr/bin/gzip
[11:08:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:14] Treating reference as 'fasta' format.
[11:08:14] Will use 8 CPU cores.
[11:08:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[11:08:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out
[11:08:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out
[11:08:14] Creating reference folder: reference
[11:08:14] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[11:08:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[11:08:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:14] Wrote 3 sequences to ref.fa
[11:08:14] Wrote 0 features to ref.gff
[11:08:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320066 reads in 19.153 CPU sec, 2.810 real sec
[11:08:14] Treating reference as 'fasta' format.
[11:08:14] Will use 8 CPU cores.
[11:08:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[11:08:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out
[11:08:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out
[11:08:14] Creating reference folder: reference
[11:08:14] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 65758 reads in 4.022 CPU sec, 0.462 real sec
[samclip] Processed 200000 records...
[11:08:14] Wrote 3 sequences to ref.fa
[11:08:14] Wrote 0 features to ref.gff
[11:08:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.038 sec; CPU: 23.084 sec
[samclip] Total SAM records 386460, removed 948, allowed 111, passed 385512
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 65182 reads in 4.148 CPU sec, 0.482 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.866 sec; CPU: 21.817 sec
[samclip] Total SAM records 386016, removed 651, allowed 69, passed 385365
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.241 CPU sec, 2.630 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.206 sec; CPU: 23.864 sec
[samclip] Total SAM records 385591, removed 1562, allowed 190, passed 384029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 65918 reads in 3.830 CPU sec, 0.449 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.013 sec; CPU: 21.622 sec
[samclip] Total SAM records 386160, removed 736, allowed 68, passed 385424
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:16] Running: samtools index snps.bam 2>> snps.log
[11:08:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:17] Running: samtools index snps.bam 2>> snps.log
[11:08:17] Wrote 385496 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:17] Using BAM RG (Read Group) ID: SAL_EB4088AA_AS.out
[11:08:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:17] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:17] Wrote 386426 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:17] Using BAM RG (Read Group) ID: SAL_CB9822AA_AS.out
[11:08:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:17] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:17] Running: samtools index snps.bam 2>> snps.log
[11:08:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:17] Marked 1 heterozygous sites with 'n'
[11:08:17] Creating extra output files: BED GFF CSV TXT HTML
[11:08:17] Identified 1811 variants.
[11:08:17] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out
[11:08:17] Result files:
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.aligned.fa
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam.bai
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bed
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.fa
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.subs.fa
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.csv
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.filt.vcf
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.gff
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.html
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.log
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.raw.vcf
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.subs.vcf
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.tab
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.txt
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz
[11:08:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz.csi
[11:08:17] Walltime used: 19 seconds
[11:08:17] May the SNPs be with you.
[11:08:17] Done.
[Fri Jun 19 11:08:17 2020]
Finished job 160.
120 of 201 steps (60%) done

[Fri Jun 19 11:08:17 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out
    jobid: 114
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_UA7988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:18] Running: samtools index snps.bam 2>> snps.log
[11:08:18] This is snippy 4.4.3
[11:08:18] Written by Torsten Seemann
[11:08:18] Obtained from https://github.com/tseemann/snippy
[11:08:18] Detected operating system: linux
[11:08:18] Enabling bundled linux tools.
[11:08:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:18] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:18] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:18] Found gzip - /usr/bin/gzip
[11:08:18] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:18] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:18] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:18] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:18] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:18] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:18] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:18] Treating reference as 'fasta' format.
[11:08:18] Will use 8 CPU cores.
[11:08:18] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
[11:08:18] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out
[11:08:18] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out
[11:08:18] Creating reference folder: reference
[11:08:18] Extracting FASTA and GFF from reference.
[11:08:18] Wrote 3 sequences to ref.fa
[11:08:18] Wrote 0 features to ref.gff
[11:08:18] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta into pseudo-reads
[11:08:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320118 sequences (80000430 bp)...
[M::process] read 65496 sequences (16331678 bp)...
[11:08:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 66308 sequences (16564590 bp)...
[11:08:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1912
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:21] Wrote 389786 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:21] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:21] Using BAM RG (Read Group) ID: SAL_UA7988AA_AS.out
[11:08:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:21] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:22] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 17.806 CPU sec, 2.521 real sec
[M::mem_process_seqs] Processed 320118 reads in 17.390 CPU sec, 2.635 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65496 reads in 4.007 CPU sec, 0.462 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 66308 reads in 4.342 CPU sec, 0.499 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.933 sec; CPU: 22.397 sec
[samclip] Total SAM records 385770, removed 766, allowed 52, passed 385004
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.031 sec; CPU: 22.287 sec
[samclip] Total SAM records 386705, removed 879, allowed 74, passed 385826
[samclip] Header contained 5 lines
[samclip] Done.
[11:08:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:23] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320082 sequences (80000088 bp)...
[M::process] read 69704 sequences (17426000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:24] Marked 1 heterozygous sites with 'n'
[11:08:24] Creating extra output files: BED GFF CSV TXT HTML
[11:08:24] Identified 16 variants.
[11:08:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out
[11:08:24] Result files:
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.aligned.fa
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam.bai
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bed
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.fa
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.subs.fa
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.csv
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.filt.vcf
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.gff
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.html
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.log
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.raw.vcf
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.subs.vcf
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.tab
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.txt
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz
[11:08:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz.csi
[11:08:24] Walltime used: 19 seconds
[11:08:24] May the SNPs be with you.
[11:08:24] Done.
[Fri Jun 19 11:08:24 2020]
Finished job 175.
121 of 201 steps (60%) done

[Fri Jun 19 11:08:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out
    jobid: 126
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
[11:08:25] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:25] Creating extra output files: BED GFF CSV TXT HTML
[11:08:25] Identified 22 variants.
[11:08:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out
[11:08:25] Result files:
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.aligned.fa
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam.bai
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bed
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.fa
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.subs.fa
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.csv
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.filt.vcf
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.gff
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.html
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.log
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.raw.vcf
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.subs.vcf
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.tab
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.txt
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz
[11:08:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz.csi
[11:08:25] Walltime used: 19 seconds
[11:08:25] May the SNPs be with you.
[11:08:25] Done.
[Fri Jun 19 11:08:25 2020]
Finished job 189.
122 of 201 steps (61%) done

[Fri Jun 19 11:08:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out
    jobid: 166
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA2453AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[11:08:25] Running: samtools index snps.bam 2>> snps.log
[11:08:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:25] This is snippy 4.4.3
[11:08:25] Written by Torsten Seemann
[11:08:25] Obtained from https://github.com/tseemann/snippy
[11:08:25] Detected operating system: linux
[11:08:25] Enabling bundled linux tools.
[11:08:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:25] Running: samtools index snps.bam 2>> snps.log
[11:08:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:25] Found gzip - /usr/bin/gzip
[11:08:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:25] Treating reference as 'fasta' format.
[11:08:25] Will use 8 CPU cores.
[11:08:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
[11:08:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out
[11:08:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out
[11:08:25] Creating reference folder: reference
[11:08:25] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:25] Wrote 3 sequences to ref.fa
[11:08:25] Wrote 0 features to ref.gff
[11:08:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta into pseudo-reads
[11:08:25] Marked 0 heterozygous sites with 'n'
[11:08:26] Creating extra output files: BED GFF CSV TXT HTML
[11:08:26] This is snippy 4.4.3
[11:08:26] Written by Torsten Seemann
[11:08:26] Obtained from https://github.com/tseemann/snippy
[11:08:26] Detected operating system: linux
[11:08:26] Enabling bundled linux tools.
[11:08:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:26] Identified 1912 variants.
[11:08:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out
[11:08:26] Result files:
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.aligned.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam.bai
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bed
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.subs.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.csv
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.filt.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.gff
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.html
[11:08:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.log
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.raw.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.subs.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.tab
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.txt
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz.csi
[11:08:26] Walltime used: 20 seconds
[11:08:26] Wishing you a life free of homopolymer errors.
[11:08:26] Done.
[11:08:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[Fri Jun 19 11:08:26 2020]
Finished job 12.
123 of 201 steps (61%) done

[Fri Jun 19 11:08:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out
    jobid: 59
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_DB1444AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[11:08:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:26] Found gzip - /usr/bin/gzip
[11:08:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:26] Marked 0 heterozygous sites with 'n'
[11:08:26] Creating extra output files: BED GFF CSV TXT HTML
[11:08:26] Identified 22 variants.
[11:08:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out
[11:08:26] Result files:
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.aligned.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam.bai
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bed
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.subs.fa
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.csv
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.filt.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.gff
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.html
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.log
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.raw.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.subs.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.tab
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.txt
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz
[11:08:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz.csi
[11:08:26] Walltime used: 19 seconds
[11:08:26] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:08:26] Done.
[11:08:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[Fri Jun 19 11:08:26 2020]
Finished job 162.
124 of 201 steps (62%) done

[Fri Jun 19 11:08:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out
    jobid: 109
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB9523AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[11:08:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:26] Treating reference as 'fasta' format.
[11:08:26] Will use 8 CPU cores.
[11:08:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[11:08:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out
[11:08:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out
[11:08:26] Creating reference folder: reference
[11:08:26] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320082 reads in 18.433 CPU sec, 2.532 real sec
[11:08:26] Wrote 3 sequences to ref.fa
[11:08:26] Wrote 0 features to ref.gff
[11:08:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:26] This is snippy 4.4.3
[11:08:26] Written by Torsten Seemann
[11:08:26] Obtained from https://github.com/tseemann/snippy
[11:08:26] Detected operating system: linux
[11:08:26] Enabling bundled linux tools.
[11:08:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:26] Found gzip - /usr/bin/gzip
[11:08:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 69704 reads in 4.450 CPU sec, 0.520 real sec
[11:08:26] This is snippy 4.4.3
[11:08:26] Written by Torsten Seemann
[11:08:26] Obtained from https://github.com/tseemann/snippy
[11:08:26] Detected operating system: linux
[11:08:26] Enabling bundled linux tools.
[11:08:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[samclip] Processed 200000 records...
[11:08:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:27] Found gzip - /usr/bin/gzip
[11:08:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:27] Treating reference as 'fasta' format.
[11:08:27] Will use 8 CPU cores.
[11:08:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[11:08:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out
[11:08:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out
[11:08:27] Creating reference folder: reference
[11:08:27] Extracting FASTA and GFF from reference.
[11:08:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:27] Wrote 3 sequences to ref.fa
[11:08:27] Wrote 0 features to ref.gff
[11:08:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta into pseudo-reads
[11:08:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:27] Treating reference as 'fasta' format.
[11:08:27] Will use 8 CPU cores.
[11:08:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[11:08:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out
[11:08:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out
[11:08:27] Creating reference folder: reference
[11:08:27] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[11:08:27] Wrote 3 sequences to ref.fa
[11:08:27] Wrote 0 features to ref.gff
[11:08:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem[samclip] Total SAM records 389973, removed 1419, allowed 239, passed 388554
 -Y -M[samclip] Header contained 5 lines
 -R[samclip] Done.
 @RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.946 sec; CPU: 23.432 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:28] Wrote 384936 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:28] Using BAM RG (Read Group) ID: SAL_CB9988AA_AS.out
[11:08:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:29] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:29] Wrote 388114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:29] Using BAM RG (Read Group) ID: SAL_SA2453AA_AS.out
[11:08:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:29] Running: samtools index snps.bam 2>> snps.log
[11:08:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:29] Wrote 384592 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:29] Using BAM RG (Read Group) ID: SAL_DB1444AA_AS.out
[11:08:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:30] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:30] Wrote 384522 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:30] Using BAM RG (Read Group) ID: SAL_KB9523AA_AS.out
[11:08:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:30] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[11:08:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 64936 sequences (16193398 bp)...
[11:08:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320138 sequences (80000116 bp)...
[M::process] read 67976 sequences (16989752 bp)...
[11:08:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:08:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:08:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000246 bp)...
[M::process] read 320054 sequences (80000440 bp)...
[M::process] read 64468 sequences (16115374 bp)...
[M::process] read 64548 sequences (16137000 bp)...
[11:08:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:33] Marked 0 heterozygous sites with 'n'
[11:08:33] Marked 0 heterozygous sites with 'n'

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1791
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:33] Creating extra output files: BED GFF CSV TXT HTML
[11:08:33] Identified 20 variants.
[11:08:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out
[11:08:33] Result files:
[11:08:33] Creating extra output files: BED GFF CSV TXT HTML
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.aligned.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam.bai
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bed
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.subs.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.csv
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.filt.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.gff
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.html
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.log
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.raw.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.subs.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.tab
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.txt
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz.csi
[11:08:33] Walltime used: 19 seconds
[11:08:33] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:08:33] Done.
[11:08:33] Identified 17 variants.
[11:08:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out
[11:08:33] Result files:
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.aligned.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam.bai
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bed
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.subs.fa
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.csv
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.filt.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.gff
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.html
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.log
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.raw.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.subs.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.tab
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.txt
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz
[11:08:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz.csi
[11:08:33] Walltime used: 19 seconds
[11:08:33] Wishing you a life free of homopolymer errors.
[11:08:33] Done.
[Fri Jun 19 11:08:33 2020]
Finished job 82.
125 of 201 steps (62%) done
[Fri Jun 19 11:08:33 2020]
Finished job 6.
126 of 201 steps (63%) done

[Fri Jun 19 11:08:33 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out
    jobid: 32
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB5876AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta

[Fri Jun 19 11:08:33 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out
    jobid: 18
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB6687AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[11:08:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.927 CPU sec, 2.738 real sec
[11:08:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:33] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[11:08:34] This is snippy 4.4.3
[11:08:34] Written by Torsten Seemann
[11:08:34] Obtained from https://github.com/tseemann/snippy
[11:08:34] Detected operating system: linux
[11:08:34] Enabling bundled linux tools.
[11:08:34] This is snippy 4.4.3
[11:08:34] Written by Torsten Seemann
[11:08:34] Obtained from https://github.com/tseemann/snippy
[11:08:34] Detected operating system: linux
[11:08:34] Enabling bundled linux tools.
[11:08:34] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:34] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:34] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:34] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:34] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:34] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:34] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:34] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:34] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:34] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:34] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:34] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:34] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:34] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:34] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:34] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:34] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:34] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:34] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:34] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:34] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:34] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:34] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:34] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:34] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:34] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:34] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:34] Found gzip - /usr/bin/gzip
[11:08:34] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:34] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:34] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:34] Found gzip - /usr/bin/gzip
[11:08:34] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:34] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:34] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:34] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::mem_process_seqs] Processed 64936 reads in 3.939 CPU sec, 0.461 real sec
[11:08:34] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:34] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:34] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:34] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320138 reads in 19.387 CPU sec, 2.883 real sec
[11:08:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:34] Treating reference as 'fasta' format.
[11:08:34] Will use 8 CPU cores.
[11:08:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
[11:08:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out
[11:08:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out
[11:08:34] Creating reference folder: reference
[11:08:34] Treating reference as 'fasta' format.
[11:08:34] Will use 8 CPU cores.
[11:08:34] Extracting FASTA and GFF from reference.
[11:08:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[11:08:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out
[11:08:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out
[11:08:34] Creating reference folder: reference
[11:08:34] Extracting FASTA and GFF from reference.
[11:08:34] Wrote 3 sequences to ref.fa
[11:08:34] Wrote 0 features to ref.gff
[11:08:34] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[11:08:34] Wrote 3 sequences to ref.fa
[11:08:34] Wrote 0 features to ref.gff
[11:08:34] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.159 sec; CPU: 22.453 sec
[samclip] Total SAM records 385174, removed 953, allowed 138, passed 384221
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 67976 reads in 4.268 CPU sec, 0.493 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320054 reads in 17.757 CPU sec, 2.542 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320044 reads in 18.852 CPU sec, 2.868 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.287 sec; CPU: 24.211 sec
[samclip] Total SAM records 388314, removed 1268, allowed 208, passed 387046
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 64468 reads in 4.071 CPU sec, 0.484 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64548 reads in 3.784 CPU sec, 0.453 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.964 sec; CPU: 22.406 sec
[samclip] Total SAM records 384620, removed 583, allowed 44, passed 384037
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.263 sec; CPU: 23.214 sec
[samclip] Total SAM records 384693, removed 741, allowed 49, passed 383952
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:36] Running: samtools index snps.bam 2>> snps.log
[11:08:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:37] Wrote 384322 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:37] Running: samtools index snps.bam 2>> snps.log
[11:08:37] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:37] Using BAM RG (Read Group) ID: SAL_BB6687AA_AS.out
[11:08:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:37] Wrote 385642 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:37] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:37] Using BAM RG (Read Group) ID: SAL_EB5876AA_AS.out
[11:08:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:37] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:37] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:37] Running: samtools index snps.bam 2>> snps.log
[11:08:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:38] Marked 0 heterozygous sites with 'n'
[11:08:38] Creating extra output files: BED GFF CSV TXT HTML
[11:08:38] Identified 1791 variants.
[11:08:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out
[11:08:38] Result files:
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.aligned.fa
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam.bai
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bed
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.fa
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.subs.fa
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.csv
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.filt.vcf
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.gff
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.html
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.log
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.raw.vcf
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.subs.vcf
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.tab
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.txt
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz
[11:08:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz.csi
[11:08:38] Walltime used: 20 seconds
[11:08:38] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:08:38] Done.
[Fri Jun 19 11:08:38 2020]
Finished job 114.
127 of 201 steps (63%) done

[Fri Jun 19 11:08:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out
    jobid: 91
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_UA7989AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[11:08:38] Running: samtools index snps.bam 2>> snps.log
[11:08:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:38] This is snippy 4.4.3
[11:08:38] Written by Torsten Seemann
[11:08:38] Obtained from https://github.com/tseemann/snippy
[11:08:38] Detected operating system: linux
[11:08:38] Enabling bundled linux tools.
[11:08:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:38] Found gzip - /usr/bin/gzip
[11:08:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:39] Treating reference as 'fasta' format.
[11:08:39] Will use 8 CPU cores.
[11:08:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[11:08:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out
[11:08:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out
[11:08:39] Creating reference folder: reference
[11:08:39] Extracting FASTA and GFF from reference.
[11:08:39] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:39] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:39] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:39] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:39] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:39] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:39] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:39] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:39] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:08:39] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:39] Wrote 3 sequences to ref.fa
[11:08:39] Wrote 0 features to ref.gff
[11:08:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta into pseudo-reads
[M::process] read 320202 sequences (80000426 bp)...
[M::process] read 320010 sequences (80000096 bp)...
[M::process] read 65632 sequences (16408000 bp)...
[11:08:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 516
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 64120 sequences (16030000 bp)...
[11:08:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 10
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 142
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 137
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320010 reads in 18.641 CPU sec, 2.566 real sec
[M::mem_process_seqs] Processed 320202 reads in 18.017 CPU sec, 2.815 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65632 reads in 4.253 CPU sec, 0.489 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 64120 reads in 3.838 CPU sec, 0.440 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.943 sec; CPU: 23.444 sec
[samclip] Total SAM records 385979, removed 1409, allowed 205, passed 384570
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.206 sec; CPU: 22.425 sec
[samclip] Total SAM records 384473, removed 460, allowed 55, passed 384013
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:43] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:43] Using BAM RG (Read Group) ID: SAL_UA7989AA_AS.out
[11:08:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:43] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:44] Marked 0 heterozygous sites with 'n'
[11:08:45] Running: samtools index snps.bam 2>> snps.log
[11:08:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:45] Marked 0 heterozygous sites with 'n'
[11:08:45] Creating extra output files: BED GFF CSV TXT HTML
[11:08:45] Identified 516 variants.
[11:08:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out
[11:08:45] Result files:
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.aligned.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam.bai
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bed
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.subs.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.csv
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.filt.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.gff
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.html
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.log
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.raw.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.subs.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.tab
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.txt
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz.csi
[11:08:45] Walltime used: 20 seconds
[11:08:45] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:08:45] Done.
[11:08:45] Creating extra output files: BED GFF CSV TXT HTML
[11:08:45] Identified 1811 variants.
[11:08:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out
[11:08:45] Result files:
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.aligned.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam.bai
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bed
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.subs.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.csv
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.filt.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.gff
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.html
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.log
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.raw.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.subs.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.tab
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.txt
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz.csi
[11:08:45] Walltime used: 19 seconds
[11:08:45] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:08:45] Done.
[Fri Jun 19 11:08:45 2020]
Finished job 126.
128 of 201 steps (64%) done

[Fri Jun 19 11:08:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out
    jobid: 79
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB4083AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
[Fri Jun 19 11:08:45 2020]
Finished job 166.
129 of 201 steps (64%) done

[Fri Jun 19 11:08:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out
    jobid: 194
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_MA3067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[11:08:45] Marked 8 heterozygous sites with 'n'
[11:08:45] Creating extra output files: BED GFF CSV TXT HTML
[11:08:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:45] Identified 142 variants.
[11:08:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out
[11:08:45] Result files:
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.aligned.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam.bai
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bed
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.subs.fa
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.csv
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.filt.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.gff
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.html
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.log
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.raw.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.subs.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.tab
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.txt
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz
[11:08:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz.csi
[11:08:45] Walltime used: 19 seconds
[11:08:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:08:45] Done.
[Fri Jun 19 11:08:45 2020]
Finished job 109.
130 of 201 steps (65%) done
[11:08:45] Running: ln -sf reference/ref.fa . 2>> snps.log

[Fri Jun 19 11:08:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out
    jobid: 93
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB3497AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[11:08:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:45] Marked 26 heterozygous sites with 'n'
[11:08:46] Creating extra output files: BED GFF CSV TXT HTML
[11:08:46] Identified 137 variants.
[11:08:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out
[11:08:46] Result files:
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.aligned.fa
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam.bai
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bed
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.fa
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.subs.fa
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.csv
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.filt.vcf
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.gff
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.html
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.log
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.raw.vcf
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.subs.vcf
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.tab
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.txt
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz
[11:08:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz.csi
[11:08:46] Walltime used: 20 seconds
[11:08:46] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:08:46] Done.
[Fri Jun 19 11:08:46 2020]
Finished job 59.
131 of 201 steps (65%) done

[Fri Jun 19 11:08:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out
    jobid: 11
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB0088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320094 sequences (80000282 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 70088 sequences (17520596 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:46] This is snippy 4.4.3
[11:08:46] Written by Torsten Seemann
[11:08:46] Obtained from https://github.com/tseemann/snippy
[11:08:46] Detected operating system: linux
[11:08:46] Enabling bundled linux tools.
[11:08:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:46] This is snippy 4.4.3
[11:08:46] Written by Torsten Seemann
[11:08:46] Obtained from https://github.com/tseemann/snippy
[11:08:46] Detected operating system: linux
[11:08:46] Enabling bundled linux tools.
[11:08:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:46] Found gzip - /usr/bin/gzip
[11:08:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:46] Found gzip - /usr/bin/gzip
[11:08:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:46] This is snippy 4.4.3
[11:08:46] Written by Torsten Seemann
[11:08:46] Obtained from https://github.com/tseemann/snippy
[11:08:46] Detected operating system: linux
[11:08:46] Enabling bundled linux tools.
[11:08:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:46] Found gzip - /usr/bin/gzip
[11:08:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:46] Running: samtools index snps.bam 2>> snps.log
[11:08:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:46] Treating reference as 'fasta' format.
[11:08:46] Will use 8 CPU cores.
[11:08:46] Treating reference as 'fasta' format.
[11:08:46] Will use 8 CPU cores.
[11:08:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
[11:08:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out
[11:08:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[11:08:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out
[11:08:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out
[11:08:46] Creating reference folder: reference
[11:08:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out
[11:08:46] Creating reference folder: reference
[11:08:46] Extracting FASTA and GFF from reference.
[11:08:46] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:46] Treating reference as 'fasta' format.
[11:08:46] Will use 8 CPU cores.
[11:08:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[11:08:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out
[11:08:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out
[11:08:46] Creating reference folder: reference
[11:08:46] Extracting FASTA and GFF from reference.
[11:08:46] Wrote 3 sequences to ref.fa
[11:08:46] Wrote 0 features to ref.gff
[11:08:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta into pseudo-reads
[11:08:46] Wrote 3 sequences to ref.fa
[11:08:46] Wrote 0 features to ref.gff
[11:08:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta into pseudo-reads
[11:08:46] This is snippy 4.4.3
[11:08:46] Written by Torsten Seemann
[11:08:46] Obtained from https://github.com/tseemann/snippy
[11:08:46] Detected operating system: linux
[11:08:46] Enabling bundled linux tools.
[11:08:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:46] Found gzip - /usr/bin/gzip
[11:08:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:46] Wrote 3 sequences to ref.fa
[11:08:46] Wrote 0 features to ref.gff
[11:08:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta into pseudo-reads
[11:08:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:46] Treating reference as 'fasta' format.
[11:08:46] Will use 8 CPU cores.
[11:08:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
[11:08:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out
[11:08:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out
[11:08:46] Creating reference folder: reference
[11:08:46] Extracting FASTA and GFF from reference.
[11:08:47] Wrote 3 sequences to ref.fa
[11:08:47] Wrote 0 features to ref.gff
[11:08:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta into pseudo-reads
[11:08:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1930
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320094 reads in 19.887 CPU sec, 2.673 real sec
[11:08:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:08:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 70088 reads in 4.148 CPU sec, 0.481 real sec
[samclip] Processed 200000 records...
[11:08:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] Processed 300000 records...
[11:08:49] Wrote 384666 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:49] Using BAM RG (Read Group) ID: SAL_EB4083AA_AS.out
[11:08:49] Wrote 388222 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:49] Using BAM RG (Read Group) ID: SAL_MA3067AA_AS.out
[11:08:49] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:08:49] Wrote 385416 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:49] Using BAM RG (Read Group) ID: SAL_CB3497AA_AS.out
[11:08:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:49] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.150 sec; CPU: 24.614 sec
[samclip] Total SAM records 390362, removed 1702, allowed 252, passed 388660
[samclip] Header contained 5 lines
[samclip] Done.
[11:08:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:49] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:49] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:08:50] Wrote 384750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:50] Using BAM RG (Read Group) ID: SAL_CB0088AA_AS.out
[11:08:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:50] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:08:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:08:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:08:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:50] Running: rm -f fake_reads\.fq 2>> snps.log
[11:08:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:08:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:08:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:08:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:08:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:08:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:08:51] Running: samtools index snps.bam 2>> snps.log
[11:08:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:08:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 64666 sequences (16094524 bp)...
[M::process] read 320024 sequences (80000480 bp)...
[M::process] read 320154 sequences (80000190 bp)...
[M::process] read 320126 sequences (80000090 bp)...
[M::process] read 64726 sequences (16096746 bp)...
[M::process] read 68096 sequences (17012204 bp)...
[M::process] read 65262 sequences (16282550 bp)...
[M::mem_process_seqs] Processed 320000 reads in 16.309 CPU sec, 2.203 real sec
[11:08:54] Marked 0 heterozygous sites with 'n'
[11:08:54] Creating extra output files: BED GFF CSV TXT HTML
[11:08:54] Identified 1930 variants.
[11:08:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out
[11:08:54] Result files:
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.aligned.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam.bai
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bed
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.subs.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.csv
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.filt.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.gff
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.html
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.log
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.raw.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.subs.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.tab
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.txt
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz.csi
[11:08:54] Walltime used: 20 seconds
[11:08:54] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:08:54] Done.
[Fri Jun 19 11:08:54 2020]
Finished job 32.
132 of 201 steps (66%) done

[Fri Jun 19 11:08:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out
    jobid: 188
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_IA5065AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
[11:08:54] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[11:08:54] Creating extra output files: BED GFF CSV TXT HTML
[11:08:54] Identified 98 variants.
[11:08:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out
[11:08:54] Result files:
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.aligned.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam.bai
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bed
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.subs.fa
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.csv
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.filt.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.gff
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.html
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.log
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.raw.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.subs.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.tab
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.txt
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz
[11:08:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz.csi
[11:08:54] Walltime used: 20 seconds
[11:08:54] May the SNPs be with you.
[11:08:54] Done.
[Fri Jun 19 11:08:54 2020]
Finished job 18.
133 of 201 steps (66%) done

[Fri Jun 19 11:08:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out
    jobid: 19
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BA7945AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[M::mem_process_seqs] Processed 64666 reads in 3.827 CPU sec, 0.463 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:08:55] This is snippy 4.4.3
[11:08:55] Written by Torsten Seemann
[11:08:55] Obtained from https://github.com/tseemann/snippy
[11:08:55] Detected operating system: linux
[11:08:55] Enabling bundled linux tools.
[11:08:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::mem_process_seqs] Processed 320024 reads in 17.464 CPU sec, 3.010 real sec
[11:08:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:08:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:55] Found gzip - /usr/bin/gzip
[11:08:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:08:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:08:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:08:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1804
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:08:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:08:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:08:55] This is snippy 4.4.3
[11:08:55] Written by Torsten Seemann
[11:08:55] Obtained from https://github.com/tseemann/snippy
[11:08:55] Detected operating system: linux
[11:08:55] Enabling bundled linux tools.
[11:08:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:08:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:08:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:08:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:08:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:08:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:08:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.692 sec; CPU: 20.710 sec
[samclip] Total SAM records 384812, removed 583, allowed 99, passed 384229
[samclip] Header contained 5 lines
[samclip] Done.
[11:08:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:08:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:08:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:08:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:08:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:08:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:08:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:08:55] Found gzip - /usr/bin/gzip
[11:08:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:08:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:08:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:08:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:08:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:08:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:55] Treating reference as 'fasta' format.
[11:08:55] Will use 8 CPU cores.
[11:08:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
[11:08:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out
[11:08:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out
[11:08:55] Creating reference folder: reference
[11:08:55] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[11:08:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:08:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:08:55] Wrote 3 sequences to ref.fa
[11:08:55] Wrote 0 features to ref.gff
[11:08:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta into pseudo-reads
[11:08:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:08:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:08:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:08:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:08:55] Treating reference as 'fasta' format.
[11:08:55] Will use 8 CPU cores.
[11:08:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[11:08:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out
[11:08:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out
[11:08:55] Creating reference folder: reference
[11:08:55] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320126 reads in 17.623 CPU sec, 3.424 real sec
[11:08:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:08:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 64726 reads in 3.980 CPU sec, 0.470 real sec
[11:08:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:08:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:08:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320154 reads in 17.442 CPU sec, 3.591 real sec
[11:08:55] Wrote 3 sequences to ref.fa
[11:08:55] Wrote 0 features to ref.gff
[11:08:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta into pseudo-reads
[11:08:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:08:55] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[11:08:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 68096 reads in 4.203 CPU sec, 0.490 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.451 sec; CPU: 22.037 sec
[samclip] Total SAM records 385165, removed 942, allowed 100, passed 384223
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 65262 reads in 4.225 CPU sec, 0.490 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.825 sec; CPU: 22.377 sec
[samclip] Total SAM records 388325, removed 994, allowed 107, passed 387331
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 385748, removed 1012, allowed 128, passed 384736
 bwa mem -Y[samclip] Header contained 5 lines
 -M[samclip] Done.
 -R @RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.021 sec; CPU: 22.238 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:57] Running: samtools index snps.bam 2>> snps.log
[11:08:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:08:58] Running: samtools index snps.bam 2>> snps.log
[11:08:58] Wrote 389202 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:58] Using BAM RG (Read Group) ID: SAL_IA5065AA_AS.out
[11:08:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:58] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:58] Wrote 387992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:08:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:08:58] Using BAM RG (Read Group) ID: SAL_BA7945AA_AS.out
[11:08:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:08:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:58] Running: bwa index reference/ref.fa 2>> snps.log
[11:08:58] Running: samtools index snps.bam 2>> snps.log
[11:08:58] Running: samtools index snps.bam 2>> snps.log
[11:08:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:08:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:08:59] Marked 0 heterozygous sites with 'n'
[11:09:00] Creating extra output files: BED GFF CSV TXT HTML
[11:09:00] Identified 1804 variants.
[11:09:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out
[11:09:00] Result files:
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.aligned.fa
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam.bai
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bed
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.fa
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.subs.fa
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.csv
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.filt.vcf
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.gff
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.html
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.log
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.raw.vcf
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.subs.vcf
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.tab
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.txt
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz
[11:09:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz.csi
[11:09:00] Walltime used: 22 seconds
[11:09:00] Questionable SNP? Try the --report option to see the alignments.
[11:09:00] Done.
[Fri Jun 19 11:09:00 2020]
Finished job 91.
134 of 201 steps (67%) done

[Fri Jun 19 11:09:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out
    jobid: 89
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB3127AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[11:09:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 103
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320056 sequences (80000148 bp)...
[11:09:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:00] This is snippy 4.4.3
[11:09:00] Written by Torsten Seemann
[11:09:00] Obtained from https://github.com/tseemann/snippy
[11:09:00] Detected operating system: linux
[11:09:00] Enabling bundled linux tools.
[11:09:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[M::process] read 67936 sequences (16980480 bp)...
[11:09:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:00] Found gzip - /usr/bin/gzip
[11:09:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320126 sequences (80000184 bp)...
[11:09:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:01] Treating reference as 'fasta' format.
[11:09:01] Will use 8 CPU cores.
[11:09:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[11:09:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out
[11:09:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out
[11:09:01] Creating reference folder: reference
[11:09:01] Extracting FASTA and GFF from reference.
[11:09:01] Wrote 3 sequences to ref.fa
[11:09:01] Wrote 0 features to ref.gff
[11:09:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta into pseudo-reads
[M::process] read 69076 sequences (17261518 bp)...
[11:09:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 374
       total no. reference observed             : 0

Time elapsed: 0.00s

normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 74
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:02] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:02] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320056 reads in 19.366 CPU sec, 2.698 real sec
[M::mem_process_seqs] Processed 320126 reads in 18.795 CPU sec, 2.672 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67936 reads in 4.354 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[11:09:04] Wrote 384102 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:04] Using BAM RG (Read Group) ID: SAL_BB3127AA_AS.out
[11:09:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:04] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69076 reads in 4.781 CPU sec, 0.553 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.217 sec; CPU: 24.314 sec
[samclip] Total SAM records 388364, removed 1774, allowed 267, passed 386590
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.072 sec; CPU: 24.114 sec
[samclip] Total SAM records 389418, removed 1376, allowed 263, passed 388042
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:05] Marked 1 heterozygous sites with 'n'
[11:09:05] Creating extra output files: BED GFF CSV TXT HTML
[11:09:05] Identified 103 variants.
[11:09:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out
[11:09:05] Result files:
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.aligned.fa
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam.bai
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bed
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.fa
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.subs.fa
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.csv
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.filt.vcf
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.gff
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.html
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.log
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.raw.vcf
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.subs.vcf
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.tab
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.txt
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz
[11:09:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz.csi
[11:09:05] Walltime used: 19 seconds
[11:09:05] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:05] Done.
[Fri Jun 19 11:09:05 2020]
Finished job 79.
135 of 201 steps (67%) done

[Fri Jun 19 11:09:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out
    jobid: 63
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB3375AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:05] This is snippy 4.4.3
[11:09:05] Written by Torsten Seemann
[11:09:05] Obtained from https://github.com/tseemann/snippy
[11:09:05] Detected operating system: linux
[11:09:05] Enabling bundled linux tools.
[11:09:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:09:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:05] Found gzip - /usr/bin/gzip
[11:09:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:05] Marked 0 heterozygous sites with 'n'
[11:09:06] Creating extra output files: BED GFF CSV TXT HTML
[11:09:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:06] Identified 26 variants.
[11:09:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out
[11:09:06] Result files:
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.aligned.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam.bai
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bed
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.subs.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.csv
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.filt.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.gff
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.html
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.log
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.raw.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.subs.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.tab
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.txt
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz.csi
[11:09:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:06] Walltime used: 20 seconds
[11:09:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:06] Wishing you a life free of homopolymer errors.
[11:09:06] Done.
[11:09:06] Treating reference as 'fasta' format.
[11:09:06] Will use 8 CPU cores.
[11:09:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
[11:09:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out
[11:09:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out
[11:09:06] Creating reference folder: reference
[11:09:06] Extracting FASTA and GFF from reference.
[Fri Jun 19 11:09:06 2020]
Finished job 11.
136 of 201 steps (68%) done

[Fri Jun 19 11:09:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out
    jobid: 104
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB6210AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[M::process] read 320118 sequences (80000104 bp)...
[11:09:06] Wrote 3 sequences to ref.fa
[11:09:06] Wrote 0 features to ref.gff
[11:09:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta into pseudo-reads
[M::process] read 63984 sequences (15961616 bp)...
[11:09:06] Marked 0 heterozygous sites with 'n'
[11:09:06] Marked 0 heterozygous sites with 'n'
[11:09:06] Creating extra output files: BED GFF CSV TXT HTML
[11:09:06] Creating extra output files: BED GFF CSV TXT HTML
[11:09:06] Identified 374 variants.
[11:09:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out
[11:09:06] Result files:
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.aligned.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam.bai
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bed
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.subs.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.csv
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.filt.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.gff
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.html
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.log
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.raw.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.subs.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.tab
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.txt
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz.csi
[11:09:06] Walltime used: 20 seconds
[11:09:06] May the SNPs be with you.
[11:09:06] Done.
[11:09:06] Identified 74 variants.
[11:09:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out
[11:09:06] Result files:
[11:09:06] Running: samtools index snps.bam 2>> snps.log
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.aligned.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam.bai
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bed
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.subs.fa
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.csv
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.filt.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.gff
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.html
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.log
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.raw.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.subs.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.tab
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.txt
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz
[11:09:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz.csi
[11:09:06] Walltime used: 20 seconds
[11:09:06] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:06] Done.
[Fri Jun 19 11:09:06 2020]
Finished job 194.
137 of 201 steps (68%) done
[Fri Jun 19 11:09:06 2020]
Finished job 93.
138 of 201 steps (69%) done

[Fri Jun 19 11:09:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out
    jobid: 151
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB9562AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta

[Fri Jun 19 11:09:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out
    jobid: 50
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB2744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:06] Running: samtools index snps.bam 2>> snps.log
[11:09:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:06] This is snippy 4.4.3
[11:09:06] Written by Torsten Seemann
[11:09:06] Obtained from https://github.com/tseemann/snippy
[11:09:06] Detected operating system: linux
[11:09:06] Enabling bundled linux tools.
[11:09:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:06] Found gzip - /usr/bin/gzip
[11:09:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:07] Treating reference as 'fasta' format.
[11:09:07] Will use 8 CPU cores.
[11:09:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[11:09:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out
[11:09:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out
[11:09:07] Creating reference folder: reference
[11:09:07] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:07] Wrote 3 sequences to ref.fa
[11:09:07] Wrote 0 features to ref.gff
[11:09:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta into pseudo-reads
[11:09:07] This is snippy 4.4.3
[11:09:07] Written by Torsten Seemann
[11:09:07] Obtained from https://github.com/tseemann/snippy
[11:09:07] Detected operating system: linux
[11:09:07] Enabling bundled linux tools.
[11:09:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:07] This is snippy 4.4.3
[11:09:07] Written by Torsten Seemann
[11:09:07] Obtained from https://github.com/tseemann/snippy
[11:09:07] Detected operating system: linux
[11:09:07] Enabling bundled linux tools.
[11:09:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:07] Found gzip - /usr/bin/gzip
[11:09:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:07] Found gzip - /usr/bin/gzip
[11:09:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:07] Treating reference as 'fasta' format.
[11:09:07] Will use 8 CPU cores.
[11:09:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
[11:09:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out
[11:09:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out
[11:09:07] Creating reference folder: reference
[11:09:07] Extracting FASTA and GFF from reference.
[11:09:07] Treating reference as 'fasta' format.
[11:09:07] Will use 8 CPU cores.
[11:09:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
[11:09:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out
[11:09:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out
[11:09:07] Creating reference folder: reference
[11:09:07] Extracting FASTA and GFF from reference.
[11:09:07] Wrote 3 sequences to ref.fa
[11:09:07] Wrote 0 features to ref.gff
[11:09:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta into pseudo-reads
[11:09:07] Wrote 3 sequences to ref.fa
[11:09:07] Wrote 0 features to ref.gff
[11:09:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320118 reads in 16.592 CPU sec, 2.192 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63984 reads in 3.740 CPU sec, 0.435 real sec
[samclip] Processed 200000 records...
[11:09:08] Wrote 383716 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:08] Using BAM RG (Read Group) ID: SAL_KB3375AA_AS.out
[11:09:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:08] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.567 sec; CPU: 20.892 sec
[samclip] Total SAM records 384381, removed 794, allowed 64, passed 383587
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:09] Wrote 384278 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:09] Using BAM RG (Read Group) ID: SAL_KB6210AA_AS.out
[11:09:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1897
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:09:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1934
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:09:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:10] Wrote 384058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:10] Using BAM RG (Read Group) ID: SAL_BB9562AA_AS.out
[11:09:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:10] Wrote 384294 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:10] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:10] Using BAM RG (Read Group) ID: SAL_KB2744AA_AS.out
[11:09:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:10] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:10] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:10] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:11] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63716 sequences (15905020 bp)...
[11:09:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320200 sequences (80000492 bp)...
[11:09:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 64078 sequences (16019500 bp)...
[11:09:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320068 sequences (80000456 bp)...
[M::process] read 320012 sequences (80000380 bp)...
[M::process] read 64282 sequences (16022514 bp)...
[M::process] read 63990 sequences (15953704 bp)...
[M::mem_process_seqs] Processed 320000 reads in 18.050 CPU sec, 2.741 real sec
[11:09:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] Processed 100000 records...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 63716 reads in 3.801 CPU sec, 0.458 real sec
[11:09:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[11:09:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:14] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320012 reads in 16.324 CPU sec, 2.250 real sec
[11:09:15] Marked 0 heterozygous sites with 'n'
[11:09:15] Creating extra output files: BED GFF CSV TXT HTML
[11:09:15] Identified 1897 variants.
[11:09:15] Marked 0 heterozygous sites with 'n'
[11:09:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out
[11:09:15] Result files:
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.aligned.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam.bai
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bed
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.subs.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.csv
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.filt.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.gff
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.html
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.log
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.raw.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.subs.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.tab
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.txt
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz.csi
[11:09:15] Walltime used: 20 seconds
[11:09:15] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:09:15] Done.
[Fri Jun 19 11:09:15 2020]
Finished job 19.
139 of 201 steps (69%) done

[Fri Jun 19 11:09:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out
    jobid: 26
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB1956AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.226 sec; CPU: 22.446 sec
[samclip] Total SAM records 384046, removed 1464, allowed 120, passed 382582
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:15] Creating extra output files: BED GFF CSV TXT HTML
[11:09:15] Identified 1934 variants.
[11:09:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out
[11:09:15] Result files:
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.aligned.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam.bai
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bed
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.subs.fa
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.csv
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.filt.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.gff
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.html
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.log
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.raw.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.subs.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.tab
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.txt
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz
[11:09:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz.csi
[11:09:15] Walltime used: 20 seconds
[11:09:15] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:09:15] Done.
[samclip] Processed 100000 records...
[Fri Jun 19 11:09:15 2020]
Finished job 188.
140 of 201 steps (70%) done

[Fri Jun 19 11:09:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out
    jobid: 100
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB4524AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320200 reads in 17.363 CPU sec, 3.115 real sec
[M::mem_process_seqs] Processed 64282 reads in 3.623 CPU sec, 0.440 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64078 reads in 3.282 CPU sec, 0.385 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320068 reads in 17.484 CPU sec, 3.146 real sec
[samclip] Processed 200000 records...
[11:09:16] This is snippy 4.4.3
[11:09:16] Written by Torsten Seemann
[11:09:16] Obtained from https://github.com/tseemann/snippy
[11:09:16] Detected operating system: linux
[11:09:16] Enabling bundled linux tools.
[11:09:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:16] This is snippy 4.4.3
[11:09:16] Written by Torsten Seemann
[11:09:16] Obtained from https://github.com/tseemann/snippy
[11:09:16] Detected operating system: linux
[11:09:16] Enabling bundled linux tools.
[11:09:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:16] Found gzip - /usr/bin/gzip
[11:09:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:16] Found gzip - /usr/bin/gzip
[11:09:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 384504, removed 583, allowed 58, passed 383921
 bwa mem[samclip] Header contained 5 lines
 -Y -M[samclip] Done.
 -R @RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.681 sec; CPU: 20.542 sec
[samclip] Processed 100000 records...
[11:09:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:09:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:16] Treating reference as 'fasta' format.
[11:09:16] Will use 8 CPU cores.
[11:09:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[11:09:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out
[11:09:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out
[11:09:16] Creating reference folder: reference
[11:09:16] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:16] Treating reference as 'fasta' format.
[11:09:16] Will use 8 CPU cores.
[11:09:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[11:09:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out
[11:09:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out
[11:09:16] Creating reference folder: reference
[11:09:16] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 63990 reads in 3.975 CPU sec, 0.457 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y[samclip] Total SAM records 384534, removed 690, allowed 104, passed 383844
 -M -R @RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out[samclip] Header contained 5 lines
 -t 8[samclip] Done.
 reference/ref.fa fake_reads.fq
[main] Real time: 4.519 sec; CPU: 21.239 sec
[11:09:16] Wrote 3 sequences to ref.fa
[11:09:16] Wrote 0 features to ref.gff
[11:09:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta into pseudo-reads
[11:09:16] Wrote 3 sequences to ref.fa
[11:09:16] Wrote 0 features to ref.gff
[11:09:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.534 sec; CPU: 22.026 sec
[samclip] Total SAM records 384273, removed 658, allowed 66, passed 383615
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:17] Running: samtools index snps.bam 2>> snps.log
[11:09:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:18] Running: samtools index snps.bam 2>> snps.log
[11:09:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:18] Running: samtools index snps.bam 2>> snps.log
[11:09:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:18] Running: samtools index snps.bam 2>> snps.log
[11:09:19] Marked 0 heterozygous sites with 'n'
[11:09:19] Creating extra output files: BED GFF CSV TXT HTML
[11:09:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:19] Identified 19 variants.
[11:09:19] Wrote 384132 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out
[11:09:19] Result files:
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.aligned.fa
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam.bai
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bed
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.fa
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.subs.fa
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.csv
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.filt.vcf
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.gff
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.html
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.log
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.raw.vcf
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.subs.vcf
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.tab
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.txt
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz
[11:09:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz.csi
[11:09:19] Walltime used: 19 seconds
[11:09:19] May the SNPs be with you.
[11:09:19] Done.
[11:09:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:19] Using BAM RG (Read Group) ID: SAL_BB1956AA_AS.out
[11:09:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[Fri Jun 19 11:09:19 2020]
Finished job 89.
141 of 201 steps (70%) done

[Fri Jun 19 11:09:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out
    jobid: 144
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FB8051AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[11:09:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:19] Wrote 383942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:19] Using BAM RG (Read Group) ID: SAL_BB4524AA_AS.out
[11:09:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:19] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:19] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:20] This is snippy 4.4.3
[11:09:20] Written by Torsten Seemann
[11:09:20] Obtained from https://github.com/tseemann/snippy
[11:09:20] Detected operating system: linux
[11:09:20] Enabling bundled linux tools.
[11:09:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:20] Found gzip - /usr/bin/gzip
[11:09:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:20] Treating reference as 'fasta' format.
[11:09:20] Will use 8 CPU cores.
[11:09:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[11:09:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out
[11:09:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out
[11:09:20] Creating reference folder: reference
[11:09:20] Extracting FASTA and GFF from reference.
[11:09:20] Wrote 3 sequences to ref.fa
[11:09:20] Wrote 0 features to ref.gff
[11:09:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta into pseudo-reads
[11:09:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 847
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:09:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320012 sequences (80000380 bp)...
[11:09:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[11:09:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 64120 sequences (15987614 bp)...
[11:09:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 63942 sequences (15930326 bp)...
[11:09:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:22] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:23] Wrote 383886 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:23] Using BAM RG (Read Group) ID: SAL_FB8051AA_AS.out
[11:09:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:23] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.800 CPU sec, 2.286 real sec
[M::mem_process_seqs] Processed 320012 reads in 17.251 CPU sec, 2.439 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63942 reads in 3.916 CPU sec, 0.453 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 64120 reads in 3.934 CPU sec, 0.455 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.670 sec; CPU: 21.278 sec
[samclip] Total SAM records 384262, removed 775, allowed 114, passed 383487
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 384529, removed 962, allowed 111, passed 383567
 bwa mem -Y[samclip] Header contained 5 lines
 -M -R[samclip] Done.
 @RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.825 sec; CPU: 21.752 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:25] Marked 0 heterozygous sites with 'n'
[11:09:25] Creating extra output files: BED GFF CSV TXT HTML
[11:09:25] Identified 847 variants.
[11:09:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out
[11:09:25] Result files:
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.aligned.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam.bai
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bed
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.subs.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.csv
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.filt.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.gff
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.html
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.log
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.raw.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.subs.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.tab
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.txt
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz.csi
[11:09:25] Walltime used: 20 seconds
[11:09:25] May the SNPs be with you.
[11:09:25] Done.
[Fri Jun 19 11:09:25 2020]
Finished job 63.
142 of 201 steps (71%) done

[Fri Jun 19 11:09:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out
    jobid: 64
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB5062AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
[M::process] read 320060 sequences (80000366 bp)...
[M::process] read 63826 sequences (15956500 bp)...
[11:09:25] Marked 0 heterozygous sites with 'n'
[11:09:25] Creating extra output files: BED GFF CSV TXT HTML
[11:09:25] Identified 22 variants.
[11:09:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out
[11:09:25] Result files:
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.aligned.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam.bai
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bed
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.subs.fa
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.csv
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.filt.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.gff
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.html
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.log
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.raw.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.subs.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.tab
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.txt
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz
[11:09:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz.csi
[11:09:25] Walltime used: 18 seconds
[11:09:25] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:25] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Fri Jun 19 11:09:25 2020]
Finished job 50.
143 of 201 steps (71%) done

[Fri Jun 19 11:09:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out
    jobid: 99
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB0053AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:25] Marked 0 heterozygous sites with 'n'
[11:09:26] Creating extra output files: BED GFF CSV TXT HTML
[11:09:26] Identified 24 variants.
[11:09:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out
[11:09:26] Result files:
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.aligned.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam.bai
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bed
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.subs.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.csv
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.filt.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.gff
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.html
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.log
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.raw.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.subs.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.tab
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.txt
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz.csi
[11:09:26] Walltime used: 20 seconds
[11:09:26] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:09:26] Done.
[Fri Jun 19 11:09:26 2020]
Finished job 104.
144 of 201 steps (72%) done

[Fri Jun 19 11:09:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out
    jobid: 177
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_EB6812AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[11:09:26] This is snippy 4.4.3
[11:09:26] Written by Torsten Seemann
[11:09:26] Obtained from https://github.com/tseemann/snippy
[11:09:26] Detected operating system: linux
[11:09:26] Enabling bundled linux tools.
[11:09:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:26] Found gzip - /usr/bin/gzip
[11:09:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:26] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:26] Treating reference as 'fasta' format.
[11:09:26] Will use 8 CPU cores.
[11:09:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
[11:09:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out
[11:09:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out
[11:09:26] Creating reference folder: reference
[11:09:26] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:26] Wrote 3 sequences to ref.fa
[11:09:26] Wrote 0 features to ref.gff
[11:09:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta into pseudo-reads
[11:09:26] This is snippy 4.4.3
[11:09:26] Written by Torsten Seemann
[11:09:26] Obtained from https://github.com/tseemann/snippy
[11:09:26] Detected operating system: linux
[11:09:26] Enabling bundled linux tools.
[11:09:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:26] Found gzip - /usr/bin/gzip
[11:09:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:26] This is snippy 4.4.3
[11:09:26] Written by Torsten Seemann
[11:09:26] Obtained from https://github.com/tseemann/snippy
[11:09:26] Detected operating system: linux
[11:09:26] Enabling bundled linux tools.
[11:09:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:26] Running: samtools index snps.bam 2>> snps.log
[11:09:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:26] Treating reference as 'fasta' format.
[11:09:26] Will use 8 CPU cores.
[11:09:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[11:09:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out
[11:09:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out
[11:09:26] Creating reference folder: reference
[11:09:26] Marked 0 heterozygous sites with 'n'
[11:09:26] Extracting FASTA and GFF from reference.
[11:09:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:26] Found gzip - /usr/bin/gzip
[11:09:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:26] Creating extra output files: BED GFF CSV TXT HTML
[11:09:26] Identified 22 variants.
[11:09:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out
[11:09:26] Result files:
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.aligned.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam.bai
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bed
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.subs.fa
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.csv
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.filt.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.gff
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.html
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.log
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.raw.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.subs.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.tab
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.txt
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz
[11:09:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz.csi
[11:09:26] Walltime used: 19 seconds
[11:09:26] Questionable SNP? Try the --report option to see the alignments.
[11:09:26] Done.
[11:09:26] Running: samtools index snps.bam 2>> snps.log
[11:09:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[Fri Jun 19 11:09:26 2020]
Finished job 151.
145 of 201 steps (72%) done

[Fri Jun 19 11:09:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out
    jobid: 168
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_VA4537AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[11:09:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:26] Wrote 3 sequences to ref.fa
[11:09:26] Wrote 0 features to ref.gff
[11:09:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta into pseudo-reads
[11:09:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:26] Treating reference as 'fasta' format.
[11:09:26] Will use 8 CPU cores.
[11:09:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[11:09:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out
[11:09:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out
[11:09:26] Creating reference folder: reference
[11:09:26] Extracting FASTA and GFF from reference.
[11:09:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:27] Wrote 3 sequences to ref.fa
[11:09:27] Wrote 0 features to ref.gff
[11:09:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:27] This is snippy 4.4.3
[11:09:27] Written by Torsten Seemann
[11:09:27] Obtained from https://github.com/tseemann/snippy
[11:09:27] Detected operating system: linux
[11:09:27] Enabling bundled linux tools.
[11:09:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:27] Found gzip - /usr/bin/gzip
[11:09:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 320060 reads in 16.742 CPU sec, 2.235 real sec
[11:09:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:27] Treating reference as 'fasta' format.
[11:09:27] Will use 8 CPU cores.
[11:09:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[11:09:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out
[11:09:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out
[11:09:27] Creating reference folder: reference
[11:09:27] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[11:09:27] Wrote 3 sequences to ref.fa
[11:09:27] Wrote 0 features to ref.gff
[11:09:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 63826 reads in 4.224 CPU sec, 0.493 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.596 sec; CPU: 21.495 sec
[samclip] Total SAM records 384144, removed 807, allowed 81, passed 383337
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:29] Wrote 383068 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:29] Using BAM RG (Read Group) ID: SAL_BB5062AA_AS.out
[11:09:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:29] Wrote 383198 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:29] Using BAM RG (Read Group) ID: SAL_CB0053AA_AS.out
[11:09:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:29] Wrote 382772 fake 250bp reads (20x, stride 25bp) to fake_reads.fq

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:29] Using BAM RG (Read Group) ID: SAL_EB6812AA_AS.out
[11:09:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:30] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:30] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:30] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:30] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:30] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:30] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:30] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:30] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:30] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:30] Running: samtools index snps.bam 2>> snps.log
[11:09:30] Wrote 386146 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:30] Using BAM RG (Read Group) ID: SAL_VA4537AA_AS.out
[11:09:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:30] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320030 sequences (80000202 bp)...
[M::process] read 63068 sequences (15720238 bp)...
[M::process] read 63168 sequences (15744678 bp)...
[M::process] read 320154 sequences (80000430 bp)...
[M::process] read 62618 sequences (15639390 bp)...
[11:09:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320090 sequences (80000322 bp)...
[11:09:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 66056 sequences (16510148 bp)...
[11:09:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:34] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320030 reads in 17.237 CPU sec, 2.590 real sec
[11:09:34] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320000 reads in 16.995 CPU sec, 2.764 real sec
[11:09:34] Creating extra output files: BED GFF CSV TXT HTML
[11:09:34] Identified 15 variants.
[11:09:34] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out
[11:09:34] Result files:
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.aligned.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam.bai
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bed
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.subs.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.csv
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.filt.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.gff
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.html
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.log
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.raw.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.subs.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.tab
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.txt
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz.csi
[11:09:34] Walltime used: 18 seconds
[11:09:34] May the SNPs be with you.
[11:09:34] Done.
[Fri Jun 19 11:09:34 2020]
Finished job 100.
146 of 201 steps (73%) done

[Fri Jun 19 11:09:34 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out
    jobid: 122
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_FA1940AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[M::mem_process_seqs] Processed 320154 reads in 16.963 CPU sec, 2.542 real sec
[11:09:34] Marked 0 heterozygous sites with 'n'
[11:09:34] Creating extra output files: BED GFF CSV TXT HTML
[11:09:34] Identified 29 variants.
[11:09:34] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out
[11:09:34] Result files:
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.aligned.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam.bai
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bed
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.subs.fa
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.csv
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.filt.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.gff
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.html
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.log
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.raw.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.subs.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.tab
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.txt
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz
[11:09:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz.csi
[11:09:34] Walltime used: 18 seconds
[11:09:34] Questionable SNP? Try the --report option to see the alignments.
[11:09:34] Done.
[samclip] Processed 100000 records...
[Fri Jun 19 11:09:34 2020]
Finished job 26.
147 of 201 steps (73%) done

[Fri Jun 19 11:09:34 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out
    jobid: 71
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB6250AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[M::mem_process_seqs] Processed 63168 reads in 3.570 CPU sec, 0.431 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63068 reads in 3.741 CPU sec, 0.442 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 62618 reads in 3.647 CPU sec, 0.433 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:35] This is snippy 4.4.3
[11:09:35] Written by Torsten Seemann
[11:09:35] Obtained from https://github.com/tseemann/snippy
[11:09:35] Detected operating system: linux
[11:09:35] Enabling bundled linux tools.
[11:09:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[samclip] Processed 300000 records...
[11:09:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:35] Found gzip - /usr/bin/gzip
[11:09:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.098 sec; CPU: 21.403 sec
[samclip] Total SAM records 383409, removed 657, allowed 121, passed 382752
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:35] This is snippy 4.4.3
[11:09:35] Written by Torsten Seemann
[11:09:35] Obtained from https://github.com/tseemann/snippy
[11:09:35] Detected operating system: linux
[11:09:35] Enabling bundled linux tools.
[11:09:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:35] Found gzip - /usr/bin/gzip
[11:09:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:35] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:35] Treating reference as 'fasta' format.
[11:09:35] Will use 8 CPU cores.
[11:09:35] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[11:09:35] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out
[11:09:35] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out
[11:09:35] Creating reference folder: reference
[11:09:35] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.286 sec; CPU: 21.378 sec
[samclip] Total SAM records 383216, removed 391, allowed 42, passed 382825
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.024 sec; CPU: 21.208 sec
[samclip] Total SAM records 383012, removed 642, allowed 66, passed 382370
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:35] Wrote 3 sequences to ref.fa
[11:09:35] Wrote 0 features to ref.gff
[11:09:35] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta into pseudo-reads
[11:09:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:35] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:35] Treating reference as 'fasta' format.
[11:09:35] Will use 8 CPU cores.
[11:09:35] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[11:09:35] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out
[11:09:35] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out
[11:09:35] Creating reference folder: reference
[11:09:35] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:36] Wrote 3 sequences to ref.fa
[11:09:36] Wrote 0 features to ref.gff
[11:09:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320090 reads in 18.450 CPU sec, 3.184 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66056 reads in 4.060 CPU sec, 0.465 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.575 sec; CPU: 23.069 sec
[samclip] Total SAM records 386415, removed 1281, allowed 219, passed 385134
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:37] Running: samtools index snps.bam 2>> snps.log
[11:09:37] Running: samtools index snps.bam 2>> snps.log
[11:09:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:37] Running: samtools index snps.bam 2>> snps.log
[11:09:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:38] Marked 0 heterozygous sites with 'n'
[11:09:38] Creating extra output files: BED GFF CSV TXT HTML
[11:09:38] Identified 22 variants.
[11:09:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out
[11:09:38] Result files:
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.aligned.fa
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam.bai
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bed
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.fa
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.subs.fa
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.csv
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.filt.vcf
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.gff
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.html
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.log
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.raw.vcf
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.subs.vcf
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.tab
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.txt
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz
[11:09:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz.csi
[11:09:38] Walltime used: 18 seconds
[11:09:38] Questionable SNP? Try the --report option to see the alignments.
[11:09:38] Done.
[Fri Jun 19 11:09:38 2020]
Finished job 144.
148 of 201 steps (74%) done

[Fri Jun 19 11:09:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out
    jobid: 138
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_PA3767AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
[11:09:38] Wrote 387290 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:38] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:38] Using BAM RG (Read Group) ID: SAL_FA1940AA_AS.out
[11:09:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:38] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:38] Wrote 382802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:38] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:38] Using BAM RG (Read Group) ID: SAL_CB6250AA_AS.out
[11:09:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:38] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:39] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:39] This is snippy 4.4.3
[11:09:39] Written by Torsten Seemann
[11:09:39] Obtained from https://github.com/tseemann/snippy
[11:09:39] Detected operating system: linux
[11:09:39] Enabling bundled linux tools.
[11:09:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:39] Found gzip - /usr/bin/gzip
[11:09:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:39] Treating reference as 'fasta' format.
[11:09:39] Will use 8 CPU cores.
[11:09:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
[11:09:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out
[11:09:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out
[11:09:39] Creating reference folder: reference
[11:09:39] Extracting FASTA and GFF from reference.
[11:09:39] Wrote 3 sequences to ref.fa
[11:09:39] Wrote 0 features to ref.gff
[11:09:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta into pseudo-reads
[11:09:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:40] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:09:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:40] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 62
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320084 sequences (80000418 bp)...
[11:09:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320016 sequences (80000024 bp)...
[M::process] read 67206 sequences (16796958 bp)...
[11:09:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 62786 sequences (15639610 bp)...
[11:09:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:41] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:42] Wrote 385754 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:42] Using BAM RG (Read Group) ID: SAL_PA3767AA_AS.out
[11:09:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:09:42] Running: bwa index reference/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1781
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:09:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:43] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320016 reads in 17.028 CPU sec, 2.347 real sec
[M::mem_process_seqs] Processed 320084 reads in 18.706 CPU sec, 2.476 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 62786 reads in 3.737 CPU sec, 0.431 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 67206 reads in 4.250 CPU sec, 0.492 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 382942, removed 640, allowed 72, passed 382302

[main] Real time: 3.719 sec; CPU: 21.342 sec
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R[samclip] Total SAM records 387568, removed 2133, allowed 398, passed 385435
 @RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out -t[samclip] Header contained 5 lines
 8[samclip] Done.
 reference/ref.fa fake_reads.fq
[main] Real time: 3.866 sec; CPU: 23.492 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320114 sequences (80000118 bp)...
[M::process] read 65640 sequences (16400950 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:45] Marked 0 heterozygous sites with 'n'
[11:09:45] Marked 0 heterozygous sites with 'n'
[11:09:45] Creating extra output files: BED GFF CSV TXT HTML
[11:09:45] Identified 62 variants.
[11:09:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out
[11:09:45] Result files:
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.aligned.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam.bai
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bed
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.subs.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.csv
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.filt.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.gff
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.html
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.log
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.raw.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.subs.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.tab
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.txt
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz.csi
[11:09:45] Walltime used: 19 seconds
[11:09:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:09:45] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Fri Jun 19 11:09:45 2020]
Finished job 64.
149 of 201 steps (74%) done

[Fri Jun 19 11:09:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out
    jobid: 95
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_GB0225AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[11:09:45] Creating extra output files: BED GFF CSV TXT HTML
[11:09:45] Identified 29 variants.
[11:09:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out
[11:09:45] Result files:
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.aligned.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam.bai
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bed
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.subs.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.csv
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.filt.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.gff
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.html
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.log
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.raw.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.subs.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.tab
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.txt
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz.csi
[11:09:45] Walltime used: 19 seconds
[11:09:45] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:09:45] Done.
[Fri Jun 19 11:09:45 2020]
Finished job 99.
150 of 201 steps (75%) done

[Fri Jun 19 11:09:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out
    jobid: 61
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CA4744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[11:09:45] Marked 0 heterozygous sites with 'n'
[11:09:45] Creating extra output files: BED GFF CSV TXT HTML
[11:09:45] Identified 26 variants.
[11:09:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out
[11:09:45] Result files:
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.aligned.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam.bai
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bed
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.subs.fa
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.csv
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.filt.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.gff
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.html
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.log
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.raw.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.subs.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.tab
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.txt
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz
[11:09:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz.csi
[11:09:45] Walltime used: 19 seconds
[11:09:45] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:09:45] Done.
[Fri Jun 19 11:09:45 2020]
Finished job 177.
151 of 201 steps (75%) done

[Fri Jun 19 11:09:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out
    jobid: 86
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_OB6949AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:46] This is snippy 4.4.3
[11:09:46] Written by Torsten Seemann
[11:09:46] Obtained from https://github.com/tseemann/snippy
[11:09:46] Detected operating system: linux
[11:09:46] Enabling bundled linux tools.
[11:09:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:46] This is snippy 4.4.3
[11:09:46] Written by Torsten Seemann
[11:09:46] Obtained from https://github.com/tseemann/snippy
[11:09:46] Detected operating system: linux
[11:09:46] Enabling bundled linux tools.
[11:09:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:46] Found gzip - /usr/bin/gzip
[11:09:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:46] Found gzip - /usr/bin/gzip
[11:09:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:46] Running: samtools index snps.bam 2>> snps.log
[11:09:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:46] Running: samtools index snps.bam 2>> snps.log
[11:09:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:46] This is snippy 4.4.3
[11:09:46] Written by Torsten Seemann
[11:09:46] Obtained from https://github.com/tseemann/snippy
[11:09:46] Detected operating system: linux
[11:09:46] Enabling bundled linux tools.
[11:09:46] Treating reference as 'fasta' format.
[11:09:46] Will use 8 CPU cores.
[11:09:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[11:09:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out
[11:09:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out
[11:09:46] Creating reference folder: reference
[11:09:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:46] Extracting FASTA and GFF from reference.
[11:09:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:46] Treating reference as 'fasta' format.
[11:09:46] Will use 8 CPU cores.
[11:09:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[11:09:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out
[11:09:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out
[11:09:46] Creating reference folder: reference
[11:09:46] Extracting FASTA and GFF from reference.
[11:09:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:46] Found gzip - /usr/bin/gzip
[11:09:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:46] Wrote 3 sequences to ref.fa
[11:09:46] Wrote 0 features to ref.gff
[11:09:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta into pseudo-reads
[11:09:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:46] Wrote 3 sequences to ref.fa
[11:09:46] Wrote 0 features to ref.gff
[11:09:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta into pseudo-reads
[11:09:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:46] Treating reference as 'fasta' format.
[11:09:46] Will use 8 CPU cores.
[11:09:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
[11:09:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out
[11:09:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out
[11:09:46] Creating reference folder: reference
[11:09:46] Extracting FASTA and GFF from reference.
[11:09:46] Wrote 3 sequences to ref.fa
[11:09:46] Wrote 0 features to ref.gff
[11:09:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta into pseudo-reads
[11:09:47] Marked 0 heterozygous sites with 'n'
[11:09:47] Creating extra output files: BED GFF CSV TXT HTML
[11:09:47] Identified 1781 variants.
[11:09:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out
[11:09:47] Result files:
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.aligned.fa
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam.bai
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bed
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.fa
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.subs.fa
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.csv
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.filt.vcf
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.gff
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.html
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.log
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.raw.vcf
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.subs.vcf
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.tab
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.txt
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz
[11:09:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz.csi
[11:09:47] Walltime used: 20 seconds
[11:09:47] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:47] Done.
[Fri Jun 19 11:09:47 2020]
Finished job 168.
152 of 201 steps (76%) done

[Fri Jun 19 11:09:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out
    jobid: 47
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA9330AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[M::mem_process_seqs] Processed 320114 reads in 19.411 CPU sec, 2.644 real sec
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 65640 reads in 4.073 CPU sec, 0.485 real sec
[samclip] Processed 200000 records...
[11:09:48] This is snippy 4.4.3
[11:09:48] Written by Torsten Seemann
[11:09:48] Obtained from https://github.com/tseemann/snippy
[11:09:48] Detected operating system: linux
[11:09:48] Enabling bundled linux tools.
[11:09:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:48] Found gzip - /usr/bin/gzip
[11:09:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 300000 records...
[11:09:48] Treating reference as 'fasta' format.
[11:09:48] Will use 8 CPU cores.
[11:09:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[11:09:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out
[11:09:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out
[11:09:48] Creating reference folder: reference
[11:09:48] Extracting FASTA and GFF from reference.
[11:09:48] Wrote 3 sequences to ref.fa
[11:09:48] Wrote 0 features to ref.gff
[11:09:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.141 sec; CPU: 24.083 sec
[samclip] Total SAM records 385939, removed 1166, allowed 215, passed 384773
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:49] Wrote 381952 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:49] Using BAM RG (Read Group) ID: SAL_GB0225AA_AS.out
[11:09:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:09:49] Running: samtools faidx reference/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:49] Wrote 385818 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:49] Using BAM RG (Read Group) ID: SAL_CA4744AA_AS.out
[11:09:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:09:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:49] Wrote 381814 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:49] Using BAM RG (Read Group) ID: SAL_OB6949AA_AS.out
[11:09:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:09:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:49] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1889
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:09:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:09:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:09:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:09:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:50] Running: samtools index snps.bam 2>> snps.log
[11:09:50] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:09:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:51] Wrote 393650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:51] Using BAM RG (Read Group) ID: SAL_SA9330AA_AS.out
[11:09:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:51] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:09:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:09:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320076 sequences (80000300 bp)...
[M::process] read 320062 sequences (80000348 bp)...
[M::process] read 61876 sequences (15469000 bp)...
[M::process] read 65756 sequences (16430214 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 61814 sequences (15447022 bp)...
[11:09:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:09:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:09:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:09:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:09:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320180 sequences (80000496 bp)...
[M::process] read 73470 sequences (18340998 bp)...
[11:09:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1818
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:09:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:09:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:09:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:09:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:09:54] Marked 0 heterozygous sites with 'n'
[11:09:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:09:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.228 CPU sec, 2.375 real sec
[11:09:54] Creating extra output files: BED GFF CSV TXT HTML
[11:09:54] Identified 100 variants.
[M::mem_process_seqs] Processed 320076 reads in 17.539 CPU sec, 2.576 real sec
[11:09:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out
[11:09:54] Result files:
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.aligned.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam.bai
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bed
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.subs.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.csv
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.filt.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.gff
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.html
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.log
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.raw.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.subs.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.tab
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.txt
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz.csi
[11:09:54] Walltime used: 19 seconds
[11:09:54] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:54] Done.
[11:09:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[Fri Jun 19 11:09:54 2020]
Finished job 71.
153 of 201 steps (76%) done

[Fri Jun 19 11:09:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out
    jobid: 187
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB5221AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
[11:09:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:09:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320062 reads in 18.873 CPU sec, 2.625 real sec
[11:09:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:09:54] Running: rm -f fake_reads\.fq 2>> snps.log
[11:09:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 61814 reads in 3.332 CPU sec, 0.407 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61876 reads in 3.303 CPU sec, 0.400 real sec
[samclip] Processed 100000 records...
[11:09:54] Marked 22 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[11:09:54] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 65756 reads in 3.747 CPU sec, 0.451 real sec
[11:09:54] Identified 1889 variants.
[11:09:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out
[11:09:54] Result files:
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.aligned.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam.bai
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bed
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.subs.fa
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.csv
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.filt.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.gff
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.html
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.log
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.raw.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.subs.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.tab
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.txt
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz
[11:09:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz.csi
[11:09:54] Walltime used: 19 seconds
[11:09:54] May the SNPs be with you.
[11:09:54] Done.
[Fri Jun 19 11:09:54 2020]
Finished job 122.
154 of 201 steps (77%) done

[Fri Jun 19 11:09:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out
    jobid: 186
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA1119AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[11:09:55] This is snippy 4.4.3
[11:09:55] Written by Torsten Seemann
[11:09:55] Obtained from https://github.com/tseemann/snippy
[11:09:55] Detected operating system: linux
[11:09:55] Enabling bundled linux tools.
[11:09:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:55] Found gzip - /usr/bin/gzip
[11:09:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[samclip] Processed 300000 records...
[11:09:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[samclip] Processed 300000 records...
[11:09:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:55] Treating reference as 'fasta' format.
[11:09:55] Will use 8 CPU cores.
[11:09:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
[11:09:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out
[11:09:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out
[11:09:55] Creating reference folder: reference
[11:09:55] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.897 sec; CPU: 21.187 sec
[samclip] Total SAM records 382038, removed 796, allowed 164, passed 381242
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.075 sec; CPU: 21.454 sec
[samclip] Total SAM records 382179, removed 672, allowed 60, passed 381507
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:55] Wrote 3 sequences to ref.fa
[11:09:55] Wrote 0 features to ref.gff
[11:09:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta into pseudo-reads
[11:09:55] This is snippy 4.4.3
[11:09:55] Written by Torsten Seemann
[11:09:55] Obtained from https://github.com/tseemann/snippy
[11:09:55] Detected operating system: linux
[11:09:55] Enabling bundled linux tools.
[11:09:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out -t 8 reference/ref.fa[11:09:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
 fake_reads.fq
[main] Real time: 4.182 sec; CPU: 23.240 sec
[samclip] Total SAM records 386081, removed 1419, allowed 302, passed 384662
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:55] Found gzip - /usr/bin/gzip
[11:09:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:55] Treating reference as 'fasta' format.
[11:09:55] Will use 8 CPU cores.
[11:09:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
[11:09:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out
[11:09:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out
[11:09:55] Creating reference folder: reference
[11:09:55] Extracting FASTA and GFF from reference.
[11:09:55] Wrote 3 sequences to ref.fa
[11:09:55] Wrote 0 features to ref.gff
[11:09:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320180 reads in 18.069 CPU sec, 2.703 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 73470 reads in 4.567 CPU sec, 0.527 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.127 sec; CPU: 23.198 sec
[samclip] Total SAM records 393741, removed 505, allowed 55, passed 393236
[samclip] Header contained 5 lines
[samclip] Done.
[11:09:57] Running: samtools index snps.bam 2>> snps.log
[11:09:57] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:57] Running: samtools index snps.bam 2>> snps.log
[11:09:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:58] Wrote 384312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:58] Using BAM RG (Read Group) ID: SAL_JB5221AA_AS.out
[11:09:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:58] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:09:58] Marked 0 heterozygous sites with 'n'
[11:09:58] Wrote 386028 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:09:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:09:58] Using BAM RG (Read Group) ID: SAL_KA1119AA_AS.out
[11:09:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:09:58] Running: bwa index reference/ref.fa 2>> snps.log
[11:09:58] Creating extra output files: BED GFF CSV TXT HTML
[11:09:58] Identified 1818 variants.
[11:09:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out
[11:09:58] Result files:
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.aligned.fa
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam.bai
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bed
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.fa
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.subs.fa
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.csv
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.filt.vcf
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.gff
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.html
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.log
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.raw.vcf
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.subs.vcf
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.tab
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.txt
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz
[11:09:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz.csi
[11:09:58] Walltime used: 19 seconds
[11:09:58] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:09:58] Done.
[Fri Jun 19 11:09:58 2020]
Finished job 138.
155 of 201 steps (77%) done

[Fri Jun 19 11:09:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out
    jobid: 43
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA9246AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:09:59] Running: samtools index snps.bam 2>> snps.log
[11:09:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:09:59] This is snippy 4.4.3
[11:09:59] Written by Torsten Seemann
[11:09:59] Obtained from https://github.com/tseemann/snippy
[11:09:59] Detected operating system: linux
[11:09:59] Enabling bundled linux tools.
[11:09:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:09:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:09:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:09:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:09:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:09:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:09:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:09:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:09:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:09:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:09:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:09:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:09:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:09:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:09:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:09:59] Found gzip - /usr/bin/gzip
[11:09:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:09:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:09:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:09:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:09:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:09:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:09:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:09:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:09:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:09:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:09:59] Treating reference as 'fasta' format.
[11:09:59] Will use 8 CPU cores.
[11:09:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
[11:09:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out
[11:09:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out
[11:09:59] Creating reference folder: reference
[11:09:59] Extracting FASTA and GFF from reference.
[11:09:59] Wrote 3 sequences to ref.fa
[11:09:59] Wrote 0 features to ref.gff
[11:09:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta into pseudo-reads
[11:10:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:10:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::bwa_idx_load_from_disk] read 0 ALT contigs

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320032 sequences (80000340 bp)...
[11:10:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 64280 sequences (16070000 bp)...
[11:10:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:10:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1708
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:10:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 320276 sequences (80000470 bp)...
[11:10:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 65752 sequences (16413928 bp)...
[11:10:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:10:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1908
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:10:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 116
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:02] Wrote 385860 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:02] Using BAM RG (Read Group) ID: SAL_SA9246AA_AS.out
[11:10:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:02] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320032 reads in 15.981 CPU sec, 2.135 real sec
[11:10:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[11:10:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:03] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 64280 reads in 3.575 CPU sec, 0.419 real sec
[M::mem_process_seqs] Processed 320276 reads in 17.191 CPU sec, 2.404 real sec
[11:10:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 65752 reads in 4.102 CPU sec, 0.473 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.515 sec; CPU: 20.102 sec
[samclip] Total SAM records 384410, removed 587, allowed 42, passed 383823
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.793 sec; CPU: 21.867 sec
[samclip] Total SAM records 386267, removed 676, allowed 238, passed 385591
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320236 sequences (80000442 bp)...
[M::process] read 65624 sequences (16391106 bp)...
[11:10:05] Marked 0 heterozygous sites with 'n'
[11:10:05] Creating extra output files: BED GFF CSV TXT HTML
[11:10:05] Identified 22 variants.
[11:10:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out
[11:10:05] Result files:
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.aligned.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam.bai
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bed
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.subs.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.csv
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.filt.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.gff
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.html
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.log
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.raw.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.subs.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.tab
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.txt
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz.csi
[11:10:05] Walltime used: 19 seconds
[11:10:05] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:10:05] Done.
[Fri Jun 19 11:10:05 2020]
Finished job 95.
156 of 201 steps (78%) done

[Fri Jun 19 11:10:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out
    jobid: 125
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA0984AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:05] Marked 0 heterozygous sites with 'n'
[11:10:05] Creating extra output files: BED GFF CSV TXT HTML
[11:10:05] Identified 1708 variants.
[11:10:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out
[11:10:05] Result files:
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.aligned.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam.bai
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bed
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.subs.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.csv
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.filt.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.gff
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.html
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.log
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.raw.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.subs.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.tab
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.txt
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz.csi
[11:10:05] Walltime used: 19 seconds
[11:10:05] Questionable SNP? Try the --report option to see the alignments.
[11:10:05] Done.
[Fri Jun 19 11:10:05 2020]
Finished job 86.
157 of 201 steps (78%) done

[Fri Jun 19 11:10:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out
    jobid: 96
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BA7932AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:05] Running: samtools index snps.bam 2>> snps.log
[11:10:05] Marked 0 heterozygous sites with 'n'
[11:10:05] This is snippy 4.4.3
[11:10:05] Written by Torsten Seemann
[11:10:05] Obtained from https://github.com/tseemann/snippy
[11:10:05] Detected operating system: linux
[11:10:05] Enabling bundled linux tools.
[11:10:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:05] Creating extra output files: BED GFF CSV TXT HTML
[11:10:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:05] Identified 1908 variants.
[11:10:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out
[11:10:05] Result files:
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.aligned.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam.bai
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bed
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.subs.fa
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.csv
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.filt.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.gff
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.html
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.log
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.raw.vcf
[11:10:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.subs.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.tab
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.txt
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz
[11:10:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz.csi
[11:10:05] Walltime used: 19 seconds
[11:10:05] May the SNPs be with you.
[11:10:05] Done.
[11:10:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:05] Found gzip - /usr/bin/gzip
[11:10:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[Fri Jun 19 11:10:05 2020]
Finished job 61.
158 of 201 steps (79%) done

[Fri Jun 19 11:10:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out
    jobid: 27
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB3640AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[11:10:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:06] Treating reference as 'fasta' format.
[11:10:06] Will use 8 CPU cores.
[11:10:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[11:10:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out
[11:10:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out
[11:10:06] Creating reference folder: reference
[11:10:06] Extracting FASTA and GFF from reference.
[11:10:06] This is snippy 4.4.3
[11:10:06] Written by Torsten Seemann
[11:10:06] Obtained from https://github.com/tseemann/snippy
[11:10:06] Detected operating system: linux
[11:10:06] Enabling bundled linux tools.
[11:10:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:06] Found gzip - /usr/bin/gzip
[11:10:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:06] Wrote 3 sequences to ref.fa
[11:10:06] Wrote 0 features to ref.gff
[11:10:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta into pseudo-reads
[11:10:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:06] Running: samtools index snps.bam 2>> snps.log
[11:10:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:06] Treating reference as 'fasta' format.
[11:10:06] Will use 8 CPU cores.
[11:10:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
[11:10:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out
[11:10:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out
[11:10:06] Creating reference folder: reference
[11:10:06] Extracting FASTA and GFF from reference.
[11:10:06] Wrote 3 sequences to ref.fa
[11:10:06] Wrote 0 features to ref.gff
[11:10:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta into pseudo-reads
[11:10:06] This is snippy 4.4.3
[11:10:06] Written by Torsten Seemann
[11:10:06] Obtained from https://github.com/tseemann/snippy
[11:10:06] Detected operating system: linux
[11:10:06] Enabling bundled linux tools.
[11:10:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:06] Found gzip - /usr/bin/gzip
[11:10:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:06] Treating reference as 'fasta' format.
[11:10:06] Will use 8 CPU cores.
[11:10:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[11:10:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out
[11:10:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out
[11:10:06] Creating reference folder: reference
[11:10:06] Extracting FASTA and GFF from reference.
[11:10:06] Wrote 3 sequences to ref.fa
[11:10:06] Wrote 0 features to ref.gff
[11:10:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320236 reads in 16.125 CPU sec, 2.138 real sec
[11:10:07] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[11:10:07] Creating extra output files: BED GFF CSV TXT HTML
[11:10:07] Identified 116 variants.
[11:10:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out
[11:10:07] Result files:
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.aligned.fa
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam.bai
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bed
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.fa
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.subs.fa
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.csv
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.filt.vcf
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.gff
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.html
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.log
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.raw.vcf
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.subs.vcf
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.tab
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.txt
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz
[11:10:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz.csi
[11:10:07] Walltime used: 19 seconds
[11:10:07] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:10:07] Done.
[Fri Jun 19 11:10:07 2020]
Finished job 47.
159 of 201 steps (79%) done

[Fri Jun 19 11:10:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out
    jobid: 101
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_XA3156AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
[M::mem_process_seqs] Processed 65624 reads in 4.222 CPU sec, 0.492 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:08] This is snippy 4.4.3
[11:10:08] Written by Torsten Seemann
[11:10:08] Obtained from https://github.com/tseemann/snippy
[11:10:08] Detected operating system: linux
[11:10:08] Enabling bundled linux tools.
[11:10:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 386177, removed 759, allowed 180, passed 385418
 -R @RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out -t[samclip] Header contained 5 lines
 8[samclip] Done.
 reference/ref.fa fake_reads.fq
[main] Real time: 3.511 sec; CPU: 20.879 sec
[11:10:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:08] Found gzip - /usr/bin/gzip
[11:10:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:08] Treating reference as 'fasta' format.
[11:10:08] Will use 8 CPU cores.
[11:10:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
[11:10:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out
[11:10:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out
[11:10:08] Creating reference folder: reference
[11:10:08] Extracting FASTA and GFF from reference.
[11:10:08] Wrote 3 sequences to ref.fa
[11:10:08] Wrote 0 features to ref.gff
[11:10:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta into pseudo-reads
[11:10:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 70
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:08] Wrote 385598 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:08] Using BAM RG (Read Group) ID: SAL_KA0984AA_AS.out
[11:10:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:09] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:10:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:09] Wrote 387022 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:09] Using BAM RG (Read Group) ID: SAL_BA7932AA_AS.out
[11:10:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:09] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:09] Wrote 384090 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:09] Using BAM RG (Read Group) ID: SAL_KB3640AA_AS.out
[11:10:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:09] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:09] Running: samtools index snps.bam 2>> snps.log
[11:10:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:11] Wrote 385394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:11] Using BAM RG (Read Group) ID: SAL_XA3156AA_AS.out
[11:10:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:11] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320104 sequences (80000368 bp)...
[M::process] read 65494 sequences (16362658 bp)...
[11:10:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[M::process] read 320016 sequences (80000392 bp)...
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 67006 sequences (16751500 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 64090 sequences (16022500 bp)...
[11:10:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320482 sequences (80000282 bp)...
[11:10:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 64912 sequences (16226712 bp)...
[11:10:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:13] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:13] Marked 0 heterozygous sites with 'n'
[11:10:13] Creating extra output files: BED GFF CSV TXT HTML
[11:10:13] Identified 70 variants.
[11:10:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out
[11:10:13] Result files:
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.aligned.fa
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam.bai
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bed
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.fa
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.subs.fa
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.csv
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.filt.vcf
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.gff
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.html
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.log
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.raw.vcf
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.subs.vcf
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.tab
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.txt
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz
[11:10:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz.csi
[11:10:13] Walltime used: 18 seconds
[11:10:13] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:10:13] Done.
[Fri Jun 19 11:10:13 2020]
Finished job 187.
160 of 201 steps (80%) done

[Fri Jun 19 11:10:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out
    jobid: 51
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB2899AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
[M::mem_process_seqs] Processed 320104 reads in 16.917 CPU sec, 2.335 real sec
[samclip] Processed 100000 records...
[11:10:14] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 65494 reads in 3.652 CPU sec, 0.432 real sec
[11:10:14] Creating extra output files: BED GFF CSV TXT HTML
[11:10:14] Identified 13 variants.
[11:10:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out
[11:10:14] Result files:
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.aligned.fa
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam.bai
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bed
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.fa
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.subs.fa
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.csv
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.filt.vcf
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.gff
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.html
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.log
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.raw.vcf
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.subs.vcf
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.tab
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.txt
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz
[11:10:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz.csi
[11:10:14] Walltime used: 19 seconds
[11:10:14] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:10:14] Done.
[Fri Jun 19 11:10:14 2020]
Finished job 186.
161 of 201 steps (80%) done

[Fri Jun 19 11:10:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out
    jobid: 146
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA5244AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[M::mem_process_seqs] Processed 320016 reads in 17.589 CPU sec, 2.645 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 16.799 CPU sec, 2.390 real sec
[11:10:14] This is snippy 4.4.3
[11:10:14] Written by Torsten Seemann
[11:10:14] Obtained from https://github.com/tseemann/snippy
[11:10:14] Detected operating system: linux
[11:10:14] Enabling bundled linux tools.
[11:10:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:14] Found gzip - /usr/bin/gzip
[11:10:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[samclip] Processed 100000 records...
[11:10:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[11:10:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67006 reads in 3.933 CPU sec, 0.455 real sec
[11:10:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:14] Treating reference as 'fasta' format.
[11:10:14] Will use 8 CPU cores.
[11:10:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
[11:10:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out
[11:10:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out
[11:10:14] Creating reference folder: reference
[11:10:14] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 64090 reads in 3.616 CPU sec, 0.430 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.784 sec; CPU: 21.109 sec
[samclip] Total SAM records 385989, removed 1810, allowed 301, passed 384179
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:14] Wrote 3 sequences to ref.fa
[11:10:14] Wrote 0 features to ref.gff
[11:10:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[11:10:15] This is snippy 4.4.3
[11:10:15] Written by Torsten Seemann
[11:10:15] Obtained from https://github.com/tseemann/snippy
[11:10:15] Detected operating system: linux
[11:10:15] Enabling bundled linux tools.
[11:10:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:15] Found gzip - /usr/bin/gzip
[11:10:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[11:10:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[11:10:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:15] Treating reference as 'fasta' format.
[11:10:15] Will use 8 CPU cores.
[11:10:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[11:10:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out
[11:10:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out
[11:10:15] Creating reference folder: reference
[11:10:15] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.082 sec; CPU: 22.102 sec
[samclip] Total SAM records 387279, removed 2243, allowed 481, passed 385036
[samclip] Header contained 5 lines
[samclip] Done.
[11:10:15] Wrote 3 sequences to ref.fa
[11:10:15] Wrote 0 features to ref.gff
[11:10:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.864 sec; CPU: 21.017 sec
[samclip] Total SAM records 384260, removed 823, allowed 90, passed 383437
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320482 reads in 18.409 CPU sec, 2.584 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64912 reads in 3.613 CPU sec, 0.418 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[11:10:16] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.952 sec; CPU: 22.587 sec
[samclip] Total SAM records 385802, removed 1041, allowed 135, passed 384761
[samclip] Header contained 5 lines
[samclip] Done.
[11:10:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:17] Running: samtools index snps.bam 2>> snps.log
[11:10:17] Running: samtools index snps.bam 2>> snps.log
[11:10:17] Wrote 380182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:17] Using BAM RG (Read Group) ID: SAL_BB2899AA_AS.out
[11:10:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:17] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:17] Marked 0 heterozygous sites with 'n'
[11:10:17] Creating extra output files: BED GFF CSV TXT HTML
[11:10:17] Identified 21 variants.
[11:10:17] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out
[11:10:17] Result files:
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.aligned.fa
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam.bai
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bed
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.fa
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.subs.fa
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.csv
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.filt.vcf
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.gff
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.html
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.log
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.raw.vcf
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.subs.vcf
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.tab
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.txt
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz
[11:10:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz.csi
[11:10:17] Walltime used: 18 seconds
[11:10:17] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:10:17] Done.
[Fri Jun 19 11:10:18 2020]
Finished job 43.
162 of 201 steps (81%) done

[Fri Jun 19 11:10:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out
    jobid: 118
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB8607AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[11:10:18] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:18] Using BAM RG (Read Group) ID: SAL_KA5244AA_AS.out
[11:10:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:18] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:18] This is snippy 4.4.3
[11:10:18] Written by Torsten Seemann
[11:10:18] Obtained from https://github.com/tseemann/snippy
[11:10:18] Detected operating system: linux
[11:10:18] Enabling bundled linux tools.
[11:10:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:18] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:18] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:18] Found gzip - /usr/bin/gzip
[11:10:18] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:18] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:18] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:18] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:18] Running: samtools index snps.bam 2>> snps.log
[11:10:18] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:18] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:18] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:18] Treating reference as 'fasta' format.
[11:10:18] Will use 8 CPU cores.
[11:10:18] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[11:10:18] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out
[11:10:18] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out
[11:10:18] Creating reference folder: reference
[11:10:18] Extracting FASTA and GFF from reference.
[11:10:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:19] Wrote 3 sequences to ref.fa
[11:10:19] Wrote 0 features to ref.gff
[11:10:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta into pseudo-reads
[11:10:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[11:10:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::process] read 60182 sequences (15045500 bp)...
[11:10:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:10:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 2
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 234
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 320220 sequences (80000454 bp)...
[11:10:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:10:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 64386 sequences (16095548 bp)...
[11:10:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:21] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:21] Wrote 379750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:21] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:21] Using BAM RG (Read Group) ID: SAL_KB8607AA_AS.out
[11:10:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:21] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.139 CPU sec, 2.163 real sec
[11:10:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[11:10:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 60182 reads in 3.228 CPU sec, 0.377 real sec
[11:10:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:22] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[11:10:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320220 reads in 17.854 CPU sec, 2.595 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.502 sec; CPU: 19.913 sec
[samclip] Total SAM records 380347, removed 432, allowed 42, passed 379915
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64386 reads in 3.795 CPU sec, 0.437 real sec
[samclip] Processed 200000 records...
[11:10:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:23] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.978 sec; CPU: 22.225 sec
[samclip] Total SAM records 384768, removed 794, allowed 154, passed 383974
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320006 sequences (80000192 bp)...
[M::process] read 59744 sequences (14936000 bp)...
[11:10:24] Marked 41 heterozygous sites with 'n'
[11:10:24] Creating extra output files: BED GFF CSV TXT HTML
[11:10:24] Identified 234 variants.
[11:10:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out
[11:10:24] Result files:
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.aligned.fa
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam.bai
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bed
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.fa
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.subs.fa
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.csv
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.filt.vcf
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.gff
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.html
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.log
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.raw.vcf
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.subs.vcf
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.tab
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.txt
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz
[11:10:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz.csi
[11:10:24] Walltime used: 19 seconds
[11:10:24] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:10:24] Done.
[Fri Jun 19 11:10:24 2020]
Finished job 125.
163 of 201 steps (81%) done

[Fri Jun 19 11:10:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out
    jobid: 133
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_RA1578AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[11:10:24] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:24] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:25] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:25] Marked 0 heterozygous sites with 'n'
[11:10:25] Creating extra output files: BED GFF CSV TXT HTML
[11:10:25] Identified 20 variants.
[11:10:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out
[11:10:25] Result files:
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.aligned.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam.bai
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bed
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.subs.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.csv
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.filt.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.gff
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.html
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.log
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.raw.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.subs.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.tab
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.txt
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz.csi
[11:10:25] Walltime used: 19 seconds
[11:10:25] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:10:25] Done.
[Fri Jun 19 11:10:25 2020]
Finished job 96.
164 of 201 steps (82%) done

[Fri Jun 19 11:10:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out
    jobid: 14
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB4431AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[11:10:25] Creating extra output files: BED GFF CSV TXT HTML
[11:10:25] Identified 122 variants.
[11:10:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out
[11:10:25] Result files:
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.aligned.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam.bai
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bed
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.subs.fa
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.csv
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.filt.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.gff
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.html
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.log
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.raw.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.subs.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.tab
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.txt
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz
[11:10:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz.csi
[11:10:25] Walltime used: 19 seconds
[11:10:25] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:10:25] Done.
[Fri Jun 19 11:10:25 2020]
Finished job 27.
165 of 201 steps (82%) done

[Fri Jun 19 11:10:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out
    jobid: 159
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JA4169AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[11:10:25] This is snippy 4.4.3
[11:10:25] Written by Torsten Seemann
[11:10:25] Obtained from https://github.com/tseemann/snippy
[11:10:25] Detected operating system: linux
[11:10:25] Enabling bundled linux tools.
[11:10:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:25] Found gzip - /usr/bin/gzip
[11:10:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:25] Treating reference as 'fasta' format.
[11:10:25] Will use 8 CPU cores.
[11:10:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[11:10:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out
[11:10:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out
[11:10:25] Creating reference folder: reference
[11:10:25] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:25] Wrote 3 sequences to ref.fa
[11:10:25] Wrote 0 features to ref.gff
[11:10:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta into pseudo-reads
[11:10:25] Running: samtools index snps.bam 2>> snps.log
[11:10:25] This is snippy 4.4.3
[11:10:25] Written by Torsten Seemann
[11:10:25] Obtained from https://github.com/tseemann/snippy
[11:10:25] Detected operating system: linux
[11:10:25] Enabling bundled linux tools.
[11:10:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:25] Found gzip - /usr/bin/gzip
[11:10:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:26] This is snippy 4.4.3
[11:10:26] Written by Torsten Seemann
[11:10:26] Obtained from https://github.com/tseemann/snippy
[11:10:26] Detected operating system: linux
[11:10:26] Enabling bundled linux tools.
[11:10:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:26] Treating reference as 'fasta' format.
[11:10:26] Will use 8 CPU cores.
[11:10:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[11:10:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out
[11:10:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out
[11:10:26] Creating reference folder: reference
[11:10:26] Extracting FASTA and GFF from reference.
[11:10:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:26] Found gzip - /usr/bin/gzip
[11:10:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:26] Wrote 3 sequences to ref.fa
[11:10:26] Wrote 0 features to ref.gff
[11:10:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta into pseudo-reads
[11:10:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:26] Treating reference as 'fasta' format.
[11:10:26] Will use 8 CPU cores.
[11:10:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[11:10:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out
[11:10:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out
[11:10:26] Creating reference folder: reference
[11:10:26] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320006 reads in 18.041 CPU sec, 2.484 real sec
[11:10:26] Wrote 3 sequences to ref.fa
[11:10:26] Wrote 0 features to ref.gff
[11:10:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta into pseudo-reads
[11:10:26] Marked 0 heterozygous sites with 'n'
[11:10:26] Creating extra output files: BED GFF CSV TXT HTML
[11:10:26] Identified 28 variants.
[11:10:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out
[11:10:26] Result files:
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.aligned.fa
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam.bai
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bed
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.fa
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.subs.fa
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.csv
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.filt.vcf
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.gff
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.html
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.log
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.raw.vcf
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.subs.vcf
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.tab
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.txt
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz
[11:10:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz.csi
[11:10:26] Walltime used: 18 seconds
[11:10:26] Questionable SNP? Try the --report option to see the alignments.
[11:10:26] Done.
[Fri Jun 19 11:10:26 2020]
Finished job 101.
166 of 201 steps (83%) done

[Fri Jun 19 11:10:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out
    jobid: 8
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_AB5674AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 59744 reads in 3.473 CPU sec, 0.400 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:10:27] This is snippy 4.4.3
[11:10:27] Written by Torsten Seemann
[11:10:27] Obtained from https://github.com/tseemann/snippy
[11:10:27] Detected operating system: linux
[11:10:27] Enabling bundled linux tools.
[11:10:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:27] Found gzip - /usr/bin/gzip
[11:10:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.857 sec; CPU: 22.103 sec
[samclip] Total SAM records 379993, removed 681, allowed 155, passed 379312
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:27] Treating reference as 'fasta' format.
[11:10:27] Will use 8 CPU cores.
[11:10:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[11:10:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out
[11:10:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out
[11:10:27] Creating reference folder: reference
[11:10:27] Extracting FASTA and GFF from reference.
[11:10:27] Wrote 3 sequences to ref.fa
[11:10:27] Wrote 0 features to ref.gff
[11:10:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta into pseudo-reads
[11:10:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:28] Wrote 384808 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:28] Using BAM RG (Read Group) ID: SAL_RA1578AA_AS.out
[11:10:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:28] Wrote 380504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:29] Using BAM RG (Read Group) ID: SAL_BB4431AA_AS.out
[11:10:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:29] Wrote 384438 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:29] Using BAM RG (Read Group) ID: SAL_JA4169AA_AS.out
[11:10:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:29] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:29] Running: samtools index snps.bam 2>> snps.log
[11:10:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:29] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:29] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:10:30] Wrote 380346 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:10:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:30] Using BAM RG (Read Group) ID: SAL_AB5674AA_AS.out
[11:10:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:30] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320108 sequences (80000268 bp)...
[M::process] read 64700 sequences (16153866 bp)...
[11:10:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320008 sequences (80000076 bp)...
[M::process] read 60496 sequences (15090634 bp)...
[M::process] read 320056 sequences (80000472 bp)...
[M::process] read 64382 sequences (16063010 bp)...
[11:10:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:32] Marked 0 heterozygous sites with 'n'
[11:10:32] Creating extra output files: BED GFF CSV TXT HTML
[11:10:32] Identified 16 variants.
[11:10:32] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out
[11:10:32] Result files:
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.aligned.fa
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam.bai
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bed
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.fa
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.subs.fa
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.csv
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.filt.vcf
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.gff
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.html
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.log
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.raw.vcf
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.subs.vcf
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.tab
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.txt
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz
[11:10:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz.csi
[11:10:32] Walltime used: 18 seconds
[11:10:32] May the SNPs be with you.
[11:10:32] Done.
[11:10:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[M::process] read 320006 sequences (80000212 bp)...
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[Fri Jun 19 11:10:32 2020]
Finished job 51.
167 of 201 steps (83%) done

[Fri Jun 19 11:10:32 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out
    jobid: 70
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_RA1599AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1674
       total no. reference observed             : 0

Time elapsed: 0.02s

[M::process] read 60340 sequences (15075616 bp)...
[11:10:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320108 reads in 17.337 CPU sec, 2.438 real sec
[11:10:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:33] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[11:10:33] This is snippy 4.4.3
[11:10:33] Written by Torsten Seemann
[11:10:33] Obtained from https://github.com/tseemann/snippy
[11:10:33] Detected operating system: linux
[11:10:33] Enabling bundled linux tools.
[11:10:33] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:33] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:33] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:33] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:33] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:33] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:33] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::mem_process_seqs] Processed 320008 reads in 16.009 CPU sec, 2.234 real sec
[11:10:33] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:33] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:33] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:33] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:33] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:33] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:33] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:33] Found gzip - /usr/bin/gzip
[11:10:33] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:33] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:33] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:33] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:33] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:33] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:33] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 64700 reads in 4.475 CPU sec, 0.528 real sec
[11:10:33] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:33] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:33] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 200000 records...
[11:10:33] Treating reference as 'fasta' format.
[11:10:33] Will use 8 CPU cores.
[11:10:33] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
[11:10:33] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out
[11:10:33] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out
[11:10:33] Creating reference folder: reference
[11:10:33] Extracting FASTA and GFF from reference.
[11:10:33] Marked 4 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320056 reads in 16.065 CPU sec, 2.405 real sec
[11:10:33] Creating extra output files: BED GFF CSV TXT HTML
[11:10:33] Identified 10 variants.
[11:10:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out
[11:10:33] Result files:
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.aligned.fa
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam.bai
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bed
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.fa
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.subs.fa
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.csv
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.filt.vcf
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.gff
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.html
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.log
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.raw.vcf
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.subs.vcf
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.tab
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.txt
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz
[11:10:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz.csi
[11:10:33] Walltime used: 18 seconds
[11:10:33] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:10:33] Done.
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60496 reads in 3.133 CPU sec, 0.375 real sec
[Fri Jun 19 11:10:33 2020]
Finished job 146.
168 of 201 steps (84%) done

[Fri Jun 19 11:10:33 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out
    jobid: 164
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB8331AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[11:10:33] Wrote 3 sequences to ref.fa
[11:10:33] Wrote 0 features to ref.gff
[11:10:33] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 64382 reads in 4.042 CPU sec, 0.472 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.914 sec; CPU: 22.365 sec
[samclip] Total SAM records 385138, removed 940, allowed 215, passed 384198
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:34] This is snippy 4.4.3
[11:10:34] Written by Torsten Seemann
[11:10:34] Obtained from https://github.com/tseemann/snippy
[11:10:34] Detected operating system: linux
[11:10:34] Enabling bundled linux tools.
[11:10:34] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 380712, removed 512, allowed 63, passed 380200
[main] CMD:[samclip] Header contained 5 lines
 bwa mem[samclip] Done.
 -Y -M -R @RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.708 sec; CPU: 19.728 sec
[11:10:34] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:34] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:34] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:34] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:34] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:34] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:34] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:34] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:34] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[samclip] Processed 300000 records...
[11:10:34] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:34] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:34] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:34] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:34] Found gzip - /usr/bin/gzip
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:34] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:34] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:34] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:34] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:34] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:34] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:34] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:34] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:34] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:34] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:34] Treating reference as 'fasta' format.
[11:10:34] Will use 8 CPU cores.
[11:10:34] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[11:10:34] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out
[11:10:34] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out
[11:10:34] Creating reference folder: reference
[11:10:34] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.821 sec; CPU: 20.679 sec
[samclip] Total SAM records 384524, removed 316, allowed 111, passed 384208
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:35] Wrote 3 sequences to ref.fa
[11:10:35] Wrote 0 features to ref.gff
[11:10:35] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320006 reads in 18.129 CPU sec, 2.532 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 60340 reads in 3.573 CPU sec, 0.413 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.909 sec; CPU: 22.275 sec
[samclip] Total SAM records 380570, removed 718, allowed 108, passed 379852
[samclip] Header contained 5 lines
[samclip] Done.
[11:10:36] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:36] Running: samtools index snps.bam 2>> snps.log
[11:10:36] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:36] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:36] Using BAM RG (Read Group) ID: SAL_RA1599AA_AS.out
[11:10:36] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:36] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:36] Running: samtools index snps.bam 2>> snps.log
[11:10:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:37] Marked 0 heterozygous sites with 'n'
[11:10:37] Creating extra output files: BED GFF CSV TXT HTML
[11:10:37] Identified 1674 variants.
[11:10:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out
[11:10:37] Result files:
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.aligned.fa
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam.bai
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bed
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.fa
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.subs.fa
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.csv
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.filt.vcf
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.gff
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.html
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.log
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.raw.vcf
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.subs.vcf
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.tab
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.txt
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz
[11:10:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz.csi
[11:10:37] Walltime used: 19 seconds
[11:10:37] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:10:37] Done.
[Fri Jun 19 11:10:37 2020]
Finished job 118.
169 of 201 steps (84%) done

[Fri Jun 19 11:10:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out
    jobid: 74
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA1344AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[11:10:37] Wrote 380542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:37] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:37] Using BAM RG (Read Group) ID: SAL_BB8331AA_AS.out
[11:10:37] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:37] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:38] Running: samtools index snps.bam 2>> snps.log
[11:10:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:38] This is snippy 4.4.3
[11:10:38] Written by Torsten Seemann
[11:10:38] Obtained from https://github.com/tseemann/snippy
[11:10:38] Detected operating system: linux
[11:10:38] Enabling bundled linux tools.
[11:10:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:38] Found gzip - /usr/bin/gzip
[11:10:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:38] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:38] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:38] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:38] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:38] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:38] Treating reference as 'fasta' format.
[11:10:38] Will use 8 CPU cores.
[11:10:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[11:10:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out
[11:10:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out
[11:10:38] Creating reference folder: reference
[11:10:38] Extracting FASTA and GFF from reference.
[11:10:38] Wrote 3 sequences to ref.fa
[11:10:38] Wrote 0 features to ref.gff
[11:10:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta into pseudo-reads
[M::process] read 320112 sequences (80000222 bp)...
[M::process] read 64494 sequences (16109924 bp)...
[11:10:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:39] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:39] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:39] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:39] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:39] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:39] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:10:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 32
       total no. reference observed             : 0

Time elapsed: 0.00s

[M::process] read 320140 sequences (80000372 bp)...
[11:10:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 60402 sequences (15100500 bp)...
[11:10:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 320112 reads in 17.624 CPU sec, 2.538 real sec

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 859
       total no. reference observed             : 0

Time elapsed: 0.01s

[11:10:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:41] Wrote 384188 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:41] Using BAM RG (Read Group) ID: SAL_SA1344AA_AS.out
[11:10:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:41] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] Processed 100000 records...
[11:10:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:41] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 64494 reads in 3.836 CPU sec, 0.441 real sec
[samclip] Processed 200000 records...
[11:10:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.913 sec; CPU: 22.032 sec
[samclip] Total SAM records 384931, removed 1093, allowed 191, passed 383838
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320140 reads in 18.917 CPU sec, 2.582 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60402 reads in 4.296 CPU sec, 0.497 real sec
[samclip] Processed 200000 records...
[11:10:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 300000 records...
[11:10:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.944 sec; CPU: 23.752 sec
[samclip] Total SAM records 381164, removed 1853, allowed 265, passed 379311
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320152 sequences (80000390 bp)...
[M::process] read 64036 sequences (16006868 bp)...
[11:10:44] Marked 0 heterozygous sites with 'n'
[11:10:44] Creating extra output files: BED GFF CSV TXT HTML
[11:10:44] Identified 19 variants.
[11:10:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out
[11:10:44] Result files:
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.aligned.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam.bai
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bed
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.subs.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.csv
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.filt.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.gff
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.html
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.log
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.raw.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.subs.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.tab
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.txt
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz.csi
[11:10:44] Walltime used: 19 seconds
[11:10:44] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:10:44] Done.
[Fri Jun 19 11:10:44 2020]
Finished job 133.
170 of 201 steps (85%) done

[Fri Jun 19 11:10:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out
    jobid: 191
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_NA2865AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[11:10:44] Marked 0 heterozygous sites with 'n'
[11:10:44] Creating extra output files: BED GFF CSV TXT HTML
[11:10:44] Identified 17 variants.
[11:10:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out
[11:10:44] Result files:
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.aligned.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam.bai
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bed
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.subs.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.csv
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.filt.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.gff
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.html
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.log
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.raw.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.subs.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.tab
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.txt
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz.csi
[11:10:44] Walltime used: 19 seconds
[11:10:44] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:10:44] Done.
[Fri Jun 19 11:10:44 2020]
Finished job 14.
171 of 201 steps (85%) done

[Fri Jun 19 11:10:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out
    jobid: 24
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB1150AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[11:10:44] Running: samtools index snps.bam 2>> snps.log
[11:10:44] Marked 0 heterozygous sites with 'n'
[11:10:44] Creating extra output files: BED GFF CSV TXT HTML
[11:10:44] Identified 32 variants.
[11:10:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out
[11:10:44] Result files:
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.aligned.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam.bai
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bed
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.subs.fa
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.csv
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.filt.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.gff
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.html
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.log
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.raw.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.subs.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.tab
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.txt
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz
[11:10:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz.csi
[11:10:44] Walltime used: 18 seconds
[11:10:44] May the SNPs be with you.
[11:10:44] Done.
[Fri Jun 19 11:10:44 2020]
Finished job 159.
172 of 201 steps (86%) done

[Fri Jun 19 11:10:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out
    jobid: 148
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_CB3409AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[11:10:44] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:44] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:44] This is snippy 4.4.3
[11:10:44] Written by Torsten Seemann
[11:10:44] Obtained from https://github.com/tseemann/snippy
[11:10:44] Detected operating system: linux
[11:10:44] Enabling bundled linux tools.
[11:10:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:44] Found gzip - /usr/bin/gzip
[11:10:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:45] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:45] This is snippy 4.4.3
[11:10:45] Written by Torsten Seemann
[11:10:45] Obtained from https://github.com/tseemann/snippy
[11:10:45] Detected operating system: linux
[11:10:45] Enabling bundled linux tools.
[11:10:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:45] Found gzip - /usr/bin/gzip
[11:10:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:45] Treating reference as 'fasta' format.
[11:10:45] Will use 8 CPU cores.
[11:10:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[11:10:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out
[11:10:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out
[11:10:45] Creating reference folder: reference
[11:10:45] Extracting FASTA and GFF from reference.
[11:10:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:45] This is snippy 4.4.3
[11:10:45] Written by Torsten Seemann
[11:10:45] Obtained from https://github.com/tseemann/snippy
[11:10:45] Detected operating system: linux
[11:10:45] Enabling bundled linux tools.
[11:10:45] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:45] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:45] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:45] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:45] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:45] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:45] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:45] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:45] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:45] Found gzip - /usr/bin/gzip
[11:10:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:45] Wrote 3 sequences to ref.fa
[11:10:45] Wrote 0 features to ref.gff
[11:10:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta into pseudo-reads
[11:10:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:45] Treating reference as 'fasta' format.
[11:10:45] Will use 8 CPU cores.
[11:10:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[11:10:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out
[11:10:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out
[11:10:45] Creating reference folder: reference
[11:10:45] Extracting FASTA and GFF from reference.
[11:10:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:45] Treating reference as 'fasta' format.
[11:10:45] Will use 8 CPU cores.
[11:10:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[11:10:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out
[11:10:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out
[11:10:45] Creating reference folder: reference
[11:10:45] Extracting FASTA and GFF from reference.
[11:10:45] Wrote 3 sequences to ref.fa
[11:10:45] Wrote 0 features to ref.gff
[11:10:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta into pseudo-reads
[11:10:45] Running: samtools index snps.bam 2>> snps.log
[11:10:45] Wrote 3 sequences to ref.fa
[11:10:45] Wrote 0 features to ref.gff
[11:10:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta into pseudo-reads
[11:10:45] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:45] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320152 reads in 16.982 CPU sec, 2.286 real sec
[11:10:46] Marked 0 heterozygous sites with 'n'
[11:10:46] Creating extra output files: BED GFF CSV TXT HTML
[11:10:46] Identified 859 variants.
[11:10:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out
[11:10:46] Result files:
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.aligned.fa
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam.bai
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bed
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.fa
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.subs.fa
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.csv
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.filt.vcf
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.gff
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.html
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.log
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.raw.vcf
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.subs.vcf
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.tab
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.txt
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz
[11:10:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz.csi
[11:10:46] Walltime used: 19 seconds
[11:10:46] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:10:46] Done.
[Fri Jun 19 11:10:46 2020]
Finished job 8.
173 of 201 steps (86%) done

[Fri Jun 19 11:10:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out
    jobid: 173
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BB1066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64036 reads in 3.630 CPU sec, 0.420 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:10:46] This is snippy 4.4.3
[11:10:46] Written by Torsten Seemann
[11:10:46] Obtained from https://github.com/tseemann/snippy
[11:10:46] Detected operating system: linux
[11:10:46] Enabling bundled linux tools.
[11:10:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:46] Found gzip - /usr/bin/gzip
[11:10:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.720 sec; CPU: 21.203 sec
[samclip] Total SAM records 384466, removed 997, allowed 98, passed 383469
[samclip] Header contained 5 lines
[samclip] Done.
[11:10:47] Treating reference as 'fasta' format.
[11:10:47] Will use 8 CPU cores.
[11:10:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[11:10:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out
[11:10:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out
[11:10:47] Creating reference folder: reference
[11:10:47] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:47] Wrote 3 sequences to ref.fa
[11:10:47] Wrote 0 features to ref.gff
[11:10:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta into pseudo-reads
[11:10:47] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:47] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:47] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:47] Wrote 383654 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:47] Using BAM RG (Read Group) ID: SAL_NA2865AA_AS.out
[11:10:48] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:48] Wrote 380042 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:48] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:48] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:48] Using BAM RG (Read Group) ID: SAL_JB1150AA_AS.out
[11:10:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:48] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:48] Wrote 378962 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:48] Using BAM RG (Read Group) ID: SAL_CB3409AA_AS.out
[11:10:48] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:48] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:48] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:48] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:48] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:48] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:48] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:48] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2586
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:10:48] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:48] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:10:49] Running: samtools index snps.bam 2>> snps.log
[11:10:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:49] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:49] Wrote 380858 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:49] Using BAM RG (Read Group) ID: SAL_BB1066AA_AS.out
[11:10:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:49] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:10:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:10:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320240 sequences (80000242 bp)...
[M::process] read 320016 sequences (80000400 bp)...
[M::process] read 63414 sequences (15840838 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 60026 sequences (14956226 bp)...
[M::process] read 58962 sequences (14740500 bp)...
[11:10:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320024 sequences (80000386 bp)...
[11:10:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 60834 sequences (15204810 bp)...
[11:10:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:52] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:52] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320240 reads in 17.603 CPU sec, 2.501 real sec
[11:10:52] Creating extra output files: BED GFF CSV TXT HTML
[11:10:52] Identified 18 variants.
[11:10:52] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out
[11:10:52] Result files:
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.aligned.fa
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam.bai
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bed
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.fa
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.subs.fa
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.csv
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.filt.vcf
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.gff
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.html
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.log
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.raw.vcf
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.subs.vcf
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.tab
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.txt
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz
[11:10:52] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz.csi
[11:10:52] Walltime used: 19 seconds
[11:10:52] May the SNPs be with you.
[11:10:52] Done.
[Fri Jun 19 11:10:52 2020]
Finished job 70.
174 of 201 steps (87%) done

[Fri Jun 19 11:10:52 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out
    jobid: 57
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KA0676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 16.270 CPU sec, 2.465 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63414 reads in 3.613 CPU sec, 0.439 real sec
[M::mem_process_seqs] Processed 58962 reads in 3.035 CPU sec, 0.357 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320016 reads in 19.970 CPU sec, 3.081 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[11:10:53] This is snippy 4.4.3
[11:10:53] Written by Torsten Seemann
[11:10:53] Obtained from https://github.com/tseemann/snippy
[11:10:53] Detected operating system: linux
[11:10:53] Enabling bundled linux tools.
[11:10:53] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:53] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:53] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:53] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:53] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:53] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:53] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:53] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:53] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:53] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:53] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:53] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:53] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:53] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:53] Found gzip - /usr/bin/gzip
[11:10:53] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:53] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:53] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:53] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[samclip] Processed 100000 records...
[11:10:53] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:53] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[11:10:53] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:53] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:53] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:53] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:53] Treating reference as 'fasta' format.
[11:10:53] Will use 8 CPU cores.
[11:10:53] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
[11:10:53] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out
[11:10:53] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out
[11:10:53] Creating reference folder: reference
[11:10:53] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 60026 reads in 4.208 CPU sec, 0.485 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 379448, removed 1280, allowed 130, passed 378168

[main] Real time: 3.831 sec; CPU: 19.874 sec
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem[samclip] Total SAM records 383807, removed 436, allowed 38, passed 383371
 -Y -M[samclip] Header contained 5 lines
 -R[samclip] Done.
 @RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.995 sec; CPU: 21.797 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:54] Wrote 3 sequences to ref.fa
[11:10:54] Wrote 0 features to ref.gff
[11:10:54] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta into pseudo-reads
[11:10:54] Marked 1 heterozygous sites with 'n'
[11:10:54] Creating extra output files: BED GFF CSV TXT HTML
[11:10:54] Identified 2586 variants.
[11:10:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out
[11:10:54] Result files:
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.aligned.fa
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam.bai
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bed
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.fa
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.subs.fa
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.csv
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.filt.vcf
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.gff
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.html
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.log
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.raw.vcf
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.subs.vcf
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.tab
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.txt
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz
[11:10:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz.csi
[11:10:54] Walltime used: 20 seconds
[11:10:54] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:10:54] Done.
[Fri Jun 19 11:10:54 2020]
Finished job 164.
175 of 201 steps (87%) done

[Fri Jun 19 11:10:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out
    jobid: 29
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_NA5728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.456 sec; CPU: 24.727 sec
[samclip] Total SAM records 380486, removed 1599, allowed 282, passed 378887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320024 reads in 17.613 CPU sec, 2.483 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[11:10:54] This is snippy 4.4.3
[11:10:54] Written by Torsten Seemann
[11:10:54] Obtained from https://github.com/tseemann/snippy
[11:10:54] Detected operating system: linux
[11:10:54] Enabling bundled linux tools.
[11:10:54] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:54] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:54] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:54] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:54] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:54] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:54] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:54] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:54] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:54] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:54] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:54] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:54] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:54] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:54] Found gzip - /usr/bin/gzip
[11:10:54] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:54] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:54] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:54] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:54] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:54] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 60834 reads in 3.753 CPU sec, 0.433 real sec
[11:10:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 200000 records...
[11:10:55] Treating reference as 'fasta' format.
[11:10:55] Will use 8 CPU cores.
[11:10:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[11:10:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out
[11:10:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out
[11:10:55] Creating reference folder: reference
[11:10:55] Extracting FASTA and GFF from reference.
[11:10:55] Wrote 3 sequences to ref.fa
[11:10:55] Wrote 0 features to ref.gff
[11:10:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.875 sec; CPU: 21.939 sec
[samclip] Total SAM records 381031, removed 423, allowed 39, passed 380608
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:55] Running: samtools index snps.bam 2>> snps.log
[11:10:55] Running: samtools index snps.bam 2>> snps.log
[11:10:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:56] Running: samtools index snps.bam 2>> snps.log
[11:10:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:10:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:56] Wrote 384394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:56] Using BAM RG (Read Group) ID: SAL_KA0676AA_AS.out
[11:10:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:56] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:56] Marked 0 heterozygous sites with 'n'
[11:10:56] Creating extra output files: BED GFF CSV TXT HTML
[11:10:56] Identified 12 variants.
[11:10:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out
[11:10:56] Result files:
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.aligned.fa
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam.bai
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bed
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.fa
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.subs.fa
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.csv
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.filt.vcf
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.gff
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.html
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.log
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.raw.vcf
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.subs.vcf
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.tab
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.txt
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz
[11:10:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz.csi
[11:10:56] Walltime used: 18 seconds
[11:10:56] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:10:56] Done.
[Fri Jun 19 11:10:56 2020]
Finished job 74.
176 of 201 steps (88%) done

[Fri Jun 19 11:10:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out
    jobid: 107
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB1789AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:10:57] This is snippy 4.4.3
[11:10:57] Written by Torsten Seemann
[11:10:57] Obtained from https://github.com/tseemann/snippy
[11:10:57] Detected operating system: linux
[11:10:57] Enabling bundled linux tools.
[11:10:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:10:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:10:57] Running: samtools index snps.bam 2>> snps.log
[11:10:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:10:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:10:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:10:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:10:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:10:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:10:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:10:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:10:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:10:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:10:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:10:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:10:57] Found gzip - /usr/bin/gzip
[11:10:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:10:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:10:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:10:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:10:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:10:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:10:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:10:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:10:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:10:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:10:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:10:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:10:57] Treating reference as 'fasta' format.
[11:10:57] Will use 8 CPU cores.
[11:10:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
[11:10:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out
[11:10:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out
[11:10:57] Creating reference folder: reference
[11:10:57] Extracting FASTA and GFF from reference.
[11:10:57] Wrote 387300 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:10:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:10:58] Using BAM RG (Read Group) ID: SAL_NA5728AA_AS.out
[11:10:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:10:58] Running: bwa index reference/ref.fa 2>> snps.log
[11:10:58] Wrote 3 sequences to ref.fa
[11:10:58] Wrote 0 features to ref.gff
[11:10:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta into pseudo-reads
[11:10:58] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:58] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:58] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:58] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:58] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:10:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320118 sequences (80000194 bp)...
[11:10:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:10:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:10:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 64276 sequences (16058486 bp)...
[11:10:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:10:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:10:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:10:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:10:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:10:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:10:59] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:10:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:10:59] Running: rm -f fake_reads\.fq 2>> snps.log
[11:10:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:10:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:10:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:10:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:10:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:10:59] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:11:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320082 sequences (80000274 bp)...

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 47
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 57

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 57
       total no. variants observed              : 3912
       total no. reference observed             : 0

Time elapsed: 0.05s

[11:11:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 67218 sequences (16796756 bp)...
[11:11:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:00] Wrote 379942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:00] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 73
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:00] Using BAM RG (Read Group) ID: SAL_KB1789AA_AS.out
[11:11:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:00] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:00] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:00] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::mem_process_seqs] Processed 320118 reads in 16.624 CPU sec, 2.212 real sec
[11:11:01] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64276 reads in 4.135 CPU sec, 0.479 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.586 sec; CPU: 21.288 sec
[samclip] Total SAM records 384690, removed 1014, allowed 244, passed 383676
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:02] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:02] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:02] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:02] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:02] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320082 reads in 19.101 CPU sec, 2.615 real sec
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 59942 sequences (14950530 bp)...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 67218 reads in 4.404 CPU sec, 0.510 real sec
[samclip] Processed 200000 records...
[11:11:03] Marked 0 heterozygous sites with 'n'
[11:11:03] Marked 0 heterozygous sites with 'n'
[11:11:03] Creating extra output files: BED GFF CSV TXT HTML
[11:11:03] Identified 105 variants.
[11:11:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out
[11:11:03] Result files:
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.aligned.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam.bai
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bed
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.subs.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.csv
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.filt.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.gff
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.html
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.log
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.raw.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.subs.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.tab
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.txt
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz.csi
[11:11:03] Walltime used: 18 seconds
[11:11:03] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[11:11:03] Done.
[samclip] Processed 300000 records...
[Fri Jun 19 11:11:03 2020]
Finished job 148.
177 of 201 steps (88%) done

[Fri Jun 19 11:11:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out
    jobid: 193
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_WA2841AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
[11:11:03] Creating extra output files: BED GFF CSV TXT HTML
[11:11:03] Identified 13 variants.
[11:11:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out
[11:11:03] Result files:
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.aligned.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam.bai
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bed
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.subs.fa
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.csv
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.filt.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.gff
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.html
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.log
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.raw.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.subs.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.tab
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.txt
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz
[11:11:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz.csi
[11:11:03] Walltime used: 19 seconds
[11:11:03] Wishing you a life free of homopolymer errors.
[11:11:03] Done.
[Fri Jun 19 11:11:03 2020]
Finished job 191.
178 of 201 steps (89%) done

[Fri Jun 19 11:11:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out
    jobid: 80
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_SA9173AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.029 sec; CPU: 24.061 sec
[samclip] Total SAM records 387496, removed 1647, allowed 406, passed 385849
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:11:04] Running: samtools index snps.bam 2>> snps.log
[11:11:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:04] This is snippy 4.4.3
[11:11:04] Written by Torsten Seemann
[11:11:04] Obtained from https://github.com/tseemann/snippy
[11:11:04] Detected operating system: linux
[11:11:04] Enabling bundled linux tools.
[11:11:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:04] This is snippy 4.4.3
[11:11:04] Written by Torsten Seemann
[11:11:04] Obtained from https://github.com/tseemann/snippy
[11:11:04] Detected operating system: linux
[11:11:04] Enabling bundled linux tools.
[11:11:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:04] Found gzip - /usr/bin/gzip
[11:11:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:04] Found gzip - /usr/bin/gzip
[11:11:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:04] Treating reference as 'fasta' format.
[11:11:04] Will use 8 CPU cores.
[11:11:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
[11:11:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out
[11:11:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out
[11:11:04] Creating reference folder: reference
[11:11:04] Extracting FASTA and GFF from reference.
[11:11:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:04] Treating reference as 'fasta' format.
[11:11:04] Will use 8 CPU cores.
[11:11:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[11:11:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out
[11:11:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out
[11:11:04] Creating reference folder: reference
[11:11:04] Extracting FASTA and GFF from reference.
[11:11:04] Wrote 3 sequences to ref.fa
[11:11:04] Wrote 0 features to ref.gff
[11:11:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta into pseudo-reads
[11:11:04] Wrote 3 sequences to ref.fa
[11:11:04] Wrote 0 features to ref.gff
[11:11:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:05] Marked 53 heterozygous sites with 'n'
[11:11:05] Creating extra output files: BED GFF CSV TXT HTML
[11:11:05] Identified 3912 variants.
[11:11:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out
[11:11:05] Result files:
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.aligned.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam.bai
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bed
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.subs.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.csv
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.filt.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.gff
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.html
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.log
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.raw.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.subs.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.tab
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.txt
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz.csi
[11:11:05] Walltime used: 20 seconds
[11:11:05] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:11:05] Done.
[Fri Jun 19 11:11:05 2020]
Finished job 24.
179 of 201 steps (89%) done

[Fri Jun 19 11:11:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out
    jobid: 143
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_TA1967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 18.081 CPU sec, 2.410 real sec
[11:11:05] Marked 0 heterozygous sites with 'n'
[11:11:05] Creating extra output files: BED GFF CSV TXT HTML
[11:11:05] Identified 73 variants.
[11:11:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out
[11:11:05] Result files:
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.aligned.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam.bai
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bed
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.subs.fa
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.csv
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.filt.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.gff
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.html
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.log
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.raw.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.subs.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.tab
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.txt
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz
[11:11:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz.csi
[11:11:05] Walltime used: 19 seconds
[11:11:05] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:11:05] Done.
[Fri Jun 19 11:11:05 2020]
Finished job 173.
180 of 201 steps (90%) done

[Fri Jun 19 11:11:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out
    jobid: 55
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_XA1733AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[samclip] Processed 100000 records...
[11:11:05] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 59942 reads in 4.212 CPU sec, 0.491 real sec
[samclip] Processed 200000 records...
[11:11:05] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:05] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:11:06] This is snippy 4.4.3
[11:11:06] Written by Torsten Seemann
[11:11:06] Obtained from https://github.com/tseemann/snippy
[11:11:06] Detected operating system: linux
[11:11:06] Enabling bundled linux tools.
[11:11:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:06] Found gzip - /usr/bin/gzip
[11:11:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[11:11:06] This is snippy 4.4.3
[11:11:06] Written by Torsten Seemann
[11:11:06] Obtained from https://github.com/tseemann/snippy
[11:11:06] Detected operating system: linux
[11:11:06] Enabling bundled linux tools.
[11:11:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:06] Treating reference as 'fasta' format.
[11:11:06] Will use 8 CPU cores.
[11:11:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[11:11:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out
[11:11:06] Found gzip - /usr/bin/gzip
[11:11:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out
[11:11:06] Creating reference folder: reference
[11:11:06] Extracting FASTA and GFF from reference.
[11:11:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.789 sec; CPU: 22.836 sec
[samclip] Total SAM records 380645, removed 1858, allowed 207, passed 378787
[samclip] Header contained 5 lines
[samclip] Done.
[11:11:06] Wrote 3 sequences to ref.fa
[11:11:06] Wrote 0 features to ref.gff
[11:11:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta into pseudo-reads
[11:11:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:06] Treating reference as 'fasta' format.
[11:11:06] Will use 8 CPU cores.
[11:11:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[11:11:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out
[11:11:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out
[11:11:06] Creating reference folder: reference
[11:11:06] Extracting FASTA and GFF from reference.
[11:11:06] Wrote 3 sequences to ref.fa
[11:11:06] Wrote 0 features to ref.gff
[11:11:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta into pseudo-reads
[11:11:07] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[bam_sort_core] merging from 0 files and 8 in-memory blocks...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:07] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:07] Wrote 383460 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:07] Using BAM RG (Read Group) ID: SAL_WA2841AA_AS.out
[11:11:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:07] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:07] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:07] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:07] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:07] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:08] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:08] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:08] Running: samtools index snps.bam 2>> snps.log
[11:11:08] Wrote 382446 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:08] Using BAM RG (Read Group) ID: SAL_SA9173AA_AS.out
[11:11:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:08] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:08] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:09] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:09] Wrote 382468 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:09] Using BAM RG (Read Group) ID: SAL_TA1967AA_AS.out
[11:11:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:11:09] Running: samtools faidx reference/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:09] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1807
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:11:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[11:11:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:11:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320192 sequences (80000106 bp)...
[11:11:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 63268 sequences (15805028 bp)...
[11:11:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:09] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:10] Wrote 383002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:10] Using BAM RG (Read Group) ID: SAL_XA1733AA_AS.out
[11:11:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:10] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320240 sequences (80000250 bp)...
[M::process] read 62206 sequences (15551500 bp)...
[11:11:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320190 sequences (80000004 bp)...
[M::process] read 62278 sequences (15552298 bp)...
[M::mem_process_seqs] Processed 320192 reads in 17.748 CPU sec, 2.480 real sec
[11:11:12] Marked 0 heterozygous sites with 'n'
[11:11:12] Creating extra output files: BED GFF CSV TXT HTML
[11:11:12] Identified 13 variants.
[11:11:12] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out
[11:11:12] Result files:
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.aligned.fa
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam.bai
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bed
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.fa
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.subs.fa
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.csv
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.filt.vcf
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.gff
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.html
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.log
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.raw.vcf
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.subs.vcf
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.tab
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.txt
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz
[11:11:12] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz.csi
[11:11:12] Walltime used: 19 seconds
[11:11:12] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:11:12] Done.
[11:11:12] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[Fri Jun 19 11:11:12 2020]
Finished job 57.
181 of 201 steps (90%) done

[Fri Jun 19 11:11:12 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out
    jobid: 23
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA9385AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[samclip] Processed 100000 records...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2591
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:11:12] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 63268 reads in 3.635 CPU sec, 0.429 real sec
[11:11:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] Processed 200000 records...
[11:11:12] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:12] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:12] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:12] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:11:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:12] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:13] This is snippy 4.4.3
[11:11:13] Written by Torsten Seemann
[11:11:13] Obtained from https://github.com/tseemann/snippy
[11:11:13] Detected operating system: linux
[11:11:13] Enabling bundled linux tools.
[11:11:13] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:13] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:13] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:13] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:13] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:13] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:13] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:13] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:13] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:13] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:13] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:13] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:13] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:13] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:13] Found gzip - /usr/bin/gzip
[11:11:13] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.944 sec; CPU: 21.991 sec
[samclip] Total SAM records 383660, removed 620, allowed 53, passed 383040
[samclip] Header contained 5 lines
[samclip] Done.
[11:11:13] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:13] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:13] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:13] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:13] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320240 reads in 17.284 CPU sec, 2.384 real sec
[11:11:13] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:13] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:13] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:13] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:13] Treating reference as 'fasta' format.
[11:11:13] Will use 8 CPU cores.
[11:11:13] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[11:11:13] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out
[11:11:13] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out
[11:11:13] Creating reference folder: reference
[11:11:13] Extracting FASTA and GFF from reference.
[11:11:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[11:11:13] Wrote 3 sequences to ref.fa
[11:11:13] Wrote 0 features to ref.gff
[11:11:13] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 62206 reads in 3.812 CPU sec, 0.436 real sec
[samclip] Processed 200000 records...
[M::process] read 320254 sequences (80000470 bp)...
[11:11:13] Marked 6 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320190 reads in 18.075 CPU sec, 2.476 real sec
[M::process] read 62748 sequences (15675344 bp)...
[11:11:13] Creating extra output files: BED GFF CSV TXT HTML
[11:11:13] Identified 1807 variants.
[11:11:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out
[11:11:13] Result files:
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.aligned.fa
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam.bai
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bed
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.fa
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.subs.fa
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.csv
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.filt.vcf
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.gff
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.html
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.log
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.raw.vcf
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.subs.vcf
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.tab
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.txt
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz
[11:11:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz.csi
[11:11:13] Walltime used: 19 seconds
[11:11:13] Wishing you a life free of homopolymer errors.
[11:11:13] Done.
[Fri Jun 19 11:11:13 2020]
Finished job 29.
182 of 201 steps (91%) done

[Fri Jun 19 11:11:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out
    jobid: 102
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA6663AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 382546, removed 556, allowed 115, passed 381990
[samclip] Header contained 5 lines

[main] Real time: 3.774 sec; CPU: 21.691 sec
[samclip] Done.
[M::mem_process_seqs] Processed 62278 reads in 3.953 CPU sec, 0.456 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[11:11:14] This is snippy 4.4.3
[11:11:14] Written by Torsten Seemann
[11:11:14] Obtained from https://github.com/tseemann/snippy
[11:11:14] Detected operating system: linux
[11:11:14] Enabling bundled linux tools.
[11:11:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:14] Found gzip - /usr/bin/gzip
[11:11:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.863 sec; CPU: 22.599 sec
[samclip] Total SAM records 382578, removed 523, allowed 104, passed 382055
[samclip] Header contained 5 lines
[samclip] Done.
[11:11:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:14] Treating reference as 'fasta' format.
[11:11:14] Will use 8 CPU cores.
[11:11:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[11:11:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out
[11:11:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out
[11:11:14] Creating reference folder: reference
[11:11:14] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:15] Wrote 3 sequences to ref.fa
[11:11:15] Wrote 0 features to ref.gff
[11:11:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta into pseudo-reads
[11:11:15] Running: samtools index snps.bam 2>> snps.log
[11:11:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320254 reads in 17.139 CPU sec, 2.377 real sec
[11:11:16] Running: samtools index snps.bam 2>> snps.log
[11:11:16] Wrote 381576 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 62748 reads in 3.923 CPU sec, 0.458 real sec
[samclip] Processed 200000 records...
[11:11:16] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:16] Using BAM RG (Read Group) ID: SAL_YA9385AA_AS.out
[11:11:16] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:16] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[11:11:16] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:17] Marked 1 heterozygous sites with 'n'
[11:11:17] Creating extra output files: BED GFF CSV TXT HTML
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.809 sec; CPU: 21.627 sec
[samclip] Total SAM records 383174, removed 683, allowed 38, passed 382491
[samclip] Header contained 5 lines
[samclip] Done.
[11:11:17] Identified 2591 variants.
[11:11:17] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out
[11:11:17] Result files:
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.aligned.fa
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam.bai
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bed
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.fa
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.subs.fa
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.csv
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.filt.vcf
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.gff
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.html
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.log
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.raw.vcf
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.subs.vcf
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.tab
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.txt
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz
[11:11:17] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz.csi
[11:11:17] Walltime used: 20 seconds
[11:11:17] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:11:17] Done.
[Fri Jun 19 11:11:17 2020]
Finished job 107.
183 of 201 steps (91%) done

[Fri Jun 19 11:11:17 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out
    jobid: 87
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_KB4651AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:17] Wrote 381992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:17] Using BAM RG (Read Group) ID: SAL_YA6663AA_AS.out
[11:11:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:17] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:11:18] This is snippy 4.4.3
[11:11:18] Written by Torsten Seemann
[11:11:18] Obtained from https://github.com/tseemann/snippy
[11:11:18] Detected operating system: linux
[11:11:18] Enabling bundled linux tools.
[11:11:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:11:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:18] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:18] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:18] Found gzip - /usr/bin/gzip
[11:11:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:18] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:18] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:18] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:18] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:18] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:18] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:18] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:18] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:18] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:18] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:18] Treating reference as 'fasta' format.
[11:11:18] Will use 8 CPU cores.
[11:11:18] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
[11:11:18] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out
[11:11:18] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out
[11:11:18] Creating reference folder: reference
[11:11:18] Extracting FASTA and GFF from reference.
[11:11:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:18] Wrote 3 sequences to ref.fa
[11:11:18] Wrote 0 features to ref.gff
[11:11:18] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta into pseudo-reads
[11:11:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:18] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:18] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:18] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:18] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:18] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:18] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320140 sequences (80000490 bp)...
[11:11:19] Running: samtools index snps.bam 2>> snps.log
[M::process] read 61436 sequences (15348128 bp)...
[11:11:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 101
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:11:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:19] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320452 sequences (80000068 bp)...
[M::process] read 61540 sequences (15359146 bp)...
[11:11:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:20] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:21] Wrote 377314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:21] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:21] Using BAM RG (Read Group) ID: SAL_KB4651AA_AS.out
[11:11:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:21] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320140 reads in 17.702 CPU sec, 2.355 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61436 reads in 4.113 CPU sec, 0.478 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[11:11:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 86
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320452 reads in 17.052 CPU sec, 2.356 real sec
[11:11:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.724 sec; CPU: 22.370 sec
[samclip] Total SAM records 381934, removed 1047, allowed 230, passed 380887
[samclip] Header contained 5 lines
[samclip] Done.
[11:11:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:22] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 61540 reads in 3.821 CPU sec, 0.443 real sec
[11:11:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[11:11:22] Marked 0 heterozygous sites with 'n'
[11:11:22] Creating extra output files: BED GFF CSV TXT HTML
[11:11:22] Identified 19 variants.
[11:11:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out
[11:11:22] Result files:
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.aligned.fa
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam.bai
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bed
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.fa
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.subs.fa
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.csv
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.filt.vcf
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.gff
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.html
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.log
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.raw.vcf
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.subs.vcf
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.tab
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.txt
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz
[11:11:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz.csi
[11:11:22] Walltime used: 18 seconds
[11:11:22] May the SNPs be with you.
[11:11:22] Done.
[Fri Jun 19 11:11:22 2020]
Finished job 193.
184 of 201 steps (92%) done

[Fri Jun 19 11:11:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out
    jobid: 36
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_VA1155AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
[11:11:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:23] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.739 sec; CPU: 21.430 sec
[samclip] Total SAM records 382173, removed 587, allowed 309, passed 381586
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320088 sequences (80000324 bp)...
[M::process] read 57226 sequences (14306500 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:23] This is snippy 4.4.3
[11:11:23] Written by Torsten Seemann
[11:11:23] Obtained from https://github.com/tseemann/snippy
[11:11:23] Detected operating system: linux
[11:11:23] Enabling bundled linux tools.
[11:11:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:23] Found gzip - /usr/bin/gzip
[11:11:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:23] Marked 0 heterozygous sites with 'n'
[11:11:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:23] Creating extra output files: BED GFF CSV TXT HTML
[11:11:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:23] Identified 101 variants.
[11:11:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out
[11:11:23] Result files:
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.aligned.fa
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam.bai
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bed
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.fa
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.subs.fa
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.csv
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.filt.vcf
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.gff
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.html
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.log
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.raw.vcf
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.subs.vcf
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.tab
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.txt
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz
[11:11:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz.csi
[11:11:23] Walltime used: 19 seconds
[11:11:23] Questionable SNP? Try the --report option to see the alignments.
[11:11:23] Done.
[11:11:23] Treating reference as 'fasta' format.
[11:11:23] Will use 8 CPU cores.
[11:11:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
[11:11:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out
[11:11:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out
[11:11:23] Creating reference folder: reference
[11:11:23] Extracting FASTA and GFF from reference.
[Fri Jun 19 11:11:23 2020]
Finished job 80.
185 of 201 steps (92%) done

[Fri Jun 19 11:11:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out
    jobid: 10
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_YA6631AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[11:11:24] Wrote 3 sequences to ref.fa
[11:11:24] Wrote 0 features to ref.gff
[11:11:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:11:24] Running: samtools index snps.bam 2>> snps.log
[11:11:24] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:24] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:24] This is snippy 4.4.3
[11:11:24] Written by Torsten Seemann
[11:11:24] Obtained from https://github.com/tseemann/snippy
[11:11:24] Detected operating system: linux
[11:11:24] Enabling bundled linux tools.
[11:11:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:24] Marked 0 heterozygous sites with 'n'
[11:11:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:24] Found gzip - /usr/bin/gzip
[11:11:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:24] Creating extra output files: BED GFF CSV TXT HTML
[11:11:24] Identified 98 variants.
[11:11:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out
[11:11:24] Result files:
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.aligned.fa
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam.bai
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bed
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.fa
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.subs.fa
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.csv
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.filt.vcf
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.gff
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.html
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.log
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.raw.vcf
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.subs.vcf
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.tab
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.txt
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz
[11:11:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz.csi
[11:11:24] Walltime used: 18 seconds
[11:11:24] May the SNPs be with you.
[11:11:24] Done.
[Fri Jun 19 11:11:24 2020]
Finished job 143.
186 of 201 steps (93%) done

[Fri Jun 19 11:11:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out
    jobid: 149
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_BA5105AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[11:11:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:24] Treating reference as 'fasta' format.
[11:11:24] Will use 8 CPU cores.
[11:11:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[11:11:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out
[11:11:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out
[11:11:24] Creating reference folder: reference
[11:11:24] Extracting FASTA and GFF from reference.
[11:11:25] Wrote 3 sequences to ref.fa
[11:11:25] Wrote 0 features to ref.gff
[11:11:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[11:11:25] Running: samtools index snps.bam 2>> snps.log
[11:11:25] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:25] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:25] This is snippy 4.4.3
[11:11:25] Written by Torsten Seemann
[11:11:25] Obtained from https://github.com/tseemann/snippy
[11:11:25] Detected operating system: linux
[11:11:25] Enabling bundled linux tools.
[11:11:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:25] Found gzip - /usr/bin/gzip
[11:11:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:25] Treating reference as 'fasta' format.
[11:11:25] Will use 8 CPU cores.
[11:11:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[11:11:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out
[11:11:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out
[11:11:25] Creating reference folder: reference
[11:11:25] Extracting FASTA and GFF from reference.
[11:11:25] Wrote 3 sequences to ref.fa
[11:11:25] Wrote 0 features to ref.gff
[11:11:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320088 reads in 20.098 CPU sec, 2.648 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 57226 reads in 3.710 CPU sec, 0.435 real sec
[samclip] Processed 200000 records...
[11:11:26] Wrote 380298 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:26] Using BAM RG (Read Group) ID: SAL_VA1155AA_AS.out
[11:11:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:26] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:26] Marked 0 heterozygous sites with 'n'
[11:11:26] Creating extra output files: BED GFF CSV TXT HTML
[11:11:26] Identified 86 variants.
[11:11:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out
[11:11:26] Result files:
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.aligned.fa
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam.bai
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bed
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.fa
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.subs.fa
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.csv
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.filt.vcf
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.gff
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.html
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.log
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.raw.vcf
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.subs.vcf
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.tab
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.txt
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz
[11:11:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz.csi
[11:11:26] Walltime used: 20 seconds
[11:11:26] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[11:11:26] Done.
[Fri Jun 19 11:11:26 2020]
Finished job 55.
187 of 201 steps (93%) done

[Fri Jun 19 11:11:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out
    jobid: 132
    wildcards: output_prefix=Agona_195, reference=SG17-135, sample=SAL_JB5195AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.061 sec; CPU: 24.376 sec
[samclip] Total SAM records 377664, removed 1635, allowed 449, passed 376029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:27] Wrote 381088 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:27] Using BAM RG (Read Group) ID: SAL_YA6631AA_AS.out
[11:11:27] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:11:27] Running: samtools faidx reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:27] Running: bwa index reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1701
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:11:27] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:27] This is snippy 4.4.3
[11:11:27] Written by Torsten Seemann
[11:11:27] Obtained from https://github.com/tseemann/snippy
[11:11:27] Detected operating system: linux
[11:11:27] Enabling bundled linux tools.
[11:11:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[11:11:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[11:11:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[11:11:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[11:11:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[11:11:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[11:11:27] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[11:11:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[11:11:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[11:11:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[11:11:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[11:11:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[11:11:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[11:11:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[11:11:27] Found gzip - /usr/bin/gzip
[11:11:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[11:11:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[11:11:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[11:11:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[11:11:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[11:11:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[11:11:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[11:11:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[11:11:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[11:11:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[11:11:28] Treating reference as 'fasta' format.
[11:11:28] Will use 8 CPU cores.
[11:11:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[11:11:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out
[11:11:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out
[11:11:28] Creating reference folder: reference
[11:11:28] Extracting FASTA and GFF from reference.
[11:11:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:28] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[11:11:28] Wrote 3 sequences to ref.fa
[11:11:28] Wrote 0 features to ref.gff
[11:11:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta into pseudo-reads
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 65
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:28] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:28] Wrote 380120 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:28] Using BAM RG (Read Group) ID: SAL_BA5105AA_AS.out
[11:11:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:28] Running: bwa index reference/ref.fa 2>> snps.log
[11:11:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[11:11:28] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:28] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:28] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:28] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:28] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:28] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:28] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:28] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:28] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320230 sequences (80000192 bp)...
[M::process] read 60068 sequences (15013292 bp)...
[11:11:29] Running: samtools index snps.bam 2>> snps.log
[11:11:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000428 bp)...
[M::process] read 61044 sequences (15249832 bp)...
[11:11:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[11:11:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[11:11:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320060 sequences (80000344 bp)...
[M::process] read 60060 sequences (15011480 bp)...
[11:11:31] Wrote 388682 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[11:11:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[11:11:31] Using BAM RG (Read Group) ID: SAL_JB5195AA_AS.out
[11:11:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[11:11:31] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320230 reads in 22.043 CPU sec, 2.955 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60068 reads in 4.514 CPU sec, 0.530 real sec
[samclip] Processed 200000 records...
[11:11:32] Marked 0 heterozygous sites with 'n'
[11:11:32] Creating extra output files: BED GFF CSV TXT HTML
[11:11:32] Identified 1701 variants.
[11:11:32] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out
[11:11:32] Result files:
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.aligned.fa
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam.bai
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bed
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.fa
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.subs.fa
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.csv
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.filt.vcf
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.gff
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.html
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.log
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.raw.vcf
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.subs.vcf
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.tab
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.txt
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz
[11:11:32] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz.csi
[11:11:32] Walltime used: 19 seconds
[11:11:32] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[11:11:32] Done.
[Fri Jun 19 11:11:32 2020]
Finished job 23.
188 of 201 steps (94%) done
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320044 reads in 18.533 CPU sec, 2.722 real sec
[11:11:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.402 sec; CPU: 27.111 sec
[samclip] Total SAM records 380650, removed 1633, allowed 584, passed 379017
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[11:11:33] Marked 0 heterozygous sites with 'n'
[11:11:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 10
          no. right trimmed                     : 59
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 72

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 72
       total no. variants observed              : 6603
       total no. reference observed             : 0

Time elapsed: 0.08s

[11:11:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[11:11:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[11:11:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[11:11:33] Creating extra output files: BED GFF CSV TXT HTML
[11:11:33] Identified 65 variants.
[11:11:33] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out
[11:11:33] Result files:
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.aligned.fa
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam.bai
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bed
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.fa
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.subs.fa
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.csv
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.filt.vcf
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.gff
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.html
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.log
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.raw.vcf
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.subs.vcf
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.tab
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.txt
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz
[11:11:33] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz.csi
[11:11:33] Walltime used: 19 seconds
[11:11:33] Questionable SNP? Try the --report option to see the alignments.
[11:11:33] Done.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[Fri Jun 19 11:11:33 2020]
Finished job 102.
189 of 201 steps (94%) done
[M::mem_process_seqs] Processed 61044 reads in 4.097 CPU sec, 0.475 real sec
[samclip] Processed 200000 records...
[11:11:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320060 reads in 18.710 CPU sec, 2.655 real sec
[M::process] read 320082 sequences (80000226 bp)...
[11:11:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 68600 sequences (17150000 bp)...
[11:11:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[11:11:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[11:11:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:33] Running: rm -f fake_reads\.fq 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out -t 8[samclip] Total SAM records 382314, removed 2907, allowed 309, passed 379407
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.078 sec; CPU: 23.161 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 60060 reads in 3.864 CPU sec, 0.445 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.027 sec; CPU: 23.141 sec
[samclip] Total SAM records 380432, removed 950, allowed 256, passed 379482
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:34] Running: samtools index snps.bam 2>> snps.log
[11:11:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:35] Running: samtools index snps.bam 2>> snps.log
[11:11:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320082 reads in 18.278 CPU sec, 2.497 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 68600 reads in 4.112 CPU sec, 0.469 real sec
[11:11:36] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[11:11:36] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:36] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.872 sec; CPU: 22.955 sec
[samclip] Total SAM records 389159, removed 1713, allowed 88, passed 387446
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[11:11:37] Marked 2 heterozygous sites with 'n'
[11:11:38] Creating extra output files: BED GFF CSV TXT HTML
[11:11:38] Identified 6603 variants.
[11:11:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out
[11:11:38] Result files:
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.aligned.fa
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam.bai
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bed
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.fa
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.subs.fa
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.csv
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.filt.vcf
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.gff
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.html
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.log
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.raw.vcf
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.subs.vcf
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.tab
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.txt
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz
[11:11:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz.csi
[11:11:38] Walltime used: 20 seconds
[11:11:38] Wishing you a life free of homopolymer errors.
[11:11:38] Done.
[Fri Jun 19 11:11:38 2020]
Finished job 87.
190 of 201 steps (95%) done
[11:11:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:38] Running: samtools index snps.bam 2>> snps.log

stats: biallelic
          no. left trimmed                      : 11
          no. right trimmed                     : 62
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 78

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 78
       total no. variants observed              : 7174
       total no. reference observed             : 0

Time elapsed: 0.09s

[11:11:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[11:11:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[11:11:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[11:11:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 34
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 37

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 37
       total no. variants observed              : 2446
       total no. reference observed             : 0

Time elapsed: 0.03s

[11:11:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:39] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1678
       total no. reference observed             : 0

Time elapsed: 0.02s

[11:11:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:39] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:40] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[11:11:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[11:11:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[11:11:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[11:11:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[11:11:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[11:11:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[11:11:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[11:11:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[11:11:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[11:11:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[11:11:42] Running: rm -f fake_reads\.fq 2>> snps.log
[11:11:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[11:11:43] Marked 10 heterozygous sites with 'n'
[11:11:43] Creating extra output files: BED GFF CSV TXT HTML
[11:11:43] Marked 0 heterozygous sites with 'n'
[11:11:43] Identified 7174 variants.
[11:11:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out
[11:11:43] Result files:
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.aligned.fa
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam.bai
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bed
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.fa
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.subs.fa
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.csv
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.filt.vcf
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.gff
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.html
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.log
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.raw.vcf
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.subs.vcf
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.tab
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.txt
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz
[11:11:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz.csi
[11:11:43] Walltime used: 20 seconds
[11:11:43] Wishing you a life free of homopolymer errors.
[11:11:43] Done.
[Fri Jun 19 11:11:44 2020]
Finished job 36.
191 of 201 steps (95%) done
[11:11:44] Creating extra output files: BED GFF CSV TXT HTML
[11:11:44] Identified 2446 variants.
[11:11:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out
[11:11:44] Result files:
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.aligned.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam.bai
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bed
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.subs.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.csv
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.filt.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.gff
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.html
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.log
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.raw.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.subs.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.tab
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.txt
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz.csi
[11:11:44] Walltime used: 20 seconds
[11:11:44] May the SNPs be with you.
[11:11:44] Done.
[Fri Jun 19 11:11:44 2020]
Finished job 10.
192 of 201 steps (96%) done
[11:11:44] Marked 0 heterozygous sites with 'n'
[11:11:44] Creating extra output files: BED GFF CSV TXT HTML
[11:11:44] Identified 1678 variants.
[11:11:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out
[11:11:44] Result files:
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.aligned.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam.bai
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bed
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.subs.fa
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.csv
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.filt.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.gff
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.html
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.log
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.raw.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.subs.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.tab
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.txt
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz
[11:11:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz.csi
[11:11:44] Walltime used: 19 seconds
[11:11:44] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[11:11:44] Done.
[Fri Jun 19 11:11:44 2020]
Finished job 149.
193 of 201 steps (96%) done
[11:11:46] Marked 0 heterozygous sites with 'n'
[11:11:46] Creating extra output files: BED GFF CSV TXT HTML
[11:11:46] Identified 126 variants.
[11:11:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out
[11:11:46] Result files:
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.aligned.fa
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam.bai
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bed
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.fa
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.subs.fa
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.csv
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.filt.vcf
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.gff
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.html
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.log
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.raw.vcf
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.subs.vcf
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.tab
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.txt
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz
[11:11:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz.csi
[11:11:46] Walltime used: 19 seconds
[11:11:46] Wishing you a life free of homopolymer errors.
[11:11:46] Done.
[Fri Jun 19 11:11:46 2020]
Finished job 132.
194 of 201 steps (97%) done

[Fri Jun 19 11:11:46 2020]
rule snippy_core:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.full.aln
    jobid: 200
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32


        snippy-core --prefix /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135 --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/*.out
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
This is snippy-core 4.4.3
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools.
Found any2fasta - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/binaries/noarch/any2fasta
Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Found minimap2 - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/minimap2
Found bedtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bedtools
Found snp-sites - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snp-sites
Saving reference FASTA: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.ref.fa
This is any2fasta 0.4.2
Opening '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Detected FASTA format
Read 64410 lines from '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Wrote 3 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 3 sequences totalling 5152410 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	SAL_AB5642AA_AS.out	snp=182	del=42	ins=8	het=0	unaligned=445626
1	SAL_AB5674AA_AS.out	snp=942	del=14	ins=50	het=0	unaligned=500594
2	SAL_AB5906AA_AS.out	snp=215	del=25	ins=8	het=0	unaligned=478900
3	SAL_AB5909AA_AS.out	snp=115	del=24	ins=5	het=0	unaligned=485170
4	SAL_AB6160AA_AS.out	snp=130	del=3	ins=5	het=0	unaligned=440603
5	SAL_AB7534AA_AS.out	snp=13	del=1	ins=1	het=68	unaligned=425297
6	SAL_AB7542AA_AS.out	snp=25	del=10	ins=8	het=0	unaligned=435908
7	SAL_AB7588AA_AS.out	snp=357	del=20	ins=40	het=216	unaligned=452649
8	SAL_AB7634AA_AS.out	snp=12	del=10	ins=7	het=0	unaligned=443024
9	SAL_AB8884AA_AS.out	snp=60	del=10	ins=17	het=0	unaligned=433934
10	SAL_AB9321AA_AS.out	snp=357	del=19	ins=25	het=224	unaligned=454860
11	SAL_BA5105AA_AS.out	snp=1835	del=49	ins=47	het=0	unaligned=501233
12	SAL_BA7932AA_AS.out	snp=22	del=2	ins=4	het=0	unaligned=439729
13	SAL_BA7945AA_AS.out	snp=2136	del=23	ins=56	het=0	unaligned=482931
14	SAL_BA8052AA_AS.out	snp=15	del=1	ins=1	het=0	unaligned=433098
15	SAL_BB0648AA_AS.out	snp=382	del=27	ins=60	het=430	unaligned=487563
16	SAL_BB1066AA_AS.out	snp=68	del=1	ins=9	het=0	unaligned=492941
17	SAL_BB1371AA_AS.out	snp=384	del=27	ins=53	het=432	unaligned=477178
18	SAL_BB1424AA_AS.out	snp=18	del=2	ins=1	het=0	unaligned=462047
19	SAL_BB1915AA_AS.out	snp=19	del=1	ins=0	het=0	unaligned=471321
20	SAL_BB1956AA_AS.out	snp=24	del=7	ins=7	het=0	unaligned=429822
21	SAL_BB2131AA_AS.out	snp=22	del=10	ins=2	het=0	unaligned=457273
22	SAL_BB2593AA_AS.out	snp=2238	del=68	ins=57	het=151	unaligned=477954
23	SAL_BB2899AA_AS.out	snp=15	del=1	ins=0	het=0	unaligned=473454
24	SAL_BB2967AA_AS.out	snp=49	del=8	ins=1	het=0	unaligned=429507
25	SAL_BB2970AA_AS.out	snp=12	del=3	ins=2	het=0	unaligned=454351
26	SAL_BB3127AA_AS.out	snp=17	del=1	ins=1	het=0	unaligned=431185
27	SAL_BB4431AA_AS.out	snp=16	del=1	ins=0	het=0	unaligned=447855
28	SAL_BB4524AA_AS.out	snp=17	del=7	ins=1	het=0	unaligned=429092
29	SAL_BB4921AA_AS.out	snp=2171	del=41	ins=68	het=0	unaligned=470442
30	SAL_BB4937AA_AS.out	snp=26	del=1	ins=1	het=0	unaligned=450484
31	SAL_BB5050AA_AS.out	snp=25	del=1	ins=1	het=0	unaligned=450435
32	SAL_BB5062AA_AS.out	snp=55	del=3	ins=4	het=0	unaligned=450035
33	SAL_BB6441AA_AS.out	snp=145	del=15	ins=5	het=0	unaligned=419421
34	SAL_BB6687AA_AS.out	snp=91	del=2	ins=13	het=0	unaligned=491312
35	SAL_BB7027AA_AS.out	snp=20	del=1	ins=1	het=0	unaligned=433286
36	SAL_BB7197AA_AS.out	snp=22	del=1	ins=1	het=0	unaligned=428581
37	SAL_BB7261AA_AS.out	snp=17	del=1	ins=1	het=1	unaligned=430804
38	SAL_BB7947AA_AS.out	snp=183	del=6	ins=5	het=1	unaligned=439268
39	SAL_BB8135AA_AS.out	snp=21	del=1	ins=1	het=0	unaligned=428995
40	SAL_BB8331AA_AS.out	snp=2887	del=23	ins=54	het=1	unaligned=510146
41	SAL_BB9086AA_AS.out	snp=17	del=1	ins=13	het=236	unaligned=436116
42	SAL_BB9562AA_AS.out	snp=19	del=2	ins=2	het=0	unaligned=428737
43	SAL_BB9988AA_AS.out	snp=41	del=2	ins=1	het=0	unaligned=433129
44	SAL_CA4728AA_AS.out	snp=112	del=9	ins=9	het=1	unaligned=492607
45	SAL_CA4744AA_AS.out	snp=2141	del=21	ins=57	het=0	unaligned=477717
46	SAL_CA4803AA_AS.out	snp=2156	del=20	ins=54	het=0	unaligned=492612
47	SAL_CB0053AA_AS.out	snp=25	del=1	ins=4	het=0	unaligned=439538
48	SAL_CB0088AA_AS.out	snp=25	del=1	ins=0	het=0	unaligned=453288
49	SAL_CB1153AA_AS.out	snp=361	del=21	ins=40	het=216	unaligned=452235
50	SAL_CB1324AA_AS.out	snp=14	del=3	ins=2	het=0	unaligned=448816
51	SAL_CB1790AA_AS.out	snp=28	del=1	ins=4	het=0	unaligned=429741
52	SAL_CB2372AA_AS.out	snp=14	del=1	ins=1	het=1	unaligned=431433
53	SAL_CB2598AA_AS.out	snp=23	del=67	ins=3	het=0	unaligned=450203
54	SAL_CB2669AA_AS.out	snp=13	del=11	ins=1	het=0	unaligned=432606
55	SAL_CB3409AA_AS.out	snp=105	del=82	ins=9	het=0	unaligned=489134
56	SAL_CB3497AA_AS.out	snp=98	del=2	ins=2	het=0	unaligned=437109
57	SAL_CB5243AA_AS.out	snp=16	del=3	ins=3	het=0	unaligned=447151
58	SAL_CB5376AA_AS.out	snp=23	del=10	ins=1	het=0	unaligned=475461
59	SAL_CB5379AA_AS.out	snp=9	del=23	ins=1	het=0	unaligned=432804
60	SAL_CB5468AA_AS.out	snp=24	del=11	ins=1	het=0	unaligned=428976
61	SAL_CB6250AA_AS.out	snp=103	del=34	ins=3	het=0	unaligned=489069
62	SAL_CB9243AA_AS.out	snp=23	del=10	ins=1	het=0	unaligned=433761
63	SAL_CB9389AA_AS.out	snp=25	del=1	ins=1	het=0	unaligned=452454
64	SAL_CB9820AA_AS.out	snp=20	del=1	ins=1	het=0	unaligned=454161
65	SAL_CB9822AA_AS.out	snp=15	del=1	ins=1	het=0	unaligned=436302
66	SAL_CB9835AA_AS.out	snp=584	del=86	ins=17	het=0	unaligned=474879
67	SAL_CB9988AA_AS.out	snp=653	del=18	ins=26	het=0	unaligned=468036
68	SAL_DB1444AA_AS.out	snp=136	del=14	ins=5	het=26	unaligned=495052
69	SAL_EA3229AA_AS.out	snp=2165	del=22	ins=58	het=0	unaligned=476726
70	SAL_EB1026AA_AS.out	snp=10	del=1	ins=17	het=0	unaligned=433054
71	SAL_EB1045AA_AS.out	snp=414	del=24	ins=26	het=236	unaligned=451693
72	SAL_EB2895AA_AS.out	snp=35	del=1	ins=1	het=0	unaligned=430989
73	SAL_EB4083AA_AS.out	snp=106	del=34	ins=3	het=1	unaligned=489128
74	SAL_EB4088AA_AS.out	snp=17	del=1	ins=13	het=0	unaligned=435647
75	SAL_EB5876AA_AS.out	snp=2183	del=14	ins=58	het=0	unaligned=494656
76	SAL_EB6812AA_AS.out	snp=20	del=6	ins=2	het=0	unaligned=436001
77	SAL_EB8845AA_AS.out	snp=20	del=1	ins=1	het=1	unaligned=424985
78	SAL_FA1940AA_AS.out	snp=2127	del=29	ins=55	het=22	unaligned=483830
79	SAL_FA2493AA_AS.out	snp=258	del=12	ins=22	het=12	unaligned=462145
80	SAL_FA5706AA_AS.out	snp=2036	del=28	ins=53	het=7	unaligned=472577
81	SAL_FB5769AA_AS.out	snp=14	del=3	ins=2	het=0	unaligned=446572
82	SAL_FB7879AA_AS.out	snp=2624	del=27	ins=52	het=169	unaligned=459870
83	SAL_FB8051AA_AS.out	snp=20	del=10	ins=1	het=0	unaligned=529916
84	SAL_GB0225AA_AS.out	snp=16	del=6	ins=2	het=0	unaligned=437578
85	SAL_GB5373AA_AS.out	snp=905	del=26	ins=28	het=0	unaligned=493837
86	SAL_HB2219AA_AS.out	snp=14	del=1	ins=7	het=0	unaligned=430476
87	SAL_HB2224AA_AS.out	snp=21	del=10	ins=1	het=0	unaligned=424955
88	SAL_HB2237AA_AS.out	snp=902	del=26	ins=27	het=0	unaligned=492551
89	SAL_HB5660AA_AS.out	snp=113	del=24	ins=13	het=0	unaligned=485694
90	SAL_HB6699AA_AS.out	snp=64	del=10	ins=4	het=4	unaligned=457150
91	SAL_IA5065AA_AS.out	snp=2199	del=22	ins=57	het=0	unaligned=494061
92	SAL_IB1406AA_AS.out	snp=33	del=10	ins=1	het=0	unaligned=450789
93	SAL_IB3115AA_AS.out	snp=1852	del=120	ins=49	het=0	unaligned=497586
94	SAL_IB6779AA_AS.out	snp=2287	del=56	ins=61	het=0	unaligned=498247
95	SAL_IB6801AA_AS.out	snp=41	del=1	ins=1	het=0	unaligned=431592
96	SAL_IB7540AA_AS.out	snp=400	del=22	ins=26	het=224	unaligned=452028
97	SAL_IB7996AA_AS.out	snp=18	del=1	ins=1	het=0	unaligned=428956
98	SAL_IB9118AA_AS.out	snp=184	del=19	ins=12	het=4	unaligned=468420
99	SAL_IB9302AA_AS.out	snp=25	del=7	ins=0	het=0	unaligned=460664
100	SAL_JA4169AA_AS.out	snp=28	del=1	ins=15	het=0	unaligned=449094
101	SAL_JB0953AA_AS.out	snp=1990	del=13	ins=45	het=78	unaligned=498634
102	SAL_JB1150AA_AS.out	snp=4326	del=90	ins=107	het=53	unaligned=511625
103	SAL_JB4414AA_AS.out	snp=129	del=3	ins=5	het=0	unaligned=436417
104	SAL_JB5195AA_AS.out	snp=118	del=42	ins=2	het=0	unaligned=643923
105	SAL_JB5221AA_AS.out	snp=64	del=6	ins=2	het=0	unaligned=496464
106	SAL_JB6580AA_AS.out	snp=13	del=10	ins=1	het=0	unaligned=445733
107	SAL_JB9521AA_AS.out	snp=71	del=5	ins=2	het=0	unaligned=452706
108	SAL_JB9710AA_AS.out	snp=409	del=22	ins=40	het=198	unaligned=448903
109	SAL_KA0676AA_AS.out	snp=11	del=1	ins=1	het=0	unaligned=456413
110	SAL_KA0984AA_AS.out	snp=317	del=7	ins=3	het=41	unaligned=468314
111	SAL_KA1119AA_AS.out	snp=16	del=1	ins=0	het=0	unaligned=433355
112	SAL_KA4888AA_AS.out	snp=33	del=20	ins=3	het=0	unaligned=418336
113	SAL_KA5244AA_AS.out	snp=6	del=10	ins=7	het=4	unaligned=424842
114	SAL_KA8881AA_AS.out	snp=986	del=33	ins=38	het=374	unaligned=451257
115	SAL_KB1136AA_AS.out	snp=2150	del=30	ins=56	het=0	unaligned=485693
116	SAL_KB1789AA_AS.out	snp=2892	del=23	ins=54	het=1	unaligned=510985
117	SAL_KB1826AA_AS.out	snp=550	del=61	ins=16	het=0	unaligned=477081
118	SAL_KB2744AA_AS.out	snp=19	del=1	ins=7	het=0	unaligned=428444
119	SAL_KB3375AA_AS.out	snp=954	del=18	ins=29	het=0	unaligned=493014
120	SAL_KB3640AA_AS.out	snp=130	del=116	ins=8	het=0	unaligned=505200
121	SAL_KB4026AA_AS.out	snp=115	del=23	ins=10	het=24	unaligned=460680
122	SAL_KB4651AA_AS.out	snp=7355	del=124	ins=177	het=2	unaligned=533508
123	SAL_KB6210AA_AS.out	snp=20	del=2	ins=2	het=0	unaligned=429806
124	SAL_KB6734AA_AS.out	snp=99	del=11	ins=2	het=0	unaligned=495549
125	SAL_KB6773AA_AS.out	snp=271	del=22	ins=46	het=654	unaligned=490736
126	SAL_KB6830AA_AS.out	snp=1989	del=18	ins=64	het=11	unaligned=489822
127	SAL_KB8607AA_AS.out	snp=1832	del=42	ins=48	het=0	unaligned=497994
128	SAL_KB8676AA_AS.out	snp=431	del=35	ins=34	het=40	unaligned=473490
129	SAL_KB9523AA_AS.out	snp=147	del=20	ins=35	het=8	unaligned=494063
130	SAL_LA4572AA_AS.out	snp=127	del=9	ins=9	het=0	unaligned=486794
131	SAL_LA7782AA_AS.out	snp=2287	del=29	ins=64	het=9	unaligned=473932
132	SAL_LA7787AA_AS.out	snp=2321	del=27	ins=54	het=69	unaligned=472179
133	SAL_LB4034AA_AS.out	snp=1883	del=21	ins=48	het=0	unaligned=516596
134	SAL_LB8076AA_AS.out	snp=497	del=35	ins=16	het=0	unaligned=451936
135	SAL_MA3067AA_AS.out	snp=492	del=2	ins=13	het=0	unaligned=464486
136	SAL_MB2521AA_AS.out	snp=303	del=39	ins=17	het=0	unaligned=451368
137	SAL_MB5439AA_AS.out	snp=1997	del=19	ins=65	het=0	unaligned=488147
138	SAL_MB7066AA_AS.out	snp=412	del=24	ins=27	het=199	unaligned=452079
139	SAL_MB7965AA_AS.out	snp=18	del=1	ins=6	het=0	unaligned=452272
140	SAL_NA2865AA_AS.out	snp=11	del=1	ins=1	het=0	unaligned=442577
141	SAL_NA5728AA_AS.out	snp=2004	del=26	ins=51	het=6	unaligned=529226
142	SAL_NA8627AA_AS.out	snp=377	del=27	ins=58	het=431	unaligned=477464
143	SAL_NB4129AA_AS.out	snp=2030	del=20	ins=57	het=0	unaligned=483720
144	SAL_NB6620AA_AS.out	snp=15	del=10	ins=1	het=0	unaligned=432044
145	SAL_OA4067AA_AS.out	snp=16	del=1	ins=2	het=0	unaligned=423923
146	SAL_OA4072AA_AS.out	snp=16	del=1	ins=2	het=1	unaligned=425979
147	SAL_OB6949AA_AS.out	snp=1868	del=19	ins=49	het=0	unaligned=498972
148	SAL_PA3767AA_AS.out	snp=2014	del=26	ins=48	het=0	unaligned=489942
149	SAL_PB5476AA_AS.out	snp=393	del=23	ins=42	het=150	unaligned=450870
150	SAL_PB8418AA_AS.out	snp=1982	del=20	ins=47	het=1	unaligned=495015
151	SAL_QA4878AA_AS.out	snp=539	del=35	ins=58	het=441	unaligned=466771
152	SAL_QA5436AA_AS.out	snp=901	del=28	ins=46	het=364	unaligned=455616
153	SAL_RA1578AA_AS.out	snp=16	del=10	ins=1	het=0	unaligned=424169
154	SAL_RA1599AA_AS.out	snp=15	del=10	ins=1	het=0	unaligned=425795
155	SAL_SA1324AA_AS.out	snp=23	del=10	ins=1	het=224	unaligned=425866
156	SAL_SA1344AA_AS.out	snp=9	del=10	ins=1	het=0	unaligned=423686
157	SAL_SA2453AA_AS.out	snp=1997	del=20	ins=48	het=0	unaligned=490787
158	SAL_SA9173AA_AS.out	snp=104	del=34	ins=3	het=0	unaligned=490802
159	SAL_SA9246AA_AS.out	snp=18	del=1	ins=13	het=0	unaligned=435538
160	SAL_SA9330AA_AS.out	snp=106	del=51	ins=2	het=0	unaligned=549158
161	SAL_TA1544AA_AS.out	snp=399	del=21	ins=41	het=228	unaligned=455204
162	SAL_TA1967AA_AS.out	snp=98	del=34	ins=18	het=0	unaligned=530657
163	SAL_TA2587AA_AS.out	snp=959	del=27	ins=38	het=380	unaligned=455206
164	SAL_TA4227AA_AS.out	snp=916	del=27	ins=38	het=381	unaligned=455510
165	SAL_TA6324AA_AS.out	snp=2010	del=13	ins=65	het=0	unaligned=487363
166	SAL_TA7615AA_AS.out	snp=2279	del=29	ins=52	het=95	unaligned=469510
167	SAL_UA4237AA_AS.out	snp=1983	del=19	ins=65	het=0	unaligned=488277
168	SAL_UA4307AA_AS.out	snp=914	del=31	ins=38	het=382	unaligned=454744
169	SAL_UA6621AA_AS.out	snp=1986	del=33	ins=53	het=0	unaligned=489817
170	SAL_UA7988AA_AS.out	snp=1972	del=34	ins=54	het=0	unaligned=503519
171	SAL_UA7989AA_AS.out	snp=2006	del=33	ins=52	het=0	unaligned=506489
172	SAL_VA1155AA_AS.out	snp=8038	del=112	ins=187	het=10	unaligned=529303
173	SAL_VA4537AA_AS.out	snp=1965	del=31	ins=54	het=0	unaligned=489119
174	SAL_WA2841AA_AS.out	snp=17	del=1	ins=1	het=0	unaligned=470280
175	SAL_WA5013AA_AS.out	snp=2261	del=32	ins=57	het=153	unaligned=475573
176	SAL_WA5463AA_AS.out	snp=2280	del=28	ins=52	het=189	unaligned=466557
177	SAL_WA5465AA_AS.out	snp=2268	del=27	ins=52	het=117	unaligned=464593
178	SAL_WA6251AA_AS.out	snp=332	del=23	ins=41	het=638	unaligned=476043
179	SAL_WA9926AA_AS.out	snp=23	del=3	ins=3	het=0	unaligned=447251
180	SAL_XA1299AA_AS.out	snp=22	del=12	ins=3	het=31	unaligned=440057
181	SAL_XA1733AA_AS.out	snp=79	del=13	ins=3	het=0	unaligned=519870
182	SAL_XA1782AA_AS.out	snp=140	del=2	ins=3	het=3	unaligned=468274
183	SAL_XA3156AA_AS.out	snp=26	del=1	ins=3	het=0	unaligned=427275
184	SAL_XA3268AA_AS.out	snp=92	del=37	ins=11	het=0	unaligned=479344
185	SAL_YA6600AA_AS.out	snp=2399	del=23	ins=72	het=96	unaligned=435696
186	SAL_YA6602AA_AS.out	snp=2403	del=24	ins=72	het=95	unaligned=443666
187	SAL_YA6631AA_AS.out	snp=2647	del=62	ins=82	het=0	unaligned=514171
188	SAL_YA6663AA_AS.out	snp=60	del=1	ins=10	het=0	unaligned=492831
189	SAL_YA7748AA_AS.out	snp=2007	del=22	ins=52	het=0	unaligned=489864
190	SAL_YA9385AA_AS.out	snp=1870	del=19	ins=48	het=0	unaligned=511360
191	SAL_ZA0287AA_AS.out	snp=2133	del=14	ins=57	het=0	unaligned=492379
192	SAL_ZA5298AA_AS.out	snp=403	del=22	ins=32	het=188	unaligned=444993
193	SAL_ZA8731AA_AS.out	snp=2260	del=58	ins=52	het=169	unaligned=468559
Opening: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.tab
Opening: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.vcf
Processing contig: CP048775.1
Processing contig: CP048776.1
Processing contig: CP048777.1
Generating /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.full.aln
Creating TSV file: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.txt
Running: snp-sites -c -o /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.aln /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.full.aln
The Snippy manual is at http://github.com/tseemann/snippy/blob/master/README.md
Done.
[Fri Jun 19 11:12:17 2020]
Finished job 200.
195 of 201 steps (97%) done

[Fri Jun 19 11:12:17 2020]
rule snippy_clean:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.full.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.clean.full.aln
    jobid: 199
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32

snippy-clean_full_aln /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.full.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.clean.full.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Fri Jun 19 11:12:48 2020]
Finished job 199.
196 of 201 steps (98%) done

[Fri Jun 19 11:12:48 2020]
rule gubbins:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.clean.full.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/gubbins/SG17-135.filtered_polymorphic_sites.fasta
    jobid: 198
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32


        run_gubbins.py -v -f 25 -p /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/gubbins/SG17-135 /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/core/SG17-135.clean.full.aln
        rm SG17-135.clean.full.aln.seq.joint.txt
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/0d285378


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 distinct randomized MP trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s SG17-135.clean.full.aln.phylip -n SG17-135.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.229 0.275 0.265 0.230 

Inference[0]: Time 181.118132 CAT-based likelihood -156149.014105, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 10.967822 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 24.728203 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 56.300032 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 129.013603 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 287.550231 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 653.525688 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.800103 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -156154.708656 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_1


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -156154.708656 .... 

Final GAMMA-based Score of best tree -156154.707064

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_1
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_1

Overall execution time: 360.386677 secs or 0.100107 hours or 0.004171 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmprpz2hmy1/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.967392 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 24.726764 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 56.295960 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 129.003723 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 287.526909 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 653.471233 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.895693 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmprpz2hmy1/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmprpz2hmy1/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmprpz2hmy1/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 42.074654



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2365 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.60%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2365
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_1.phylip -n SG17-135.clean.full.iteration_2 -t RAxML_result.SG17-135.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.163 0.349 0.341 0.147 

Inference[0]: Time 87.946870 CAT-based likelihood -28376.176280, best rearrangement setting 15


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 11.944616 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.194224 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 62.239093 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 143.001218 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 320.119910 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 728.969427 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -28377.182415 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_2


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -28377.182415 .... 

Final GAMMA-based Score of best tree -28377.181845

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_2
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_2

Overall execution time: 163.851447 secs or 0.045514 hours or 0.001896 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpsmgdxlmd/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.006876 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 21.929001 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.680846 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 109.551030 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 240.029192 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 540.854435 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.892836 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpsmgdxlmd/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpsmgdxlmd/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpsmgdxlmd/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 45.187378



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2385 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.10%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2385
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_2.phylip -n SG17-135.clean.full.iteration_3 -t RAxML_result.SG17-135.clean.full.iteration_2 


Partition: 0 with name: No Name Provided
Base frequencies: 0.163 0.349 0.341 0.146 

Inference[0]: Time 41.298957 CAT-based likelihood -28486.142037, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.003424 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.358081 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 62.658063 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 144.006038 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 322.493658 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 734.504959 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -28487.183564 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_3


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -28487.183564 .... 

Final GAMMA-based Score of best tree -28487.182321

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_3
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_3

Overall execution time: 115.737812 secs or 0.032149 hours or 0.001340 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpgwj7g2yr/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.006573 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 21.927874 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.678837 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 109.547694 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 240.022714 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 540.838186 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.892806 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpgwj7g2yr/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpgwj7g2yr/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpgwj7g2yr/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 45.048887



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2385 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.10%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2385
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_3.phylip -n SG17-135.clean.full.iteration_4 -t RAxML_result.SG17-135.clean.full.iteration_3 


Partition: 0 with name: No Name Provided
Base frequencies: 0.163 0.349 0.341 0.146 

Inference[0]: Time 40.590537 CAT-based likelihood -28486.136221, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.003427 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.358088 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 62.658077 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 144.006102 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 322.493804 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 734.505367 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -28487.180130 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_4


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -28487.180130 .... 

Final GAMMA-based Score of best tree -28487.177159

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_4
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_4

Overall execution time: 113.870317 secs or 0.031631 hours or 0.001318 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpywbgo845/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.006600 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 21.927939 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.678988 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 109.548034 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 240.023504 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 540.839949 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.892808 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpywbgo845/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpywbgo845/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpywbgo845/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.901922



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2385 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.10%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2385
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_4.phylip -n SG17-135.clean.full.iteration_5 -t RAxML_result.SG17-135.clean.full.iteration_4 


Partition: 0 with name: No Name Provided
Base frequencies: 0.163 0.349 0.341 0.146 

Inference[0]: Time 41.286063 CAT-based likelihood -28486.134990, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.003427 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.358089 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 62.658081 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 144.006100 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 322.493797 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 734.505222 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -28487.180844 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_5


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -28487.180844 .... 

Final GAMMA-based Score of best tree -28487.177161

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_5
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_5

Overall execution time: 115.955927 secs or 0.032210 hours or 0.001342 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4537 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.93%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4537
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmphrf29mn9/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.006591 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 21.927918 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.678939 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 109.547923 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 240.023247 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 540.839395 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.892808 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmphrf29mn9/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmphrf29mn9/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmphrf29mn9/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 44.601083

Sample Reference has missing data percentage of 0.0
Sample SAL_AB5642AA_AS.out has missing data percentage of 9.029036897296605
Sample SAL_AB5674AA_AS.out has missing data percentage of 9.983599907616048
Sample SAL_AB5906AA_AS.out has missing data percentage of 9.590288816301499
Sample SAL_AB5909AA_AS.out has missing data percentage of 9.685060001048054
Sample SAL_AB6160AA_AS.out has missing data percentage of 8.885201294151669
Sample SAL_AB7534AA_AS.out has missing data percentage of 8.596540259800754
Sample SAL_AB7542AA_AS.out has missing data percentage of 8.768362766161854
Sample SAL_AB7588AA_AS.out has missing data percentage of 9.121925467887843
Sample SAL_AB7634AA_AS.out has missing data percentage of 8.895118983155456
Sample SAL_AB8884AA_AS.out has missing data percentage of 8.736416550701517
Sample SAL_AB9321AA_AS.out has missing data percentage of 9.2003159686438
Sample SAL_BA5105AA_AS.out has missing data percentage of 10.007452823047855
Sample SAL_BA7932AA_AS.out has missing data percentage of 9.069949790486394
Sample SAL_BA7945AA_AS.out has missing data percentage of 9.706525684097345
Sample SAL_BA8052AA_AS.out has missing data percentage of 8.781987458296214
Sample SAL_BB0648AA_AS.out has missing data percentage of 9.837260621728472
Sample SAL_BB1066AA_AS.out has missing data percentage of 9.966015903237514
Sample SAL_BB1371AA_AS.out has missing data percentage of 9.562709489345762
Sample SAL_BB1424AA_AS.out has missing data percentage of 9.20856453581916
Sample SAL_BB1915AA_AS.out has missing data percentage of 9.440223118889994
Sample SAL_BB1956AA_AS.out has missing data percentage of 8.693892760863363
Sample SAL_BB2131AA_AS.out has missing data percentage of 9.456778478420778
Sample SAL_BB2593AA_AS.out has missing data percentage of 9.797939216793695
Sample SAL_BB2899AA_AS.out has missing data percentage of 9.455070539805645
Sample SAL_BB2967AA_AS.out has missing data percentage of 8.68911829609833
Sample SAL_BB2970AA_AS.out has missing data percentage of 9.277813683305482
Sample SAL_BB3127AA_AS.out has missing data percentage of 8.664818987619386
Sample SAL_BB4431AA_AS.out has missing data percentage of 8.984397592582889
Sample SAL_BB4524AA_AS.out has missing data percentage of 8.66740030393544
Sample SAL_BB4921AA_AS.out has missing data percentage of 9.513450987013844
Sample SAL_BB4937AA_AS.out has missing data percentage of 9.079498720016458
Sample SAL_BB5050AA_AS.out has missing data percentage of 9.097373850295298
Sample SAL_BB5062AA_AS.out has missing data percentage of 9.002525031975328
Sample SAL_BB6441AA_AS.out has missing data percentage of 8.568999749631725
Sample SAL_BB6687AA_AS.out has missing data percentage of 9.79627009496527
Sample SAL_BB7027AA_AS.out has missing data percentage of 8.776960684417583
Sample SAL_BB7197AA_AS.out has missing data percentage of 8.703480507180135
Sample SAL_BB7261AA_AS.out has missing data percentage of 8.732690139177588
Sample SAL_BB7947AA_AS.out has missing data percentage of 8.829673880766476
Sample SAL_BB8135AA_AS.out has missing data percentage of 8.666294025514274
Sample SAL_BB8331AA_AS.out has missing data percentage of 10.23829625359783
Sample SAL_BB9086AA_AS.out has missing data percentage of 8.765994942172693
Sample SAL_BB9562AA_AS.out has missing data percentage of 8.632756321798926
Sample SAL_BB9988AA_AS.out has missing data percentage of 8.708643139812244
Sample SAL_CA4728AA_AS.out has missing data percentage of 9.855912087741464
Sample SAL_CA4744AA_AS.out has missing data percentage of 9.588367385359472
Sample SAL_CA4803AA_AS.out has missing data percentage of 9.898727003479925
Sample SAL_CB0053AA_AS.out has missing data percentage of 8.833070349603389
Sample SAL_CB0088AA_AS.out has missing data percentage of 9.115734190407984
Sample SAL_CB1153AA_AS.out has missing data percentage of 9.136675846836724
Sample SAL_CB1324AA_AS.out has missing data percentage of 9.07274459912934
Sample SAL_CB1790AA_AS.out has missing data percentage of 8.68777911695692
Sample SAL_CB2372AA_AS.out has missing data percentage of 8.770730590151016
Sample SAL_CB2598AA_AS.out has missing data percentage of 9.099547590350923
Sample SAL_CB2669AA_AS.out has missing data percentage of 8.730943383775747
Sample SAL_CB3409AA_AS.out has missing data percentage of 9.760675101554419
Sample SAL_CB3497AA_AS.out has missing data percentage of 8.833807868550833
Sample SAL_CB5243AA_AS.out has missing data percentage of 9.034820598516035
Sample SAL_CB5376AA_AS.out has missing data percentage of 9.539768768401583
Sample SAL_CB5379AA_AS.out has missing data percentage of 8.733388841338325
Sample SAL_CB5468AA_AS.out has missing data percentage of 8.694397379090562
Sample SAL_CB6250AA_AS.out has missing data percentage of 9.784974410033364
Sample SAL_CB9243AA_AS.out has missing data percentage of 8.770885857297847
Sample SAL_CB9389AA_AS.out has missing data percentage of 9.10240062417393
Sample SAL_CB9820AA_AS.out has missing data percentage of 9.145099089552268
Sample SAL_CB9822AA_AS.out has missing data percentage of 8.856379830021291
Sample SAL_CB9835AA_AS.out has missing data percentage of 9.588367385359472
Sample SAL_CB9988AA_AS.out has missing data percentage of 9.419786080688455
Sample SAL_DB1444AA_AS.out has missing data percentage of 9.850419512422341
Sample SAL_EA3229AA_AS.out has missing data percentage of 9.603020722341585
Sample SAL_EB1026AA_AS.out has missing data percentage of 8.72158853817922
Sample SAL_EB1045AA_AS.out has missing data percentage of 9.141566761961878
Sample SAL_EB2895AA_AS.out has missing data percentage of 8.683140510945364
Sample SAL_EB4083AA_AS.out has missing data percentage of 9.761529070861984
Sample SAL_EB4088AA_AS.out has missing data percentage of 8.757319390343548
Sample SAL_EB5876AA_AS.out has missing data percentage of 10.070355425907488
Sample SAL_EB6812AA_AS.out has missing data percentage of 8.721452679425745
Sample SAL_EB8845AA_AS.out has missing data percentage of 8.579402648469356
Sample SAL_FA1940AA_AS.out has missing data percentage of 9.774726778342561
Sample SAL_FA2493AA_AS.out has missing data percentage of 9.340522202231577
Sample SAL_FA5706AA_AS.out has missing data percentage of 9.52208772205628
Sample SAL_FB5769AA_AS.out has missing data percentage of 9.007357721920421
Sample SAL_FB7879AA_AS.out has missing data percentage of 9.492412288618336
Sample SAL_FB8051AA_AS.out has missing data percentage of 10.644572151672712
Sample SAL_GB0225AA_AS.out has missing data percentage of 8.777212993531183
Sample SAL_GB5373AA_AS.out has missing data percentage of 9.903404426278188
Sample SAL_HB2219AA_AS.out has missing data percentage of 8.6656535485336
Sample SAL_HB2224AA_AS.out has missing data percentage of 8.584875815395126
Sample SAL_HB2237AA_AS.out has missing data percentage of 9.892671584753543
Sample SAL_HB5660AA_AS.out has missing data percentage of 9.699325170163089
Sample SAL_HB6699AA_AS.out has missing data percentage of 9.291865360093626
Sample SAL_IA5065AA_AS.out has missing data percentage of 10.062281534272312
Sample SAL_IB1406AA_AS.out has missing data percentage of 9.123633406502977
Sample SAL_IB3115AA_AS.out has missing data percentage of 9.950469780161129
Sample SAL_IB6779AA_AS.out has missing data percentage of 10.016671809890905
Sample SAL_IB6801AA_AS.out has missing data percentage of 8.692883524408966
Sample SAL_IB7540AA_AS.out has missing data percentage of 9.144633288111777
Sample SAL_IB7996AA_AS.out has missing data percentage of 8.649893933130322
Sample SAL_IB9118AA_AS.out has missing data percentage of 9.39517623791585
Sample SAL_IB9302AA_AS.out has missing data percentage of 9.261588266461715
Sample SAL_JA4169AA_AS.out has missing data percentage of 8.977488204548939
Sample SAL_JB0953AA_AS.out has missing data percentage of 10.432981847329696
Sample SAL_JB1150AA_AS.out has missing data percentage of 10.240644669193639
Sample SAL_JB4414AA_AS.out has missing data percentage of 8.79338018519489
Sample SAL_JB5195AA_AS.out has missing data percentage of 13.999681702348997
Sample SAL_JB5221AA_AS.out has missing data percentage of 10.1134420591529
Sample SAL_JB6580AA_AS.out has missing data percentage of 8.96007887571059
Sample SAL_JB9521AA_AS.out has missing data percentage of 9.10587472658426
Sample SAL_JB9710AA_AS.out has missing data percentage of 9.061468322590787
Sample SAL_KA0676AA_AS.out has missing data percentage of 9.242179873107924
Sample SAL_KA0984AA_AS.out has missing data percentage of 9.471722941303195
Sample SAL_KA1119AA_AS.out has missing data percentage of 8.726692945631267
Sample SAL_KA4888AA_AS.out has missing data percentage of 8.44201063191788
Sample SAL_KA5244AA_AS.out has missing data percentage of 8.563196640018942
Sample SAL_KA8881AA_AS.out has missing data percentage of 9.12949474129582
Sample SAL_KB1136AA_AS.out has missing data percentage of 9.740665048006662
Sample SAL_KB1789AA_AS.out has missing data percentage of 10.225059729330546
Sample SAL_KB1826AA_AS.out has missing data percentage of 9.600614081565714
Sample SAL_KB2744AA_AS.out has missing data percentage of 8.646982674127253
Sample SAL_KB3375AA_AS.out has missing data percentage of 9.882986796470002
Sample SAL_KB3640AA_AS.out has missing data percentage of 10.466422509078276
Sample SAL_KB4026AA_AS.out has missing data percentage of 9.36532612893772
Sample SAL_KB4651AA_AS.out has missing data percentage of 10.73258921553215
Sample SAL_KB6210AA_AS.out has missing data percentage of 8.658685935319589
Sample SAL_KB6734AA_AS.out has missing data percentage of 9.85839636209075
Sample SAL_KB6773AA_AS.out has missing data percentage of 10.178615444034927
Sample SAL_KB6830AA_AS.out has missing data percentage of 9.868779852535027
Sample SAL_KB8607AA_AS.out has missing data percentage of 9.896029236803749
Sample SAL_KB8676AA_AS.out has missing data percentage of 9.476206280167922
Sample SAL_KB9523AA_AS.out has missing data percentage of 9.838172816216101
Sample SAL_LA4572AA_AS.out has missing data percentage of 9.725875852271074
Sample SAL_LA7782AA_AS.out has missing data percentage of 9.60434049308964
Sample SAL_LA7787AA_AS.out has missing data percentage of 9.542660619011297
Sample SAL_LB4034AA_AS.out has missing data percentage of 10.404762043393285
Sample SAL_LB8076AA_AS.out has missing data percentage of 9.187816963323959
Sample SAL_MA3067AA_AS.out has missing data percentage of 9.319502912229423
Sample SAL_MB2521AA_AS.out has missing data percentage of 9.088329538992433
Sample SAL_MB5439AA_AS.out has missing data percentage of 9.748467222134884
Sample SAL_MB7066AA_AS.out has missing data percentage of 9.143313517363719
Sample SAL_MB7965AA_AS.out has missing data percentage of 9.069076412785472
Sample SAL_NA2865AA_AS.out has missing data percentage of 8.817271917413404
Sample SAL_NA5728AA_AS.out has missing data percentage of 10.90738120607638
Sample SAL_NA8627AA_AS.out has missing data percentage of 9.558575501561405
Sample SAL_NB4129AA_AS.out has missing data percentage of 9.678325288554289
Sample SAL_NB6620AA_AS.out has missing data percentage of 8.722636591420326
Sample SAL_OA4067AA_AS.out has missing data percentage of 8.534743935362286
Sample SAL_OA4072AA_AS.out has missing data percentage of 8.60436184232233
Sample SAL_OB6949AA_AS.out has missing data percentage of 9.932788733815826
Sample SAL_PA3767AA_AS.out has missing data percentage of 9.796619446045638
Sample SAL_PB5476AA_AS.out has missing data percentage of 9.102478257747345
Sample SAL_PB8418AA_AS.out has missing data percentage of 9.957398576588432
Sample SAL_QA4878AA_AS.out has missing data percentage of 9.393468299300716
Sample SAL_QA5436AA_AS.out has missing data percentage of 9.190728222327028
Sample SAL_RA1578AA_AS.out has missing data percentage of 8.545709677607178
Sample SAL_RA1599AA_AS.out has missing data percentage of 8.609815600854745
Sample SAL_SA1324AA_AS.out has missing data percentage of 8.590659516614554
Sample SAL_SA1344AA_AS.out has missing data percentage of 8.55186213830033
Sample SAL_SA2453AA_AS.out has missing data percentage of 9.820918754524582
Sample SAL_SA9173AA_AS.out has missing data percentage of 9.812689595742574
Sample SAL_SA9246AA_AS.out has missing data percentage of 8.718289111309076
Sample SAL_SA9330AA_AS.out has missing data percentage of 11.61027557977723
Sample SAL_TA1544AA_AS.out has missing data percentage of 9.21009779889411
Sample SAL_TA1967AA_AS.out has missing data percentage of 10.550771386593846
Sample SAL_TA2587AA_AS.out has missing data percentage of 9.20928264637325
Sample SAL_TA4227AA_AS.out has missing data percentage of 9.183760609113017
Sample SAL_TA6324AA_AS.out has missing data percentage of 9.734958980360647
Sample SAL_TA7615AA_AS.out has missing data percentage of 9.52146665346896
Sample SAL_UA4237AA_AS.out has missing data percentage of 9.776415308564342
Sample SAL_UA4307AA_AS.out has missing data percentage of 9.206546062910366
Sample SAL_UA6621AA_AS.out has missing data percentage of 9.821209880424888
Sample SAL_UA7988AA_AS.out has missing data percentage of 10.198974848663052
Sample SAL_UA7989AA_AS.out has missing data percentage of 10.314823548591823
Sample SAL_VA1155AA_AS.out has missing data percentage of 10.605289563524641
Sample SAL_VA4537AA_AS.out has missing data percentage of 9.771213859145526
Sample SAL_WA2841AA_AS.out has missing data percentage of 9.439097432075476
Sample SAL_WA5013AA_AS.out has missing data percentage of 9.613113086885555
Sample SAL_WA5463AA_AS.out has missing data percentage of 9.449655598059937
Sample SAL_WA5465AA_AS.out has missing data percentage of 9.397447019938243
Sample SAL_WA6251AA_AS.out has missing data percentage of 9.63065827447738
Sample SAL_WA9926AA_AS.out has missing data percentage of 9.035247583169818
Sample SAL_XA1299AA_AS.out has missing data percentage of 8.870159789302482
Sample SAL_XA1733AA_AS.out has missing data percentage of 10.426402401982761
Sample SAL_XA1782AA_AS.out has missing data percentage of 9.484066679476205
Sample SAL_XA3156AA_AS.out has missing data percentage of 8.573308412956267
Sample SAL_XA3268AA_AS.out has missing data percentage of 9.590579942201805
Sample SAL_YA6600AA_AS.out has missing data percentage of 8.837281970961161
Sample SAL_YA6602AA_AS.out has missing data percentage of 8.97917673477072
Sample SAL_YA6631AA_AS.out has missing data percentage of 10.305255210668406
Sample SAL_YA6663AA_AS.out has missing data percentage of 9.849313234001176
Sample SAL_YA7748AA_AS.out has missing data percentage of 9.836542511174382
Sample SAL_YA9385AA_AS.out has missing data percentage of 10.250698216950903
Sample SAL_ZA0287AA_AS.out has missing data percentage of 10.184321511680942
Sample SAL_ZA5298AA_AS.out has missing data percentage of 9.002039822141484
Sample SAL_ZA8731AA_AS.out has missing data percentage of 9.473916089752175
gubbins /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln
1592529277
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s SG17-135.clean.full.aln.phylip -n SG17-135.clean.full.iteration_1 
1592529652
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmprpz2hmy1/rooted_tree.newick -n internal 
1592529694
1592529742
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_1 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592529783
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_1.phylip -n SG17-135.clean.full.iteration_2 -t RAxML_result.SG17-135.clean.full.iteration_1
1592529947
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpsmgdxlmd/rooted_tree.newick -n internal 
1592529993
1592530041
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_2 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592530081
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_2.phylip -n SG17-135.clean.full.iteration_3 -t RAxML_result.SG17-135.clean.full.iteration_2
1592530197
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpgwj7g2yr/rooted_tree.newick -n internal 
1592530242
1592530291
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_3 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592530330
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_3.phylip -n SG17-135.clean.full.iteration_4 -t RAxML_result.SG17-135.clean.full.iteration_3
1592530444
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpywbgo845/rooted_tree.newick -n internal 
1592530488
1592530536
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_4 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592530575
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_4.phylip -n SG17-135.clean.full.iteration_5 -t RAxML_result.SG17-135.clean.full.iteration_4
1592530691
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmphrf29mn9/rooted_tree.newick -n internal 
1592530736
1592530785
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmp4emdq6fn/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_5 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592530824
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.tab regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1 regex:^RAxML_result.SG17-135.clean.full.iteration_1$
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.gff regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.gff regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.gff regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4 regex:^RAxML_result.SG17-135.clean.full.iteration_4$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.gff regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.stats regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.stats regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.stats regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.tab regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3 regex:^RAxML_result.SG17-135.clean.full.iteration_3$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.tab regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2 regex:^RAxML_result.SG17-135.clean.full.iteration_2$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.tab regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_parsimonyTree.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.stats regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./SG17-135.clean.full.aln.phylip regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.vcf regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.vcf regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.start regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.phylip regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.snp_sites.aln regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.snp_sites.aln regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
[Fri Jun 19 11:40:29 2020]
Finished job 198.
197 of 201 steps (98%) done

[Fri Jun 19 11:40:29 2020]
rule snp_sites:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/gubbins/SG17-135.filtered_polymorphic_sites.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln
    jobid: 197
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32

snp-sites -c /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/gubbins/SG17-135.filtered_polymorphic_sites.fasta > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Fri Jun 19 11:40:30 2020]
Finished job 197.
198 of 201 steps (99%) done

[Fri Jun 19 11:40:30 2020]
rule fasttree:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/fasttree/SG17-135.clean.fullcore.tree
    jobid: 195
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32

fasttree -gtr -nt /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/fasttree/SG17-135.clean.fullcore.tree
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/89835887
FastTree Version 2.1.10 Double precision (No SSE3)
Alignment: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln
Nucleotide distances: Jukes-Cantor Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Generalized Time-Reversible, CAT approximation with 20 rate categories
      0.10 seconds: Joined    100 of    175
Initial topology in 0.15 seconds
Refining topology: 30 rounds ME-NNIs, 2 rounds ME-SPRs, 15 rounds ML-NNIs
      0.20 seconds: ME NNI round 6 of 30, 1 of 176 splits
      0.37 seconds: SPR round   1 of   2, 101 of 354 nodes
      0.53 seconds: SPR round   1 of   2, 201 of 354 nodes
      0.66 seconds: SPR round   1 of   2, 301 of 354 nodes
      0.92 seconds: SPR round   2 of   2, 101 of 354 nodes
      1.08 seconds: SPR round   2 of   2, 201 of 354 nodes
      1.21 seconds: SPR round   2 of   2, 301 of 354 nodes
Total branch-length 1.024 after 1.31 sec
      1.38 seconds: ML Lengths 101 of 176 splits
      1.74 seconds: ML NNI round 1 of 15, 101 of 176 splits, 20 changes (max delta 0.000)
ML-NNI round 1: LogLk = -14821.966 NNIs 43 max delta 0.00 Time 1.93
      1.93 seconds: Optimizing GTR model, step 1 of 12
      2.08 seconds: Optimizing GTR model, step 2 of 12
      2.24 seconds: Optimizing GTR model, step 3 of 12
      2.40 seconds: Optimizing GTR model, step 4 of 12
      2.65 seconds: Optimizing GTR model, step 5 of 12
      2.81 seconds: Optimizing GTR model, step 6 of 12
      2.94 seconds: Optimizing GTR model, step 7 of 12
      3.05 seconds: Optimizing GTR model, step 8 of 12
      3.15 seconds: Optimizing GTR model, step 9 of 12
      3.26 seconds: Optimizing GTR model, step 10 of 12
      3.38 seconds: Optimizing GTR model, step 11 of 12
      3.48 seconds: Optimizing GTR model, step 12 of 12
GTR Frequencies: 0.1579 0.3566 0.3507 0.1348
GTR rates(ac ag at cg ct gt) 1.1586 3.6445 1.8814 0.1557 3.8737 1.0000
      3.60 seconds: ML Lengths 1 of 176 splits
      3.70 seconds: ML Lengths 101 of 176 splits
      3.81 seconds: Site likelihoods with rate category 2 of 20
      3.91 seconds: Site likelihoods with rate category 11 of 20
      4.02 seconds: Site likelihoods with rate category 19 of 20
Switched to using 20 rate categories (CAT approximation)
Rate categories were divided by 0.790 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
Use -gamma for approximate but comparable Gamma(20) log-likelihoods
      4.32 seconds: ML NNI round 2 of 15, 101 of 176 splits, 12 changes (max delta 0.000)
ML-NNI round 2: LogLk = -14182.687 NNIs 22 max delta 0.00 Time 4.56
Turning off heuristics for final round of ML NNIs (converged)
      4.56 seconds: ML NNI round 3 of 15, 1 of 176 splits
      5.00 seconds: ML NNI round 3 of 15, 101 of 176 splits, 1 changes (max delta 0.000)
ML-NNI round 3: LogLk = -14182.181 NNIs 3 max delta 0.00 Time 5.29 (final)
      5.29 seconds: ML Lengths 1 of 176 splits
      5.40 seconds: ML Lengths 101 of 176 splits
Optimize all lengths: LogLk = -14182.181 Time 5.49
      6.05 seconds: ML split tests for    100 of    175 internal splits
Total time: 6.50 seconds Unique: 178/195 Bad splits: 0/175
[Fri Jun 19 11:40:37 2020]
Finished job 195.
199 of 201 steps (99%) done

[Fri Jun 19 11:40:37 2020]
rule snp_dists:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_dists/SG17-135.pairwise_snps.csv
    jobid: 196
    wildcards: output_prefix=Agona_195, reference=SG17-135
    threads: 32

snp-dists -c /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_sites/SG17-135.clean.fullcore.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_dists/SG17-135.pairwise_snps.csv
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/4ead7ed0
This is snp-dists 0.6.3
Read 195 sequences of length 1743
[Fri Jun 19 11:40:38 2020]
Finished job 196.
200 of 201 steps (100%) done

[Fri Jun 19 11:40:38 2020]
localrule all:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB0648AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5376AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7197AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA2587AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB6160AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9822AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA8052AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5674AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB5660AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6631AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0088AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1136AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5642AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4431AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7782AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA8627AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB1406AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6687AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7945AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5465AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA0287AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2593AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA9385AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB1150AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2131AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1956AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3640AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5909AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA5728AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9118AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6779AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB5876AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB2895AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6830AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1790AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA1155AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB6699AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB6620AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA8731AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9243AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB9302AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB6441AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9246AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7066AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB3115AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4026AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9330AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9086AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1153AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB2744AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2899AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA7787AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA7748AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB8076AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1733AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2219AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0676AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_DB1444AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7261AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4744AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA4227AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB3375AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5062AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4921AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EA3229AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA4878AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9835AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA4888AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1599AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB6250AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA8881AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5379AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1344AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB0953AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NB4129AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2598AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9820AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4083AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA9173AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3268AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB4088AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB8845AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB5439AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB6580AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OB6949AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB4651AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6773AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB3127AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB8884AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7989AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7534AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3497AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5468AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB0225AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA7932AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4072AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1826AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB0053AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4524AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA3156AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6663AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1371AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6210AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2237AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB1324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB1789AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB5769AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB9523AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA5706AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8676AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7634AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7588AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA7988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB7542AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB4937AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LB4034AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB8607AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB6801AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4728AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1782AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA1940AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4307AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7996AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA0984AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1045AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA9926AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7947AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB2521AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1915AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5195AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_RA1578AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA6251AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6602AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB5050AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_HB2224AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PA3767AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KB6734AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2970AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FA2493AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA7615AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1967AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB8051AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB1026AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA5244AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_YA6600AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB3409AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BA5105AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MB7965AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB9562AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB2967AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_ZA5298AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB4414AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5013AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_XA1299AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IB7540AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB9321AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JA4169AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB8418AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_FB7879AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB7027AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CA4803AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8331AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_LA4572AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA2453AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1424AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_VA4537AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA6324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_PB5476AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_QA5436AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9710AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB1066AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_OA4067AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2372AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB2669AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_EB6812AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_SA1324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_GB5373AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA6621AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB9389AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_TA1544AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA5463AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_CB5243AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_AB5906AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_KA1119AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB5221AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_IA5065AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_BB8135AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_UA4237AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_NA2865AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_JB9521AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_WA2841AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snippyout/SG17-135/SAL_MA3067AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/fasttree/SG17-135.clean.fullcore.tree, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_195/snp_dists/SG17-135.pairwise_snps.csv
    jobid: 0

[Fri Jun 19 11:40:38 2020]
Finished job 0.
201 of 201 steps (100%) done
Complete log: /data/malcummi/pipelord/snplord/.snakemake/log/2020-06-19T110213.003655.snakemake.log
['SAL_BB0648AA_AS', 'SAL_CB5376AA_AS', 'SAL_BB7197AA_AS', 'SAL_TA2587AA_AS', 'SAL_AB6160AA_AS', 'SAL_CB9822AA_AS', 'SAL_BA8052AA_AS', 'SAL_AB5674AA_AS', 'SAL_HB5660AA_AS', 'SAL_YA6631AA_AS', 'SAL_CB0088AA_AS', 'SAL_KB1136AA_AS', 'SAL_AB5642AA_AS', 'SAL_BB4431AA_AS', 'SAL_LA7782AA_AS', 'SAL_NA8627AA_AS', 'SAL_IB1406AA_AS', 'SAL_BB6687AA_AS', 'SAL_BA7945AA_AS', 'SAL_WA5465AA_AS', 'SAL_ZA0287AA_AS', 'SAL_BB2593AA_AS', 'SAL_YA9385AA_AS', 'SAL_JB1150AA_AS', 'SAL_BB2131AA_AS', 'SAL_BB1956AA_AS', 'SAL_KB3640AA_AS', 'SAL_AB5909AA_AS', 'SAL_NA5728AA_AS', 'SAL_IB9118AA_AS', 'SAL_IB6779AA_AS', 'SAL_EB5876AA_AS', 'SAL_EB2895AA_AS', 'SAL_KB6830AA_AS', 'SAL_CB1790AA_AS', 'SAL_VA1155AA_AS', 'SAL_HB6699AA_AS', 'SAL_NB6620AA_AS', 'SAL_ZA8731AA_AS', 'SAL_CB9243AA_AS', 'SAL_IB9302AA_AS', 'SAL_BB6441AA_AS', 'SAL_SA9246AA_AS', 'SAL_MB7066AA_AS', 'SAL_IB3115AA_AS', 'SAL_KB4026AA_AS', 'SAL_SA9330AA_AS', 'SAL_BB9086AA_AS', 'SAL_CB1153AA_AS', 'SAL_KB2744AA_AS', 'SAL_BB2899AA_AS', 'SAL_LA7787AA_AS', 'SAL_YA7748AA_AS', 'SAL_LB8076AA_AS', 'SAL_XA1733AA_AS', 'SAL_HB2219AA_AS', 'SAL_KA0676AA_AS', 'SAL_BB9988AA_AS', 'SAL_DB1444AA_AS', 'SAL_BB7261AA_AS', 'SAL_CA4744AA_AS', 'SAL_TA4227AA_AS', 'SAL_KB3375AA_AS', 'SAL_BB5062AA_AS', 'SAL_BB4921AA_AS', 'SAL_EA3229AA_AS', 'SAL_QA4878AA_AS', 'SAL_CB9835AA_AS', 'SAL_KA4888AA_AS', 'SAL_RA1599AA_AS', 'SAL_CB6250AA_AS', 'SAL_KA8881AA_AS', 'SAL_CB5379AA_AS', 'SAL_SA1344AA_AS', 'SAL_JB0953AA_AS', 'SAL_NB4129AA_AS', 'SAL_CB2598AA_AS', 'SAL_CB9820AA_AS', 'SAL_EB4083AA_AS', 'SAL_SA9173AA_AS', 'SAL_XA3268AA_AS', 'SAL_EB4088AA_AS', 'SAL_EB8845AA_AS', 'SAL_MB5439AA_AS', 'SAL_JB6580AA_AS', 'SAL_OB6949AA_AS', 'SAL_KB4651AA_AS', 'SAL_KB6773AA_AS', 'SAL_BB3127AA_AS', 'SAL_AB8884AA_AS', 'SAL_UA7989AA_AS', 'SAL_AB7534AA_AS', 'SAL_CB3497AA_AS', 'SAL_CB5468AA_AS', 'SAL_GB0225AA_AS', 'SAL_BA7932AA_AS', 'SAL_OA4072AA_AS', 'SAL_KB1826AA_AS', 'SAL_CB0053AA_AS', 'SAL_BB4524AA_AS', 'SAL_XA3156AA_AS', 'SAL_YA6663AA_AS', 'SAL_BB1371AA_AS', 'SAL_KB6210AA_AS', 'SAL_HB2237AA_AS', 'SAL_CB1324AA_AS', 'SAL_KB1789AA_AS', 'SAL_FB5769AA_AS', 'SAL_KB9523AA_AS', 'SAL_FA5706AA_AS', 'SAL_KB8676AA_AS', 'SAL_AB7634AA_AS', 'SAL_AB7588AA_AS', 'SAL_UA7988AA_AS', 'SAL_AB7542AA_AS', 'SAL_BB4937AA_AS', 'SAL_LB4034AA_AS', 'SAL_KB8607AA_AS', 'SAL_IB6801AA_AS', 'SAL_CA4728AA_AS', 'SAL_XA1782AA_AS', 'SAL_FA1940AA_AS', 'SAL_UA4307AA_AS', 'SAL_IB7996AA_AS', 'SAL_KA0984AA_AS', 'SAL_CB9988AA_AS', 'SAL_EB1045AA_AS', 'SAL_WA9926AA_AS', 'SAL_BB7947AA_AS', 'SAL_MB2521AA_AS', 'SAL_BB1915AA_AS', 'SAL_JB5195AA_AS', 'SAL_RA1578AA_AS', 'SAL_WA6251AA_AS', 'SAL_YA6602AA_AS', 'SAL_BB5050AA_AS', 'SAL_HB2224AA_AS', 'SAL_PA3767AA_AS', 'SAL_KB6734AA_AS', 'SAL_BB2970AA_AS', 'SAL_FA2493AA_AS', 'SAL_TA7615AA_AS', 'SAL_TA1967AA_AS', 'SAL_FB8051AA_AS', 'SAL_EB1026AA_AS', 'SAL_KA5244AA_AS', 'SAL_YA6600AA_AS', 'SAL_CB3409AA_AS', 'SAL_BA5105AA_AS', 'SAL_MB7965AA_AS', 'SAL_BB9562AA_AS', 'SAL_BB2967AA_AS', 'SAL_ZA5298AA_AS', 'SAL_JB4414AA_AS', 'SAL_WA5013AA_AS', 'SAL_XA1299AA_AS', 'SAL_IB7540AA_AS', 'SAL_AB9321AA_AS', 'SAL_JA4169AA_AS', 'SAL_PB8418AA_AS', 'SAL_FB7879AA_AS', 'SAL_BB7027AA_AS', 'SAL_CA4803AA_AS', 'SAL_BB8331AA_AS', 'SAL_LA4572AA_AS', 'SAL_SA2453AA_AS', 'SAL_BB1424AA_AS', 'SAL_VA4537AA_AS', 'SAL_TA6324AA_AS', 'SAL_PB5476AA_AS', 'SAL_QA5436AA_AS', 'SAL_JB9710AA_AS', 'SAL_BB1066AA_AS', 'SAL_OA4067AA_AS', 'SAL_CB2372AA_AS', 'SAL_CB2669AA_AS', 'SAL_EB6812AA_AS', 'SAL_SA1324AA_AS', 'SAL_GB5373AA_AS', 'SAL_UA6621AA_AS', 'SAL_CB9389AA_AS', 'SAL_TA1544AA_AS', 'SAL_WA5463AA_AS', 'SAL_CB5243AA_AS', 'SAL_AB5906AA_AS', 'SAL_KA1119AA_AS', 'SAL_JB5221AA_AS', 'SAL_IA5065AA_AS', 'SAL_BB8135AA_AS', 'SAL_UA4237AA_AS', 'SAL_NA2865AA_AS', 'SAL_JB9521AA_AS', 'SAL_WA2841AA_AS', 'SAL_MA3067AA_AS']
['SG17-135']
