Building DAG of jobs...
Using shell: /usr/bin/bash
Provided cores: 36
Rules claiming more threads will be scaled down.
Job counts:
	count	jobs
	1	all
	1	fasttree
	1	gubbins
	1	snippy_clean
	1	snippy_core
	195	snippy_run
	1	snp_dists
	1	snp_sites
	202

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
    jobid: 67
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_QA4878AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
    jobid: 103
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1371AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
    jobid: 173
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB9710AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
    jobid: 154
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA5298AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
    jobid: 44
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB7066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
    jobid: 171
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PB5476AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta

[Tue Jun 16 12:33:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
    jobid: 162
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB7879AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:33:51] This is snippy 4.4.3
[12:33:51] Written by Torsten Seemann
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Detected operating system: linux
[12:33:51] Enabling bundled linux tools.
[12:33:51] This is snippy 4.4.3
[12:33:51] Written by Torsten Seemann
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Detected operating system: linux
[12:33:51] Enabling bundled linux tools.
[12:33:51] This is snippy 4.4.3
[12:33:51] This is snippy 4.4.3
[12:33:51] This is snippy 4.4.3
[12:33:51] Written by Torsten Seemann
[12:33:51] This is snippy 4.4.3
[12:33:51] Written by Torsten Seemann
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] This is snippy 4.4.3
[12:33:51] Written by Torsten Seemann
[12:33:51] Detected operating system: linux
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Written by Torsten Seemann
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Enabling bundled linux tools.
[12:33:51] Written by Torsten Seemann
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Detected operating system: linux
[12:33:51] Detected operating system: linux
[12:33:51] Detected operating system: linux
[12:33:51] Obtained from https://github.com/tseemann/snippy
[12:33:51] Enabling bundled linux tools.
[12:33:51] Enabling bundled linux tools.
[12:33:51] Enabling bundled linux tools.
[12:33:51] Detected operating system: linux
[12:33:51] Enabling bundled linux tools.
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found gzip - /usr/bin/gzip
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:33:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:33:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:33:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta
[12:33:51] Will use 8 CPU cores.
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Creating reference folder: reference
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Treating reference as 'fasta' format.
[12:33:51] Will use 8 CPU cores.
[12:33:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta
[12:33:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[12:33:51] Creating reference folder: reference
[12:33:51] Extracting FASTA and GFF from reference.
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1371AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7066AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB5476AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA4878AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA5298AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB7879AA_AS.fasta into pseudo-reads
[12:33:51] Wrote 3 sequences to ref.fa
[12:33:51] Wrote 0 features to ref.gff
[12:33:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9710AA_AS.fasta into pseudo-reads
[12:33:54] Wrote 410326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:54] Using BAM RG (Read Group) ID: SAL_PB5476AA_AS.out
[12:33:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:55] Wrote 406280 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:55] Wrote 414490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:55] Using BAM RG (Read Group) ID: SAL_JB9710AA_AS.out
[12:33:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:55] Using BAM RG (Read Group) ID: SAL_FB7879AA_AS.out
[12:33:55] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:55] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:55] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:55] Wrote 406056 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:55] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:55] Using BAM RG (Read Group) ID: SAL_BB1371AA_AS.out
[12:33:55] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:55] Wrote 413060 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:55] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:56] Wrote 406412 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:56] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:56] Using BAM RG (Read Group) ID: SAL_ZA5298AA_AS.out
[12:33:56] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:56] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:57] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:57] Using BAM RG (Read Group) ID: SAL_QA4878AA_AS.out
[12:33:57] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:57] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:33:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:33:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:33:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:33:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:33:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320084 sequences (80000076 bp)...
[M::process] read 94406 sequences (23596172 bp)...
[12:33:57] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[12:33:57] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:57] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:57] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:33:57] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 86280 sequences (21535684 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 86056 sequences (21495038 bp)...
[M::process] read 320004 sequences (80000188 bp)...
[M::process] read 86408 sequences (21602000 bp)...
[12:33:58] Wrote 410630 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:33:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:33:58] Using BAM RG (Read Group) ID: SAL_MB7066AA_AS.out
[12:33:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:33:58] Running: bwa index reference/ref.fa 2>> snps.log
[12:33:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:33:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:33:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:33:59] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:33:59] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:33:59] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:33:59] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:33:59] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320090 sequences (80000262 bp)...
[M::process] read 320224 sequences (80000224 bp)...
[M::process] read 92836 sequences (23202520 bp)...
[M::process] read 90236 sequences (22559000 bp)...
[12:34:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320000 reads in 18.959 CPU sec, 2.828 real sec
[M::process] read 320000 sequences (80000000 bp)...
[M::mem_process_seqs] Processed 320084 reads in 22.782 CPU sec, 3.546 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86056 reads in 5.354 CPU sec, 0.667 real sec
[M::process] read 90630 sequences (22628860 bp)...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 94406 reads in 6.561 CPU sec, 0.791 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 406245, removed 1464, allowed 88, passed 404781
 -R @RG\tID:SAL_BB1371AA_AS.out\tSM:SAL_BB1371AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.648 sec; CPU: 24.921 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 19.804 CPU sec, 4.646 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB7879AA_AS.out\tSM:SAL_FB7879AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.247 sec; CPU: 29.903 sec
[samclip] Total SAM records 415359, removed 5083, allowed 375, passed 410276
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320004 reads in 19.881 CPU sec, 4.483 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86280 reads in 4.971 CPU sec, 0.604 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320224 reads in 20.478 CPU sec, 3.632 real sec
[M::mem_process_seqs] Processed 86408 reads in 4.969 CPU sec, 0.595 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320090 reads in 19.302 CPU sec, 3.955 real sec
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9710AA_AS.out\tSM:SAL_JB9710AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.308 sec; CPU: 25.378 sec
[samclip] Total SAM records 406763, removed 2268, allowed 107, passed 404495
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 92836 reads in 4.977 CPU sec, 0.598 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA5298AA_AS.out\tSM:SAL_ZA5298AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.173 sec; CPU: 25.457 sec
[samclip] Total SAM records 406715, removed 1929, allowed 105, passed 404786
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 90236 reads in 5.617 CPU sec, 0.663 real sec
[M::mem_process_seqs] Processed 320000 reads in 19.694 CPU sec, 3.492 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[12:34:04] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA4878AA_AS.out\tSM:SAL_QA4878AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.217 sec; CPU: 26.024 sec
[samclip] Total SAM records 413310, removed 2191, allowed 165, passed 411119
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[12:34:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[12:34:04] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB5476AA_AS.out\tSM:SAL_PB5476AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.504 sec; CPU: 25.485 sec
[samclip] Total SAM records 410862, removed 2313, allowed 84, passed 408549
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[12:34:04] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:04] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 90630 reads in 5.845 CPU sec, 0.677 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7066AA_AS.out\tSM:SAL_MB7066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.960 sec; CPU: 26.055 sec
[samclip] Total SAM records 410973, removed 1976, allowed 116, passed 408997
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:05] Running: samtools index snps.bam 2>> snps.log
[12:34:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:06] Running: samtools index snps.bam 2>> snps.log
[12:34:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:06] Running: samtools index snps.bam 2>> snps.log
[12:34:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:06] Running: samtools index snps.bam 2>> snps.log
[12:34:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:07] Running: samtools index snps.bam 2>> snps.log
[12:34:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 341
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:08] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:34:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:34:08] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2232
       total no. reference observed             : 0

Time elapsed: 0.03s

[12:34:08] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:08] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:08] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:08] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:08] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:08] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:08] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:08] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:34:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 392
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:09] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:34:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:34:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:09] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:09] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 459
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 383
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:10] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:13] Marked 432 heterozygous sites with 'n'
[12:34:13] Creating extra output files: BED GFF CSV TXT HTML
[12:34:13] Identified 341 variants.
[12:34:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out
[12:34:13] Result files:
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.aligned.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bam.bai
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.bed
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.consensus.subs.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.csv
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.filt.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.gff
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.html
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.log
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.raw.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.subs.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.tab
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.txt
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out/snps.vcf.gz.csi
[12:34:13] Walltime used: 22 seconds
[12:34:13] Wishing you a life free of homopolymer errors.
[12:34:13] Done.
[Tue Jun 16 12:34:13 2020]
Finished job 103.
1 of 202 steps (0.50%) done

[Tue Jun 16 12:34:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
    jobid: 184
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5463AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[12:34:13] Marked 169 heterozygous sites with 'n'
[12:34:13] Creating extra output files: BED GFF CSV TXT HTML
[12:34:13] Identified 2232 variants.
[12:34:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out
[12:34:13] Result files:
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.aligned.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bam.bai
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.bed
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.consensus.subs.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.csv
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.filt.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.gff
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.html
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.log
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.raw.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.subs.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.tab
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.txt
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out/snps.vcf.gz.csi
[12:34:13] Walltime used: 22 seconds
[12:34:13] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:34:13] Done.
[Tue Jun 16 12:34:13 2020]
Finished job 162.
2 of 202 steps (0.99%) done

[Tue Jun 16 12:34:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
    jobid: 72
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA8881AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:13] Marked 198 heterozygous sites with 'n'
[12:34:13] Creating extra output files: BED GFF CSV TXT HTML
[12:34:13] This is snippy 4.4.3
[12:34:13] Written by Torsten Seemann
[12:34:13] Obtained from https://github.com/tseemann/snippy
[12:34:13] Detected operating system: linux
[12:34:13] Enabling bundled linux tools.
[12:34:13] Identified 392 variants.
[12:34:13] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out
[12:34:13] Result files:
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.aligned.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bam.bai
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.bed
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.consensus.subs.fa
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.csv
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.filt.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.gff
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.html
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.log
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.raw.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.subs.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.tab
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.txt
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz
[12:34:13] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out/snps.vcf.gz.csi
[12:34:13] Walltime used: 22 seconds
[12:34:13] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:34:13] Done.
[12:34:13] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:13] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:13] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:13] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:13] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:13] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[Tue Jun 16 12:34:13 2020]
Finished job 173.
3 of 202 steps (1%) done

[Tue Jun 16 12:34:13 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
    jobid: 158
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB7540AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
[12:34:13] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:13] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:13] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:13] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:13] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:13] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:13] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:13] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:13] Found gzip - /usr/bin/gzip
[12:34:13] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:13] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:13] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:13] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:13] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:13] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:13] Marked 188 heterozygous sites with 'n'
[12:34:13] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:13] Creating extra output files: BED GFF CSV TXT HTML
[12:34:14] Identified 398 variants.
[12:34:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out
[12:34:14] Result files:
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.aligned.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bam.bai
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.bed
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.consensus.subs.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.csv
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.filt.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.gff
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.html
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.log
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.raw.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.subs.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.tab
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.txt
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out/snps.vcf.gz.csi
[12:34:14] Walltime used: 23 seconds
[12:34:14] May the SNPs be with you.
[12:34:14] Done.
[Tue Jun 16 12:34:14 2020]
Finished job 154.
4 of 202 steps (2%) done

[Tue Jun 16 12:34:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
    jobid: 39
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA8731AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[12:34:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:14] Treating reference as 'fasta' format.
[12:34:14] Will use 8 CPU cores.
[12:34:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta
[12:34:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[12:34:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[12:34:14] Creating reference folder: reference
[12:34:14] Extracting FASTA and GFF from reference.
[12:34:14] This is snippy 4.4.3
[12:34:14] Written by Torsten Seemann
[12:34:14] Obtained from https://github.com/tseemann/snippy
[12:34:14] Detected operating system: linux
[12:34:14] Enabling bundled linux tools.
[12:34:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:14] Wrote 3 sequences to ref.fa
[12:34:14] Wrote 0 features to ref.gff
[12:34:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5463AA_AS.fasta into pseudo-reads
[12:34:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:14] Found gzip - /usr/bin/gzip
[12:34:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:14] Treating reference as 'fasta' format.
[12:34:14] Will use 8 CPU cores.
[12:34:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta
[12:34:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[12:34:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[12:34:14] Creating reference folder: reference
[12:34:14] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:14] This is snippy 4.4.3
[12:34:14] Written by Torsten Seemann
[12:34:14] Obtained from https://github.com/tseemann/snippy
[12:34:14] Detected operating system: linux
[12:34:14] Enabling bundled linux tools.
[12:34:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:14] Found gzip - /usr/bin/gzip
[12:34:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:14] Wrote 3 sequences to ref.fa
[12:34:14] Wrote 0 features to ref.gff
[12:34:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA8881AA_AS.fasta into pseudo-reads
[12:34:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:14] This is snippy 4.4.3
[12:34:14] Written by Torsten Seemann
[12:34:14] Obtained from https://github.com/tseemann/snippy
[12:34:14] Detected operating system: linux
[12:34:14] Enabling bundled linux tools.
[12:34:14] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:14] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:14] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:14] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:14] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:14] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:14] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:14] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:14] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:14] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:14] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:14] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:14] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:14] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:14] Found gzip - /usr/bin/gzip
[12:34:14] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:14] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:14] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:14] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:14] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:14] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:14] Treating reference as 'fasta' format.
[12:34:14] Will use 8 CPU cores.
[12:34:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta
[12:34:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[12:34:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[12:34:14] Creating reference folder: reference
[12:34:14] Extracting FASTA and GFF from reference.
[12:34:14] Marked 441 heterozygous sites with 'n'
[12:34:14] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:14] Creating extra output files: BED GFF CSV TXT HTML
[12:34:14] Identified 459 variants.
[12:34:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out
[12:34:14] Result files:
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.aligned.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bam.bai
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.bed
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.consensus.subs.fa
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.csv
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.filt.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.gff
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.html
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.log
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.raw.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.subs.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.tab
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.txt
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz
[12:34:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out/snps.vcf.gz.csi
[12:34:14] Walltime used: 23 seconds
[12:34:14] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:34:14] Done.
[Tue Jun 16 12:34:14 2020]
Finished job 67.
5 of 202 steps (2%) done

[Tue Jun 16 12:34:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
    jobid: 127
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB1045AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[12:34:14] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:14] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:14] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:14] Treating reference as 'fasta' format.
[12:34:14] Will use 8 CPU cores.
[12:34:14] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta
[12:34:14] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[12:34:14] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[12:34:14] Creating reference folder: reference
[12:34:14] Extracting FASTA and GFF from reference.
[12:34:14] Wrote 3 sequences to ref.fa
[12:34:14] Wrote 0 features to ref.gff
[12:34:14] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7540AA_AS.fasta into pseudo-reads
[12:34:15] Wrote 3 sequences to ref.fa
[12:34:15] Wrote 0 features to ref.gff
[12:34:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA8731AA_AS.fasta into pseudo-reads
[12:34:15] Marked 150 heterozygous sites with 'n'
[12:34:15] Creating extra output files: BED GFF CSV TXT HTML
[12:34:15] Identified 383 variants.
[12:34:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out
[12:34:15] Result files:
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.aligned.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bam.bai
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.bed
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.consensus.subs.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.csv
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.filt.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.gff
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.html
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.log
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.raw.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.subs.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.tab
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.txt
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out/snps.vcf.gz.csi
[12:34:15] Walltime used: 24 seconds
[12:34:15] Questionable SNP? Try the --report option to see the alignments.
[12:34:15] Done.
[Tue Jun 16 12:34:15 2020]
Finished job 171.
6 of 202 steps (3%) done

[Tue Jun 16 12:34:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
    jobid: 1
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB0648AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:15] This is snippy 4.4.3
[12:34:15] Written by Torsten Seemann
[12:34:15] Obtained from https://github.com/tseemann/snippy
[12:34:15] Detected operating system: linux
[12:34:15] Enabling bundled linux tools.
[12:34:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:15] Found gzip - /usr/bin/gzip
[12:34:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:15] Marked 199 heterozygous sites with 'n'
[12:34:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:15] Creating extra output files: BED GFF CSV TXT HTML
[12:34:15] Identified 401 variants.
[12:34:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out
[12:34:15] Result files:
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.aligned.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bam.bai
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.bed
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.consensus.subs.fa
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.csv
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.filt.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.gff
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.html
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.log
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.raw.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.subs.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.tab
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.txt
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz
[12:34:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out/snps.vcf.gz.csi
[12:34:15] Walltime used: 24 seconds
[12:34:15] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:34:15] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Tue Jun 16 12:34:15 2020]
Finished job 44.
7 of 202 steps (3%) done

[Tue Jun 16 12:34:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
    jobid: 156
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5013AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
[12:34:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:15] Treating reference as 'fasta' format.
[12:34:15] Will use 8 CPU cores.
[12:34:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta
[12:34:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[12:34:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[12:34:15] Creating reference folder: reference
[12:34:15] Extracting FASTA and GFF from reference.
[12:34:15] This is snippy 4.4.3
[12:34:15] Written by Torsten Seemann
[12:34:15] Obtained from https://github.com/tseemann/snippy
[12:34:15] Detected operating system: linux
[12:34:15] Enabling bundled linux tools.
[12:34:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:16] Wrote 3 sequences to ref.fa
[12:34:16] Wrote 0 features to ref.gff
[12:34:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1045AA_AS.fasta into pseudo-reads
[12:34:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:16] Found gzip - /usr/bin/gzip
[12:34:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:16] Treating reference as 'fasta' format.
[12:34:16] Will use 8 CPU cores.
[12:34:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta
[12:34:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[12:34:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[12:34:16] Creating reference folder: reference
[12:34:16] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:16] Wrote 3 sequences to ref.fa
[12:34:16] Wrote 0 features to ref.gff
[12:34:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB0648AA_AS.fasta into pseudo-reads
[12:34:16] This is snippy 4.4.3
[12:34:16] Written by Torsten Seemann
[12:34:16] Obtained from https://github.com/tseemann/snippy
[12:34:16] Detected operating system: linux
[12:34:16] Enabling bundled linux tools.
[12:34:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:16] Found gzip - /usr/bin/gzip
[12:34:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:16] Treating reference as 'fasta' format.
[12:34:16] Will use 8 CPU cores.
[12:34:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta
[12:34:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[12:34:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[12:34:16] Creating reference folder: reference
[12:34:16] Extracting FASTA and GFF from reference.
[12:34:16] Wrote 3 sequences to ref.fa
[12:34:16] Wrote 0 features to ref.gff
[12:34:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5013AA_AS.fasta into pseudo-reads
[12:34:17] Wrote 410514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:17] Using BAM RG (Read Group) ID: SAL_WA5463AA_AS.out
[12:34:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:17] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:17] Wrote 413214 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:17] Using BAM RG (Read Group) ID: SAL_KA8881AA_AS.out
[12:34:17] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:17] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:17] Wrote 405032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:17] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:17] Using BAM RG (Read Group) ID: SAL_IB7540AA_AS.out
[12:34:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:18] Wrote 404780 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:18] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:18] Using BAM RG (Read Group) ID: SAL_ZA8731AA_AS.out
[12:34:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:18] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:18] Wrote 404984 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:18] Using BAM RG (Read Group) ID: SAL_EB1045AA_AS.out
[12:34:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:18] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:19] Wrote 406206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:19] Using BAM RG (Read Group) ID: SAL_BB0648AA_AS.out
[12:34:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:19] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320132 sequences (80000022 bp)...
[M::process] read 90382 sequences (22584208 bp)...
[12:34:19] Wrote 409500 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:19] Using BAM RG (Read Group) ID: SAL_WA5013AA_AS.out
[12:34:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:19] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:34:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:34:19] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:19] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:19] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:19] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:19] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320186 sequences (80000468 bp)...
[M::process] read 84780 sequences (21192786 bp)...
[M::process] read 93028 sequences (23245926 bp)...
[M::process] read 85032 sequences (21258000 bp)...
[12:34:20] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:20] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:20] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:20] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:20] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[12:34:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 84984 sequences (21244752 bp)...
[M::process] read 320116 sequences (80000194 bp)...
[M::process] read 86090 sequences (21522500 bp)...
[12:34:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:22] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320370 sequences (80000034 bp)...
[M::process] read 89130 sequences (22267784 bp)...
[M::mem_process_seqs] Processed 320000 reads in 19.330 CPU sec, 3.321 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 85032 reads in 4.410 CPU sec, 0.545 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320186 reads in 19.680 CPU sec, 4.139 real sec
[M::mem_process_seqs] Processed 320000 reads in 21.005 CPU sec, 4.357 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320132 reads in 21.769 CPU sec, 5.397 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7540AA_AS.out\tSM:SAL_IB7540AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.224 sec; CPU: 24.362 sec
[M::mem_process_seqs] Processed 93028 reads in 5.469 CPU sec, 0.667 real sec
[samclip] Total SAM records 405377, removed 2030, allowed 118, passed 403347
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 84780 reads in 4.610 CPU sec, 0.564 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320116 reads in 18.812 CPU sec, 3.644 real sec
[M::mem_process_seqs] Processed 320370 reads in 18.775 CPU sec, 2.821 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 19.517 CPU sec, 4.310 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 90382 reads in 5.020 CPU sec, 0.645 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 86090 reads in 4.762 CPU sec, 0.606 real sec
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA8881AA_AS.out\tSM:SAL_KA8881AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.004 sec; CPU: 25.701 sec
[samclip] Total SAM records 413454, removed 2921, allowed 296, passed 410533
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 84984 reads in 4.664 CPU sec, 0.575 real sec
[M::mem_process_seqs] Processed 89130 reads in 5.691 CPU sec, 0.709 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA8731AA_AS.out\tSM:SAL_ZA8731AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.342 sec; CPU: 26.259 sec
[samclip] Total SAM records 405148, removed 2630, allowed 279, passed 402518
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5463AA_AS.out\tSM:SAL_WA5463AA_AS.out -t 8[samclip] Total SAM records 411033, removed 3773, allowed 393, passed 407260
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 7.251 sec; CPU: 27.406 sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5013AA_AS.out\tSM:SAL_WA5013AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.587 sec; CPU: 25.040 sec
[samclip] Total SAM records 409939, removed 3495, allowed 278, passed 406444
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 400000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB0648AA_AS.out\tSM:SAL_BB0648AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.464 sec; CPU: 24.254 sec
[samclip] Total SAM records 406412, removed 1570, allowed 112, passed 404842
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB1045AA_AS.out\tSM:SAL_EB1045AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.016 sec; CPU: 24.807 sec
[samclip] Total SAM records 405367, removed 2039, allowed 122, passed 403328
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:27] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:27] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: samtools index snps.bam 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 398
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:34:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 715
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:31] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:32] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2007
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 26
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 27
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 1987
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:34:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 401
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 18

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 18
       total no. variants observed              : 338
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:36] Marked 224 heterozygous sites with 'n'
[12:34:36] Creating extra output files: BED GFF CSV TXT HTML
[12:34:36] Identified 398 variants.
[12:34:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out
[12:34:36] Result files:
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.aligned.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bam.bai
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.bed
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.consensus.subs.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.csv
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.filt.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.gff
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.html
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.log
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.raw.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.subs.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.tab
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.txt
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out/snps.vcf.gz.csi
[12:34:36] Walltime used: 22 seconds
[12:34:36] May the SNPs be with you.
[12:34:36] Done.
[Tue Jun 16 12:34:36 2020]
Finished job 158.
8 of 202 steps (4%) done

[Tue Jun 16 12:34:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
    jobid: 22
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2593AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[12:34:36] Marked 374 heterozygous sites with 'n'
[12:34:36] Creating extra output files: BED GFF CSV TXT HTML
[12:34:36] Identified 715 variants.
[12:34:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out
[12:34:36] Result files:
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.aligned.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bam.bai
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.bed
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.consensus.subs.fa
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.csv
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.filt.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.gff
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.html
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.log
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.raw.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.subs.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.tab
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.txt
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz
[12:34:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out/snps.vcf.gz.csi
[12:34:36] Walltime used: 22 seconds
[12:34:36] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:34:36] Done.
[Tue Jun 16 12:34:36 2020]
Finished job 72.
9 of 202 steps (4%) done

[Tue Jun 16 12:34:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
    jobid: 183
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA1544AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:36] This is snippy 4.4.3
[12:34:36] Written by Torsten Seemann
[12:34:36] Obtained from https://github.com/tseemann/snippy
[12:34:36] Detected operating system: linux
[12:34:36] Enabling bundled linux tools.
[12:34:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:36] Found gzip - /usr/bin/gzip
[12:34:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:37] Treating reference as 'fasta' format.
[12:34:37] Will use 8 CPU cores.
[12:34:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta
[12:34:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[12:34:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[12:34:37] Creating reference folder: reference
[12:34:37] Extracting FASTA and GFF from reference.
[12:34:37] This is snippy 4.4.3
[12:34:37] Written by Torsten Seemann
[12:34:37] Obtained from https://github.com/tseemann/snippy
[12:34:37] Detected operating system: linux
[12:34:37] Enabling bundled linux tools.
[12:34:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:37] Found gzip - /usr/bin/gzip
[12:34:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:37] Wrote 3 sequences to ref.fa
[12:34:37] Wrote 0 features to ref.gff
[12:34:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2593AA_AS.fasta into pseudo-reads
[12:34:37] Marked 189 heterozygous sites with 'n'
[12:34:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:37] Creating extra output files: BED GFF CSV TXT HTML
[12:34:37] Treating reference as 'fasta' format.
[12:34:37] Will use 8 CPU cores.
[12:34:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta
[12:34:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[12:34:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[12:34:37] Creating reference folder: reference
[12:34:37] Marked 169 heterozygous sites with 'n'
[12:34:37] Identified 2007 variants.
[12:34:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out
[12:34:37] Result files:
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.aligned.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bam.bai
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.bed
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.consensus.subs.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.csv
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.filt.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.gff
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.html
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.log
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.raw.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.subs.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.tab
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.txt
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out/snps.vcf.gz.csi
[12:34:37] Walltime used: 24 seconds
[12:34:37] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:34:37] Done.
[Tue Jun 16 12:34:37 2020]
Finished job 184.
10 of 202 steps (5%) done

[Tue Jun 16 12:34:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
    jobid: 142
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA2493AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[12:34:37] Marked 153 heterozygous sites with 'n'
[12:34:37] Extracting FASTA and GFF from reference.
[12:34:37] Marked 236 heterozygous sites with 'n'
[12:34:37] Wrote 3 sequences to ref.fa
[12:34:37] Wrote 0 features to ref.gff
[12:34:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1544AA_AS.fasta into pseudo-reads
[12:34:37] Creating extra output files: BED GFF CSV TXT HTML
[12:34:37] Identified 2000 variants.
[12:34:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out
[12:34:37] Result files:
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.aligned.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bam.bai
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.bed
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.consensus.subs.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.csv
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.filt.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.gff
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.html
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.log
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.raw.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.subs.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.tab
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.txt
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out/snps.vcf.gz.csi
[12:34:37] Walltime used: 23 seconds
[12:34:37] Questionable SNP? Try the --report option to see the alignments.
[12:34:37] Done.
[Tue Jun 16 12:34:37 2020]
Finished job 39.
11 of 202 steps (5%) done

[Tue Jun 16 12:34:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
    jobid: 88
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6773AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[12:34:37] Marked 430 heterozygous sites with 'n'
[12:34:37] Creating extra output files: BED GFF CSV TXT HTML
[12:34:37] Creating extra output files: BED GFF CSV TXT HTML
[12:34:37] Identified 401 variants.
[12:34:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out
[12:34:37] Result files:
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.aligned.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bam.bai
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.bed
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.consensus.subs.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.csv
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.filt.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.gff
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.html
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.log
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.raw.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.subs.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.tab
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.txt
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out/snps.vcf.gz.csi
[12:34:37] Walltime used: 22 seconds
[12:34:37] May the SNPs be with you.
[12:34:37] Done.
[12:34:37] Creating extra output files: BED GFF CSV TXT HTML
[12:34:37] Identified 338 variants.
[12:34:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out
[12:34:37] Result files:
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.aligned.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bam.bai
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.bed
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.consensus.subs.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.csv
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.filt.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.gff
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.html
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.log
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.raw.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.subs.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.tab
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.txt
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out/snps.vcf.gz.csi
[12:34:37] Walltime used: 22 seconds
[12:34:37] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:34:37] Done.
[12:34:37] Identified 1987 variants.
[12:34:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out
[12:34:37] Result files:
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.aligned.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bam.bai
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.bed
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.consensus.subs.fa
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.csv
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.filt.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.gff
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.html
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.log
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.raw.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.subs.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.tab
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.txt
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz
[12:34:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out/snps.vcf.gz.csi
[12:34:37] Walltime used: 21 seconds
[12:34:37] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:34:37] Done.
[Tue Jun 16 12:34:37 2020]
Finished job 127.
12 of 202 steps (6%) done

[Tue Jun 16 12:34:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
    jobid: 52
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA7787AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[Tue Jun 16 12:34:37 2020]
Finished job 1.
13 of 202 steps (6%) done
[Tue Jun 16 12:34:37 2020]
Finished job 156.
14 of 202 steps (7%) done

[Tue Jun 16 12:34:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
    jobid: 132
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB7623AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

[Tue Jun 16 12:34:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
    jobid: 151
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB7965AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[12:34:38] This is snippy 4.4.3
[12:34:38] Written by Torsten Seemann
[12:34:38] Obtained from https://github.com/tseemann/snippy
[12:34:38] Detected operating system: linux
[12:34:38] Enabling bundled linux tools.
[12:34:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:38] Found gzip - /usr/bin/gzip
[12:34:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:38] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:38] Treating reference as 'fasta' format.
[12:34:38] Will use 8 CPU cores.
[12:34:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta
[12:34:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[12:34:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[12:34:38] Creating reference folder: reference
[12:34:38] Extracting FASTA and GFF from reference.
[12:34:38] This is snippy 4.4.3
[12:34:38] Written by Torsten Seemann
[12:34:38] Obtained from https://github.com/tseemann/snippy
[12:34:38] Detected operating system: linux
[12:34:38] Enabling bundled linux tools.
[12:34:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:38] Found gzip - /usr/bin/gzip
[12:34:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:38] Wrote 3 sequences to ref.fa
[12:34:38] Wrote 0 features to ref.gff
[12:34:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA2493AA_AS.fasta into pseudo-reads
[12:34:38] This is snippy 4.4.3
[12:34:38] Written by Torsten Seemann
[12:34:38] Obtained from https://github.com/tseemann/snippy
[12:34:38] Detected operating system: linux
[12:34:38] Enabling bundled linux tools.
[12:34:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:38] Found gzip - /usr/bin/gzip
[12:34:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:38] Treating reference as 'fasta' format.
[12:34:38] Will use 8 CPU cores.
[12:34:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta
[12:34:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[12:34:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[12:34:38] Creating reference folder: reference
[12:34:38] Extracting FASTA and GFF from reference.
[12:34:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:38] This is snippy 4.4.3
[12:34:38] Written by Torsten Seemann
[12:34:38] Obtained from https://github.com/tseemann/snippy
[12:34:38] Detected operating system: linux
[12:34:38] Enabling bundled linux tools.
[12:34:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:38] This is snippy 4.4.3
[12:34:38] Written by Torsten Seemann
[12:34:38] Obtained from https://github.com/tseemann/snippy
[12:34:38] Detected operating system: linux
[12:34:38] Enabling bundled linux tools.
[12:34:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:38] Found gzip - /usr/bin/gzip
[12:34:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:38] Found gzip - /usr/bin/gzip
[12:34:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:38] Treating reference as 'fasta' format.
[12:34:38] Will use 8 CPU cores.
[12:34:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta
[12:34:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[12:34:38] Wrote 3 sequences to ref.fa
[12:34:38] Wrote 0 features to ref.gff
[12:34:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6773AA_AS.fasta into pseudo-reads
[12:34:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[12:34:38] Creating reference folder: reference
[12:34:38] Extracting FASTA and GFF from reference.
[12:34:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:38] Treating reference as 'fasta' format.
[12:34:38] Will use 8 CPU cores.
[12:34:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta
[12:34:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[12:34:38] Treating reference as 'fasta' format.
[12:34:38] Will use 8 CPU cores.
[12:34:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta
[12:34:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[12:34:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[12:34:38] Creating reference folder: reference
[12:34:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[12:34:38] Creating reference folder: reference
[12:34:38] Extracting FASTA and GFF from reference.
[12:34:38] Extracting FASTA and GFF from reference.
[12:34:38] Wrote 3 sequences to ref.fa
[12:34:38] Wrote 0 features to ref.gff
[12:34:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7787AA_AS.fasta into pseudo-reads
[12:34:39] Wrote 3 sequences to ref.fa
[12:34:39] Wrote 0 features to ref.gff
[12:34:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB7623AA_AS.fasta into pseudo-reads
[12:34:39] Wrote 3 sequences to ref.fa
[12:34:39] Wrote 0 features to ref.gff
[12:34:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB7965AA_AS.fasta into pseudo-reads
[12:34:40] Wrote 405698 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:40] Using BAM RG (Read Group) ID: SAL_BB2593AA_AS.out
[12:34:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:40] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:40] Wrote 407900 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:40] Using BAM RG (Read Group) ID: SAL_TA1544AA_AS.out
[12:34:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:40] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:41] Wrote 410746 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:41] Using BAM RG (Read Group) ID: SAL_FA2493AA_AS.out
[12:34:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:41] Wrote 407344 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:41] Using BAM RG (Read Group) ID: SAL_KB6773AA_AS.out
[12:34:41] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:41] Wrote 408542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:42] Using BAM RG (Read Group) ID: SAL_LA7787AA_AS.out
[12:34:42] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:42] Wrote 404884 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:42] Using BAM RG (Read Group) ID: SAL_MB7965AA_AS.out
[12:34:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:34:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:42] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:42] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:34:42] Wrote 415768 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:34:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:34:42] Using BAM RG (Read Group) ID: SAL_LB7623AA_AS.out
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:34:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:42] Running: bwa index reference/ref.fa 2>> snps.log
[12:34:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320008 sequences (80000064 bp)...
[M::process] read 85690 sequences (21422500 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 87900 sequences (21975000 bp)...
[12:34:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:34:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:34:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:34:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:34:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:34:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:34:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB7623AA_AS.out\tSM:SAL_LB7623AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 320582 sequences (80000206 bp)...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 90164 sequences (22499880 bp)...
[M::process] read 320040 sequences (80000138 bp)...
[M::process] read 320148 sequences (80000262 bp)...
[M::process] read 320126 sequences (80000292 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 95768 sequences (23942000 bp)...
[M::process] read 87304 sequences (21826000 bp)...
[M::process] read 84758 sequences (21189500 bp)...
[M::mem_process_seqs] Processed 320008 reads in 20.315 CPU sec, 2.927 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 85690 reads in 5.622 CPU sec, 0.706 real sec
[M::mem_process_seqs] Processed 320000 reads in 19.383 CPU sec, 3.610 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 87900 reads in 5.747 CPU sec, 0.704 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2593AA_AS.out\tSM:SAL_BB2593AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.867 sec; CPU: 26.533 sec
[samclip] Total SAM records 405987, removed 2166, allowed 277, passed 403821
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 88394 sequences (22098500 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA1544AA_AS.out\tSM:SAL_TA1544AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.400 sec; CPU: 25.742 sec
[samclip] Total SAM records 408288, removed 2066, allowed 153, passed 406222
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320126 reads in 17.960 CPU sec, 3.306 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320040 reads in 17.984 CPU sec, 3.579 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 20.453 CPU sec, 3.601 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 84758 reads in 4.555 CPU sec, 0.580 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 87304 reads in 5.378 CPU sec, 0.665 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320582 reads in 19.359 CPU sec, 4.512 real sec
[M::mem_process_seqs] Processed 95768 reads in 5.676 CPU sec, 0.708 real sec
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB7965AA_AS.out\tSM:SAL_MB7965AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.060 sec; CPU: 23.136 sec
[samclip] Total SAM records 405031, removed 687, allowed 84, passed 404344
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:49] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6773AA_AS.out\tSM:SAL_KB6773AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.337 sec; CPU: 23.992 sec
[samclip] Total SAM records 407629, removed 2177, allowed 226, passed 405452
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 90164 reads in 5.757 CPU sec, 0.682 real sec
[12:34:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[M::mem_process_seqs] Processed 320148 reads in 20.935 CPU sec, 5.121 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB7623AA_AS.out\tSM:SAL_LB7623AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.473 sec; CPU: 26.809 sec
[samclip] Total SAM records 416259, removed 9557, allowed 1022, passed 406702
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA2493AA_AS.out\tSM:SAL_FA2493AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.076 sec; CPU: 25.686 sec
[samclip] Total SAM records 411023, removed 3956, allowed 144, passed 407067
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[12:34:49] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 88394 reads in 5.858 CPU sec, 0.693 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7787AA_AS.out\tSM:SAL_LA7787AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 6.695 sec; CPU: 27.366 sec
[samclip] Total SAM records 409091, removed 3332, allowed 310, passed 405759
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:51] Running: samtools index snps.bam 2>> snps.log
[12:34:51] Running: samtools index snps.bam 2>> snps.log
[12:34:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:51] Running: samtools index snps.bam 2>> snps.log
[12:34:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:34:52] Running: samtools index snps.bam 2>> snps.log
[12:34:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:34:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1980
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:53] Running: samtools index snps.bam 2>> snps.log
[12:34:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:34:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 395
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:34:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:54] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:54] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:54] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 15
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 265
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:55] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:34:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2094
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 11
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 11

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 11
       total no. variants observed              : 231
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:34:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:55] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:56] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 2027
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:34:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:34:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:34:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:34:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:34:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:34:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:34:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:34:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:34:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:34:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:34:57] Running: rm -f fake_reads\.fq 2>> snps.log
[12:34:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:34:58] Marked 151 heterozygous sites with 'n'
[12:34:58] Marked 228 heterozygous sites with 'n'
[12:34:58] Creating extra output files: BED GFF CSV TXT HTML
[12:34:58] Identified 1980 variants.
[12:34:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out
[12:34:58] Result files:
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.aligned.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bam.bai
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.bed
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.consensus.subs.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.csv
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.filt.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.gff
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.html
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.log
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.raw.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.subs.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.tab
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.txt
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out/snps.vcf.gz.csi
[12:34:58] Walltime used: 22 seconds
[12:34:58] May the SNPs be with you.
[12:34:58] Done.
[Tue Jun 16 12:34:58 2020]
Finished job 22.
15 of 202 steps (7%) done

[Tue Jun 16 12:34:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
    jobid: 143
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA7615AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
[12:34:58] Creating extra output files: BED GFF CSV TXT HTML
[12:34:58] Identified 395 variants.
[12:34:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out
[12:34:58] Result files:
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.aligned.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bam.bai
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.bed
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.consensus.subs.fa
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.csv
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.filt.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.gff
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.html
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.log
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.raw.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.subs.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.tab
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.txt
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz
[12:34:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out/snps.vcf.gz.csi
[12:34:58] Walltime used: 21 seconds
[12:34:58] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:34:58] Done.
[Tue Jun 16 12:34:58 2020]
Finished job 183.
16 of 202 steps (8%) done

[Tue Jun 16 12:34:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
    jobid: 113
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7588AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:59] Marked 0 heterozygous sites with 'n'
[12:34:59] Creating extra output files: BED GFF CSV TXT HTML
[12:34:59] Identified 20 variants.
[12:34:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out
[12:34:59] Result files:
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.aligned.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bam.bai
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.bed
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.consensus.subs.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.csv
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.filt.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.gff
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.html
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.log
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.raw.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.subs.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.tab
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.txt
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out/snps.vcf.gz.csi
[12:34:59] Walltime used: 21 seconds
[12:34:59] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:34:59] Done.
[Tue Jun 16 12:34:59 2020]
Finished job 151.
17 of 202 steps (8%) done

[Tue Jun 16 12:34:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
    jobid: 16
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA8627AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[12:34:59] This is snippy 4.4.3
[12:34:59] Written by Torsten Seemann
[12:34:59] Obtained from https://github.com/tseemann/snippy
[12:34:59] Detected operating system: linux
[12:34:59] This is snippy 4.4.3
[12:34:59] Enabling bundled linux tools.
[12:34:59] Written by Torsten Seemann
[12:34:59] Obtained from https://github.com/tseemann/snippy
[12:34:59] Detected operating system: linux
[12:34:59] Enabling bundled linux tools.
[12:34:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:59] Found gzip - /usr/bin/gzip
[12:34:59] Found gzip - /usr/bin/gzip
[12:34:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:34:59] Marked 654 heterozygous sites with 'n'
[12:34:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:34:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:34:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:34:59] Treating reference as 'fasta' format.
[12:34:59] Will use 8 CPU cores.
[12:34:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta
[12:34:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[12:34:59] Treating reference as 'fasta' format.
[12:34:59] Will use 8 CPU cores.
[12:34:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta
[12:34:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[12:34:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[12:34:59] Creating reference folder: reference
[12:34:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[12:34:59] Creating reference folder: reference
[12:34:59] Extracting FASTA and GFF from reference.
[12:34:59] Extracting FASTA and GFF from reference.
[12:34:59] Creating extra output files: BED GFF CSV TXT HTML
[12:34:59] Identified 265 variants.
[12:34:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out
[12:34:59] Result files:
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.aligned.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bam.bai
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.bed
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.consensus.subs.fa
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.csv
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.filt.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.gff
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.html
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.log
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.raw.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.subs.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.tab
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.txt
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz
[12:34:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out/snps.vcf.gz.csi
[12:34:59] Walltime used: 21 seconds
[12:34:59] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:34:59] Done.
[Tue Jun 16 12:34:59 2020]
Finished job 88.
18 of 202 steps (9%) done

[Tue Jun 16 12:34:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
    jobid: 49
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1153AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:34:59] Wrote 3 sequences to ref.fa
[12:34:59] Wrote 0 features to ref.gff
[12:34:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA7615AA_AS.fasta into pseudo-reads
[12:34:59] Wrote 3 sequences to ref.fa
[12:34:59] Wrote 0 features to ref.gff
[12:34:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7588AA_AS.fasta into pseudo-reads
[12:34:59] This is snippy 4.4.3
[12:34:59] Written by Torsten Seemann
[12:34:59] Obtained from https://github.com/tseemann/snippy
[12:34:59] Detected operating system: linux
[12:34:59] Enabling bundled linux tools.
[12:34:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:34:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:34:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:34:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:34:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:34:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:34:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:34:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:34:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:34:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:34:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:34:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:34:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:34:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:34:59] Found gzip - /usr/bin/gzip
[12:34:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:34:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:34:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:34:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:34:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:34:59] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:00] Treating reference as 'fasta' format.
[12:35:00] Will use 8 CPU cores.
[12:35:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta
[12:35:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[12:35:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[12:35:00] Creating reference folder: reference
[12:35:00] Extracting FASTA and GFF from reference.
[12:35:00] Marked 97 heterozygous sites with 'n'
[12:35:00] This is snippy 4.4.3
[12:35:00] Written by Torsten Seemann
[12:35:00] Obtained from https://github.com/tseemann/snippy
[12:35:00] Detected operating system: linux
[12:35:00] Enabling bundled linux tools.
[12:35:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:00] Marked 12 heterozygous sites with 'n'
[12:35:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:00] Wrote 3 sequences to ref.fa
[12:35:00] Wrote 0 features to ref.gff
[12:35:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA8627AA_AS.fasta into pseudo-reads
[12:35:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:00] Found gzip - /usr/bin/gzip
[12:35:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:00] Creating extra output files: BED GFF CSV TXT HTML
[12:35:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:00] Identified 2094 variants.
[12:35:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out
[12:35:00] Result files:
[12:35:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.aligned.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bam
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bam.bai
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.bed
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.consensus.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.consensus.subs.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.csv
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.filt.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.gff
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.html
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.log
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.raw.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.subs.vcf
[12:35:00] Creating extra output files: BED GFF CSV TXT HTML
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.tab
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.txt
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf.gz
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out/snps.vcf.gz.csi
[12:35:00] Walltime used: 22 seconds
[12:35:00] Wishing you a life free of homopolymer errors.
[12:35:00] Done.
[12:35:00] Identified 231 variants.
[12:35:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out
[12:35:00] Result files:
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.aligned.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bam.bai
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.bed
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.consensus.subs.fa
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.csv
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.filt.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.gff
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.html
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.log
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.raw.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.subs.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.tab
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.txt
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz
[12:35:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out/snps.vcf.gz.csi
[12:35:00] Walltime used: 22 seconds
[12:35:00] May the SNPs be with you.
[12:35:00] Done.
[Tue Jun 16 12:35:00 2020]
Finished job 132.
19 of 202 steps (9%) done

[Tue Jun 16 12:35:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
    jobid: 53
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA7748AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[Tue Jun 16 12:35:00 2020]
Finished job 142.
20 of 202 steps (10%) done

[Tue Jun 16 12:35:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
    jobid: 33
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB2895AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
[12:35:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:00] Treating reference as 'fasta' format.
[12:35:00] Will use 8 CPU cores.
[12:35:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta
[12:35:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[12:35:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[12:35:00] Creating reference folder: reference
[12:35:00] Extracting FASTA and GFF from reference.
[12:35:00] Wrote 3 sequences to ref.fa
[12:35:00] Wrote 0 features to ref.gff
[12:35:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1153AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:00] This is snippy 4.4.3
[12:35:00] Written by Torsten Seemann
[12:35:00] Obtained from https://github.com/tseemann/snippy
[12:35:00] Detected operating system: linux
[12:35:00] Enabling bundled linux tools.
[12:35:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:00] This is snippy 4.4.3
[12:35:00] Written by Torsten Seemann
[12:35:00] Obtained from https://github.com/tseemann/snippy
[12:35:00] Detected operating system: linux
[12:35:00] Enabling bundled linux tools.
[12:35:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:01] Found gzip - /usr/bin/gzip
[12:35:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:01] Found gzip - /usr/bin/gzip
[12:35:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:01] Treating reference as 'fasta' format.
[12:35:01] Will use 8 CPU cores.
[12:35:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta
[12:35:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[12:35:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[12:35:01] Creating reference folder: reference
[12:35:01] Extracting FASTA and GFF from reference.
[12:35:01] Treating reference as 'fasta' format.
[12:35:01] Will use 8 CPU cores.
[12:35:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta
[12:35:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[12:35:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[12:35:01] Creating reference folder: reference
[12:35:01] Extracting FASTA and GFF from reference.
[12:35:01] Wrote 3 sequences to ref.fa
[12:35:01] Wrote 0 features to ref.gff
[12:35:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA7748AA_AS.fasta into pseudo-reads
[12:35:01] Wrote 3 sequences to ref.fa
[12:35:01] Wrote 0 features to ref.gff
[12:35:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB2895AA_AS.fasta into pseudo-reads
[12:35:01] Marked 69 heterozygous sites with 'n'
[12:35:01] Creating extra output files: BED GFF CSV TXT HTML
[12:35:01] Identified 2027 variants.
[12:35:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out
[12:35:01] Result files:
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.aligned.fa
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bam.bai
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.bed
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.fa
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.consensus.subs.fa
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.csv
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.filt.vcf
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.gff
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.html
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.log
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.raw.vcf
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.subs.vcf
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.tab
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.txt
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz
[12:35:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out/snps.vcf.gz.csi
[12:35:01] Walltime used: 23 seconds
[12:35:01] Questionable SNP? Try the --report option to see the alignments.
[12:35:01] Done.
[Tue Jun 16 12:35:01 2020]
Finished job 52.
21 of 202 steps (10%) done

[Tue Jun 16 12:35:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
    jobid: 20
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA5465AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:02] Wrote 403046 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:02] This is snippy 4.4.3
[12:35:02] Written by Torsten Seemann
[12:35:02] Obtained from https://github.com/tseemann/snippy
[12:35:02] Detected operating system: linux
[12:35:02] Enabling bundled linux tools.
[12:35:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:02] Using BAM RG (Read Group) ID: SAL_AB7588AA_AS.out
[12:35:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:02] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:02] Found gzip - /usr/bin/gzip
[12:35:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:02] Wrote 406744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:02] Using BAM RG (Read Group) ID: SAL_TA7615AA_AS.out
[12:35:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:02] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:02] Treating reference as 'fasta' format.
[12:35:02] Will use 8 CPU cores.
[12:35:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta
[12:35:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[12:35:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[12:35:02] Creating reference folder: reference
[12:35:02] Extracting FASTA and GFF from reference.
[12:35:03] Wrote 407736 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:03] Using BAM RG (Read Group) ID: SAL_NA8627AA_AS.out
[12:35:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:03] Wrote 3 sequences to ref.fa
[12:35:03] Wrote 0 features to ref.gff
[12:35:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA5465AA_AS.fasta into pseudo-reads
[12:35:03] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:03] Wrote 402534 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:03] Using BAM RG (Read Group) ID: SAL_CB1153AA_AS.out
[12:35:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:03] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:04] Wrote 404570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:04] Using BAM RG (Read Group) ID: SAL_EB2895AA_AS.out
[12:35:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:04] Wrote 405610 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:04] Using BAM RG (Read Group) ID: SAL_YA7748AA_AS.out
[12:35:04] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:35:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[12:35:04] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320138 sequences (80000040 bp)...
[M::process] read 83046 sequences (20734284 bp)...
[M::process] read 86606 sequences (21651500 bp)...
[12:35:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320356 sequences (80000092 bp)...
[M::process] read 87380 sequences (21841040 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 82534 sequences (20616314 bp)...
[12:35:06] Wrote 405876 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:06] Using BAM RG (Read Group) ID: SAL_WA5465AA_AS.out
[12:35:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:06] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:35:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320092 sequences (80000466 bp)...
[M::process] read 320278 sequences (80000248 bp)...
[M::process] read 85518 sequences (21375596 bp)...
[M::process] read 84292 sequences (21073000 bp)...
[M::mem_process_seqs] Processed 320138 reads in 19.667 CPU sec, 2.826 real sec
[12:35:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 19.325 CPU sec, 3.373 real sec
[M::mem_process_seqs] Processed 86606 reads in 6.018 CPU sec, 0.766 real sec
[M::process] read 320220 sequences (80000068 bp)...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 83046 reads in 4.447 CPU sec, 0.562 real sec
[M::process] read 85656 sequences (21413362 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320356 reads in 18.867 CPU sec, 3.561 real sec
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA7615AA_AS.out\tSM:SAL_TA7615AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 407133, removed 2739, allowed 331, passed 404394

[main] Real time: 4.832 sec; CPU: 26.298 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 87380 reads in 4.421 CPU sec, 0.535 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7588AA_AS.out\tSM:SAL_AB7588AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.232 sec; CPU: 24.394 sec
[samclip] Total SAM records 403383, removed 1599, allowed 139, passed 401784
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 19.384 CPU sec, 4.226 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320092 reads in 18.304 CPU sec, 3.215 real sec
[M::mem_process_seqs] Processed 320278 reads in 18.252 CPU sec, 3.256 real sec
[M::mem_process_seqs] Processed 82534 reads in 4.747 CPU sec, 0.566 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA8627AA_AS.out\tSM:SAL_NA8627AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.410 sec; CPU: 23.888 sec
[samclip] Total SAM records 407929, removed 1519, allowed 106, passed 406410
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 85518 reads in 6.015 CPU sec, 0.724 real sec
[M::mem_process_seqs] Processed 84292 reads in 5.000 CPU sec, 0.610 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1153AA_AS.out\tSM:SAL_CB1153AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.896 sec; CPU: 24.697 sec
[samclip] Total SAM records 402828, removed 1466, allowed 132, passed 401362
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA7748AA_AS.out\tSM:SAL_YA7748AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.906 sec; CPU: 24.914 sec
[samclip] Total SAM records 405840, removed 1509, allowed 205, passed 404331
[samclip] Header contained 5 lines
[samclip] Done.
[12:35:11] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB2895AA_AS.out\tSM:SAL_EB2895AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.979 sec; CPU: 23.884 sec
[samclip] Total SAM records 404840, removed 868, allowed 67, passed 403972
[samclip] Header contained 5 lines
[samclip] Done.
[12:35:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320220 reads in 21.417 CPU sec, 3.297 real sec
[12:35:11] Running: samtools index snps.bam 2>> snps.log
[12:35:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[12:35:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 85656 reads in 5.005 CPU sec, 0.584 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[12:35:12] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA5465AA_AS.out\tSM:SAL_WA5465AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.747 sec; CPU: 26.961 sec
[samclip] Total SAM records 406397, removed 2896, allowed 341, passed 403501
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:13] Running: samtools index snps.bam 2>> snps.log
[12:35:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:13] Running: samtools index snps.bam 2>> snps.log
[12:35:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:13] Running: samtools index snps.bam 2>> snps.log
[12:35:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:35:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 24
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 2004
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:15] Running: samtools index snps.bam 2>> snps.log
[12:35:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:15] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:15] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 333
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:35:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 351
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:16] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:16] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:35:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1803
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 35
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:17] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:17] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 2000
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:19] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:19] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:19] Marked 216 heterozygous sites with 'n'
[12:35:19] Creating extra output files: BED GFF CSV TXT HTML
[12:35:19] Identified 345 variants.
[12:35:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out
[12:35:19] Result files:
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.aligned.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bam.bai
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.bed
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.consensus.subs.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.csv
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.filt.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.gff
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.html
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.log
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.raw.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.subs.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.tab
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.txt
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out/snps.vcf.gz.csi
[12:35:19] Walltime used: 20 seconds
[12:35:19] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:35:19] Done.
[Tue Jun 16 12:35:19 2020]
Finished job 113.
22 of 202 steps (11%) done

[Tue Jun 16 12:35:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
    jobid: 159
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB9321AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[12:35:19] Marked 95 heterozygous sites with 'n'
[12:35:19] Creating extra output files: BED GFF CSV TXT HTML
[12:35:19] Identified 2004 variants.
[12:35:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out
[12:35:19] Result files:
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.aligned.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bam.bai
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.bed
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.consensus.subs.fa
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.csv
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.filt.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.gff
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.html
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.log
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.raw.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.subs.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.tab
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.txt
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz
[12:35:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out/snps.vcf.gz.csi
[12:35:19] Walltime used: 20 seconds
[12:35:19] May the SNPs be with you.
[12:35:19] Done.
[Tue Jun 16 12:35:19 2020]
Finished job 143.
23 of 202 steps (11%) done

[Tue Jun 16 12:35:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
    jobid: 148
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6600AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:20] This is snippy 4.4.3
[12:35:20] Written by Torsten Seemann
[12:35:20] Obtained from https://github.com/tseemann/snippy
[12:35:20] Detected operating system: linux
[12:35:20] Enabling bundled linux tools.
[12:35:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:20] Found gzip - /usr/bin/gzip
[12:35:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:20] This is snippy 4.4.3
[12:35:20] Written by Torsten Seemann
[12:35:20] Obtained from https://github.com/tseemann/snippy
[12:35:20] Detected operating system: linux
[12:35:20] Enabling bundled linux tools.
[12:35:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:20] Marked 431 heterozygous sites with 'n'
[12:35:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:20] Found gzip - /usr/bin/gzip
[12:35:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:20] Treating reference as 'fasta' format.
[12:35:20] Will use 8 CPU cores.
[12:35:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta
[12:35:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[12:35:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[12:35:20] Creating reference folder: reference
[12:35:20] Extracting FASTA and GFF from reference.
[12:35:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:20] Creating extra output files: BED GFF CSV TXT HTML
[12:35:20] Identified 333 variants.
[12:35:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out
[12:35:20] Result files:
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.aligned.fa
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bam.bai
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.bed
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.fa
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.consensus.subs.fa
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.csv
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.filt.vcf
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.gff
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.html
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.log
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.raw.vcf
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.subs.vcf
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.tab
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.txt
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz
[12:35:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out/snps.vcf.gz.csi
[12:35:20] Walltime used: 21 seconds
[12:35:20] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:35:20] Done.
[Tue Jun 16 12:35:20 2020]
Finished job 16.
24 of 202 steps (12%) done

[Tue Jun 16 12:35:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
    jobid: 110
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA5706AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[12:35:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:20] Wrote 3 sequences to ref.fa
[12:35:20] Wrote 0 features to ref.gff
[12:35:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB9321AA_AS.fasta into pseudo-reads
[12:35:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:20] Treating reference as 'fasta' format.
[12:35:20] Will use 8 CPU cores.
[12:35:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta
[12:35:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[12:35:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[12:35:20] Creating reference folder: reference
[12:35:20] Extracting FASTA and GFF from reference.
[12:35:20] Marked 216 heterozygous sites with 'n'
[12:35:21] Creating extra output files: BED GFF CSV TXT HTML
[12:35:21] Identified 351 variants.
[12:35:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out
[12:35:21] Result files:
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.aligned.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bam.bai
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.bed
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.consensus.subs.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.csv
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.filt.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.gff
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.html
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.log
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.raw.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.subs.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.tab
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.txt
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out/snps.vcf.gz.csi
[12:35:21] Walltime used: 21 seconds
[12:35:21] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:35:21] Done.
[Tue Jun 16 12:35:21 2020]
Finished job 49.
25 of 202 steps (12%) done

[Tue Jun 16 12:35:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
    jobid: 121
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
[12:35:21] Wrote 3 sequences to ref.fa
[12:35:21] Wrote 0 features to ref.gff
[12:35:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6600AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:21] This is snippy 4.4.3
[12:35:21] Written by Torsten Seemann
[12:35:21] Obtained from https://github.com/tseemann/snippy
[12:35:21] Detected operating system: linux
[12:35:21] Enabling bundled linux tools.
[12:35:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:21] Found gzip - /usr/bin/gzip
[12:35:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:21] Marked 0 heterozygous sites with 'n'
[12:35:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:21] Creating extra output files: BED GFF CSV TXT HTML
[12:35:21] Identified 1803 variants.
[12:35:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out
[12:35:21] Result files:
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.aligned.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bam.bai
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.bed
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.consensus.subs.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.csv
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.filt.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.gff
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.html
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.log
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.raw.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.subs.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.tab
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.txt
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out/snps.vcf.gz.csi
[12:35:21] Walltime used: 21 seconds
[12:35:21] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:35:21] Done.
[Tue Jun 16 12:35:21 2020]
Finished job 53.
26 of 202 steps (13%) done

[Tue Jun 16 12:35:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
    jobid: 15
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA7782AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[12:35:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:21] Treating reference as 'fasta' format.
[12:35:21] Will use 8 CPU cores.
[12:35:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta
[12:35:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[12:35:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[12:35:21] Creating reference folder: reference
[12:35:21] Extracting FASTA and GFF from reference.
[12:35:21] This is snippy 4.4.3
[12:35:21] Written by Torsten Seemann
[12:35:21] Obtained from https://github.com/tseemann/snippy
[12:35:21] Detected operating system: linux
[12:35:21] Enabling bundled linux tools.
[12:35:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:21] Found gzip - /usr/bin/gzip
[12:35:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:21] Marked 0 heterozygous sites with 'n'
[12:35:21] Wrote 3 sequences to ref.fa
[12:35:21] Wrote 0 features to ref.gff
[12:35:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA5706AA_AS.fasta into pseudo-reads
[12:35:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:21] Creating extra output files: BED GFF CSV TXT HTML
[12:35:21] Identified 35 variants.
[12:35:21] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out
[12:35:21] Result files:
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.aligned.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bam.bai
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.bed
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.consensus.subs.fa
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.csv
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.filt.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.gff
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.html
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.log
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.raw.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.subs.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.tab
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.txt
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz
[12:35:21] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out/snps.vcf.gz.csi
[12:35:21] Walltime used: 21 seconds
[12:35:21] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:35:21] Done.
[Tue Jun 16 12:35:21 2020]
Finished job 33.
27 of 202 steps (13%) done

[Tue Jun 16 12:35:21 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
    jobid: 136
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6602AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[12:35:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:22] Treating reference as 'fasta' format.
[12:35:22] Will use 8 CPU cores.
[12:35:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta
[12:35:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[12:35:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[12:35:22] Creating reference folder: reference
[12:35:22] Extracting FASTA and GFF from reference.
[12:35:22] Wrote 3 sequences to ref.fa
[12:35:22] Wrote 0 features to ref.gff
[12:35:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1782AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:22] This is snippy 4.4.3
[12:35:22] Written by Torsten Seemann
[12:35:22] Obtained from https://github.com/tseemann/snippy
[12:35:22] Detected operating system: linux
[12:35:22] Enabling bundled linux tools.
[12:35:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:22] Found gzip - /usr/bin/gzip
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:22] Treating reference as 'fasta' format.
[12:35:22] Will use 8 CPU cores.
[12:35:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta
[12:35:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[12:35:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[12:35:22] Creating reference folder: reference
[12:35:22] Extracting FASTA and GFF from reference.
[12:35:22] This is snippy 4.4.3
[12:35:22] Written by Torsten Seemann
[12:35:22] Obtained from https://github.com/tseemann/snippy
[12:35:22] Detected operating system: linux
[12:35:22] Enabling bundled linux tools.
[12:35:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:22] Found gzip - /usr/bin/gzip
[12:35:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:22] Wrote 3 sequences to ref.fa
[12:35:22] Wrote 0 features to ref.gff
[12:35:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA7782AA_AS.fasta into pseudo-reads
[12:35:22] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:22] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:22] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:22] Treating reference as 'fasta' format.
[12:35:22] Will use 8 CPU cores.
[12:35:22] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta
[12:35:22] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[12:35:22] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[12:35:22] Creating reference folder: reference
[12:35:22] Extracting FASTA and GFF from reference.
[12:35:23] Wrote 3 sequences to ref.fa
[12:35:23] Wrote 0 features to ref.gff
[12:35:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6602AA_AS.fasta into pseudo-reads
[12:35:23] Wrote 402154 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:23] Using BAM RG (Read Group) ID: SAL_AB9321AA_AS.out
[12:35:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:23] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:23] Marked 117 heterozygous sites with 'n'
[12:35:23] Wrote 404506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:23] Creating extra output files: BED GFF CSV TXT HTML
[12:35:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:23] Using BAM RG (Read Group) ID: SAL_YA6600AA_AS.out
[12:35:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:23] Identified 2000 variants.
[12:35:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out
[12:35:23] Result files:
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.aligned.fa
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bam.bai
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.bed
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.fa
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.consensus.subs.fa
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.csv
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.filt.vcf
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.gff
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.html
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.log
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.raw.vcf
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.subs.vcf
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.tab
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.txt
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz
[12:35:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out/snps.vcf.gz.csi
[12:35:23] Walltime used: 21 seconds
[12:35:23] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:35:23] Done.
[12:35:23] Running: bwa index reference/ref.fa 2>> snps.log
[Tue Jun 16 12:35:23 2020]
Finished job 20.
28 of 202 steps (14%) done

[Tue Jun 16 12:35:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
    jobid: 131
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1915AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:24] Wrote 404550 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:24] Using BAM RG (Read Group) ID: SAL_FA5706AA_AS.out
[12:35:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:24] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:25] Wrote 405058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:25] Using BAM RG (Read Group) ID: SAL_XA1782AA_AS.out
[12:35:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:25] This is snippy 4.4.3
[12:35:25] Written by Torsten Seemann
[12:35:25] Obtained from https://github.com/tseemann/snippy
[12:35:25] Detected operating system: linux
[12:35:25] Enabling bundled linux tools.
[12:35:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:25] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:25] Found gzip - /usr/bin/gzip
[12:35:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:25] Treating reference as 'fasta' format.
[12:35:25] Will use 8 CPU cores.
[12:35:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta
[12:35:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[12:35:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[12:35:25] Creating reference folder: reference
[12:35:25] Extracting FASTA and GFF from reference.
[12:35:25] Wrote 3 sequences to ref.fa
[12:35:25] Wrote 0 features to ref.gff
[12:35:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1915AA_AS.fasta into pseudo-reads
[12:35:25] Wrote 405414 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:25] Using BAM RG (Read Group) ID: SAL_LA7782AA_AS.out
[12:35:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:35:25] Running: bwa index reference/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:35:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:35:25] Wrote 404406 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:25] Using BAM RG (Read Group) ID: SAL_YA6602AA_AS.out
[12:35:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:25] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320054 sequences (80000362 bp)...
[M::process] read 82154 sequences (20501814 bp)...
[M::process] read 84452 sequences (21101846 bp)...
[12:35:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320182 sequences (80000392 bp)...
[M::process] read 84876 sequences (21209724 bp)...
[M::process] read 320054 sequences (80000082 bp)...
[M::process] read 84496 sequences (21118820 bp)...
[12:35:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:35:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:35:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320080 sequences (80000452 bp)...
[M::process] read 320150 sequences (80000310 bp)...
[12:35:28] Wrote 400510 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:28] Using BAM RG (Read Group) ID: SAL_BB1915AA_AS.out
[12:35:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::process] read 85334 sequences (21318726 bp)...
[12:35:28] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.863 CPU sec, 2.728 real sec
[M::process] read 84256 sequences (21053322 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 82154 reads in 5.156 CPU sec, 0.663 real sec
[M::mem_process_seqs] Processed 320054 reads in 19.093 CPU sec, 3.408 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320182 reads in 17.281 CPU sec, 2.936 real sec
[12:35:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 84452 reads in 5.700 CPU sec, 0.682 real sec
[samclip] Processed 200000 records...
[samclip] Processed 400000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[samclip] Total SAM records 402607, removed 1844, allowed 140, passed 400763
[main] CMD:[samclip] Header contained 5 lines
 bwa[samclip] Done.
 mem -Y -M -R @RG\tID:SAL_AB9321AA_AS.out\tSM:SAL_AB9321AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.591 sec; CPU: 24.615 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 84876 reads in 5.966 CPU sec, 0.722 real sec
[M::mem_process_seqs] Processed 320080 reads in 18.543 CPU sec, 2.666 real sec
[M::mem_process_seqs] Processed 320054 reads in 18.075 CPU sec, 3.631 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6600AA_AS.out\tSM:SAL_YA6600AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.197 sec; CPU: 25.385 sec
[samclip] Total SAM records 404993, removed 3185, allowed 439, passed 401808
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1782AA_AS.out\tSM:SAL_XA1782AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.723 sec; CPU: 23.776 sec
[samclip] Total SAM records 405367, removed 2700, allowed 170, passed 402667
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 85334 reads in 6.183 CPU sec, 0.741 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 80510 sequences (20127500 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 84496 reads in 6.837 CPU sec, 0.819 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320150 reads in 19.508 CPU sec, 3.937 real sec
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA7782AA_AS.out\tSM:SAL_LA7782AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 405778, removed 2756, allowed 243, passed 403022

[main] Real time: 4.352 sec; CPU: 25.288 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA5706AA_AS.out\tSM:SAL_FA5706AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.283 sec; CPU: 25.466 sec
[samclip] Total SAM records 404881, removed 2154, allowed 357, passed 402727
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[12:35:32] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[12:35:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 84256 reads in 5.758 CPU sec, 0.674 real sec
[samclip] Processed 300000 records...
[samclip] Processed 400000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:33] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6602AA_AS.out\tSM:SAL_YA6602AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.403 sec; CPU: 25.775 sec
[samclip] Total SAM records 404746, removed 3172, allowed 410, passed 401574
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:33] Running: samtools index snps.bam 2>> snps.log
[12:35:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.316 CPU sec, 3.267 real sec
[12:35:34] Running: samtools index snps.bam 2>> snps.log
[12:35:34] Running: samtools index snps.bam 2>> snps.log
[12:35:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 80510 reads in 4.631 CPU sec, 0.635 real sec
[samclip] Processed 100000 records...
[12:35:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[12:35:35] Running: samtools index snps.bam 2>> snps.log
[12:35:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 345
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[samclip] Processed 400000 records...
[12:35:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1915AA_AS.out\tSM:SAL_BB1915AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.720 sec; CPU: 24.592 sec
[12:35:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Total SAM records 400671, removed 744, allowed 46, passed 399927
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:36] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:36] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:36] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:36] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:36] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:36] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:36] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 130
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:35:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 25
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2099
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:37] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:37] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 2010
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1842
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:38] Running: samtools index snps.bam 2>> snps.log
[12:35:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:38] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:38] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:38] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 4
          no. right trimmed                     : 26
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 33

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 33
       total no. variants observed              : 2097
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:35:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:39] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:40] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:40] Marked 224 heterozygous sites with 'n'
[12:35:40] Creating extra output files: BED GFF CSV TXT HTML
[12:35:40] Identified 345 variants.
[12:35:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out
[12:35:40] Result files:
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.aligned.fa
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bam.bai
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.bed
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.fa
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.consensus.subs.fa
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.csv
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.filt.vcf
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.gff
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.html
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.log
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.raw.vcf
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.subs.vcf
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.tab
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.txt
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz
[12:35:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out/snps.vcf.gz.csi
[12:35:40] Walltime used: 20 seconds
[12:35:40] Questionable SNP? Try the --report option to see the alignments.
[12:35:40] Done.
[Tue Jun 16 12:35:40 2020]
Finished job 159.
29 of 202 steps (14%) done

[Tue Jun 16 12:35:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
    jobid: 94
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5468AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[12:35:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:41] Marked 3 heterozygous sites with 'n'
[12:35:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:41] Creating extra output files: BED GFF CSV TXT HTML
[12:35:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:41] Identified 130 variants.
[12:35:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out
[12:35:41] Result files:
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.aligned.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bam.bai
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.bed
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.consensus.subs.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.csv
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.filt.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.gff
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.html
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.log
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.raw.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.subs.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.tab
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.txt
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out/snps.vcf.gz.csi
[12:35:41] Walltime used: 20 seconds
[12:35:41] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:35:41] Done.
[12:35:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[Tue Jun 16 12:35:41 2020]
Finished job 121.
30 of 202 steps (15%) done
[12:35:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log

[Tue Jun 16 12:35:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
    jobid: 62
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA4227AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[12:35:41] This is snippy 4.4.3
[12:35:41] Written by Torsten Seemann
[12:35:41] Obtained from https://github.com/tseemann/snippy
[12:35:41] Detected operating system: linux
[12:35:41] Enabling bundled linux tools.
[12:35:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:41] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:41] Found gzip - /usr/bin/gzip
[12:35:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:41] Marked 96 heterozygous sites with 'n'
[12:35:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:41] Treating reference as 'fasta' format.
[12:35:41] Will use 8 CPU cores.
[12:35:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta
[12:35:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[12:35:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[12:35:41] Creating reference folder: reference
[12:35:41] Extracting FASTA and GFF from reference.
[12:35:41] Creating extra output files: BED GFF CSV TXT HTML
[12:35:41] Identified 2099 variants.
[12:35:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out
[12:35:41] Result files:
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.aligned.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bam.bai
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.bed
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.consensus.subs.fa
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.csv
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.filt.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.gff
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.html
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.log
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.raw.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.subs.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.tab
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.txt
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz
[12:35:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out/snps.vcf.gz.csi
[12:35:41] Walltime used: 21 seconds
[12:35:41] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:35:41] Done.
[Tue Jun 16 12:35:41 2020]
Finished job 148.
31 of 202 steps (15%) done

[Tue Jun 16 12:35:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
    jobid: 135
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA6251AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[12:35:41] Wrote 3 sequences to ref.fa
[12:35:41] Wrote 0 features to ref.gff
[12:35:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5468AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:42] This is snippy 4.4.3
[12:35:42] Written by Torsten Seemann
[12:35:42] Obtained from https://github.com/tseemann/snippy
[12:35:42] Detected operating system: linux
[12:35:42] Enabling bundled linux tools.
[12:35:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:42] Found gzip - /usr/bin/gzip
[12:35:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:42] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:42] Treating reference as 'fasta' format.
[12:35:42] Will use 8 CPU cores.
[12:35:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta
[12:35:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[12:35:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[12:35:42] Creating reference folder: reference
[12:35:42] Extracting FASTA and GFF from reference.
[12:35:42] This is snippy 4.4.3
[12:35:42] Written by Torsten Seemann
[12:35:42] Obtained from https://github.com/tseemann/snippy
[12:35:42] Detected operating system: linux
[12:35:42] Enabling bundled linux tools.
[12:35:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:42] Found gzip - /usr/bin/gzip
[12:35:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:42] Wrote 3 sequences to ref.fa
[12:35:42] Wrote 0 features to ref.gff
[12:35:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA4227AA_AS.fasta into pseudo-reads
[12:35:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:42] Marked 9 heterozygous sites with 'n'
[12:35:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:42] Creating extra output files: BED GFF CSV TXT HTML
[12:35:42] Identified 2010 variants.
[12:35:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out
[12:35:42] Result files:
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.aligned.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bam.bai
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.bed
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.consensus.subs.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.csv
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.filt.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.gff
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.html
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.log
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.raw.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.subs.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.tab
[12:35:42] Marked 7 heterozygous sites with 'n'
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.txt
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out/snps.vcf.gz.csi
[12:35:42] Walltime used: 20 seconds
[12:35:42] May the SNPs be with you.
[12:35:42] Done.
[Tue Jun 16 12:35:42 2020]
Finished job 15.
32 of 202 steps (16%) done

[Tue Jun 16 12:35:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
    jobid: 4
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA2587AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[12:35:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:42] Treating reference as 'fasta' format.
[12:35:42] Will use 8 CPU cores.
[12:35:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta
[12:35:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[12:35:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[12:35:42] Creating reference folder: reference
[12:35:42] Extracting FASTA and GFF from reference.
[12:35:42] Creating extra output files: BED GFF CSV TXT HTML
[12:35:42] Identified 1842 variants.
[12:35:42] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out
[12:35:42] Result files:
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.aligned.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bam.bai
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.bed
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.consensus.subs.fa
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.csv
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.filt.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.gff
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.html
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.log
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.raw.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.subs.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.tab
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.txt
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz
[12:35:42] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out/snps.vcf.gz.csi
[12:35:42] Walltime used: 21 seconds
[12:35:42] Questionable SNP? Try the --report option to see the alignments.
[12:35:42] Done.
[Tue Jun 16 12:35:42 2020]
Finished job 110.
33 of 202 steps (16%) done

[Tue Jun 16 12:35:42 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
    jobid: 54
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB8076AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[12:35:42] Wrote 3 sequences to ref.fa
[12:35:42] Wrote 0 features to ref.gff
[12:35:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA6251AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:43] This is snippy 4.4.3
[12:35:43] Written by Torsten Seemann
[12:35:43] Obtained from https://github.com/tseemann/snippy
[12:35:43] Detected operating system: linux
[12:35:43] Enabling bundled linux tools.
[12:35:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:43] Found gzip - /usr/bin/gzip
[12:35:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:43] This is snippy 4.4.3
[12:35:43] Written by Torsten Seemann
[12:35:43] Obtained from https://github.com/tseemann/snippy
[12:35:43] Detected operating system: linux
[12:35:43] Enabling bundled linux tools.
[12:35:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:43] Found gzip - /usr/bin/gzip
[12:35:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:43] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:43] Treating reference as 'fasta' format.
[12:35:43] Will use 8 CPU cores.
[12:35:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta
[12:35:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[12:35:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[12:35:43] Creating reference folder: reference
[12:35:43] Extracting FASTA and GFF from reference.
[12:35:43] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:43] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:43] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:43] Treating reference as 'fasta' format.
[12:35:43] Will use 8 CPU cores.
[12:35:43] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta
[12:35:43] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[12:35:43] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[12:35:43] Creating reference folder: reference
[12:35:43] Extracting FASTA and GFF from reference.
[12:35:43] Wrote 3 sequences to ref.fa
[12:35:43] Wrote 0 features to ref.gff
[12:35:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA2587AA_AS.fasta into pseudo-reads
[12:35:43] Wrote 3 sequences to ref.fa
[12:35:43] Wrote 0 features to ref.gff
[12:35:43] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB8076AA_AS.fasta into pseudo-reads
[12:35:44] Marked 95 heterozygous sites with 'n'
[12:35:44] Creating extra output files: BED GFF CSV TXT HTML
[12:35:44] Identified 2097 variants.
[12:35:44] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out
[12:35:44] Result files:
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.aligned.fa
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bam.bai
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.bed
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.fa
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.consensus.subs.fa
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.csv
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.filt.vcf
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.gff
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.html
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.log
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.raw.vcf
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.subs.vcf
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.tab
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.txt
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz
[12:35:44] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out/snps.vcf.gz.csi
[12:35:44] Walltime used: 22 seconds
[12:35:44] Questionable SNP? Try the --report option to see the alignments.
[12:35:44] Done.
[Tue Jun 16 12:35:44 2020]
Finished job 136.
34 of 202 steps (17%) done

[Tue Jun 16 12:35:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
    jobid: 172
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_QA5436AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
[12:35:44] Wrote 399890 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:44] Using BAM RG (Read Group) ID: SAL_CB5468AA_AS.out
[12:35:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:44] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:44] This is snippy 4.4.3
[12:35:44] Written by Torsten Seemann
[12:35:44] Obtained from https://github.com/tseemann/snippy
[12:35:44] Detected operating system: linux
[12:35:44] Enabling bundled linux tools.
[12:35:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:45] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:45] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:45] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:45] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:45] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:45] Found gzip - /usr/bin/gzip
[12:35:45] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:45] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:45] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:45] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:45] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:45] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:45] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:45] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:45] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:45] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:45] Treating reference as 'fasta' format.
[12:35:45] Will use 8 CPU cores.
[12:35:45] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta
[12:35:45] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[12:35:45] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[12:35:45] Creating reference folder: reference
[12:35:45] Extracting FASTA and GFF from reference.
[12:35:45] Wrote 3 sequences to ref.fa
[12:35:45] Wrote 0 features to ref.gff
[12:35:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_QA5436AA_AS.fasta into pseudo-reads
[12:35:45] Wrote 403620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:45] Using BAM RG (Read Group) ID: SAL_TA4227AA_AS.out
[12:35:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:45] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:45] Marked 0 heterozygous sites with 'n'
[12:35:45] Creating extra output files: BED GFF CSV TXT HTML
[12:35:45] Identified 19 variants.
[12:35:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out
[12:35:45] Result files:
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.aligned.fa
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bam.bai
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.bed
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.fa
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.consensus.subs.fa
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.csv
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.filt.vcf
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.gff
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.html
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.log
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.raw.vcf
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.subs.vcf
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.tab
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.txt
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz
[12:35:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out/snps.vcf.gz.csi
[12:35:45] Walltime used: 20 seconds
[12:35:45] Wishing you a life free of homopolymer errors.
[12:35:45] Done.
[12:35:45] Wrote 405514 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[Tue Jun 16 12:35:45 2020]
Finished job 131.
35 of 202 steps (17%) done

[Tue Jun 16 12:35:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
    jobid: 65
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4921AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[12:35:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:45] Using BAM RG (Read Group) ID: SAL_WA6251AA_AS.out
[12:35:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:45] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:35:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:46] Wrote 403896 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:46] Using BAM RG (Read Group) ID: SAL_TA2587AA_AS.out
[12:35:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:35:46] Wrote 399724 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:46] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:46] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:46] Using BAM RG (Read Group) ID: SAL_LB8076AA_AS.out
[12:35:46] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:46] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:46] This is snippy 4.4.3
[12:35:46] Written by Torsten Seemann
[12:35:46] Obtained from https://github.com/tseemann/snippy
[12:35:46] Detected operating system: linux
[12:35:46] Enabling bundled linux tools.
[12:35:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:35:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:35:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:35:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:35:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:35:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:35:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:35:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:35:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:35:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:35:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:35:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:35:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:35:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:35:46] Found gzip - /usr/bin/gzip
[12:35:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:35:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:35:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:35:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:35:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:35:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:35:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:35:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:35:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:35:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:35:47] Treating reference as 'fasta' format.
[12:35:47] Will use 8 CPU cores.
[12:35:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta
[12:35:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[12:35:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[12:35:47] Creating reference folder: reference
[12:35:47] Extracting FASTA and GFF from reference.
[M::process] read 320032 sequences (80000134 bp)...
[M::process] read 79858 sequences (19922496 bp)...
[12:35:47] Wrote 3 sequences to ref.fa
[12:35:47] Wrote 0 features to ref.gff
[12:35:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4921AA_AS.fasta into pseudo-reads
[12:35:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320186 sequences (80000138 bp)...
[M::process] read 83434 sequences (20847472 bp)...
[M::process] read 320166 sequences (80000378 bp)...
[M::process] read 85348 sequences (21329224 bp)...
[12:35:48] Wrote 403504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:48] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:48] Using BAM RG (Read Group) ID: SAL_QA5436AA_AS.out
[12:35:48] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:35:48] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:35:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320232 sequences (80000328 bp)...
[M::process] read 83664 sequences (20911040 bp)...
[M::process] read 320116 sequences (80000394 bp)...
[M::process] read 79608 sequences (19902000 bp)...
[M::mem_process_seqs] Processed 320032 reads in 18.269 CPU sec, 2.649 real sec
[12:35:50] Wrote 397582 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:35:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:35:50] Using BAM RG (Read Group) ID: SAL_BB4921AA_AS.out
[12:35:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[12:35:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:35:50] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:35:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[M::mem_process_seqs] Processed 79858 reads in 4.596 CPU sec, 0.563 real sec
[12:35:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::process] read 320164 sequences (80000414 bp)...
[samclip] Processed 300000 records...
[M::process] read 83340 sequences (20806156 bp)...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5468AA_AS.out\tSM:SAL_CB5468AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.402 sec; CPU: 23.484 sec
[samclip] Total SAM records 400217, removed 960, allowed 90, passed 399257
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320186 reads in 20.241 CPU sec, 3.364 real sec
[M::mem_process_seqs] Processed 320166 reads in 19.342 CPU sec, 3.297 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 83434 reads in 4.849 CPU sec, 0.592 real sec
[M::mem_process_seqs] Processed 85348 reads in 4.833 CPU sec, 0.583 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[12:35:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320116 reads in 19.042 CPU sec, 3.065 real sec
[12:35:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:35:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:35:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:35:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA4227AA_AS.out\tSM:SAL_TA4227AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.012 sec; CPU: 25.690 sec
[samclip] Total SAM records 403869, removed 2657, allowed 178, passed 401212
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[M::process] read 320000 sequences (80000000 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA6251AA_AS.out\tSM:SAL_WA6251AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.969 sec; CPU: 24.786 sec
[samclip] Total SAM records 405808, removed 2367, allowed 207, passed 403441
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320232 reads in 19.491 CPU sec, 3.679 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 77582 sequences (19392188 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 79608 reads in 5.384 CPU sec, 0.639 real sec
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 83664 reads in 5.116 CPU sec, 0.619 real sec
[samclip] Processed 200000 records...
[12:35:53] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB8076AA_AS.out\tSM:SAL_LB8076AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.648 sec; CPU: 24.991 sec
[samclip] Total SAM records 400362, removed 2981, allowed 142, passed 397381
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320164 reads in 18.388 CPU sec, 2.773 real sec
[12:35:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA2587AA_AS.out\tSM:SAL_TA2587AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.409 sec; CPU: 25.224 sec
[samclip] Total SAM records 404132, removed 2606, allowed 194, passed 401526
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 83340 reads in 6.052 CPU sec, 0.723 real sec
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_QA5436AA_AS.out\tSM:SAL_QA5436AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.307 sec; CPU: 24.977 sec
[samclip] Total SAM records 403759, removed 2662, allowed 189, passed 401097
[samclip] Header contained 5 lines
[samclip] Done.
[12:35:54] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:54] Running: samtools index snps.bam 2>> snps.log
[12:35:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:54] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:54] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:55] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.934 CPU sec, 2.927 real sec
[12:35:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:56] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 77582 reads in 4.618 CPU sec, 0.652 real sec
[12:35:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 100000 records...
[12:35:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:35:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[12:35:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:56] Running: samtools index snps.bam 2>> snps.log
[12:35:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:56] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[12:35:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4921AA_AS.out\tSM:SAL_BB4921AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.466 sec; CPU: 25.238 sec
[samclip] Total SAM records 397955, removed 1774, allowed 218, passed 396181
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:57] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 669
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:57] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:35:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 17
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 17

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 17
       total no. variants observed              : 317
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:58] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:58] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:35:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 388
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:35:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:59] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:35:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 18
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 687
       total no. reference observed             : 0

Time elapsed: 0.01s

[12:35:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:35:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:35:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:35:59] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:35:59] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:35:59] Running: samtools index snps.bam 2>> snps.log
[12:35:59] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:35:59] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:35:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:35:59] Running: rm -f fake_reads\.fq 2>> snps.log
[12:35:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:35:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 672
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:00] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:01] Marked 0 heterozygous sites with 'n'
[12:36:01] Creating extra output files: BED GFF CSV TXT HTML
[12:36:01] Identified 25 variants.
[12:36:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out
[12:36:01] Result files:
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.aligned.fa
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bam.bai
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.bed
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.fa
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.consensus.subs.fa
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.csv
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.filt.vcf
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.gff
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.html
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.log
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.raw.vcf
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.subs.vcf
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.tab
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.txt
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz
[12:36:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out/snps.vcf.gz.csi
[12:36:01] Walltime used: 20 seconds
[12:36:01] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:36:01] Done.
[Tue Jun 16 12:36:01 2020]
Finished job 94.
36 of 202 steps (18%) done

[Tue Jun 16 12:36:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
    jobid: 185
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:02] This is snippy 4.4.3
[12:36:02] Written by Torsten Seemann
[12:36:02] Obtained from https://github.com/tseemann/snippy
[12:36:02] Detected operating system: linux
[12:36:02] Enabling bundled linux tools.
[12:36:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:02] Found gzip - /usr/bin/gzip
[12:36:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:02] Marked 381 heterozygous sites with 'n'
[12:36:02] Treating reference as 'fasta' format.
[12:36:02] Will use 8 CPU cores.
[12:36:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta
[12:36:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[12:36:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[12:36:02] Creating reference folder: reference
[12:36:02] Extracting FASTA and GFF from reference.
[12:36:02] Creating extra output files: BED GFF CSV TXT HTML
[12:36:02] Identified 669 variants.
[12:36:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out
[12:36:02] Result files:
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.aligned.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bam.bai
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.bed
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.consensus.subs.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.csv
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.filt.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.gff
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.html
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.log
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.raw.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.subs.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.tab
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.txt
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out/snps.vcf.gz.csi
[12:36:02] Walltime used: 20 seconds
[12:36:02] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:36:02] Done.
[Tue Jun 16 12:36:02 2020]
Finished job 62.
37 of 202 steps (18%) done

[Tue Jun 16 12:36:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
    jobid: 69
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA4888AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[12:36:02] Marked 638 heterozygous sites with 'n'
[12:36:02] Wrote 3 sequences to ref.fa
[12:36:02] Wrote 0 features to ref.gff
[12:36:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5243AA_AS.fasta into pseudo-reads
[12:36:02] Creating extra output files: BED GFF CSV TXT HTML
[12:36:02] Identified 317 variants.
[12:36:02] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out
[12:36:02] Result files:
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.aligned.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bam.bai
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.bed
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.consensus.subs.fa
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.csv
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.filt.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.gff
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.html
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.log
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.raw.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.subs.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.tab
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.txt
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz
[12:36:02] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out/snps.vcf.gz.csi
[12:36:02] Walltime used: 20 seconds
[12:36:02] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:36:02] Done.
[Tue Jun 16 12:36:02 2020]
Finished job 135.
38 of 202 steps (19%) done

[Tue Jun 16 12:36:02 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
    jobid: 123
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA4307AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1932
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:36:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:03] Marked 0 heterozygous sites with 'n'
[12:36:03] This is snippy 4.4.3
[12:36:03] Written by Torsten Seemann
[12:36:03] Obtained from https://github.com/tseemann/snippy
[12:36:03] Detected operating system: linux
[12:36:03] Enabling bundled linux tools.
[12:36:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:03] Creating extra output files: BED GFF CSV TXT HTML
[12:36:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:03] Identified 388 variants.
[12:36:03] Found gzip - /usr/bin/gzip
[12:36:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out
[12:36:03] Result files:
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.aligned.fa
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bam.bai
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.bed
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.fa
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.consensus.subs.fa
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.csv
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.filt.vcf
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.gff
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.html
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.log
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.raw.vcf
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.subs.vcf
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.tab
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.txt
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz
[12:36:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out/snps.vcf.gz.csi
[12:36:03] Walltime used: 20 seconds
[12:36:03] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:03] Done.
[12:36:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[Tue Jun 16 12:36:03 2020]
Finished job 54.
39 of 202 steps (19%) done
[12:36:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9

[Tue Jun 16 12:36:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
    jobid: 76
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NB4129AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[12:36:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:03] This is snippy 4.4.3
[12:36:03] Written by Torsten Seemann
[12:36:03] Obtained from https://github.com/tseemann/snippy
[12:36:03] Detected operating system: linux
[12:36:03] Enabling bundled linux tools.
[12:36:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:03] Found gzip - /usr/bin/gzip
[12:36:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:03] Treating reference as 'fasta' format.
[12:36:03] Will use 8 CPU cores.
[12:36:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta
[12:36:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[12:36:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[12:36:03] Creating reference folder: reference
[12:36:03] Extracting FASTA and GFF from reference.
[12:36:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:03] Treating reference as 'fasta' format.
[12:36:03] Will use 8 CPU cores.
[12:36:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta
[12:36:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[12:36:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[12:36:03] Creating reference folder: reference
[12:36:03] Extracting FASTA and GFF from reference.
[12:36:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:03] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:03] Wrote 3 sequences to ref.fa
[12:36:03] Wrote 0 features to ref.gff
[12:36:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA4888AA_AS.fasta into pseudo-reads
[12:36:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:03] Wrote 3 sequences to ref.fa
[12:36:03] Wrote 0 features to ref.gff
[12:36:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4307AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:04] Marked 380 heterozygous sites with 'n'
[12:36:04] Creating extra output files: BED GFF CSV TXT HTML
[12:36:04] Identified 687 variants.
[12:36:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out
[12:36:04] Result files:
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.aligned.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bam.bai
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.bed
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.consensus.subs.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.csv
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.filt.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.gff
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.html
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.log
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.raw.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.subs.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.tab
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.txt
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out/snps.vcf.gz.csi
[12:36:04] Walltime used: 21 seconds
[12:36:04] Questionable SNP? Try the --report option to see the alignments.
[12:36:04] Done.
[Tue Jun 16 12:36:04 2020]
Finished job 4.
40 of 202 steps (20%) done

[Tue Jun 16 12:36:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
    jobid: 35
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1790AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
[12:36:04] This is snippy 4.4.3
[12:36:04] Written by Torsten Seemann
[12:36:04] Obtained from https://github.com/tseemann/snippy
[12:36:04] Detected operating system: linux
[12:36:04] Enabling bundled linux tools.
[12:36:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:04] Found gzip - /usr/bin/gzip
[12:36:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:04] Treating reference as 'fasta' format.
[12:36:04] Will use 8 CPU cores.
[12:36:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta
[12:36:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[12:36:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[12:36:04] Creating reference folder: reference
[12:36:04] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:04] Marked 364 heterozygous sites with 'n'
[12:36:04] Wrote 3 sequences to ref.fa
[12:36:04] Wrote 0 features to ref.gff
[12:36:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB4129AA_AS.fasta into pseudo-reads
[12:36:04] Creating extra output files: BED GFF CSV TXT HTML
[12:36:04] Identified 672 variants.
[12:36:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out
[12:36:04] Result files:
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.aligned.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bam.bai
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.bed
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.consensus.subs.fa
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.csv
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.filt.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.gff
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.html
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.log
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.raw.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.subs.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.tab
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.txt
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz
[12:36:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out/snps.vcf.gz.csi
[12:36:04] Walltime used: 20 seconds
[12:36:04] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:36:04] Done.
[Tue Jun 16 12:36:04 2020]
Finished job 172.
41 of 202 steps (20%) done

[Tue Jun 16 12:36:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
    jobid: 130
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB2521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
[12:36:04] This is snippy 4.4.3
[12:36:04] Written by Torsten Seemann
[12:36:04] Obtained from https://github.com/tseemann/snippy
[12:36:04] Detected operating system: linux
[12:36:04] Enabling bundled linux tools.
[12:36:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:04] Found gzip - /usr/bin/gzip
[12:36:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:05] Treating reference as 'fasta' format.
[12:36:05] Will use 8 CPU cores.
[12:36:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta
[12:36:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[12:36:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[12:36:05] Creating reference folder: reference
[12:36:05] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:05] Wrote 3 sequences to ref.fa
[12:36:05] Wrote 0 features to ref.gff
[12:36:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1790AA_AS.fasta into pseudo-reads
[12:36:05] Wrote 398166 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:05] This is snippy 4.4.3
[12:36:05] Written by Torsten Seemann
[12:36:05] Obtained from https://github.com/tseemann/snippy
[12:36:05] Detected operating system: linux
[12:36:05] Enabling bundled linux tools.
[12:36:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:05] Using BAM RG (Read Group) ID: SAL_CB5243AA_AS.out
[12:36:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:05] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:05] Found gzip - /usr/bin/gzip
[12:36:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:05] Treating reference as 'fasta' format.
[12:36:05] Will use 8 CPU cores.
[12:36:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta
[12:36:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[12:36:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[12:36:05] Creating reference folder: reference
[12:36:05] Extracting FASTA and GFF from reference.
[12:36:06] Wrote 3 sequences to ref.fa
[12:36:06] Wrote 0 features to ref.gff
[12:36:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB2521AA_AS.fasta into pseudo-reads
[12:36:06] Wrote 401826 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:06] Using BAM RG (Read Group) ID: SAL_KA4888AA_AS.out
[12:36:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:06] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:06] Wrote 401744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:06] Using BAM RG (Read Group) ID: SAL_UA4307AA_AS.out
[12:36:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:06] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:07] Wrote 395494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:07] Using BAM RG (Read Group) ID: SAL_NB4129AA_AS.out
[12:36:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:07] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 78166 sequences (19480154 bp)...
[12:36:08] Wrote 396332 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:08] Using BAM RG (Read Group) ID: SAL_CB1790AA_AS.out
[12:36:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:08] Marked 0 heterozygous sites with 'n'
[12:36:08] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:08] Creating extra output files: BED GFF CSV TXT HTML
[12:36:08] Identified 1932 variants.
[12:36:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out
[12:36:08] Result files:
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.aligned.fa
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bam.bai
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.bed
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.fa
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.consensus.subs.fa
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.csv
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.filt.vcf
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.gff
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.html
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.log
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.raw.vcf
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.subs.vcf
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.tab
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.txt
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz
[12:36:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out/snps.vcf.gz.csi
[12:36:08] Walltime used: 22 seconds
[12:36:08] Questionable SNP? Try the --report option to see the alignments.
[12:36:08] Done.
[Tue Jun 16 12:36:08 2020]
Finished job 65.
42 of 202 steps (21%) done

[Tue Jun 16 12:36:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
    jobid: 98
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1826AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
[12:36:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:36:08] Wrote 395948 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:08] Using BAM RG (Read Group) ID: SAL_MB2521AA_AS.out
[12:36:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:08] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:08] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:08] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:08] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:08] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:09] This is snippy 4.4.3
[12:36:09] Written by Torsten Seemann
[12:36:09] Obtained from https://github.com/tseemann/snippy
[12:36:09] Detected operating system: linux
[12:36:09] Enabling bundled linux tools.
[12:36:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::process] read 320224 sequences (80000284 bp)...
[12:36:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:09] Found gzip - /usr/bin/gzip
[12:36:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::process] read 320132 sequences (80000216 bp)...
[M::process] read 81602 sequences (20383156 bp)...
[12:36:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::process] read 81612 sequences (20380304 bp)...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:09] Treating reference as 'fasta' format.
[12:36:09] Will use 8 CPU cores.
[12:36:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta
[12:36:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[12:36:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[12:36:09] Creating reference folder: reference
[12:36:09] Extracting FASTA and GFF from reference.
[12:36:09] Wrote 3 sequences to ref.fa
[12:36:09] Wrote 0 features to ref.gff
[12:36:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1826AA_AS.fasta into pseudo-reads
[M::process] read 320018 sequences (80000346 bp)...
[M::process] read 75476 sequences (18869000 bp)...
[12:36:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320000 reads in 19.050 CPU sec, 2.698 real sec
[M::process] read 320046 sequences (80000154 bp)...
[samclip] Processed 100000 records...
[12:36:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:10] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:10] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:10] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:10] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 78166 reads in 4.940 CPU sec, 0.601 real sec
[samclip] Processed 200000 records...
[M::process] read 76286 sequences (19045174 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320224 reads in 17.620 CPU sec, 2.420 real sec
[M::process] read 75948 sequences (18967186 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5243AA_AS.out\tSM:SAL_CB5243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.379 sec; CPU: 24.564 sec
[samclip] Total SAM records 398723, removed 1507, allowed 93, passed 397216
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 81602 reads in 5.542 CPU sec, 0.672 real sec
[samclip] Processed 200000 records...
[12:36:12] Wrote 395606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:12] Using BAM RG (Read Group) ID: SAL_KB1826AA_AS.out
[12:36:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320132 reads in 19.031 CPU sec, 3.189 real sec
[12:36:12] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA4888AA_AS.out\tSM:SAL_KA4888AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.129 sec; CPU: 23.727 sec
[samclip] Total SAM records 402122, removed 1283, allowed 212, passed 400839
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 81612 reads in 5.591 CPU sec, 0.660 real sec
[M::mem_process_seqs] Processed 320018 reads in 19.479 CPU sec, 3.546 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 400000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4307AA_AS.out\tSM:SAL_UA4307AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.721 sec; CPU: 25.185 sec
[samclip] Total SAM records 401984, removed 2467, allowed 193, passed 399517
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320046 reads in 17.645 CPU sec, 3.214 real sec
[M::mem_process_seqs] Processed 75476 reads in 4.216 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[12:36:13] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 18.013 CPU sec, 2.757 real sec
[12:36:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 76286 reads in 4.771 CPU sec, 0.557 real sec
[samclip] Processed 100000 records...
[12:36:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NB4129AA_AS.out\tSM:SAL_NB4129AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 395722, removed 1343, allowed 191, passed 394379

[main] Real time: 5.024 sec; CPU: 24.267 sec
[samclip] Header contained 5 lines
[samclip] Done.
[12:36:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 75948 reads in 5.069 CPU sec, 0.598 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320140 sequences (80000052 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1790AA_AS.out\tSM:SAL_CB1790AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.660 sec; CPU: 22.985 sec
[samclip] Total SAM records 396567, removed 730, allowed 71, passed 395837
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::process] read 75466 sequences (18860340 bp)...
[12:36:15] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB2521AA_AS.out\tSM:SAL_MB2521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.227 sec; CPU: 23.605 sec
[samclip] Total SAM records 396515, removed 2385, allowed 111, passed 394130
[samclip] Header contained 5 lines
[samclip] Done.
[12:36:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:15] Running: samtools index snps.bam 2>> snps.log
[12:36:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:16] Running: samtools index snps.bam 2>> snps.log
[12:36:16] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:16] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:16] Running: samtools index snps.bam 2>> snps.log
[12:36:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:36:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:17] Running: samtools index snps.bam 2>> snps.log
[12:36:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:17] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:17] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 37
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320140 reads in 18.464 CPU sec, 3.779 real sec
[12:36:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:18] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 666
       total no. reference observed             : 0

Time elapsed: 0.01s

[12:36:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[12:36:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 75466 reads in 4.540 CPU sec, 0.571 real sec
[12:36:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[12:36:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:19] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1826AA_AS.out\tSM:SAL_KB1826AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.366 sec; CPU: 23.593 sec
[samclip] Total SAM records 395965, removed 1616, allowed 126, passed 394349
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:19] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1823
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:36:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 30
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:36:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 260
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:20] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:20] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:20] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:20] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:20] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:20] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:20] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:20] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:21] Running: samtools index snps.bam 2>> snps.log
[12:36:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:22] Marked 0 heterozygous sites with 'n'
[12:36:22] Creating extra output files: BED GFF CSV TXT HTML
[12:36:22] Identified 21 variants.
[12:36:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out
[12:36:22] Result files:
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.aligned.fa
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bam.bai
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.bed
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.fa
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.consensus.subs.fa
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.csv
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.filt.vcf
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.gff
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.html
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.log
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.raw.vcf
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.subs.vcf
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.tab
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.txt
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz
[12:36:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out/snps.vcf.gz.csi
[12:36:22] Walltime used: 20 seconds
[12:36:22] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:36:22] Done.
[Tue Jun 16 12:36:22 2020]
Finished job 185.
43 of 202 steps (21%) done

[Tue Jun 16 12:36:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
    jobid: 68
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9835AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:22] This is snippy 4.4.3
[12:36:22] Written by Torsten Seemann
[12:36:22] Obtained from https://github.com/tseemann/snippy
[12:36:22] Detected operating system: linux
[12:36:22] Enabling bundled linux tools.
[12:36:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:22] Found gzip - /usr/bin/gzip
[12:36:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:23] Marked 0 heterozygous sites with 'n'
[12:36:23] Treating reference as 'fasta' format.
[12:36:23] Will use 8 CPU cores.
[12:36:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta
[12:36:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[12:36:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[12:36:23] Creating reference folder: reference
[12:36:23] Extracting FASTA and GFF from reference.
[12:36:23] Creating extra output files: BED GFF CSV TXT HTML
[12:36:23] Identified 37 variants.
[12:36:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out
[12:36:23] Result files:
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.aligned.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bam.bai
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.bed
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.consensus.subs.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.csv
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.filt.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.gff
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.html
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.log
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.raw.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.subs.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.tab
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.txt
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out/snps.vcf.gz.csi
[12:36:23] Walltime used: 20 seconds
[12:36:23] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:23] Done.
[Tue Jun 16 12:36:23 2020]
Finished job 69.
44 of 202 steps (22%) done

[Tue Jun 16 12:36:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
    jobid: 193
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB9521AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[12:36:23] Wrote 3 sequences to ref.fa
[12:36:23] Wrote 0 features to ref.gff
[12:36:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9835AA_AS.fasta into pseudo-reads
[12:36:23] Marked 382 heterozygous sites with 'n'
[12:36:23] Creating extra output files: BED GFF CSV TXT HTML
[12:36:23] Identified 666 variants.
[12:36:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out
[12:36:23] Result files:
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.aligned.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bam.bai
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.bed
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.consensus.subs.fa
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.csv
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.filt.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.gff
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.html
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.log
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.raw.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.subs.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.tab
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.txt
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz
[12:36:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out/snps.vcf.gz.csi
[12:36:23] Walltime used: 20 seconds
[12:36:23] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:23] Done.
[Tue Jun 16 12:36:23 2020]
Finished job 123.
45 of 202 steps (22%) done

[Tue Jun 16 12:36:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
    jobid: 75
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB0953AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:23] This is snippy 4.4.3
[12:36:23] Written by Torsten Seemann
[12:36:23] Obtained from https://github.com/tseemann/snippy
[12:36:23] Detected operating system: linux
[12:36:23] Enabling bundled linux tools.
[12:36:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:23] Found gzip - /usr/bin/gzip
[12:36:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:24] Treating reference as 'fasta' format.
[12:36:24] Will use 8 CPU cores.
[12:36:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta
[12:36:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[12:36:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[12:36:24] Creating reference folder: reference
[12:36:24] Extracting FASTA and GFF from reference.
[12:36:24] Wrote 3 sequences to ref.fa
[12:36:24] Wrote 0 features to ref.gff
[12:36:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB9521AA_AS.fasta into pseudo-reads
[12:36:24] This is snippy 4.4.3
[12:36:24] Written by Torsten Seemann
[12:36:24] Obtained from https://github.com/tseemann/snippy
[12:36:24] Detected operating system: linux
[12:36:24] Enabling bundled linux tools.
[12:36:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:24] Found gzip - /usr/bin/gzip
[12:36:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:24] Treating reference as 'fasta' format.
[12:36:24] Will use 8 CPU cores.
[12:36:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta
[12:36:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[12:36:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[12:36:24] Creating reference folder: reference
[12:36:24] Extracting FASTA and GFF from reference.
[12:36:24] Marked 0 heterozygous sites with 'n'
[12:36:24] Marked 0 heterozygous sites with 'n'
[12:36:24] Wrote 3 sequences to ref.fa
[12:36:24] Wrote 0 features to ref.gff
[12:36:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB0953AA_AS.fasta into pseudo-reads
[12:36:24] Creating extra output files: BED GFF CSV TXT HTML
[12:36:24] Identified 30 variants.
[12:36:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out
[12:36:24] Result files:
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.aligned.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bam.bai
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.bed
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.consensus.subs.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.csv
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.filt.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.gff
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.html
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.log
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.raw.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.subs.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.tab
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.txt
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out/snps.vcf.gz.csi
[12:36:24] Walltime used: 20 seconds
[12:36:24] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:36:24] Done.
[Tue Jun 16 12:36:24 2020]
Finished job 35.
46 of 202 steps (23%) done

[Tue Jun 16 12:36:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
    jobid: 13
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5642AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[12:36:24] Creating extra output files: BED GFF CSV TXT HTML
[12:36:24] Identified 1823 variants.
[12:36:24] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out
[12:36:24] Result files:
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.aligned.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bam.bai
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.bed
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.consensus.subs.fa
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.csv
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.filt.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.gff
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.html
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.log
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.raw.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.subs.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.tab
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.txt
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz
[12:36:24] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out/snps.vcf.gz.csi
[12:36:24] Walltime used: 20 seconds
[12:36:24] Questionable SNP? Try the --report option to see the alignments.
[12:36:24] Done.
[Tue Jun 16 12:36:24 2020]
Finished job 76.
47 of 202 steps (23%) done

[Tue Jun 16 12:36:24 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
    jobid: 153
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[12:36:25] Marked 0 heterozygous sites with 'n'
[12:36:25] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:36:25] Creating extra output files: BED GFF CSV TXT HTML
[12:36:25] Identified 260 variants.
[12:36:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out
[12:36:25] Result files:
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.aligned.fa
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bam.bai
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.bed
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.fa
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.consensus.subs.fa
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.csv
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.filt.vcf
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.gff
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.html
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.log
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.raw.vcf
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.subs.vcf
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.tab
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.txt
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz
[12:36:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out/snps.vcf.gz.csi
[12:36:25] Walltime used: 20 seconds
[12:36:25] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:36:25] Done.

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 467
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:25] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[Tue Jun 16 12:36:25 2020]
Finished job 130.
48 of 202 steps (24%) done

[Tue Jun 16 12:36:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
    jobid: 40
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9243AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:25] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:25] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:25] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:25] This is snippy 4.4.3
[12:36:25] Written by Torsten Seemann
[12:36:25] Obtained from https://github.com/tseemann/snippy
[12:36:25] Detected operating system: linux
[12:36:25] Enabling bundled linux tools.
[12:36:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:25] Found gzip - /usr/bin/gzip
[12:36:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:25] This is snippy 4.4.3
[12:36:25] Written by Torsten Seemann
[12:36:25] Obtained from https://github.com/tseemann/snippy
[12:36:25] Detected operating system: linux
[12:36:25] Enabling bundled linux tools.
[12:36:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:25] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:25] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:25] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:25] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:25] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:25] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:25] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:25] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:25] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:25] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:25] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:25] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:25] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:25] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:25] Found gzip - /usr/bin/gzip
[12:36:25] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:25] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:25] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:25] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:25] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:25] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:25] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:25] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:25] Treating reference as 'fasta' format.
[12:36:25] Will use 8 CPU cores.
[12:36:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta
[12:36:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[12:36:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[12:36:25] Creating reference folder: reference
[12:36:25] Extracting FASTA and GFF from reference.
[12:36:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:25] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:25] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:25] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:25] Treating reference as 'fasta' format.
[12:36:25] Will use 8 CPU cores.
[12:36:25] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta
[12:36:25] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[12:36:25] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[12:36:25] Creating reference folder: reference
[12:36:25] Wrote 3 sequences to ref.fa
[12:36:25] Wrote 0 features to ref.gff
[12:36:25] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5642AA_AS.fasta into pseudo-reads
[12:36:25] Extracting FASTA and GFF from reference.
[12:36:25] Wrote 394846 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:25] Using BAM RG (Read Group) ID: SAL_CB9835AA_AS.out
[12:36:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:26] Wrote 3 sequences to ref.fa
[12:36:26] Wrote 0 features to ref.gff
[12:36:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2967AA_AS.fasta into pseudo-reads
[12:36:26] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:26] This is snippy 4.4.3
[12:36:26] Written by Torsten Seemann
[12:36:26] Obtained from https://github.com/tseemann/snippy
[12:36:26] Detected operating system: linux
[12:36:26] Enabling bundled linux tools.
[12:36:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:26] Found gzip - /usr/bin/gzip
[12:36:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:26] Treating reference as 'fasta' format.
[12:36:26] Will use 8 CPU cores.
[12:36:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta
[12:36:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[12:36:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[12:36:26] Creating reference folder: reference
[12:36:26] Extracting FASTA and GFF from reference.
[12:36:26] Wrote 3 sequences to ref.fa
[12:36:26] Wrote 0 features to ref.gff
[12:36:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9243AA_AS.fasta into pseudo-reads
[12:36:26] Wrote 394794 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:27] Using BAM RG (Read Group) ID: SAL_JB9521AA_AS.out
[12:36:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:27] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:27] Wrote 398246 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:27] Using BAM RG (Read Group) ID: SAL_JB0953AA_AS.out
[12:36:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:27] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320152 sequences (80000310 bp)...
[M::process] read 74694 sequences (18673500 bp)...
[12:36:28] Wrote 394490 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:28] Using BAM RG (Read Group) ID: SAL_AB5642AA_AS.out
[12:36:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:28] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:28] Wrote 394170 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:28] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:28] Using BAM RG (Read Group) ID: SAL_BB2967AA_AS.out
[12:36:28] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:28] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:29] Wrote 393608 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[M::process] read 320196 sequences (80000406 bp)...
[12:36:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:29] Using BAM RG (Read Group) ID: SAL_CB9243AA_AS.out
[12:36:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:29] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 74598 sequences (18601214 bp)...
[12:36:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:29] Marked 0 heterozygous sites with 'n'
[12:36:29] Creating extra output files: BED GFF CSV TXT HTML
[12:36:29] Identified 467 variants.
[12:36:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out
[12:36:29] Result files:
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.aligned.fa
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bam.bai
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.bed
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.fa
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.consensus.subs.fa
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.csv
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.filt.vcf
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.gff
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.html
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.log
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.raw.vcf
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.subs.vcf
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.tab
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.txt
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz
[12:36:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out/snps.vcf.gz.csi
[12:36:29] Walltime used: 20 seconds
[12:36:29] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:29] Done.
[Tue Jun 16 12:36:29 2020]
Finished job 98.
49 of 202 steps (24%) done

[Tue Jun 16 12:36:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
    jobid: 42
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB6441AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[M::process] read 320008 sequences (80000424 bp)...
[M::process] read 78238 sequences (19559500 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320152 reads in 16.484 CPU sec, 2.123 real sec
[12:36:30] This is snippy 4.4.3
[12:36:30] Written by Torsten Seemann
[12:36:30] Obtained from https://github.com/tseemann/snippy
[12:36:30] Detected operating system: linux
[12:36:30] Enabling bundled linux tools.
[12:36:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:30] Found gzip - /usr/bin/gzip
[12:36:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] Processed 100000 records...
[12:36:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:30] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:30] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:30] Treating reference as 'fasta' format.
[12:36:30] Will use 8 CPU cores.
[12:36:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta
[12:36:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[12:36:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[12:36:30] Creating reference folder: reference
[12:36:30] Extracting FASTA and GFF from reference.
[12:36:30] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:30] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 74694 reads in 4.720 CPU sec, 0.553 real sec
[12:36:30] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:31] Wrote 3 sequences to ref.fa
[12:36:31] Wrote 0 features to ref.gff
[12:36:31] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6441AA_AS.fasta into pseudo-reads
[12:36:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320160 sequences (80000364 bp)...
[M::process] read 74330 sequences (18582500 bp)...
[samclip] Processed 300000 records...
[M::process] read 320016 sequences (80000230 bp)...
[M::process] read 74154 sequences (18463210 bp)...
[M::process] read 320140 sequences (80000152 bp)...
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 395104, removed 1437, allowed 126, passed 393667
 bwa mem -Y[samclip] Header contained 5 lines
 -M -R[samclip] Done.
 @RG\tID:SAL_CB9835AA_AS.out\tSM:SAL_CB9835AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.557 sec; CPU: 21.716 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320196 reads in 17.627 CPU sec, 2.584 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74598 reads in 4.805 CPU sec, 0.575 real sec
[M::mem_process_seqs] Processed 320008 reads in 18.256 CPU sec, 2.626 real sec
[M::process] read 73468 sequences (18367000 bp)...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 78238 reads in 4.705 CPU sec, 0.577 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB9521AA_AS.out\tSM:SAL_JB9521AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.364 sec; CPU: 22.997 sec
[samclip] Total SAM records 395069, removed 883, allowed 95, passed 394186
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[12:36:33] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB0953AA_AS.out\tSM:SAL_JB0953AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.208 sec; CPU: 23.528 sec
[samclip] Total SAM records 398486, removed 1292, allowed 243, passed 397194
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:33] Wrote 394306 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:33] Using BAM RG (Read Group) ID: SAL_BB6441AA_AS.out
[12:36:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:33] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320016 reads in 18.063 CPU sec, 2.797 real sec
[M::mem_process_seqs] Processed 320160 reads in 18.373 CPU sec, 2.969 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74330 reads in 4.307 CPU sec, 0.544 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74154 reads in 4.579 CPU sec, 0.580 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320140 reads in 18.676 CPU sec, 3.508 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5642AA_AS.out\tSM:SAL_AB5642AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.650 sec; CPU: 23.331 sec
[samclip] Total SAM records 394735, removed 1211, allowed 74, passed 393524
[samclip] Header contained 5 lines
[samclip] Done.
[12:36:35] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2967AA_AS.out\tSM:SAL_BB2967AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.514 sec; CPU: 23.264 sec
[samclip] Total SAM records 394473, removed 1082, allowed 98, passed 393391
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 73468 reads in 4.408 CPU sec, 0.513 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[12:36:35] Running: samtools index snps.bam 2>> snps.log
[12:36:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9243AA_AS.out\tSM:SAL_CB9243AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.930 sec; CPU: 23.641 sec
[samclip] Total SAM records 393980, removed 1071, allowed 135, passed 392909
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320138 sequences (80000338 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 74168 sequences (18517842 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:37] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 23
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 490
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:37] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:37] Running: samtools index snps.bam 2>> snps.log
[12:36:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:37] Running: samtools index snps.bam 2>> snps.log
[12:36:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:37] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:37] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:37] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:38] Running: samtools index snps.bam 2>> snps.log
[12:36:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 64
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:38] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:38] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:38] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:38] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:38] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:38] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:38] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:39] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 17
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 1797
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:36:39] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:39] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320138 reads in 16.874 CPU sec, 3.594 real sec
[12:36:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:39] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 74168 reads in 5.183 CPU sec, 0.612 real sec
[samclip] Processed 200000 records...
[12:36:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] Processed 300000 records...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 163
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 51
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:40] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:40] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6441AA_AS.out\tSM:SAL_BB6441AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 5.160 sec; CPU: 22.633 sec
[samclip] Total SAM records 394628, removed 1210, allowed 135, passed 393418
[samclip] Header contained 5 lines
[samclip] Done.
[12:36:40] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:40] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:40] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:40] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:40] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:40] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:40] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:41] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:41] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:41] Creating extra output files: BED GFF CSV TXT HTML
[12:36:41] Identified 490 variants.
[12:36:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out
[12:36:41] Result files:
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.aligned.fa
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bam.bai
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.bed
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.fa
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.consensus.subs.fa
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.csv
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.filt.vcf
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.gff
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.html
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.log
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.raw.vcf
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.subs.vcf
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.tab
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.txt
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz
[12:36:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out/snps.vcf.gz.csi
[12:36:41] Walltime used: 19 seconds
[12:36:41] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:36:41] Done.
[Tue Jun 16 12:36:41 2020]
Finished job 68.
50 of 202 steps (25%) done

[Tue Jun 16 12:36:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
    jobid: 157
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1299AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:42] This is snippy 4.4.3
[12:36:42] Written by Torsten Seemann
[12:36:42] Obtained from https://github.com/tseemann/snippy
[12:36:42] Detected operating system: linux
[12:36:42] Enabling bundled linux tools.
[12:36:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:42] Found gzip - /usr/bin/gzip
[12:36:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:42] Running: samtools index snps.bam 2>> snps.log
[12:36:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:42] Treating reference as 'fasta' format.
[12:36:42] Will use 8 CPU cores.
[12:36:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta
[12:36:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[12:36:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[12:36:42] Creating reference folder: reference
[12:36:42] Extracting FASTA and GFF from reference.
[12:36:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:42] Wrote 3 sequences to ref.fa
[12:36:42] Wrote 0 features to ref.gff
[12:36:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1299AA_AS.fasta into pseudo-reads
[12:36:43] Marked 0 heterozygous sites with 'n'
[12:36:43] Creating extra output files: BED GFF CSV TXT HTML
[12:36:43] Identified 64 variants.
[12:36:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out
[12:36:43] Result files:
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.aligned.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bam.bai
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.bed
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.consensus.subs.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.csv
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.filt.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.gff
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.html
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.log
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.raw.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.subs.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.tab
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.txt
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out/snps.vcf.gz.csi
[12:36:43] Walltime used: 20 seconds
[12:36:43] May the SNPs be with you.
[12:36:43] Done.
[Tue Jun 16 12:36:43 2020]
Finished job 193.
51 of 202 steps (25%) done

[Tue Jun 16 12:36:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
    jobid: 48
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9086AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:43] This is snippy 4.4.3
[12:36:43] Written by Torsten Seemann
[12:36:43] Obtained from https://github.com/tseemann/snippy
[12:36:43] Detected operating system: linux
[12:36:43] Enabling bundled linux tools.
[12:36:43] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:43] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:43] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:43] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:43] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:43] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:43] Marked 78 heterozygous sites with 'n'
[12:36:43] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:43] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:43] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:43] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:43] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:43] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:43] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:43] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:43] Found gzip - /usr/bin/gzip
[12:36:43] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:43] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:43] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:43] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:43] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:43] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:43] Creating extra output files: BED GFF CSV TXT HTML
[12:36:43] Identified 1797 variants.
[12:36:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out
[12:36:43] Result files:
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.aligned.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bam.bai
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.bed
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.consensus.subs.fa
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.csv
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.filt.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.gff
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.html
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.log
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.raw.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.subs.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.tab
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.txt
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz
[12:36:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out/snps.vcf.gz.csi
[12:36:43] Walltime used: 19 seconds
[12:36:43] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:43] Done.
[12:36:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[Tue Jun 16 12:36:44 2020]
Finished job 75.
52 of 202 steps (26%) done

[Tue Jun 16 12:36:44 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
    jobid: 111
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB8676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
[12:36:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:44] Treating reference as 'fasta' format.
[12:36:44] Will use 8 CPU cores.
[12:36:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta
[12:36:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[12:36:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[12:36:44] Creating reference folder: reference
[12:36:44] Extracting FASTA and GFF from reference.
[12:36:44] Wrote 3 sequences to ref.fa
[12:36:44] Wrote 0 features to ref.gff
[12:36:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9086AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:44] This is snippy 4.4.3
[12:36:44] Written by Torsten Seemann
[12:36:44] Obtained from https://github.com/tseemann/snippy
[12:36:44] Detected operating system: linux
[12:36:44] Enabling bundled linux tools.
[12:36:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:44] Found gzip - /usr/bin/gzip
[12:36:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:44] Treating reference as 'fasta' format.
[12:36:44] Will use 8 CPU cores.
[12:36:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta
[12:36:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[12:36:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[12:36:44] Creating reference folder: reference
[12:36:44] Extracting FASTA and GFF from reference.
[12:36:45] Marked 0 heterozygous sites with 'n'
[12:36:45] Wrote 3 sequences to ref.fa
[12:36:45] Wrote 0 features to ref.gff
[12:36:45] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8676AA_AS.fasta into pseudo-reads
[12:36:45] Creating extra output files: BED GFF CSV TXT HTML
[12:36:45] Identified 51 variants.
[12:36:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out
[12:36:45] Result files:
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.aligned.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bam.bai
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.bed
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.consensus.subs.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.csv
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.filt.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.gff
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.html
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.log
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.raw.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.subs.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.tab
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.txt
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out/snps.vcf.gz.csi
[12:36:45] Walltime used: 20 seconds
[12:36:45] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:45] Done.
[12:36:45] Marked 0 heterozygous sites with 'n'
[Tue Jun 16 12:36:45 2020]
Finished job 153.
53 of 202 steps (26%) done

[Tue Jun 16 12:36:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
    jobid: 92
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7534AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[12:36:45] Creating extra output files: BED GFF CSV TXT HTML
[12:36:45] Identified 163 variants.
[12:36:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out
[12:36:45] Result files:
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.aligned.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bam.bai
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.bed
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.consensus.subs.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.csv
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.filt.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.gff
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.html
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.log
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.raw.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.subs.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.tab
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.txt
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out/snps.vcf.gz.csi
[12:36:45] Walltime used: 20 seconds
[12:36:45] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:36:45] Done.
[Tue Jun 16 12:36:45 2020]
Finished job 13.
54 of 202 steps (27%) done

[Tue Jun 16 12:36:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
    jobid: 81
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA3268AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[12:36:45] Marked 0 heterozygous sites with 'n'
[12:36:45] Creating extra output files: BED GFF CSV TXT HTML
[12:36:45] Identified 22 variants.
[12:36:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out
[12:36:45] Result files:
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.aligned.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bam.bai
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.bed
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.consensus.subs.fa
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.csv
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.filt.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.gff
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.html
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.log
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.raw.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.subs.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.tab
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.txt
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz
[12:36:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out/snps.vcf.gz.csi
[12:36:45] Walltime used: 19 seconds
[12:36:45] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:36:45] Done.
[Tue Jun 16 12:36:45 2020]
Finished job 40.
55 of 202 steps (27%) done

[Tue Jun 16 12:36:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
    jobid: 83
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB8845AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[12:36:45] Wrote 397540 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:45] Using BAM RG (Read Group) ID: SAL_XA1299AA_AS.out
[12:36:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:45] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 132
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:46] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:46] This is snippy 4.4.3
[12:36:46] Written by Torsten Seemann
[12:36:46] Obtained from https://github.com/tseemann/snippy
[12:36:46] Detected operating system: linux
[12:36:46] Enabling bundled linux tools.
[12:36:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:46] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:46] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:46] Found gzip - /usr/bin/gzip
[12:36:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:46] This is snippy 4.4.3
[12:36:46] Written by Torsten Seemann
[12:36:46] Obtained from https://github.com/tseemann/snippy
[12:36:46] Detected operating system: linux
[12:36:46] Enabling bundled linux tools.
[12:36:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:46] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:46] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:46] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:46] Found gzip - /usr/bin/gzip
[12:36:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:46] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:46] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:36:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:46] Treating reference as 'fasta' format.
[12:36:46] Will use 8 CPU cores.
[12:36:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta
[12:36:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[12:36:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[12:36:46] Creating reference folder: reference
[12:36:46] Extracting FASTA and GFF from reference.
[12:36:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:46] Treating reference as 'fasta' format.
[12:36:46] Will use 8 CPU cores.
[12:36:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta
[12:36:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[12:36:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[12:36:46] Creating reference folder: reference
[12:36:46] Extracting FASTA and GFF from reference.
[12:36:46] Wrote 3 sequences to ref.fa
[12:36:46] Wrote 0 features to ref.gff
[12:36:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7534AA_AS.fasta into pseudo-reads
[12:36:46] This is snippy 4.4.3
[12:36:46] Written by Torsten Seemann
[12:36:46] Obtained from https://github.com/tseemann/snippy
[12:36:46] Detected operating system: linux
[12:36:46] Enabling bundled linux tools.
[12:36:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:36:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:46] Found gzip - /usr/bin/gzip
[12:36:46] Wrote 3 sequences to ref.fa
[12:36:46] Wrote 0 features to ref.gff
[12:36:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3268AA_AS.fasta into pseudo-reads
[12:36:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:46] Treating reference as 'fasta' format.
[12:36:46] Will use 8 CPU cores.
[12:36:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta
[12:36:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[12:36:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[12:36:46] Creating reference folder: reference
[12:36:46] Extracting FASTA and GFF from reference.
[12:36:46] Wrote 3 sequences to ref.fa
[12:36:46] Wrote 0 features to ref.gff
[12:36:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB8845AA_AS.fasta into pseudo-reads
[12:36:47] Wrote 393026 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:47] Using BAM RG (Read Group) ID: SAL_BB9086AA_AS.out
[12:36:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:47] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:47] Wrote 392172 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:47] Using BAM RG (Read Group) ID: SAL_KB8676AA_AS.out
[12:36:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::process] read 320158 sequences (80000292 bp)...
[12:36:47] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 77382 sequences (19326182 bp)...
[12:36:48] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:48] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:48] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:48] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:48] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[12:36:49] Wrote 393274 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:49] Using BAM RG (Read Group) ID: SAL_AB7534AA_AS.out
[M::process] read 73026 sequences (18200700 bp)...
[12:36:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:49] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:49] Wrote 397176 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:49] Using BAM RG (Read Group) ID: SAL_XA3268AA_AS.out
[12:36:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:49] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:49] Wrote 393052 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:49] Using BAM RG (Read Group) ID: SAL_EB8845AA_AS.out
[12:36:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:36:49] Running: bwa index reference/ref.fa 2>> snps.log
[12:36:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:50] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:50] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:50] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:50] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:50] Marked 0 heterozygous sites with 'n'
[M::process] read 320128 sequences (80000194 bp)...
[12:36:50] Creating extra output files: BED GFF CSV TXT HTML
[12:36:50] Identified 132 variants.
[12:36:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out
[12:36:50] Result files:
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.aligned.fa
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bam.bai
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.bed
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.fa
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.consensus.subs.fa
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.csv
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.filt.vcf
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.gff
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.html
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.log
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.raw.vcf
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.subs.vcf
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.tab
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.txt
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz
[12:36:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out/snps.vcf.gz.csi
[12:36:50] Walltime used: 20 seconds
[12:36:50] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:36:50] Done.
[Tue Jun 16 12:36:50 2020]
Finished job 42.
56 of 202 steps (28%) done
[M::mem_process_seqs] Processed 320158 reads in 18.399 CPU sec, 2.540 real sec

[Tue Jun 16 12:36:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
    jobid: 21
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_ZA0287AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[M::process] read 72044 sequences (18011000 bp)...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 77382 reads in 5.695 CPU sec, 0.659 real sec
[12:36:51] This is snippy 4.4.3
[12:36:51] Written by Torsten Seemann
[12:36:51] Obtained from https://github.com/tseemann/snippy
[12:36:51] Detected operating system: linux
[12:36:51] Enabling bundled linux tools.
[12:36:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:36:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:36:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:36:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:36:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[samclip] Processed 300000 records...
[12:36:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:36:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:36:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:36:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:36:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:36:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:36:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:36:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:36:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:36:51] Found gzip - /usr/bin/gzip
[12:36:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:36:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:36:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:36:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:36:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:36:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:36:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:36:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:36:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:36:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:36:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:36:51] Treating reference as 'fasta' format.
[12:36:51] Will use 8 CPU cores.
[12:36:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta
[12:36:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:36:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[12:36:51] Creating reference folder: reference
[12:36:51] Extracting FASTA and GFF from reference.
[12:36:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:36:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1299AA_AS.out\tSM:SAL_XA1299AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.985 sec; CPU: 24.615 sec
[samclip] Total SAM records 398069, removed 1650, allowed 237, passed 396419
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:51] Wrote 3 sequences to ref.fa
[12:36:51] Wrote 0 features to ref.gff
[12:36:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_ZA0287AA_AS.fasta into pseudo-reads
[12:36:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 18.758 CPU sec, 2.509 real sec
[12:36:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320362 sequences (80000096 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 76814 sequences (19186104 bp)...
[M::process] read 73274 sequences (18271504 bp)...
[samclip] Processed 100000 records...
[M::process] read 320212 sequences (80000078 bp)...
[M::mem_process_seqs] Processed 73026 reads in 4.233 CPU sec, 0.508 real sec
[samclip] Processed 200000 records...
[M::process] read 72840 sequences (18210000 bp)...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9086AA_AS.out\tSM:SAL_BB9086AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 393328, removed 872, allowed 140, passed 392456

[main] Real time: 4.080 sec; CPU: 23.598 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320128 reads in 18.189 CPU sec, 2.869 real sec
[samclip] Processed 100000 records...
[12:36:53] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 72044 reads in 4.076 CPU sec, 0.497 real sec
[12:36:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[12:36:54] Wrote 394326 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:36:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:36:54] Using BAM RG (Read Group) ID: SAL_ZA0287AA_AS.out
[12:36:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.576 CPU sec, 2.553 real sec
[12:36:54] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB8676AA_AS.out\tSM:SAL_KB8676AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.453 sec; CPU: 22.879 sec
[samclip] Total SAM records 392256, removed 966, allowed 100, passed 391290
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 73274 reads in 4.285 CPU sec, 0.506 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320362 reads in 18.607 CPU sec, 3.231 real sec
[12:36:55] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 320212 reads in 18.228 CPU sec, 2.970 real sec
[12:36:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 76814 reads in 4.308 CPU sec, 0.540 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7534AA_AS.out\tSM:SAL_AB7534AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.087 sec; CPU: 22.407 sec
[samclip] Total SAM records 393670, removed 1211, allowed 78, passed 392459
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 72840 reads in 4.505 CPU sec, 0.558 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[12:36:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:36:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:36:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:36:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:36:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB8845AA_AS.out\tSM:SAL_EB8845AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 393465, removed 1178, allowed 128, passed 392287
[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.554 sec; CPU: 23.318 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3268AA_AS.out\tSM:SAL_XA3268AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.929 sec; CPU: 23.552 sec
[samclip] Total SAM records 397271, removed 743, allowed 79, passed 396528
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:56] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320096 sequences (80000188 bp)...
[12:36:56] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:56] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 74230 sequences (18552290 bp)...
[12:36:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:57] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:57] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:57] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:57] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:36:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:36:57] Running: samtools index snps.bam 2>> snps.log
[12:36:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:36:58] Running: samtools index snps.bam 2>> snps.log
[12:36:58] Running: samtools index snps.bam 2>> snps.log
[12:36:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:36:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:36:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:36:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:36:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:36:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:36:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:36:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:36:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:36:58] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:36:58] Running: rm -f fake_reads\.fq 2>> snps.log
[12:36:58] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320096 reads in 17.835 CPU sec, 2.477 real sec
[12:36:59] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::mem_process_seqs] Processed 74230 reads in 4.201 CPU sec, 0.660 real sec

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 318
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:36:59] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:36:59] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[12:37:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[12:37:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:00] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:00] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_ZA0287AA_AS.out\tSM:SAL_ZA0287AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.465 sec; CPU: 22.700 sec
[samclip] Total SAM records 394998, removed 7111, allowed 443, passed 387887
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:01] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:01] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:01] Marked 31 heterozygous sites with 'n'
[12:37:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:01] Creating extra output files: BED GFF CSV TXT HTML
[12:37:01] Identified 27 variants.
[12:37:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out
[12:37:01] Result files:
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.aligned.fa
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bam.bai
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.bed
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.fa
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.consensus.subs.fa
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.csv
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.filt.vcf
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.gff
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.html
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.log
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.raw.vcf
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.subs.vcf
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.tab
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.txt
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz
[12:37:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out/snps.vcf.gz.csi
[12:37:01] Walltime used: 19 seconds
[12:37:01] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:37:01] Done.
[Tue Jun 16 12:37:01 2020]
Finished job 157.
57 of 202 steps (28%) done

[Tue Jun 16 12:37:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
    jobid: 138
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2224AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[12:37:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:02] Running: samtools index snps.bam 2>> snps.log
[12:37:02] This is snippy 4.4.3
[12:37:02] Written by Torsten Seemann
[12:37:02] Obtained from https://github.com/tseemann/snippy
[12:37:02] Detected operating system: linux
[12:37:02] Enabling bundled linux tools.
[12:37:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:02] Found gzip - /usr/bin/gzip
[12:37:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:03] Marked 236 heterozygous sites with 'n'
[12:37:03] Creating extra output files: BED GFF CSV TXT HTML
[12:37:03] Identified 20 variants.
[12:37:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out
[12:37:03] Result files:
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.aligned.fa
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bam.bai
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.bed
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.fa
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.consensus.subs.fa
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.csv
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.filt.vcf
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.gff
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.html
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.log
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.raw.vcf
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.subs.vcf
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.tab
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.txt
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz
[12:37:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out/snps.vcf.gz.csi
[12:37:03] Walltime used: 20 seconds
[12:37:03] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:37:03] Done.
[Tue Jun 16 12:37:03 2020]
Finished job 48.
58 of 202 steps (29%) done
[12:37:03] Checking version: snpEff -version is >= 4.3 - ok, have 4.3

[Tue Jun 16 12:37:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
    jobid: 166
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LA4572AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[12:37:03] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:03] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:03] Treating reference as 'fasta' format.
[12:37:03] Will use 8 CPU cores.
[12:37:03] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta
[12:37:03] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[12:37:03] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[12:37:03] Creating reference folder: reference
[12:37:03] Extracting FASTA and GFF from reference.
[12:37:03] Wrote 3 sequences to ref.fa
[12:37:03] Wrote 0 features to ref.gff
[12:37:03] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2224AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:03] This is snippy 4.4.3
[12:37:03] Written by Torsten Seemann
[12:37:03] Obtained from https://github.com/tseemann/snippy
[12:37:03] Detected operating system: linux
[12:37:03] Enabling bundled linux tools.
[12:37:03] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:03] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:03] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:03] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:03] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:03] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:03] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:03] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:03] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:03] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:03] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:03] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:03] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:03] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:03] Found gzip - /usr/bin/gzip
[12:37:03] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:03] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:03] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:03] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:03] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:03] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:03] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:04] Treating reference as 'fasta' format.
[12:37:04] Will use 8 CPU cores.
[12:37:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta
[12:37:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[12:37:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[12:37:04] Creating reference folder: reference
[12:37:04] Extracting FASTA and GFF from reference.
[12:37:04] Wrote 3 sequences to ref.fa
[12:37:04] Wrote 0 features to ref.gff
[12:37:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LA4572AA_AS.fasta into pseudo-reads
[12:37:04] Marked 40 heterozygous sites with 'n'
[12:37:04] Creating extra output files: BED GFF CSV TXT HTML
[12:37:04] Identified 318 variants.
[12:37:04] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out
[12:37:04] Result files:
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.aligned.fa
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bam.bai
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.bed
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.fa
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.consensus.subs.fa
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.csv
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.filt.vcf
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.gff
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.html
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.log
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.raw.vcf
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.subs.vcf
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.tab
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.txt
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz
[12:37:04] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out/snps.vcf.gz.csi
[12:37:04] Walltime used: 20 seconds
[12:37:04] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:04] Done.
[Tue Jun 16 12:37:04 2020]
Finished job 111.
59 of 202 steps (29%) done

[Tue Jun 16 12:37:04 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
    jobid: 117
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_LB4034AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:05] This is snippy 4.4.3
[12:37:05] Written by Torsten Seemann
[12:37:05] Obtained from https://github.com/tseemann/snippy
[12:37:05] Detected operating system: linux
[12:37:05] Enabling bundled linux tools.
[12:37:05] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:05] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:05] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:05] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:05] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:05] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:05] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:05] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:05] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:05] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:05] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:05] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:05] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:05] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:05] Found gzip - /usr/bin/gzip
[12:37:05] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:05] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:05] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:05] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:05] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:05] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:05] Marked 68 heterozygous sites with 'n'
[12:37:05] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:05] Creating extra output files: BED GFF CSV TXT HTML
[12:37:05] Identified 15 variants.
[12:37:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out
[12:37:05] Result files:
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.aligned.fa
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bam.bai
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.bed
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.fa
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.consensus.subs.fa
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.csv
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.filt.vcf
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.gff
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.html
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.log
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.raw.vcf
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.subs.vcf
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.tab
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.txt
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz
[12:37:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out/snps.vcf.gz.csi
[12:37:05] Walltime used: 19 seconds
[12:37:05] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:37:05] Done.
[Tue Jun 16 12:37:05 2020]
Finished job 92.
60 of 202 steps (30%) done

[Tue Jun 16 12:37:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
    jobid: 186
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5906AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[12:37:05] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:05] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:05] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:05] Treating reference as 'fasta' format.
[12:37:05] Will use 8 CPU cores.
[12:37:05] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta
[12:37:05] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[12:37:05] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[12:37:05] Creating reference folder: reference
[12:37:05] Extracting FASTA and GFF from reference.
[12:37:05] Wrote 3 sequences to ref.fa
[12:37:05] Wrote 0 features to ref.gff
[12:37:05] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_LB4034AA_AS.fasta into pseudo-reads
[12:37:06] Wrote 392296 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:06] Using BAM RG (Read Group) ID: SAL_HB2224AA_AS.out
[12:37:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:06] Marked 1 heterozygous sites with 'n'
[12:37:06] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:06] Creating extra output files: BED GFF CSV TXT HTML
[12:37:06] Identified 22 variants.
[12:37:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out
[12:37:06] Result files:
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.aligned.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bam.bai
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.bed
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.consensus.subs.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.csv
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.filt.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.gff
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.html
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.log
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.raw.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.subs.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.tab
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.txt
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out/snps.vcf.gz.csi
[12:37:06] Walltime used: 20 seconds
[12:37:06] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:37:06] Done.
[12:37:06] Marked 0 heterozygous sites with 'n'
[Tue Jun 16 12:37:06 2020]
Finished job 83.
61 of 202 steps (30%) done
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609

[Tue Jun 16 12:37:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
    jobid: 90
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB8884AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
[12:37:06] Creating extra output files: BED GFF CSV TXT HTML
[12:37:06] Identified 100 variants.
[12:37:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out
[12:37:06] Result files:
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.aligned.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bam.bai
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.bed
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.consensus.subs.fa
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.csv
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.filt.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.gff
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.html
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.log
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.raw.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.subs.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.tab
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.txt
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz
[12:37:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out/snps.vcf.gz.csi
[12:37:06] Walltime used: 20 seconds
[12:37:06] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:37:06] Done.
[Tue Jun 16 12:37:06 2020]
Finished job 81.
62 of 202 steps (31%) done

[Tue Jun 16 12:37:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
    jobid: 108
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB5769AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[12:37:06] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1883
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:37:06] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:06] This is snippy 4.4.3
[12:37:06] Written by Torsten Seemann
[12:37:06] Obtained from https://github.com/tseemann/snippy
[12:37:06] Detected operating system: linux
[12:37:06] Enabling bundled linux tools.
[12:37:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:06] Found gzip - /usr/bin/gzip
[12:37:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:06] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:06] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:06] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:06] Treating reference as 'fasta' format.
[12:37:06] Will use 8 CPU cores.
[12:37:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta
[12:37:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[12:37:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[12:37:06] Creating reference folder: reference
[12:37:06] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:06] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:06] Wrote 3 sequences to ref.fa
[12:37:06] Wrote 0 features to ref.gff
[12:37:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5906AA_AS.fasta into pseudo-reads
[12:37:06] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:06] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:06] Wrote 396758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:06] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:06] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:06] Using BAM RG (Read Group) ID: SAL_LA4572AA_AS.out
[12:37:06] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:06] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:07] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:07] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:07] This is snippy 4.4.3
[12:37:07] Written by Torsten Seemann
[12:37:07] Obtained from https://github.com/tseemann/snippy
[12:37:07] Detected operating system: linux
[12:37:07] Enabling bundled linux tools.
[12:37:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:07] Found gzip - /usr/bin/gzip
[12:37:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:07] This is snippy 4.4.3
[12:37:07] Written by Torsten Seemann
[12:37:07] Obtained from https://github.com/tseemann/snippy
[12:37:07] Detected operating system: linux
[12:37:07] Enabling bundled linux tools.
[12:37:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:07] Found gzip - /usr/bin/gzip
[12:37:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:07] Treating reference as 'fasta' format.
[12:37:07] Will use 8 CPU cores.
[12:37:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta
[12:37:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[12:37:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[12:37:07] Creating reference folder: reference
[12:37:07] Extracting FASTA and GFF from reference.
[12:37:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:07] Treating reference as 'fasta' format.
[12:37:07] Will use 8 CPU cores.
[12:37:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta
[12:37:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[12:37:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[12:37:07] Creating reference folder: reference
[12:37:07] Extracting FASTA and GFF from reference.
[12:37:07] Wrote 3 sequences to ref.fa
[12:37:07] Wrote 0 features to ref.gff
[12:37:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB8884AA_AS.fasta into pseudo-reads
[12:37:07] Wrote 3 sequences to ref.fa
[12:37:07] Wrote 0 features to ref.gff
[12:37:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB5769AA_AS.fasta into pseudo-reads
[12:37:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 72296 sequences (18038458 bp)...
[12:37:08] Wrote 391912 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:08] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:08] Using BAM RG (Read Group) ID: SAL_LB4034AA_AS.out
[12:37:08] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:08] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:08] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320068 sequences (80000128 bp)...
[M::process] read 76690 sequences (19135790 bp)...
[12:37:10] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.943 CPU sec, 2.251 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 72296 reads in 4.437 CPU sec, 0.515 real sec
[samclip] Processed 200000 records...
[12:37:11] Wrote 391628 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 300000 records...
[12:37:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:11] Using BAM RG (Read Group) ID: SAL_AB8884AA_AS.out
[12:37:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:11] Marked 0 heterozygous sites with 'n'
[12:37:11] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:11] Creating extra output files: BED GFF CSV TXT HTML
[12:37:11] Identified 1883 variants.
[12:37:11] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out
[12:37:11] Result files:
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.aligned.fa
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bam.bai
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.bed
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.fa
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.consensus.subs.fa
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.csv
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.filt.vcf
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.gff
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.html
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.log
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.raw.vcf
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.subs.vcf
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.tab
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.txt
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz
[12:37:11] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out/snps.vcf.gz.csi
[12:37:11] Walltime used: 20 seconds
[12:37:11] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:37:11] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2224AA_AS.out\tSM:SAL_HB2224AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.646 sec; CPU: 21.907 sec
[samclip] Total SAM records 392637, removed 954, allowed 181, passed 391683
[samclip] Header contained 5 lines
[samclip] Done.
[Tue Jun 16 12:37:11 2020]
Finished job 21.
63 of 202 steps (31%) done

[Tue Jun 16 12:37:11 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
    jobid: 38
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NB6620AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320018 sequences (80000480 bp)...
[M::process] read 71894 sequences (17973500 bp)...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:12] This is snippy 4.4.3
[12:37:12] Written by Torsten Seemann
[12:37:12] Obtained from https://github.com/tseemann/snippy
[12:37:12] Detected operating system: linux
[12:37:12] Enabling bundled linux tools.
[12:37:12] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:12] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:12] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:12] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:12] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:12] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:12] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:12] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:12] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:12] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:12] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:12] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:12] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:12] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:12] Found gzip - /usr/bin/gzip
[12:37:12] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:12] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:12] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:12] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:12] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:12] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:12] Wrote 390314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:12] Using BAM RG (Read Group) ID: SAL_AB5906AA_AS.out
[12:37:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:12] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:12] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:12] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:12] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:12] Treating reference as 'fasta' format.
[12:37:12] Will use 8 CPU cores.
[12:37:12] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta
[12:37:12] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[12:37:12] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[12:37:12] Creating reference folder: reference
[12:37:12] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:12] Wrote 3 sequences to ref.fa
[12:37:12] Wrote 0 features to ref.gff
[12:37:12] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NB6620AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320068 reads in 19.356 CPU sec, 2.622 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[12:37:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::mem_process_seqs] Processed 76690 reads in 5.361 CPU sec, 0.619 real sec
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320072 sequences (80000244 bp)...
[M::process] read 71556 sequences (17889000 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LA4572AA_AS.out\tSM:SAL_LA4572AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.062 sec; CPU: 25.269 sec
[samclip] Total SAM records 396933, removed 880, allowed 169, passed 396053
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:14] Running: samtools index snps.bam 2>> snps.log
[12:37:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320018 reads in 20.001 CPU sec, 2.754 real sec
[12:37:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::mem_process_seqs] Processed 71894 reads in 4.779 CPU sec, 0.552 real sec
[M::process] read 70314 sequences (17547474 bp)...
[12:37:15] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[samclip] Processed 300000 records...
[12:37:15] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:15] Using BAM RG (Read Group) ID: SAL_NB6620AA_AS.out
[12:37:15] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:15] Running: bwa index reference/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_LB4034AA_AS.out\tSM:SAL_LB4034AA_AS.out -t 8[samclip] Total SAM records 392199, removed 1061, allowed 175, passed 391138
 reference/ref.fa fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 4.170 sec; CPU: 25.323 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:15] Running: samtools index snps.bam 2>> snps.log
[12:37:15] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:15] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320072 reads in 18.786 CPU sec, 2.604 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 71556 reads in 4.221 CPU sec, 0.518 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[12:37:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 23
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:17] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:17] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:17] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:17] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:17] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[12:37:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:17] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:17] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.386 CPU sec, 2.351 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB8884AA_AS.out\tSM:SAL_AB8884AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.318 sec; CPU: 23.668 sec
[samclip] Total SAM records 391994, removed 1043, allowed 151, passed 390951
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[12:37:17] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[M::process] read 70182 sequences (17512214 bp)...
[12:37:17] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:17] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:17] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:17] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:17] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 70314 reads in 4.487 CPU sec, 0.521 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5906AA_AS.out\tSM:SAL_AB5906AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390431, removed 709, allowed 60, passed 389722

[main] Real time: 3.780 sec; CPU: 22.442 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:18] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 136
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:18] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:19] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:19] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:19] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:19] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:19] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:19] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:19] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:19] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:19] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:19] Running: samtools index snps.bam 2>> snps.log
[12:37:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.452 CPU sec, 2.372 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70182 reads in 4.199 CPU sec, 0.486 real sec
[12:37:20] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[12:37:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[12:37:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1716
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:37:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa[samclip] Total SAM records 390419, removed 721, allowed 60, passed 389698
 mem -Y[samclip] Header contained 5 lines
 -M[samclip] Done.
 -R @RG\tID:SAL_NB6620AA_AS.out\tSM:SAL_NB6620AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.776 sec; CPU: 22.213 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:21] Wrote 390122 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:21] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:21] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:21] Using BAM RG (Read Group) ID: SAL_FB5769AA_AS.out
[12:37:21] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:21] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:22] Marked 0 heterozygous sites with 'n'
[12:37:22] Creating extra output files: BED GFF CSV TXT HTML
[12:37:22] Identified 23 variants.
[12:37:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out
[12:37:22] Result files:
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.aligned.fa
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bam.bai
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.bed
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.fa
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.consensus.subs.fa
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.csv
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.filt.vcf
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.gff
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.html
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.log
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.raw.vcf
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.subs.vcf
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.tab
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.txt
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz
[12:37:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out/snps.vcf.gz.csi
[12:37:22] Walltime used: 20 seconds
[12:37:22] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:22] Done.
[Tue Jun 16 12:37:22 2020]
Finished job 138.
64 of 202 steps (32%) done

[Tue Jun 16 12:37:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
    jobid: 137
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB5050AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 49
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:22] This is snippy 4.4.3
[12:37:22] Written by Torsten Seemann
[12:37:22] Obtained from https://github.com/tseemann/snippy
[12:37:22] Detected operating system: linux
[12:37:22] Enabling bundled linux tools.
[12:37:22] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:22] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:22] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:22] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:22] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:22] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:22] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:22] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:22] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:22] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:22] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:22] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:22] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:22] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:22] Found gzip - /usr/bin/gzip
[12:37:22] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:22] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:22] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:22] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:22] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:22] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:22] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:23] Treating reference as 'fasta' format.
[12:37:23] Will use 8 CPU cores.
[12:37:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta
[12:37:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[12:37:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[12:37:23] Creating reference folder: reference
[12:37:23] Extracting FASTA and GFF from reference.
[12:37:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:23] Running: samtools index snps.bam 2>> snps.log
[12:37:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:23] Wrote 3 sequences to ref.fa
[12:37:23] Wrote 0 features to ref.gff
[12:37:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5050AA_AS.fasta into pseudo-reads
[12:37:23] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:23] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:23] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:23] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:23] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:23] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:23] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:23] Marked 0 heterozygous sites with 'n'
[12:37:23] Creating extra output files: BED GFF CSV TXT HTML
[12:37:23] Identified 136 variants.
[12:37:23] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out
[12:37:23] Result files:
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.aligned.fa
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bam.bai
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.bed
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.fa
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.consensus.subs.fa
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.csv
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.filt.vcf
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.gff
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.html
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.log
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.raw.vcf
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.subs.vcf
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.tab
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.txt
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz
[12:37:23] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out/snps.vcf.gz.csi
[12:37:23] Walltime used: 20 seconds
[12:37:23] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:37:23] Done.
[Tue Jun 16 12:37:23 2020]
Finished job 166.
65 of 202 steps (32%) done

[Tue Jun 16 12:37:23 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
    jobid: 84
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MB5439AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[12:37:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 15

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 15
       total no. variants observed              : 201
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320022 sequences (80000370 bp)...
[M::process] read 70100 sequences (17509008 bp)...
[12:37:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:24] This is snippy 4.4.3
[12:37:24] Written by Torsten Seemann
[12:37:24] Obtained from https://github.com/tseemann/snippy
[12:37:24] Detected operating system: linux
[12:37:24] Enabling bundled linux tools.
[12:37:24] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:24] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:24] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:24] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:24] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:24] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:24] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:24] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:24] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:24] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:24] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:24] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:24] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:24] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:24] Found gzip - /usr/bin/gzip
[12:37:24] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:24] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:24] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:24] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:24] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:24] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:24] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:24] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:24] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:24] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:24] Treating reference as 'fasta' format.
[12:37:24] Will use 8 CPU cores.
[12:37:24] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta
[12:37:24] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[12:37:24] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[12:37:24] Creating reference folder: reference
[12:37:24] Extracting FASTA and GFF from reference.
[12:37:24] Wrote 3 sequences to ref.fa
[12:37:24] Wrote 0 features to ref.gff
[12:37:24] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MB5439AA_AS.fasta into pseudo-reads
[12:37:25] Marked 0 heterozygous sites with 'n'
[12:37:25] Creating extra output files: BED GFF CSV TXT HTML
[12:37:25] Identified 1716 variants.
[12:37:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out
[12:37:25] Result files:
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.aligned.fa
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bam.bai
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.bed
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.fa
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.consensus.subs.fa
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.csv
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.filt.vcf
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.gff
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.html
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.log
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.raw.vcf
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.subs.vcf
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.tab
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.txt
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz
[12:37:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out/snps.vcf.gz.csi
[12:37:25] Walltime used: 20 seconds
[12:37:25] Questionable SNP? Try the --report option to see the alignments.
[12:37:25] Done.
[Tue Jun 16 12:37:25 2020]
Finished job 117.
66 of 202 steps (33%) done

[Tue Jun 16 12:37:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
    jobid: 124
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB7996AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[12:37:25] Wrote 390662 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:25] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:25] Using BAM RG (Read Group) ID: SAL_BB5050AA_AS.out
[12:37:25] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:26] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320022 reads in 17.119 CPU sec, 2.322 real sec
[12:37:26] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:26] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[12:37:26] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:26] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:26] Running: bcftools index -f snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:26] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:26] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:26] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 70100 reads in 4.299 CPU sec, 0.494 real sec
[12:37:26] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:26] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 200000 records...
[12:37:26] This is snippy 4.4.3
[12:37:26] Written by Torsten Seemann
[12:37:26] Obtained from https://github.com/tseemann/snippy
[12:37:26] Detected operating system: linux
[12:37:26] Enabling bundled linux tools.
[12:37:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:26] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:26] Found gzip - /usr/bin/gzip
[12:37:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[12:37:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:26] Treating reference as 'fasta' format.
[12:37:26] Will use 8 CPU cores.
[12:37:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta
[12:37:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[12:37:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[12:37:26] Creating reference folder: reference
[12:37:26] Extracting FASTA and GFF from reference.
[12:37:27] Wrote 3 sequences to ref.fa
[12:37:27] Wrote 0 features to ref.gff
[12:37:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB7996AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB5769AA_AS.out\tSM:SAL_FB5769AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.733 sec; CPU: 21.986 sec
[samclip] Total SAM records 390554, removed 1191, allowed 124, passed 389363
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:27] Marked 0 heterozygous sites with 'n'
[12:37:27] Creating extra output files: BED GFF CSV TXT HTML
[12:37:27] Identified 49 variants.
[12:37:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out
[12:37:27] Result files:
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.aligned.fa
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bam.bai
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.bed
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.fa
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.consensus.subs.fa
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.csv
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.filt.vcf
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.gff
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.html
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.log
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.raw.vcf
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.subs.vcf
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.tab
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.txt
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz
[12:37:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out/snps.vcf.gz.csi
[12:37:27] Walltime used: 20 seconds
[12:37:27] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:27] Done.
[Tue Jun 16 12:37:27 2020]
Finished job 90.
67 of 202 steps (33%) done

[Tue Jun 16 12:37:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
    jobid: 179
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[12:37:27] Wrote 389178 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:27] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:27] Using BAM RG (Read Group) ID: SAL_MB5439AA_AS.out
[12:37:27] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:27] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:27] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:27] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:27] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:27] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:27] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:28] This is snippy 4.4.3
[12:37:28] Written by Torsten Seemann
[12:37:28] Obtained from https://github.com/tseemann/snippy
[12:37:28] Detected operating system: linux
[12:37:28] Enabling bundled linux tools.
[12:37:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:28] Found gzip - /usr/bin/gzip
[12:37:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:28] Marked 0 heterozygous sites with 'n'
[12:37:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::process] read 320196 sequences (80000214 bp)...
[12:37:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:28] Creating extra output files: BED GFF CSV TXT HTML
[12:37:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:28] Identified 201 variants.
[12:37:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out
[12:37:28] Result files:
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.aligned.fa
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bam.bai
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.bed
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.fa
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.consensus.subs.fa
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.csv
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.filt.vcf
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.gff
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.html
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.log
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.raw.vcf
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.subs.vcf
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.tab
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.txt
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz
[12:37:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out/snps.vcf.gz.csi
[12:37:28] Walltime used: 22 seconds
[12:37:28] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:37:28] Done.
[M::process] read 70466 sequences (17591806 bp)...
[Tue Jun 16 12:37:28 2020]
Finished job 186.
68 of 202 steps (34%) done

[Tue Jun 16 12:37:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
    jobid: 34
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6830AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
[12:37:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:28] Treating reference as 'fasta' format.
[12:37:28] Will use 8 CPU cores.
[12:37:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta
[12:37:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[12:37:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[12:37:28] Creating reference folder: reference
[12:37:28] Extracting FASTA and GFF from reference.
[12:37:28] Wrote 3 sequences to ref.fa
[12:37:28] Wrote 0 features to ref.gff
[12:37:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1324AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:29] This is snippy 4.4.3
[12:37:29] Written by Torsten Seemann
[12:37:29] Obtained from https://github.com/tseemann/snippy
[12:37:29] Detected operating system: linux
[12:37:29] Enabling bundled linux tools.
[12:37:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:29] Found gzip - /usr/bin/gzip
[12:37:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:29] Running: samtools index snps.bam 2>> snps.log
[12:37:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:29] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:29] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:29] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:29] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:29] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:29] Treating reference as 'fasta' format.
[12:37:29] Will use 8 CPU cores.
[12:37:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta
[12:37:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[12:37:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[12:37:29] Creating reference folder: reference
[12:37:29] Extracting FASTA and GFF from reference.
[12:37:29] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:37:29] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:29] Wrote 3 sequences to ref.fa
[12:37:29] Wrote 0 features to ref.gff
[12:37:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6830AA_AS.fasta into pseudo-reads
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 69178 sequences (17293548 bp)...
[12:37:29] Wrote 390506 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:29] Using BAM RG (Read Group) ID: SAL_IB7996AA_AS.out
[12:37:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:29] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320196 reads in 17.511 CPU sec, 2.463 real sec
[12:37:30] Marked 0 heterozygous sites with 'n'
[12:37:30] Creating extra output files: BED GFF CSV TXT HTML
[12:37:30] Identified 18 variants.
[12:37:30] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out
[12:37:30] Result files:
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.aligned.fa
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bam.bai
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.bed
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.fa
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.consensus.subs.fa
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.csv
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.filt.vcf
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.gff
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.html
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.log
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.raw.vcf
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.subs.vcf
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.tab
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.txt
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz
[12:37:30] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out/snps.vcf.gz.csi
[12:37:30] Walltime used: 18 seconds
[12:37:30] May the SNPs be with you.
[12:37:30] Done.
[Tue Jun 16 12:37:30 2020]
Finished job 38.
69 of 202 steps (34%) done

[Tue Jun 16 12:37:30 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
    jobid: 115
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7542AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70466 reads in 4.415 CPU sec, 0.509 real sec
[samclip] Processed 200000 records...
[12:37:31] Wrote 393742 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:31] Using BAM RG (Read Group) ID: SAL_SA1324AA_AS.out
[12:37:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:31] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:31] This is snippy 4.4.3
[12:37:31] Written by Torsten Seemann
[12:37:31] Obtained from https://github.com/tseemann/snippy
[12:37:31] Detected operating system: linux
[12:37:31] Enabling bundled linux tools.
[12:37:31] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:31] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:31] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:31] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:31] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:31] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:31] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:31] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:31] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:31] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:31] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5050AA_AS.out\tSM:SAL_BB5050AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.910 sec; CPU: 22.499 sec
[samclip] Total SAM records 390961, removed 904, allowed 84, passed 390057
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:31] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:37:31] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:31] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:31] Found gzip - /usr/bin/gzip
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:37:31] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:31] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:31] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:31] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:31] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:31] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:31] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:32] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:32] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:32] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:32] Treating reference as 'fasta' format.
[12:37:32] Will use 8 CPU cores.
[12:37:32] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta
[12:37:32] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[12:37:32] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[12:37:32] Creating reference folder: reference
[12:37:32] Extracting FASTA and GFF from reference.
[M::process] read 320292 sequences (80000104 bp)...
[12:37:32] Wrote 390082 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:32] Using BAM RG (Read Group) ID: SAL_KB6830AA_AS.out
[12:37:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:32] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:37:32] Running: bwa index reference/ref.fa 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 70214 sequences (17551350 bp)...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:32] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 19.608 CPU sec, 2.611 real sec
[12:37:32] Wrote 3 sequences to ref.fa
[12:37:32] Wrote 0 features to ref.gff
[12:37:32] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7542AA_AS.fasta into pseudo-reads
[12:37:32] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:32] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:32] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[12:37:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:32] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 69178 reads in 4.447 CPU sec, 0.510 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MB5439AA_AS.out\tSM:SAL_MB5439AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.037 sec; CPU: 24.637 sec
[samclip] Total SAM records 389353, removed 1107, allowed 184, passed 388246
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:33] Running: samtools index snps.bam 2>> snps.log
[M::process] read 320118 sequences (80000122 bp)...
[M::process] read 73624 sequences (18390972 bp)...
[12:37:33] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:33] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320008 sequences (80000410 bp)...
[M::process] read 70074 sequences (17518500 bp)...
[M::mem_process_seqs] Processed 320292 reads in 18.125 CPU sec, 2.625 real sec
[12:37:34] Wrote 390342 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:35] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:35] Using BAM RG (Read Group) ID: SAL_AB7542AA_AS.out
[12:37:35] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:35] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70214 reads in 4.166 CPU sec, 0.492 real sec
[12:37:35] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[12:37:35] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:35] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB7996AA_AS.out\tSM:SAL_IB7996AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.129 sec; CPU: 22.871 sec
[samclip] Total SAM records 390743, removed 795, allowed 71, passed 389948
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320118 reads in 18.160 CPU sec, 3.016 real sec
[12:37:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:36] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320008 reads in 18.276 CPU sec, 2.415 real sec
[12:37:36] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:36] Marked 0 heterozygous sites with 'n'
[12:37:36] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:36] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:36] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:36] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:37:36] Creating extra output files: BED GFF CSV TXT HTML
[12:37:36] Identified 19 variants.
[12:37:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out
[12:37:36] Result files:
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.aligned.fa
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bam.bai
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.bed
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.fa
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.consensus.subs.fa
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.csv
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.filt.vcf
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.gff
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.html
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.log
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.raw.vcf
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.subs.vcf
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.tab
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.txt
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz
[12:37:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out/snps.vcf.gz.csi
[12:37:36] Walltime used: 29 seconds
[12:37:36] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:36] Done.
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[Tue Jun 16 12:37:36 2020]
Finished job 108.
70 of 202 steps (35%) done

[Tue Jun 16 12:37:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
    jobid: 58
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[samclip] Processed 100000 records...
[12:37:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 100000 records...
[12:37:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:37] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 73624 reads in 4.735 CPU sec, 0.551 real sec
[samclip] Processed 200000 records...
[M::process] read 320000 sequences (80000000 bp)...
[12:37:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 70074 reads in 4.471 CPU sec, 0.526 real sec
[M::process] read 70342 sequences (17519162 bp)...
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[12:37:37] This is snippy 4.4.3
[12:37:37] Written by Torsten Seemann
[12:37:37] Obtained from https://github.com/tseemann/snippy
[12:37:37] Detected operating system: linux
[12:37:37] Enabling bundled linux tools.
[12:37:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:37] Found gzip - /usr/bin/gzip
[12:37:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1324AA_AS.out\tSM:SAL_SA1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.465 sec; CPU: 23.452 sec
[samclip] Total SAM records 393923, removed 902, allowed 133, passed 393021
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:37] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6830AA_AS.out\tSM:SAL_KB6830AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.870 sec; CPU: 23.305 sec
[samclip] Total SAM records 390268, removed 1175, allowed 164, passed 389093
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:37] Treating reference as 'fasta' format.
[12:37:37] Will use 8 CPU cores.
[12:37:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta
[12:37:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[12:37:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[12:37:37] Creating reference folder: reference
[12:37:37] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:38] Wrote 3 sequences to ref.fa
[12:37:38] Wrote 0 features to ref.gff
[12:37:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9988AA_AS.fasta into pseudo-reads
[12:37:38] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1809
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:37:38] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:38] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:39] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:39] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:39] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:39] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:39] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:39] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:39] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:39] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 16.363 CPU sec, 2.164 real sec
[samclip] Processed 100000 records...
[12:37:39] Running: samtools index snps.bam 2>> snps.log
[12:37:39] Running: samtools index snps.bam 2>> snps.log
[M::mem_process_seqs] Processed 70342 reads in 4.067 CPU sec, 0.475 real sec
[12:37:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 200000 records...
[12:37:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7542AA_AS.out\tSM:SAL_AB7542AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.559 sec; CPU: 20.964 sec
[samclip] Total SAM records 391084, removed 1808, allowed 278, passed 389276
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:40] Wrote 389596 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:40] Using BAM RG (Read Group) ID: SAL_BB9988AA_AS.out
[12:37:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:40] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:40] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:41] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:41] Marked 0 heterozygous sites with 'n'
[12:37:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:41] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:41] Creating extra output files: BED GFF CSV TXT HTML
[12:37:41] Identified 27 variants.
[12:37:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out
[12:37:41] Result files:
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.aligned.fa
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bam.bai
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.bed
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.fa
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.consensus.subs.fa
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.csv
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.filt.vcf
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.gff
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.html
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.log
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.raw.vcf
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.subs.vcf
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.tab
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.txt
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz
[12:37:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out/snps.vcf.gz.csi
[12:37:41] Walltime used: 19 seconds
[12:37:41] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:37:41] Done.
[Tue Jun 16 12:37:41 2020]
Finished job 137.
71 of 202 steps (35%) done

[Tue Jun 16 12:37:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
    jobid: 31
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB6779AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[12:37:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:42] This is snippy 4.4.3
[12:37:42] Written by Torsten Seemann
[12:37:42] Obtained from https://github.com/tseemann/snippy
[12:37:42] Detected operating system: linux
[12:37:42] Enabling bundled linux tools.
[12:37:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:42] Found gzip - /usr/bin/gzip
[12:37:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:42] Running: samtools index snps.bam 2>> snps.log
[12:37:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:42] Treating reference as 'fasta' format.
[12:37:42] Will use 8 CPU cores.
[12:37:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta
[12:37:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[12:37:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[12:37:42] Creating reference folder: reference
[12:37:42] Extracting FASTA and GFF from reference.
[12:37:42] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:42] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:42] Wrote 3 sequences to ref.fa
[12:37:42] Wrote 0 features to ref.gff
[12:37:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6779AA_AS.fasta into pseudo-reads
[12:37:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 69596 sequences (17394542 bp)...
[12:37:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 23

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 23
       total no. variants observed              : 1799
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:37:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:43] Marked 0 heterozygous sites with 'n'
[12:37:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:43] Creating extra output files: BED GFF CSV TXT HTML
[12:37:43] Identified 1809 variants.
[12:37:43] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out
[12:37:43] Result files:
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.aligned.fa
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bam.bai
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.bed
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.fa
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.consensus.subs.fa
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.csv
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.filt.vcf
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.gff
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.html
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.log
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.raw.vcf
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.subs.vcf
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.tab
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.txt
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz
[12:37:43] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out/snps.vcf.gz.csi
[12:37:43] Walltime used: 19 seconds
[12:37:43] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:37:43] Done.
[Tue Jun 16 12:37:43 2020]
Finished job 84.
72 of 202 steps (36%) done

[Tue Jun 16 12:37:43 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
    jobid: 177
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2669AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
[12:37:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:44] This is snippy 4.4.3
[12:37:44] Written by Torsten Seemann
[12:37:44] Obtained from https://github.com/tseemann/snippy
[12:37:44] Detected operating system: linux
[12:37:44] Enabling bundled linux tools.
[12:37:44] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:44] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:44] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:44] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:44] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:44] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:44] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:44] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:44] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:44] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:44] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:44] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:44] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:44] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:44] Found gzip - /usr/bin/gzip
[12:37:44] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:44] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:44] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:44] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:44] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:44] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:44] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:44] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:44] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:44] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:44] Treating reference as 'fasta' format.
[12:37:44] Will use 8 CPU cores.
[12:37:44] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta
[12:37:44] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[12:37:44] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[12:37:44] Creating reference folder: reference
[12:37:44] Extracting FASTA and GFF from reference.
[12:37:44] Wrote 3 sequences to ref.fa
[12:37:44] Wrote 0 features to ref.gff
[12:37:44] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2669AA_AS.fasta into pseudo-reads
[12:37:45] Wrote 389130 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:45] Using BAM RG (Read Group) ID: SAL_IB6779AA_AS.out
[12:37:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:45] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 17.540 CPU sec, 2.386 real sec
[12:37:45] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:45] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:45] Marked 0 heterozygous sites with 'n'
[12:37:45] Creating extra output files: BED GFF CSV TXT HTML
[12:37:45] Identified 20 variants.
[12:37:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out
[12:37:45] Result files:
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.aligned.fa
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bam.bai
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.bed
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.fa
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.consensus.subs.fa
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.csv
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.filt.vcf
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.gff
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.html
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.log
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.raw.vcf
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.subs.vcf
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.tab
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.txt
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz
[12:37:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out/snps.vcf.gz.csi
[12:37:45] Walltime used: 19 seconds
[12:37:45] May the SNPs be with you.
[12:37:45] Done.
[Tue Jun 16 12:37:45 2020]
Finished job 124.
73 of 202 steps (36%) done

[Tue Jun 16 12:37:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
    jobid: 77
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2598AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[samclip] Processed 100000 records...
[12:37:45] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:45] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:45] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:45] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:45] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:45] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 69596 reads in 4.281 CPU sec, 0.496 real sec
[samclip] Processed 200000 records...
[12:37:46] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:46] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:46] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:37:46] This is snippy 4.4.3
[12:37:46] Written by Torsten Seemann
[12:37:46] Obtained from https://github.com/tseemann/snippy
[12:37:46] Detected operating system: linux
[12:37:46] Enabling bundled linux tools.
[12:37:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:46] Found gzip - /usr/bin/gzip
[12:37:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9988AA_AS.out\tSM:SAL_BB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.788 sec; CPU: 22.393 sec
[samclip] Total SAM records 389928, removed 961, allowed 81, passed 388967
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:46] Treating reference as 'fasta' format.
[12:37:46] Will use 8 CPU cores.
[12:37:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta
[12:37:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[12:37:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[12:37:46] Creating reference folder: reference
[12:37:46] Extracting FASTA and GFF from reference.
[12:37:46] Wrote 3 sequences to ref.fa
[12:37:46] Wrote 0 features to ref.gff
[12:37:46] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2598AA_AS.fasta into pseudo-reads
[12:37:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:47] Wrote 390114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:47] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:47] Using BAM RG (Read Group) ID: SAL_CB2669AA_AS.out
[12:37:47] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:47] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:47] Marked 224 heterozygous sites with 'n'
[12:37:47] Creating extra output files: BED GFF CSV TXT HTML
[12:37:47] Identified 24 variants.
[12:37:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out
[12:37:47] Result files:
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.aligned.fa
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bam.bai
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.bed
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.fa
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.consensus.subs.fa
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.csv
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.filt.vcf
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.gff
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.html
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.log
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.raw.vcf
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.subs.vcf
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.tab
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.txt
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz
[12:37:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out/snps.vcf.gz.csi
[12:37:47] Walltime used: 19 seconds
[12:37:47] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:37:47] Done.
[Tue Jun 16 12:37:47 2020]
Finished job 179.
74 of 202 steps (37%) done

[Tue Jun 16 12:37:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
    jobid: 119
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB6801AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[M::process] read 320016 sequences (80000232 bp)...
[M::process] read 69114 sequences (17274708 bp)...
[12:37:47] Marked 11 heterozygous sites with 'n'
[12:37:48] Creating extra output files: BED GFF CSV TXT HTML
[12:37:48] Identified 1799 variants.
[12:37:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out
[12:37:48] Result files:
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.aligned.fa
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bam.bai
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.bed
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.fa
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.consensus.subs.fa
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.csv
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.filt.vcf
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.gff
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.html
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.log
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.raw.vcf
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.subs.vcf
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.tab
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.txt
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz
[12:37:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out/snps.vcf.gz.csi
[12:37:48] Walltime used: 19 seconds
[12:37:48] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:48] Done.
[Tue Jun 16 12:37:48 2020]
Finished job 34.
75 of 202 steps (37%) done

[Tue Jun 16 12:37:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
    jobid: 106
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB1324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:48] This is snippy 4.4.3
[12:37:48] Written by Torsten Seemann
[12:37:48] Obtained from https://github.com/tseemann/snippy
[12:37:48] Detected operating system: linux
[12:37:48] Enabling bundled linux tools.
[12:37:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:48] Found gzip - /usr/bin/gzip
[12:37:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:48] Running: samtools index snps.bam 2>> snps.log
[12:37:48] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:48] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:48] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:48] Treating reference as 'fasta' format.
[12:37:48] Will use 8 CPU cores.
[12:37:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta
[12:37:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[12:37:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[12:37:48] Creating reference folder: reference
[12:37:48] Extracting FASTA and GFF from reference.
[12:37:48] This is snippy 4.4.3
[12:37:48] Written by Torsten Seemann
[12:37:48] Obtained from https://github.com/tseemann/snippy
[12:37:48] Detected operating system: linux
[12:37:48] Enabling bundled linux tools.
[12:37:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:48] Wrote 3 sequences to ref.fa
[12:37:48] Wrote 0 features to ref.gff
[12:37:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB6801AA_AS.fasta into pseudo-reads
[12:37:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:48] Found gzip - /usr/bin/gzip
[12:37:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:49] Treating reference as 'fasta' format.
[12:37:49] Will use 8 CPU cores.
[12:37:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta
[12:37:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[12:37:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[12:37:49] Creating reference folder: reference
[12:37:49] Extracting FASTA and GFF from reference.
[12:37:49] Wrote 3 sequences to ref.fa
[12:37:49] Wrote 0 features to ref.gff
[12:37:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB1324AA_AS.fasta into pseudo-reads
[12:37:49] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:49] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:49] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:49] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:49] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:49] Wrote 389850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:49] Using BAM RG (Read Group) ID: SAL_CB2598AA_AS.out
[12:37:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:49] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 70114 sequences (17460752 bp)...
[M::mem_process_seqs] Processed 320016 reads in 18.155 CPU sec, 2.379 real sec
[12:37:50] Marked 0 heterozygous sites with 'n'
[12:37:50] Creating extra output files: BED GFF CSV TXT HTML
[12:37:50] Identified 27 variants.
[12:37:50] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out
[12:37:50] Result files:
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.aligned.fa
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bam.bai
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.bed
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.fa
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.consensus.subs.fa
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.csv
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.filt.vcf
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.gff
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.html
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.log
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.raw.vcf
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.subs.vcf
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.tab
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.txt
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz
[12:37:50] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out/snps.vcf.gz.csi
[12:37:50] Walltime used: 19 seconds
[12:37:50] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:37:50] Done.
[Tue Jun 16 12:37:50 2020]
Finished job 115.
76 of 202 steps (38%) done

[Tue Jun 16 12:37:50 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
    jobid: 141
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2970AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69114 reads in 4.955 CPU sec, 0.577 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:37:50] This is snippy 4.4.3
[12:37:50] Written by Torsten Seemann
[12:37:50] Obtained from https://github.com/tseemann/snippy
[12:37:50] Detected operating system: linux
[12:37:50] Enabling bundled linux tools.
[12:37:51] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:51] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:51] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:51] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:51] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:51] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:51] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:51] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:51] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:51] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:51] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:51] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:51] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:37:51] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:51] Found gzip - /usr/bin/gzip
[12:37:51] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:51] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:51] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:51] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:51] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:51] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:51] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6779AA_AS.out\tSM:SAL_IB6779AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.758 sec; CPU: 23.624 sec
[samclip] Total SAM records 389354, removed 1595, allowed 224, passed 387759
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:51] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:51] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:51] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:37:51] Treating reference as 'fasta' format.
[12:37:51] Will use 8 CPU cores.
[12:37:51] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta
[12:37:51] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[12:37:51] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[12:37:51] Creating reference folder: reference
[12:37:51] Extracting FASTA and GFF from reference.
[12:37:51] Wrote 3 sequences to ref.fa
[12:37:51] Wrote 0 features to ref.gff
[12:37:51] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2970AA_AS.fasta into pseudo-reads
[12:37:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:37:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:37:51] Wrote 389442 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:37:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:51] Using BAM RG (Read Group) ID: SAL_IB6801AA_AS.out
[12:37:51] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 42
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:51] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[12:37:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 69850 sequences (17398288 bp)...
[12:37:51] Wrote 389650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:51] Using BAM RG (Read Group) ID: SAL_CB1324AA_AS.out
[12:37:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:51] Running: bwa index reference/ref.fa 2>> snps.log
[12:37:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:52] Running: rm -f fake_reads\.fq 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 18.342 CPU sec, 2.546 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 70114 reads in 4.168 CPU sec, 0.479 real sec
[samclip] Processed 200000 records...
[12:37:53] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 300000 records...
[12:37:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2669AA_AS.out\tSM:SAL_CB2669AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.959 sec; CPU: 23.075 sec
[samclip] Total SAM records 390411, removed 831, allowed 90, passed 389580
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::process] read 320040 sequences (80000230 bp)...
[12:37:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 69402 sequences (17313044 bp)...
[M::process] read 320020 sequences (80000364 bp)...
[12:37:54] Wrote 391206 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:37:54] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:37:54] Using BAM RG (Read Group) ID: SAL_BB2970AA_AS.out
[12:37:54] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:37:54] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 69630 sequences (17337020 bp)...
[M::mem_process_seqs] Processed 320000 reads in 17.568 CPU sec, 2.495 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69850 reads in 4.060 CPU sec, 0.530 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[12:37:55] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2598AA_AS.out\tSM:SAL_CB2598AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390229, removed 1109, allowed 119, passed 389120

[main] Real time: 4.149 sec; CPU: 22.231 sec
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:55] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:55] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:56] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:37:56] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:37:56] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:37:56] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:37:56] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320040 reads in 16.891 CPU sec, 2.433 real sec
[12:37:56] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320020 reads in 16.751 CPU sec, 2.270 real sec
[M::process] read 320386 sequences (80000080 bp)...
[samclip] Processed 100000 records...
[12:37:56] Creating extra output files: BED GFF CSV TXT HTML
[12:37:56] Identified 42 variants.
[12:37:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out
[12:37:56] Result files:
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.aligned.fa
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bam.bai
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.bed
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.fa
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.consensus.subs.fa
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.csv
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.filt.vcf
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.gff
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.html
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.log
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.raw.vcf
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.subs.vcf
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.tab
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.txt
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz
[12:37:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out/snps.vcf.gz.csi
[12:37:56] Walltime used: 19 seconds
[12:37:56] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:37:56] Done.
[Tue Jun 16 12:37:56 2020]
Finished job 58.
77 of 202 steps (38%) done

[Tue Jun 16 12:37:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
    jobid: 25
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2131AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[12:37:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 2003
       total no. reference observed             : 0

Time elapsed: 0.02s

[M::mem_process_seqs] Processed 69402 reads in 3.710 CPU sec, 0.443 real sec
[12:37:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::process] read 70820 sequences (17705000 bp)...
[12:37:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::mem_process_seqs] Processed 69630 reads in 4.167 CPU sec, 0.488 real sec
[12:37:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 200000 records...
[12:37:57] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] Processed 300000 records...
[12:37:57] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:57] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:37:57] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:57] Running: rm -f fake_reads\.fq 2>> snps.log
[12:37:57] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB6801AA_AS.out\tSM:SAL_IB6801AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 389685, removed 716, allowed 60, passed 388969
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.893 sec; CPU: 21.170 sec
[12:37:57] This is snippy 4.4.3
[12:37:57] Written by Torsten Seemann
[12:37:57] Obtained from https://github.com/tseemann/snippy
[12:37:57] Detected operating system: linux
[12:37:57] Enabling bundled linux tools.
[12:37:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:37:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:37:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:37:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:37:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:37:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:37:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:37:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:37:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:37:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:37:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:37:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:37:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:37:57] Found gzip - /usr/bin/gzip
[12:37:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:37:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:37:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:37:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:37:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:37:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:37:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:37:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:37:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:37:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB1324AA_AS.out\tSM:SAL_CB1324AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390070, removed 1171, allowed 134, passed 388899

[main] Real time: 3.750 sec; CPU: 21.508 sec
[samclip] Header contained 5 lines
[samclip] Done.
[12:37:57] Treating reference as 'fasta' format.
[12:37:57] Will use 8 CPU cores.
[12:37:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta
[12:37:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[12:37:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[12:37:57] Creating reference folder: reference
[12:37:57] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:57] Running: samtools index snps.bam 2>> snps.log
[12:37:57] Wrote 3 sequences to ref.fa
[12:37:57] Wrote 0 features to ref.gff
[12:37:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2131AA_AS.fasta into pseudo-reads
[12:37:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:37:58] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:37:58] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:37:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:37:58] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:37:58] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:37:58] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:37:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:37:58] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:37:58] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:37:58] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:37:59] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:37:59] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320386 reads in 17.423 CPU sec, 2.618 real sec
[12:37:59] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:37:59] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[12:37:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:37:59] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 200000 records...
[12:37:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:37:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 70820 reads in 5.330 CPU sec, 0.619 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2970AA_AS.out\tSM:SAL_BB2970AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.009 sec; CPU: 23.273 sec
[samclip] Total SAM records 391641, removed 1206, allowed 106, passed 390435
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:00] Wrote 390266 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:00] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:00] Using BAM RG (Read Group) ID: SAL_BB2131AA_AS.out
[12:38:00] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:00] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:01] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:01] Marked 0 heterozygous sites with 'n'
[12:38:01] Creating extra output files: BED GFF CSV TXT HTML
[12:38:01] Identified 2003 variants.
[12:38:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:01] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out
[12:38:01] Result files:
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.aligned.fa
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bam.bai
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.bed
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.fa
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.consensus.subs.fa
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.csv
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.filt.vcf
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.gff
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.html
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.log
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.raw.vcf
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.subs.vcf
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.tab
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.txt
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz
[12:38:01] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out/snps.vcf.gz.csi
[12:38:01] Walltime used: 19 seconds
[12:38:01] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:01] Done.
[Tue Jun 16 12:38:01 2020]
Finished job 31.
78 of 202 steps (39%) done

[Tue Jun 16 12:38:01 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
    jobid: 140
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6734AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:02] Running: samtools index snps.bam 2>> snps.log
[12:38:02] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:02] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:02] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:02] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:02] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:02] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:02] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 41
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:02] This is snippy 4.4.3
[12:38:02] Written by Torsten Seemann
[12:38:02] Obtained from https://github.com/tseemann/snippy
[12:38:02] Detected operating system: linux
[12:38:02] Enabling bundled linux tools.
[12:38:02] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:02] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:02] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:02] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:02] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:02] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:02] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:02] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:02] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:02] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:02] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:02] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:02] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:02] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:02] Found gzip - /usr/bin/gzip
[12:38:02] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:02] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:02] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:02] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:02] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:02] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:02] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320024 sequences (80000176 bp)...
[12:38:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 70242 sequences (17560500 bp)...
[12:38:02] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:02] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:02] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:02] Treating reference as 'fasta' format.
[12:38:02] Will use 8 CPU cores.
[12:38:02] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta
[12:38:02] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[12:38:02] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[12:38:02] Creating reference folder: reference
[12:38:02] Extracting FASTA and GFF from reference.
[12:38:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:02] Wrote 3 sequences to ref.fa
[12:38:02] Wrote 0 features to ref.gff
[12:38:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6734AA_AS.fasta into pseudo-reads
[12:38:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:03] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:03] Marked 0 heterozygous sites with 'n'
[12:38:03] Creating extra output files: BED GFF CSV TXT HTML
[12:38:03] Identified 17 variants.
[12:38:03] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out
[12:38:03] Result files:
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.aligned.fa
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bam.bai
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.bed
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.fa
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.consensus.subs.fa
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.csv
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.filt.vcf
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.gff
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.html
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.log
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.raw.vcf
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.subs.vcf
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.tab
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.txt
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz
[12:38:03] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out/snps.vcf.gz.csi
[12:38:03] Walltime used: 19 seconds
[12:38:03] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:03] Done.
[Tue Jun 16 12:38:03 2020]
Finished job 177.
79 of 202 steps (39%) done

[Tue Jun 16 12:38:03 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
    jobid: 73
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5379AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:04] This is snippy 4.4.3
[12:38:04] Written by Torsten Seemann
[12:38:04] Obtained from https://github.com/tseemann/snippy
[12:38:04] Detected operating system: linux
[12:38:04] Enabling bundled linux tools.
[12:38:04] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:04] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:04] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:04] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:04] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:04] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:04] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:04] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:04] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:04] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:04] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:04] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:04] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:04] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:04] Found gzip - /usr/bin/gzip
[12:38:04] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:04] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:04] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:04] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:04] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:04] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:04] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:04] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:04] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:04] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:04] Treating reference as 'fasta' format.
[12:38:04] Will use 8 CPU cores.
[12:38:04] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta
[12:38:04] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[12:38:04] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[12:38:04] Creating reference folder: reference
[12:38:04] Extracting FASTA and GFF from reference.
[12:38:04] Wrote 3 sequences to ref.fa
[12:38:04] Wrote 0 features to ref.gff
[12:38:04] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5379AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320024 reads in 17.235 CPU sec, 2.395 real sec
[12:38:05] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:05] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 100000 records...
[12:38:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:05] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 70242 reads in 4.311 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[12:38:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:05] Creating extra output files: BED GFF CSV TXT HTML
[12:38:05] Identified 29 variants.
[12:38:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out
[12:38:05] Result files:
[12:38:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.aligned.fa
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bam.bai
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.bed
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.fa
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.consensus.subs.fa
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.csv
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.filt.vcf
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.gff
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.html
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.log
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.raw.vcf
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.subs.vcf
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.tab
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.txt
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz
[12:38:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out/snps.vcf.gz.csi
[12:38:05] Walltime used: 19 seconds
[12:38:05] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:38:05] Done.
[12:38:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[Tue Jun 16 12:38:05 2020]
Finished job 77.
80 of 202 steps (40%) done

[Tue Jun 16 12:38:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
    jobid: 56
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2219AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[12:38:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:05] Wrote 387804 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:05] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:05] Using BAM RG (Read Group) ID: SAL_KB6734AA_AS.out
[12:38:05] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:05] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:05] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[12:38:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2131AA_AS.out\tSM:SAL_BB2131AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.793 sec; CPU: 22.093 sec
[samclip] Total SAM records 390573, removed 982, allowed 240, passed 389591
[samclip] Header contained 5 lines
[samclip] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:06] This is snippy 4.4.3
[12:38:06] Written by Torsten Seemann
[12:38:06] Obtained from https://github.com/tseemann/snippy
[12:38:06] Detected operating system: linux
[12:38:06] Enabling bundled linux tools.
[12:38:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:06] Found gzip - /usr/bin/gzip
[12:38:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:06] Treating reference as 'fasta' format.
[12:38:06] Will use 8 CPU cores.
[12:38:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta
[12:38:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[12:38:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[12:38:06] Creating reference folder: reference
[12:38:06] Extracting FASTA and GFF from reference.
[12:38:06] Wrote 3 sequences to ref.fa
[12:38:06] Wrote 0 features to ref.gff
[12:38:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2219AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:07] Marked 0 heterozygous sites with 'n'
[12:38:07] Creating extra output files: BED GFF CSV TXT HTML
[12:38:07] Identified 41 variants.
[12:38:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out
[12:38:07] Result files:
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.aligned.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bam.bai
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.bed
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.consensus.subs.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.csv
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.filt.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.gff
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.html
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.log
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.raw.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.subs.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.tab
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.txt
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out/snps.vcf.gz.csi
[12:38:07] Walltime used: 19 seconds
[12:38:07] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:38:07] Done.
[Tue Jun 16 12:38:07 2020]
Finished job 119.
81 of 202 steps (40%) done

[Tue Jun 16 12:38:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
    jobid: 45
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB3115AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[12:38:07] Wrote 388498 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:07] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:07] Using BAM RG (Read Group) ID: SAL_CB5379AA_AS.out
[12:38:07] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:07] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:07] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:07] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:07] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:07] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:07] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:38:07] Marked 0 heterozygous sites with 'n'
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:07] Creating extra output files: BED GFF CSV TXT HTML
[12:38:07] Identified 19 variants.
[12:38:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out
[12:38:07] Result files:
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.aligned.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bam.bai
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.bed
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.consensus.subs.fa
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.csv
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.filt.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.gff
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.html
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.log
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.raw.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.subs.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.tab
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.txt
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz
[12:38:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out/snps.vcf.gz.csi
[12:38:07] Walltime used: 19 seconds
[12:38:07] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:38:07] Done.
[Tue Jun 16 12:38:07 2020]
Finished job 106.
82 of 202 steps (41%) done

[Tue Jun 16 12:38:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
    jobid: 30
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB9118AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::process] read 320044 sequences (80000476 bp)...
[M::process] read 67760 sequences (16940000 bp)...
[12:38:07] This is snippy 4.4.3
[12:38:07] Written by Torsten Seemann
[12:38:07] Obtained from https://github.com/tseemann/snippy
[12:38:07] Detected operating system: linux
[12:38:07] Enabling bundled linux tools.
[12:38:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:07] Found gzip - /usr/bin/gzip
[12:38:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:08] Running: samtools index snps.bam 2>> snps.log
[12:38:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:08] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:08] Treating reference as 'fasta' format.
[12:38:08] Will use 8 CPU cores.
[12:38:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta
[12:38:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[12:38:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[12:38:08] Creating reference folder: reference
[12:38:08] Extracting FASTA and GFF from reference.
[12:38:08] This is snippy 4.4.3
[12:38:08] Written by Torsten Seemann
[12:38:08] Obtained from https://github.com/tseemann/snippy
[12:38:08] Detected operating system: linux
[12:38:08] Enabling bundled linux tools.
[12:38:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:08] Found gzip - /usr/bin/gzip
[12:38:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:08] Wrote 3 sequences to ref.fa
[12:38:08] Wrote 0 features to ref.gff
[12:38:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB3115AA_AS.fasta into pseudo-reads
[12:38:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:08] Treating reference as 'fasta' format.
[12:38:08] Will use 8 CPU cores.
[12:38:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta
[12:38:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[12:38:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[12:38:08] Creating reference folder: reference
[12:38:08] Extracting FASTA and GFF from reference.
[12:38:08] Wrote 3 sequences to ref.fa
[12:38:08] Wrote 0 features to ref.gff
[12:38:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9118AA_AS.fasta into pseudo-reads
[12:38:09] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:09] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:09] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:09] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:09] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:09] Wrote 388312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:09] Using BAM RG (Read Group) ID: SAL_HB2219AA_AS.out
[M::process] read 320000 sequences (80000000 bp)...
[12:38:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:09] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 68498 sequences (17108608 bp)...
[12:38:09] Marked 0 heterozygous sites with 'n'
[12:38:09] Creating extra output files: BED GFF CSV TXT HTML
[12:38:09] Identified 17 variants.
[12:38:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out
[12:38:09] Result files:
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.aligned.fa
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bam.bai
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.bed
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.fa
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.consensus.subs.fa
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.csv
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.filt.vcf
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.gff
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.html
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.log
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.raw.vcf
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.subs.vcf
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.tab
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.txt
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz
[12:38:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out/snps.vcf.gz.csi
[12:38:09] Walltime used: 19 seconds
[12:38:09] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:38:09] Done.
[Tue Jun 16 12:38:09 2020]
Finished job 141.
83 of 202 steps (41%) done

[Tue Jun 16 12:38:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
    jobid: 120
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[M::mem_process_seqs] Processed 320044 reads in 17.638 CPU sec, 2.379 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67760 reads in 3.895 CPU sec, 0.449 real sec
[12:38:10] This is snippy 4.4.3
[12:38:10] Written by Torsten Seemann
[12:38:10] Obtained from https://github.com/tseemann/snippy
[12:38:10] Detected operating system: linux
[12:38:10] Enabling bundled linux tools.
[12:38:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:10] Found gzip - /usr/bin/gzip
[12:38:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[samclip] Processed 200000 records...
[12:38:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[samclip] Processed 300000 records...
[12:38:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:10] Treating reference as 'fasta' format.
[12:38:10] Will use 8 CPU cores.
[12:38:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta
[12:38:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[12:38:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[12:38:10] Creating reference folder: reference
[12:38:10] Extracting FASTA and GFF from reference.
[12:38:11] Wrote 388058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:11] Using BAM RG (Read Group) ID: SAL_IB3115AA_AS.out
[12:38:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:38:11] Wrote 3 sequences to ref.fa
[12:38:11] Wrote 0 features to ref.gff
[12:38:11] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4728AA_AS.fasta into pseudo-reads
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6734AA_AS.out\tSM:SAL_KB6734AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.777 sec; CPU: 22.110 sec
[samclip] Total SAM records 387938, removed 504, allowed 38, passed 387434
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:11] Running: bwa index reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:11] Wrote 387684 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:11] Using BAM RG (Read Group) ID: SAL_IB9118AA_AS.out
[12:38:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:38:11] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.699 CPU sec, 2.240 real sec
[12:38:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320024 sequences (80000272 bp)...
[M::process] read 68288 sequences (17043056 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 68498 reads in 4.425 CPU sec, 0.511 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5379AA_AS.out\tSM:SAL_CB5379AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.652 sec; CPU: 21.668 sec
[samclip] Total SAM records 388916, removed 1029, allowed 78, passed 387887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:13] Running: samtools index snps.bam 2>> snps.log
[12:38:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:13] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:13] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320062 sequences (80000346 bp)...
[M::process] read 67996 sequences (16962818 bp)...
[M::process] read 320094 sequences (80000328 bp)...
[M::process] read 67590 sequences (16897500 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:13] Wrote 392448 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:13] Using BAM RG (Read Group) ID: SAL_CA4728AA_AS.out
[12:38:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:13] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320024 reads in 17.040 CPU sec, 2.660 real sec
[12:38:14] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[12:38:14] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 68288 reads in 3.882 CPU sec, 0.474 real sec
[12:38:14] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320062 reads in 17.371 CPU sec, 2.314 real sec
[12:38:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2219AA_AS.out\tSM:SAL_HB2219AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.356 sec; CPU: 21.556 sec
[samclip] Total SAM records 388641, removed 826, allowed 90, passed 387815
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:15] Marked 0 heterozygous sites with 'n'
[12:38:16] Creating extra output files: BED GFF CSV TXT HTML
[12:38:16] Identified 29 variants.
[12:38:16] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out
[12:38:16] Result files:
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.aligned.fa
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bam.bai
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.bed
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.fa
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.consensus.subs.fa
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.csv
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.filt.vcf
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.gff
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.html
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.log
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.raw.vcf
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.subs.vcf
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.tab
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.txt
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz
[12:38:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out/snps.vcf.gz.csi
[12:38:16] Walltime used: 19 seconds
[12:38:16] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:16] Done.
[Tue Jun 16 12:38:16 2020]
Finished job 25.
84 of 202 steps (42%) done

[Tue Jun 16 12:38:16 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
    jobid: 164
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4803AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[samclip] Processed 100000 records...
[M::process] read 320100 sequences (80000048 bp)...
[M::mem_process_seqs] Processed 67996 reads in 3.937 CPU sec, 0.460 real sec
[M::process] read 72348 sequences (18083964 bp)...
[12:38:16] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:16] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[12:38:16] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320094 reads in 18.479 CPU sec, 2.881 real sec
[12:38:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[12:38:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:16] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[12:38:16] This is snippy 4.4.3
[12:38:16] Written by Torsten Seemann
[12:38:16] Obtained from https://github.com/tseemann/snippy
[12:38:16] Detected operating system: linux
[12:38:16] Enabling bundled linux tools.
[12:38:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:16] Found gzip - /usr/bin/gzip
[12:38:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB3115AA_AS.out\tSM:SAL_IB3115AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.796 sec; CPU: 21.896 sec
[samclip] Total SAM records 388474, removed 1480, allowed 193, passed 386994
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 67590 reads in 4.111 CPU sec, 0.479 real sec
[12:38:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[samclip] Processed 200000 records...
[12:38:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:17] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:17] Treating reference as 'fasta' format.
[12:38:17] Will use 8 CPU cores.
[12:38:17] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta
[12:38:17] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[12:38:17] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[12:38:17] Creating reference folder: reference
[12:38:17] Extracting FASTA and GFF from reference.
[12:38:17] Wrote 3 sequences to ref.fa
[12:38:17] Wrote 0 features to ref.gff
[12:38:17] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4803AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9118AA_AS.out\tSM:SAL_IB9118AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.306 sec; CPU: 23.164 sec
[samclip] Total SAM records 387893, removed 737, allowed 98, passed 387156
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:17] Running: samtools index snps.bam 2>> snps.log
[12:38:17] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:17] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:17] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:17] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:17] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:18] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:18] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:18] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:18] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:18] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:18] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:18] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:18] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:18] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320100 reads in 17.552 CPU sec, 2.341 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[12:38:18] Running: samtools index snps.bam 2>> snps.log
[12:38:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 72348 reads in 4.781 CPU sec, 0.561 real sec
[samclip] Processed 300000 records...
[12:38:19] Running: samtools index snps.bam 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4728AA_AS.out\tSM:SAL_CA4728AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.750 sec; CPU: 22.868 sec
[samclip] Total SAM records 392624, removed 994, allowed 114, passed 391630
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:19] Wrote 392020 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:19] Using BAM RG (Read Group) ID: SAL_CA4803AA_AS.out
[12:38:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:20] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:20] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:38:20] Marked 0 heterozygous sites with 'n'
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:20] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:20] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:20] Creating extra output files: BED GFF CSV TXT HTML
[12:38:20] Identified 105 variants.
[12:38:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out
[12:38:20] Result files:
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.aligned.fa
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bam.bai
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.bed
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.fa
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.consensus.subs.fa
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.csv
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.filt.vcf
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.gff
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.html
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.log
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.raw.vcf
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.subs.vcf
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.tab
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.txt
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz
[12:38:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out/snps.vcf.gz.csi
[12:38:20] Walltime used: 18 seconds
[12:38:20] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:38:20] Done.
[Tue Jun 16 12:38:20 2020]
Finished job 140.
85 of 202 steps (42%) done

[Tue Jun 16 12:38:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
    jobid: 155
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB4414AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[12:38:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:21] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:21] Running: samtools index snps.bam 2>> snps.log
[12:38:21] This is snippy 4.4.3
[12:38:21] Written by Torsten Seemann
[12:38:21] Obtained from https://github.com/tseemann/snippy
[12:38:21] Detected operating system: linux
[12:38:21] Enabling bundled linux tools.
[12:38:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:21] Found gzip - /usr/bin/gzip
[12:38:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:21] Treating reference as 'fasta' format.
[12:38:21] Will use 8 CPU cores.
[12:38:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta
[12:38:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[12:38:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[12:38:21] Creating reference folder: reference
[12:38:21] Extracting FASTA and GFF from reference.
[12:38:22] Wrote 3 sequences to ref.fa
[12:38:22] Wrote 0 features to ref.gff
[12:38:22] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB4414AA_AS.fasta into pseudo-reads
[M::process] read 320018 sequences (80000222 bp)...
[12:38:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1697
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:38:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 72002 sequences (17989846 bp)...
[12:38:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:22] Marked 0 heterozygous sites with 'n'
[12:38:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:22] Creating extra output files: BED GFF CSV TXT HTML
[12:38:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:22] Identified 13 variants.
[12:38:22] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out
[12:38:22] Result files:
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.aligned.fa
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bam.bai
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.bed
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.fa
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.consensus.subs.fa
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.csv
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.filt.vcf
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.gff
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.html
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.log
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.raw.vcf
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.subs.vcf
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.tab
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.txt
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz
[12:38:22] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out/snps.vcf.gz.csi
[12:38:22] Walltime used: 18 seconds
[12:38:22] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:22] Done.
[12:38:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[Tue Jun 16 12:38:22 2020]
Finished job 73.
86 of 202 steps (43%) done

[Tue Jun 16 12:38:22 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
    jobid: 116
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4937AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
[12:38:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 185
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:23] This is snippy 4.4.3
[12:38:23] Written by Torsten Seemann
[12:38:23] Obtained from https://github.com/tseemann/snippy
[12:38:23] Detected operating system: linux
[12:38:23] Enabling bundled linux tools.
[12:38:23] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:23] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:23] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:23] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:23] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:23] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:23] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:23] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:23] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:23] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:23] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:23] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:23] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:23] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:23] Found gzip - /usr/bin/gzip
[12:38:23] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:23] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:23] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:23] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:23] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:23] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:23] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:23] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:23] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:23] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:23] Treating reference as 'fasta' format.
[12:38:23] Will use 8 CPU cores.
[12:38:23] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta
[12:38:23] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[12:38:23] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[12:38:23] Creating reference folder: reference
[12:38:23] Extracting FASTA and GFF from reference.
[12:38:23] Wrote 3 sequences to ref.fa
[12:38:23] Wrote 0 features to ref.gff
[12:38:23] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4937AA_AS.fasta into pseudo-reads
[12:38:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 120
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320018 reads in 19.334 CPU sec, 2.616 real sec
[12:38:24] Wrote 387532 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:24] Using BAM RG (Read Group) ID: SAL_JB4414AA_AS.out
[12:38:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:24] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[12:38:25] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:25] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:25] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:25] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:25] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:25] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 72002 reads in 4.873 CPU sec, 0.561 real sec
[12:38:25] Marked 0 heterozygous sites with 'n'
[12:38:25] Creating extra output files: BED GFF CSV TXT HTML
[12:38:25] Identified 17 variants.
[12:38:25] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out
[12:38:25] Result files:
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.aligned.fa
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bam.bai
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.bed
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.fa
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.consensus.subs.fa
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.csv
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.filt.vcf
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.gff
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.html
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.log
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.raw.vcf
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.subs.vcf
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.tab
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.txt
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz
[12:38:25] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out/snps.vcf.gz.csi
[12:38:25] Walltime used: 19 seconds
[12:38:25] Wishing you a life free of homopolymer errors.
[12:38:25] Done.
[Tue Jun 16 12:38:25 2020]
Finished job 56.
87 of 202 steps (43%) done

[Tue Jun 16 12:38:25 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
    jobid: 182
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9389AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4803AA_AS.out\tSM:SAL_CA4803AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.043 sec; CPU: 24.757 sec
[samclip] Total SAM records 392443, removed 2978, allowed 329, passed 389465
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:26] Wrote 388660 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:26] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:26] Using BAM RG (Read Group) ID: SAL_BB4937AA_AS.out
[12:38:26] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:26] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:26] This is snippy 4.4.3
[12:38:26] Written by Torsten Seemann
[12:38:26] Obtained from https://github.com/tseemann/snippy
[12:38:26] Detected operating system: linux
[12:38:26] Enabling bundled linux tools.
[12:38:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:26] Found gzip - /usr/bin/gzip
[12:38:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:38:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:26] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:26] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:26] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:26] Treating reference as 'fasta' format.
[12:38:26] Will use 8 CPU cores.
[12:38:26] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta
[12:38:26] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[12:38:26] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[12:38:26] Creating reference folder: reference
[12:38:26] Extracting FASTA and GFF from reference.
[12:38:26] Wrote 3 sequences to ref.fa
[12:38:26] Wrote 0 features to ref.gff
[12:38:26] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9389AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:26] Marked 0 heterozygous sites with 'n'
[M::process] read 320096 sequences (80000392 bp)...
[12:38:26] Creating extra output files: BED GFF CSV TXT HTML
[12:38:26] Identified 1697 variants.
[12:38:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out
[12:38:26] Result files:
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.aligned.fa
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bam.bai
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.bed
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.fa
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.consensus.subs.fa
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.csv
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.filt.vcf
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.gff
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.html
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.log
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.raw.vcf
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.subs.vcf
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.tab
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.txt
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz
[12:38:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out/snps.vcf.gz.csi
[12:38:26] Walltime used: 19 seconds
[12:38:26] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:38:26] Done.
[M::process] read 67436 sequences (16851378 bp)...
[Tue Jun 16 12:38:27 2020]
Finished job 45.
88 of 202 steps (44%) done

[Tue Jun 16 12:38:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
    jobid: 17
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB1406AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[12:38:27] Marked 4 heterozygous sites with 'n'
[12:38:27] Creating extra output files: BED GFF CSV TXT HTML
[12:38:27] Identified 185 variants.
[12:38:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out
[12:38:27] Result files:
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.aligned.fa
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bam.bai
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.bed
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.fa
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.consensus.subs.fa
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.csv
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.filt.vcf
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.gff
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.html
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.log
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.raw.vcf
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.subs.vcf
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.tab
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.txt
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz
[12:38:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out/snps.vcf.gz.csi
[12:38:27] Walltime used: 19 seconds
[12:38:27] Questionable SNP? Try the --report option to see the alignments.
[12:38:27] Done.
[Tue Jun 16 12:38:27 2020]
Finished job 30.
89 of 202 steps (44%) done

[Tue Jun 16 12:38:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
    jobid: 46
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB4026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:27] This is snippy 4.4.3
[12:38:27] Written by Torsten Seemann
[12:38:27] Obtained from https://github.com/tseemann/snippy
[12:38:27] Detected operating system: linux
[12:38:27] Enabling bundled linux tools.
[12:38:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:27] Found gzip - /usr/bin/gzip
[12:38:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:27] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:27] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:27] Treating reference as 'fasta' format.
[12:38:27] Will use 8 CPU cores.
[12:38:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta
[12:38:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[12:38:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[12:38:27] Creating reference folder: reference
[12:38:27] Extracting FASTA and GFF from reference.
[12:38:28] This is snippy 4.4.3
[12:38:28] Written by Torsten Seemann
[12:38:28] Obtained from https://github.com/tseemann/snippy
[12:38:28] Detected operating system: linux
[12:38:28] Enabling bundled linux tools.
[12:38:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:28] Found gzip - /usr/bin/gzip
[12:38:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:28] Wrote 3 sequences to ref.fa
[12:38:28] Wrote 0 features to ref.gff
[12:38:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB1406AA_AS.fasta into pseudo-reads
[12:38:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:28] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:28] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:28] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:28] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:28] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:28] Treating reference as 'fasta' format.
[12:38:28] Will use 8 CPU cores.
[12:38:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta
[12:38:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[12:38:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[12:38:28] Creating reference folder: reference
[12:38:28] Extracting FASTA and GFF from reference.
[12:38:28] Wrote 3 sequences to ref.fa
[12:38:28] Wrote 0 features to ref.gff
[12:38:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4026AA_AS.fasta into pseudo-reads
[M::process] read 320226 sequences (80000298 bp)...
[M::process] read 68434 sequences (17060382 bp)...
[M::mem_process_seqs] Processed 320096 reads in 17.144 CPU sec, 2.335 real sec
[12:38:29] Marked 1 heterozygous sites with 'n'
[12:38:29] Creating extra output files: BED GFF CSV TXT HTML
[12:38:29] Identified 120 variants.
[12:38:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out
[12:38:29] Result files:
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.aligned.fa
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bam.bai
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.bed
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.fa
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.consensus.subs.fa
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.csv
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.filt.vcf
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.gff
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.html
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.log
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.raw.vcf
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.subs.vcf
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.tab
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.txt
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz
[12:38:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out/snps.vcf.gz.csi
[12:38:29] Walltime used: 19 seconds
[12:38:29] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:38:29] Done.
[Tue Jun 16 12:38:29 2020]
Finished job 120.
90 of 202 steps (45%) done

[Tue Jun 16 12:38:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
    jobid: 28
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5909AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67436 reads in 4.242 CPU sec, 0.492 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:38:30] This is snippy 4.4.3
[12:38:30] Written by Torsten Seemann
[12:38:30] Obtained from https://github.com/tseemann/snippy
[12:38:30] Detected operating system: linux
[12:38:30] Enabling bundled linux tools.
[12:38:30] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:30] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:30] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:30] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:30] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:30] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:30] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:30] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:30] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:30] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:30] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:30] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:30] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:30] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:30] Found gzip - /usr/bin/gzip
[12:38:30] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:30] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:30] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:30] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:30] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:30] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB4414AA_AS.out\tSM:SAL_JB4414AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.772 sec; CPU: 21.970 sec
[samclip] Total SAM records 387882, removed 1240, allowed 78, passed 386642
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:30] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:30] Treating reference as 'fasta' format.
[12:38:30] Will use 8 CPU cores.
[12:38:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta
[12:38:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[12:38:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[12:38:30] Creating reference folder: reference
[12:38:30] Extracting FASTA and GFF from reference.
[12:38:30] Wrote 3 sequences to ref.fa
[12:38:30] Wrote 0 features to ref.gff
[12:38:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5909AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320226 reads in 16.467 CPU sec, 2.265 real sec
[12:38:30] Wrote 387620 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:30] Using BAM RG (Read Group) ID: SAL_IB1406AA_AS.out
[12:38:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:30] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] Processed 100000 records...
[12:38:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1902
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:38:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 68434 reads in 4.580 CPU sec, 0.528 real sec
[samclip] Processed 200000 records...
[12:38:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[samclip] Processed 300000 records...
[12:38:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4937AA_AS.out\tSM:SAL_BB4937AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 389113, removed 1279, allowed 151, passed 387834
[samclip] Header contained 5 lines

[main] Real time: 3.679 sec; CPU: 21.602 sec
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:32] Wrote 388648 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:32] Using BAM RG (Read Group) ID: SAL_KB4026AA_AS.out
[12:38:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:32] Running: samtools index snps.bam 2>> snps.log
[12:38:32] Wrote 387434 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:32] Using BAM RG (Read Group) ID: SAL_CB9389AA_AS.out
[12:38:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:32] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:33] Wrote 386744 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:33] Using BAM RG (Read Group) ID: SAL_AB5909AA_AS.out
[12:38:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:33] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320060 sequences (80000232 bp)...
[M::process] read 67560 sequences (16890000 bp)...
[12:38:33] Running: samtools index snps.bam 2>> snps.log
[12:38:34] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:34] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320132 sequences (80000104 bp)...
[M::process] read 68516 sequences (17114840 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[12:38:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 67434 sequences (16826322 bp)...
[12:38:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320028 sequences (80000470 bp)...
[12:38:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 66716 sequences (16679000 bp)...
[12:38:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:35] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320060 reads in 16.696 CPU sec, 2.775 real sec
[12:38:36] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67560 reads in 4.014 CPU sec, 0.494 real sec
[12:38:36] Creating extra output files: BED GFF CSV TXT HTML
[12:38:36] Identified 1902 variants.
[12:38:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out
[12:38:36] Result files:
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.aligned.fa
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bam.bai
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.bed
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.fa
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.consensus.subs.fa
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.csv
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.filt.vcf
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.gff
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.html
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.log
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.raw.vcf
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.subs.vcf
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.tab
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.txt
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz
[12:38:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out/snps.vcf.gz.csi
[12:38:36] Walltime used: 20 seconds
[12:38:36] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:36] Done.
[Tue Jun 16 12:38:36 2020]
Finished job 164.
91 of 202 steps (45%) done

[Tue Jun 16 12:38:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
    jobid: 9
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB5660AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[12:38:36] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:36] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 15.631 CPU sec, 2.480 real sec
[12:38:37] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:37] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:37] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320132 reads in 17.285 CPU sec, 2.854 real sec
[12:38:37] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:37] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:37] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:37] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:37] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:37] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67434 reads in 3.773 CPU sec, 0.452 real sec
[12:38:37] This is snippy 4.4.3
[12:38:37] Written by Torsten Seemann
[12:38:37] Obtained from https://github.com/tseemann/snippy
[12:38:37] Detected operating system: linux
[12:38:37] Enabling bundled linux tools.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB1406AA_AS.out\tSM:SAL_IB1406AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.466 sec; CPU: 21.351 sec
[samclip] Total SAM records 387912, removed 862, allowed 124, passed 387050
[samclip] Header contained 5 lines
[samclip] Done.
[12:38:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[samclip] Processed 200000 records...
[12:38:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:37] Found gzip - /usr/bin/gzip
[12:38:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[M::mem_process_seqs] Processed 68516 reads in 4.334 CPU sec, 0.503 real sec
[12:38:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[12:38:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:37] Treating reference as 'fasta' format.
[12:38:37] Will use 8 CPU cores.
[12:38:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta
[12:38:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[12:38:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[12:38:37] Creating reference folder: reference
[12:38:37] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320028 reads in 17.052 CPU sec, 2.279 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[12:38:38] Wrote 3 sequences to ref.fa
[12:38:38] Wrote 0 features to ref.gff
[12:38:38] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB5660AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9389AA_AS.out\tSM:SAL_CB9389AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.927 sec; CPU: 19.961 sec
[samclip] Total SAM records 387789, removed 947, allowed 69, passed 386842
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4026AA_AS.out\tSM:SAL_KB4026AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.297 sec; CPU: 22.184 sec
[samclip] Total SAM records 389838, removed 2946, allowed 93, passed 386892
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 66716 reads in 3.840 CPU sec, 0.456 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5909AA_AS.out\tSM:SAL_AB5909AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 386819, removed 459, allowed 82, passed 386360

[main] Real time: 3.666 sec; CPU: 21.440 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:39] Running: samtools index snps.bam 2>> snps.log
[12:38:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:40] Running: samtools index snps.bam 2>> snps.log
[12:38:40] Marked 0 heterozygous sites with 'n'
[12:38:40] Creating extra output files: BED GFF CSV TXT HTML
[12:38:40] Identified 122 variants.
[12:38:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out
[12:38:40] Result files:
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.aligned.fa
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bam.bai
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.bed
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.fa
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.consensus.subs.fa
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.csv
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.filt.vcf
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.gff
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.html
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.log
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.raw.vcf
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.subs.vcf
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.tab
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.txt
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz
[12:38:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out/snps.vcf.gz.csi
[12:38:40] Walltime used: 19 seconds
[12:38:40] Questionable SNP? Try the --report option to see the alignments.
[12:38:40] Done.
[Tue Jun 16 12:38:40 2020]
Finished job 155.
92 of 202 steps (46%) done

[Tue Jun 16 12:38:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
    jobid: 7
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA8052AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[12:38:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:40] Running: samtools index snps.bam 2>> snps.log
[12:38:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:40] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:40] Using BAM RG (Read Group) ID: SAL_HB5660AA_AS.out
[12:38:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:40] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:40] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:41] This is snippy 4.4.3
[12:38:41] Written by Torsten Seemann
[12:38:41] Obtained from https://github.com/tseemann/snippy
[12:38:41] Detected operating system: linux
[12:38:41] Enabling bundled linux tools.
[12:38:41] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:41] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:41] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:41] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:41] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:41] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:41] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:41] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:41] Found gzip - /usr/bin/gzip
[12:38:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:41] Treating reference as 'fasta' format.
[12:38:41] Will use 8 CPU cores.
[12:38:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta
[12:38:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[12:38:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[12:38:41] Creating reference folder: reference
[12:38:41] Extracting FASTA and GFF from reference.
[12:38:41] Marked 0 heterozygous sites with 'n'
[12:38:41] Creating extra output files: BED GFF CSV TXT HTML
[12:38:41] Identified 28 variants.
[12:38:41] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out
[12:38:41] Result files:
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.aligned.fa
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bam.bai
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.bed
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.fa
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.consensus.subs.fa
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.csv
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.filt.vcf
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.gff
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.html
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.log
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.raw.vcf
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.subs.vcf
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.tab
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.txt
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz
[12:38:41] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out/snps.vcf.gz.csi
[12:38:41] Walltime used: 18 seconds
[12:38:41] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:38:41] Done.
[12:38:41] Wrote 3 sequences to ref.fa
[12:38:41] Wrote 0 features to ref.gff
[12:38:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA8052AA_AS.fasta into pseudo-reads
[Tue Jun 16 12:38:41 2020]
Finished job 116.
93 of 202 steps (46%) done

[Tue Jun 16 12:38:41 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
    jobid: 37
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB6699AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:42] This is snippy 4.4.3
[12:38:42] Written by Torsten Seemann
[12:38:42] Obtained from https://github.com/tseemann/snippy
[12:38:42] Detected operating system: linux
[12:38:42] Enabling bundled linux tools.
[12:38:42] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:42] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:42] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:42] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:42] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:42] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:42] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:42] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:42] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:42] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:42] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:42] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:42] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:42] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:42] Found gzip - /usr/bin/gzip
[12:38:42] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:42] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:42] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:42] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:42] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:42] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:42] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:42] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:42] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:42] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:42] Treating reference as 'fasta' format.
[12:38:42] Will use 8 CPU cores.
[12:38:42] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta
[12:38:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:42] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[12:38:42] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[12:38:42] Creating reference folder: reference
[12:38:42] Extracting FASTA and GFF from reference.
[12:38:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:42] Wrote 3 sequences to ref.fa
[12:38:42] Wrote 0 features to ref.gff
[12:38:42] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB6699AA_AS.fasta into pseudo-reads
[12:38:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 36
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320038 sequences (80000204 bp)...
[12:38:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 66598 sequences (16649500 bp)...
[12:38:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:38:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:38:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 124
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 127
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:44] Wrote 392016 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:44] Using BAM RG (Read Group) ID: SAL_BA8052AA_AS.out
[12:38:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:44] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:44] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:45] Wrote 387752 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:45] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:45] Using BAM RG (Read Group) ID: SAL_HB6699AA_AS.out
[12:38:45] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:45] Running: bwa index reference/ref.fa 2>> snps.log
[M::mem_process_seqs] Processed 320038 reads in 18.493 CPU sec, 2.548 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66598 reads in 3.716 CPU sec, 0.431 real sec
[samclip] Processed 200000 records...
[12:38:46] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:46] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:46] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:46] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:46] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB5660AA_AS.out\tSM:SAL_HB5660AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.958 sec; CPU: 22.800 sec
[samclip] Total SAM records 386765, removed 664, allowed 86, passed 386101
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 320294 sequences (80000080 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 71722 sequences (17913654 bp)...
[12:38:47] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:47] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:47] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:47] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:47] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:47] Marked 0 heterozygous sites with 'n'
[12:38:47] Creating extra output files: BED GFF CSV TXT HTML
[12:38:47] Identified 36 variants.
[12:38:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out
[12:38:47] Result files:
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.aligned.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bam.bai
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.bed
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.consensus.subs.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.csv
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.filt.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.gff
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.html
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.log
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.raw.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.subs.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.tab
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.txt
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out/snps.vcf.gz.csi
[12:38:47] Walltime used: 20 seconds
[12:38:47] Wishing you a life free of homopolymer errors.
[12:38:47] Done.
[Tue Jun 16 12:38:47 2020]
Finished job 17.
94 of 202 steps (47%) done

[Tue Jun 16 12:38:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
    jobid: 168
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1424AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 67752 sequences (16917538 bp)...
[12:38:47] Marked 0 heterozygous sites with 'n'
[12:38:47] Creating extra output files: BED GFF CSV TXT HTML
[12:38:47] Identified 27 variants.
[12:38:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out
[12:38:47] Result files:
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.aligned.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bam.bai
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.bed
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.consensus.subs.fa
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.csv
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.filt.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.gff
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.html
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.log
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.raw.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.subs.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.tab
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.txt
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz
[12:38:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out/snps.vcf.gz.csi
[12:38:47] Walltime used: 21 seconds
[12:38:47] Questionable SNP? Try the --report option to see the alignments.
[12:38:47] Done.
[Tue Jun 16 12:38:47 2020]
Finished job 182.
95 of 202 steps (47%) done

[Tue Jun 16 12:38:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
    jobid: 180
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_GB5373AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:48] Marked 24 heterozygous sites with 'n'
[12:38:48] Creating extra output files: BED GFF CSV TXT HTML
[12:38:48] Identified 124 variants.
[12:38:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out
[12:38:48] Result files:
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.aligned.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bam.bai
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.bed
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.consensus.subs.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.csv
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.filt.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.gff
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.html
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.log
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.raw.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.subs.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.tab
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.txt
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out/snps.vcf.gz.csi
[12:38:48] Walltime used: 20 seconds
[12:38:48] Wishing you a life free of homopolymer errors.
[12:38:48] Done.
[Tue Jun 16 12:38:48 2020]
Finished job 46.
96 of 202 steps (48%) done

[Tue Jun 16 12:38:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
    jobid: 105
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_HB2237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[12:38:48] This is snippy 4.4.3
[12:38:48] Written by Torsten Seemann
[12:38:48] Obtained from https://github.com/tseemann/snippy
[12:38:48] Detected operating system: linux
[12:38:48] Enabling bundled linux tools.
[12:38:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:48] Found gzip - /usr/bin/gzip
[12:38:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:48] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:48] Treating reference as 'fasta' format.
[12:38:48] Will use 8 CPU cores.
[12:38:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta
[12:38:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[12:38:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[12:38:48] Creating reference folder: reference
[12:38:48] Extracting FASTA and GFF from reference.
[12:38:48] Running: samtools index snps.bam 2>> snps.log
[12:38:48] Wrote 3 sequences to ref.fa
[12:38:48] Wrote 0 features to ref.gff
[12:38:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1424AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:38:48] This is snippy 4.4.3
[12:38:48] Written by Torsten Seemann
[12:38:48] Obtained from https://github.com/tseemann/snippy
[12:38:48] Detected operating system: linux
[12:38:48] Enabling bundled linux tools.
[12:38:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:48] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:48] Found gzip - /usr/bin/gzip
[12:38:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:48] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:48] This is snippy 4.4.3
[12:38:48] Written by Torsten Seemann
[12:38:48] Obtained from https://github.com/tseemann/snippy
[12:38:48] Detected operating system: linux
[12:38:48] Enabling bundled linux tools.
[12:38:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:48] Marked 0 heterozygous sites with 'n'
[12:38:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:48] Treating reference as 'fasta' format.
[12:38:48] Will use 8 CPU cores.
[12:38:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta
[12:38:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[12:38:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[12:38:48] Creating reference folder: reference
[12:38:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:48] Extracting FASTA and GFF from reference.
[12:38:48] Found gzip - /usr/bin/gzip
[12:38:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:48] Creating extra output files: BED GFF CSV TXT HTML
[12:38:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:48] Identified 127 variants.
[12:38:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out
[12:38:48] Result files:
[12:38:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.aligned.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bam.bai
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.bed
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.consensus.subs.fa
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.csv
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.filt.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.gff
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.html
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.log
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.raw.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.subs.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.tab
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.txt
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz
[12:38:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out/snps.vcf.gz.csi
[12:38:48] Walltime used: 18 seconds
[12:38:48] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:38:48] Done.
[Tue Jun 16 12:38:48 2020]
Finished job 28.
97 of 202 steps (48%) done

[Tue Jun 16 12:38:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
    jobid: 129
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7947AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[M::mem_process_seqs] Processed 320294 reads in 17.677 CPU sec, 2.357 real sec
[12:38:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:49] Wrote 3 sequences to ref.fa
[12:38:49] Wrote 0 features to ref.gff
[12:38:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB5373AA_AS.fasta into pseudo-reads
[12:38:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:49] Treating reference as 'fasta' format.
[12:38:49] Will use 8 CPU cores.
[12:38:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta
[12:38:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[12:38:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[12:38:49] Creating reference folder: reference
[12:38:49] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[12:38:49] Wrote 3 sequences to ref.fa
[12:38:49] Wrote 0 features to ref.gff
[12:38:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_HB2237AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 71722 reads in 4.442 CPU sec, 0.521 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:38:49] This is snippy 4.4.3
[12:38:49] Written by Torsten Seemann
[12:38:49] Obtained from https://github.com/tseemann/snippy
[12:38:49] Detected operating system: linux
[12:38:49] Enabling bundled linux tools.
[12:38:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:38:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:49] Found gzip - /usr/bin/gzip
[12:38:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:38:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:38:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:50] Treating reference as 'fasta' format.
[12:38:50] Will use 8 CPU cores.
[12:38:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta
[12:38:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[12:38:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[12:38:50] Creating reference folder: reference
[12:38:50] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA8052AA_AS.out\tSM:SAL_BA8052AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.800 sec; CPU: 22.688 sec
[samclip] Total SAM records 392343, removed 1246, allowed 371, passed 391097
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 17.765 CPU sec, 2.431 real sec
[12:38:50] Wrote 3 sequences to ref.fa
[12:38:50] Wrote 0 features to ref.gff
[12:38:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7947AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67752 reads in 4.120 CPU sec, 0.472 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB6699AA_AS.out\tSM:SAL_HB6699AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.836 sec; CPU: 22.464 sec
[samclip] Total SAM records 388223, removed 1114, allowed 173, passed 387109
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:51] Wrote 386636 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:51] Using BAM RG (Read Group) ID: SAL_BB1424AA_AS.out
[12:38:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:51] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 13
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:51] Wrote 386850 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:51] Using BAM RG (Read Group) ID: SAL_GB5373AA_AS.out
[12:38:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:38:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:51] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:51] Wrote 386690 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:51] Using BAM RG (Read Group) ID: SAL_HB2237AA_AS.out
[12:38:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:52] Running: samtools index snps.bam 2>> snps.log
[12:38:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:52] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:52] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:52] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:38:52] Wrote 386696 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:38:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:38:52] Using BAM RG (Read Group) ID: SAL_BB7947AA_AS.out
[12:38:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:38:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:38:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:38:53] Running: samtools index snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:38:53] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:38:53] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320022 sequences (80000134 bp)...
[M::process] read 66614 sequences (16649802 bp)...
[12:38:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:38:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320072 sequences (80000370 bp)...
[M::process] read 320062 sequences (80000134 bp)...
[M::process] read 66628 sequences (16657000 bp)...
[12:38:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:38:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:38:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:38:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:38:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 66778 sequences (16694500 bp)...
[12:38:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320154 sequences (80000082 bp)...
[12:38:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:38:55] Running: rm -f fake_reads\.fq 2>> snps.log
[12:38:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 66542 sequences (16623902 bp)...
[12:38:56] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 53
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:38:56] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:38:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320022 reads in 17.313 CPU sec, 2.778 real sec
[12:38:56] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:38:56] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:38:56] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:38:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:38:56] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:38:56] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[12:38:56] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:38:56] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:38:56] Creating extra output files: BED GFF CSV TXT HTML
[12:38:56] Identified 126 variants.
[12:38:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out
[12:38:56] Result files:
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.aligned.fa
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bam.bai
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.bed
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.fa
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.consensus.subs.fa
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.csv
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.filt.vcf
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.gff
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.html
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.log
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.raw.vcf
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.subs.vcf
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.tab
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.txt
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz
[12:38:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out/snps.vcf.gz.csi
[12:38:56] Walltime used: 19 seconds
[12:38:56] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:38:56] Done.
[12:38:56] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[Tue Jun 16 12:38:56 2020]
Finished job 9.
98 of 202 steps (49%) done

[Tue Jun 16 12:38:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
    jobid: 2
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB5376AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[12:38:56] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 66614 reads in 4.240 CPU sec, 0.500 real sec
[12:38:56] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320062 reads in 18.307 CPU sec, 2.841 real sec
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1424AA_AS.out\tSM:SAL_BB1424AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.231 sec; CPU: 22.121 sec
[samclip] Total SAM records 386760, removed 436, allowed 46, passed 386324
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320072 reads in 18.473 CPU sec, 3.226 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:57] This is snippy 4.4.3
[12:38:57] Written by Torsten Seemann
[12:38:57] Obtained from https://github.com/tseemann/snippy
[12:38:57] Detected operating system: linux
[12:38:57] Enabling bundled linux tools.
[12:38:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:38:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:38:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:38:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:38:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:38:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:38:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[M::mem_process_seqs] Processed 66628 reads in 4.056 CPU sec, 0.476 real sec
[12:38:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:38:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:38:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:38:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:38:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:38:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:38:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:38:57] Found gzip - /usr/bin/gzip
[12:38:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:38:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:38:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:38:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:38:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:38:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 200000 records...
[12:38:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:38:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:38:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:38:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:38:57] Treating reference as 'fasta' format.
[12:38:57] Will use 8 CPU cores.
[12:38:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta
[12:38:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[12:38:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[12:38:57] Creating reference folder: reference
[12:38:57] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[12:38:57] Wrote 3 sequences to ref.fa
[12:38:57] Wrote 0 features to ref.gff
[12:38:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB5376AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 66778 reads in 4.302 CPU sec, 0.503 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_HB2237AA_AS.out\tSM:SAL_HB2237AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.264 sec; CPU: 22.935 sec
[samclip] Total SAM records 386963, removed 1362, allowed 123, passed 385601
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320154 reads in 17.835 CPU sec, 2.753 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB5373AA_AS.out\tSM:SAL_GB5373AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.653 sec; CPU: 23.341 sec
[samclip] Total SAM records 387159, removed 1332, allowed 117, passed 385827
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 66542 reads in 3.810 CPU sec, 0.446 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7947AA_AS.out\tSM:SAL_BB7947AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.184 sec; CPU: 22.237 sec
[samclip] Total SAM records 386970, removed 1115, allowed 55, passed 385855
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:59] Running: samtools index snps.bam 2>> snps.log
[12:38:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:38:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:38:59] Marked 0 heterozygous sites with 'n'
[12:38:59] Creating extra output files: BED GFF CSV TXT HTML
[12:38:59] Identified 17 variants.
[12:38:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out
[12:38:59] Result files:
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.aligned.fa
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bam.bai
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.bed
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.fa
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.consensus.subs.fa
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.csv
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.filt.vcf
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.gff
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.html
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.log
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.raw.vcf
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.subs.vcf
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.tab
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.txt
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz
[12:38:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out/snps.vcf.gz.csi
[12:38:59] Walltime used: 18 seconds
[12:38:59] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:38:59] Done.
[Tue Jun 16 12:38:59 2020]
Finished job 7.
99 of 202 steps (49%) done

[Tue Jun 16 12:38:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
    jobid: 5
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB6160AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
[12:38:59] Running: samtools index snps.bam 2>> snps.log
[12:39:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:00] Running: samtools index snps.bam 2>> snps.log
[12:39:00] Wrote 386032 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:00] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:00] Using BAM RG (Read Group) ID: SAL_CB5376AA_AS.out
[12:39:00] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:00] Marked 4 heterozygous sites with 'n'
[12:39:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:00] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:00] Creating extra output files: BED GFF CSV TXT HTML
[12:39:00] Identified 53 variants.
[12:39:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out
[12:39:00] Result files:
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.aligned.fa
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bam.bai
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.bed
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.fa
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.consensus.subs.fa
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.csv
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.filt.vcf
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.gff
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.html
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.log
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.raw.vcf
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.subs.vcf
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.tab
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.txt
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz
[12:39:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out/snps.vcf.gz.csi
[12:39:00] Walltime used: 18 seconds
[12:39:00] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:39:00] Done.
[Tue Jun 16 12:39:00 2020]
Finished job 37.
100 of 202 steps (50%) done

[Tue Jun 16 12:39:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
    jobid: 85
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB6580AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:01] Running: samtools index snps.bam 2>> snps.log
[12:39:01] This is snippy 4.4.3
[12:39:01] Written by Torsten Seemann
[12:39:01] Obtained from https://github.com/tseemann/snippy
[12:39:01] Detected operating system: linux
[12:39:01] Enabling bundled linux tools.
[12:39:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:01] Found gzip - /usr/bin/gzip
[12:39:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:01] Treating reference as 'fasta' format.
[12:39:01] Will use 8 CPU cores.
[12:39:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta
[12:39:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[12:39:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[12:39:01] Creating reference folder: reference
[12:39:01] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:01] Wrote 3 sequences to ref.fa
[12:39:01] Wrote 0 features to ref.gff
[12:39:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB6160AA_AS.fasta into pseudo-reads
[12:39:01] This is snippy 4.4.3
[12:39:01] Written by Torsten Seemann
[12:39:01] Obtained from https://github.com/tseemann/snippy
[12:39:01] Detected operating system: linux
[12:39:01] Enabling bundled linux tools.
[12:39:01] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:01] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:01] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:01] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:01] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:01] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:01] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:01] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:01] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:01] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:01] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:01] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:01] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:01] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:01] Found gzip - /usr/bin/gzip
[12:39:01] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:01] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:01] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:01] Treating reference as 'fasta' format.
[12:39:01] Will use 8 CPU cores.
[12:39:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta
[12:39:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[12:39:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[12:39:01] Creating reference folder: reference
[12:39:01] Extracting FASTA and GFF from reference.
[12:39:02] Wrote 3 sequences to ref.fa
[12:39:02] Wrote 0 features to ref.gff
[12:39:02] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB6580AA_AS.fasta into pseudo-reads
[12:39:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:02] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:02] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:02] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:02] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:02] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:39:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320006 sequences (80000324 bp)...
[M::process] read 66026 sequences (16506500 bp)...
[12:39:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 19
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 20

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 20
       total no. variants observed              : 816
       total no. reference observed             : 0

Time elapsed: 0.01s

[12:39:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:39:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:39:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 20
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 21

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 21
       total no. variants observed              : 818
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 160
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:04] Wrote 386002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:04] Using BAM RG (Read Group) ID: SAL_AB6160AA_AS.out
[12:39:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:04] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:04] Wrote 386996 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:04] Using BAM RG (Read Group) ID: SAL_JB6580AA_AS.out
[12:39:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:04] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320006 reads in 18.312 CPU sec, 2.573 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66026 reads in 4.180 CPU sec, 0.482 real sec
[samclip] Processed 200000 records...
[12:39:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320006 sequences (80000340 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB5376AA_AS.out\tSM:SAL_CB5376AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.976 sec; CPU: 23.065 sec
[samclip] Total SAM records 386389, removed 1059, allowed 97, passed 385330
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:06] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 65996 sequences (16499000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:06] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:06] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:06] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:06] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:06] Marked 0 heterozygous sites with 'n'
[12:39:06] Creating extra output files: BED GFF CSV TXT HTML
[12:39:06] Identified 20 variants.
[12:39:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out
[12:39:06] Result files:
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.aligned.fa
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bam.bai
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.bed
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.fa
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.consensus.subs.fa
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.csv
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.filt.vcf
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.gff
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.html
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.log
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.raw.vcf
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.subs.vcf
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.tab
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.txt
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz
[12:39:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out/snps.vcf.gz.csi
[12:39:06] Walltime used: 18 seconds
[12:39:06] Wishing you a life free of homopolymer errors.
[12:39:06] Done.
[M::process] read 320000 sequences (80000000 bp)...
[Tue Jun 16 12:39:06 2020]
Finished job 168.
101 of 202 steps (50%) done

[Tue Jun 16 12:39:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
    jobid: 170
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA6324AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
[M::process] read 66996 sequences (16687816 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:07] This is snippy 4.4.3
[12:39:07] Written by Torsten Seemann
[12:39:07] Obtained from https://github.com/tseemann/snippy
[12:39:07] Detected operating system: linux
[12:39:07] Enabling bundled linux tools.
[12:39:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:07] Found gzip - /usr/bin/gzip
[12:39:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:08] Treating reference as 'fasta' format.
[12:39:08] Will use 8 CPU cores.
[12:39:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta
[12:39:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[12:39:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[12:39:08] Creating reference folder: reference
[12:39:08] Extracting FASTA and GFF from reference.
[12:39:08] Marked 0 heterozygous sites with 'n'
[12:39:08] Wrote 3 sequences to ref.fa
[12:39:08] Wrote 0 features to ref.gff
[12:39:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA6324AA_AS.fasta into pseudo-reads
[12:39:08] Creating extra output files: BED GFF CSV TXT HTML
[12:39:08] Identified 816 variants.
[12:39:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out
[12:39:08] Result files:
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.aligned.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bam.bai
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.bed
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.consensus.subs.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.csv
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.filt.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.gff
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.html
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.log
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.raw.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.subs.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.tab
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.txt
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out/snps.vcf.gz.csi
[12:39:08] Walltime used: 20 seconds
[12:39:08] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:39:08] Done.
[Tue Jun 16 12:39:08 2020]
Finished job 105.
102 of 202 steps (50%) done

[Tue Jun 16 12:39:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
    jobid: 191
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA4237AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[12:39:08] Running: samtools index snps.bam 2>> snps.log
[12:39:08] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:08] Marked 0 heterozygous sites with 'n'
[12:39:08] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 320006 reads in 17.343 CPU sec, 2.356 real sec
[12:39:08] Identified 818 variants.
[12:39:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out
[12:39:08] Result files:
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.aligned.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bam.bai
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.bed
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.consensus.subs.fa
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.csv
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.filt.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.gff
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.html
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.log
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.raw.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.subs.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.tab
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.txt
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz
[12:39:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out/snps.vcf.gz.csi
[12:39:08] Walltime used: 20 seconds
[12:39:08] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:08] Done.
[Tue Jun 16 12:39:08 2020]
Finished job 180.
103 of 202 steps (51%) done

[Tue Jun 16 12:39:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
    jobid: 41
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IB9302AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:08] Marked 1 heterozygous sites with 'n'
[12:39:09] Creating extra output files: BED GFF CSV TXT HTML
[12:39:09] Identified 160 variants.
[12:39:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out
[12:39:09] Result files:
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.aligned.fa
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bam.bai
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.bed
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.fa
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.consensus.subs.fa
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.csv
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.filt.vcf
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.gff
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.html
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.log
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.raw.vcf
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.subs.vcf
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.tab
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.txt
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz
[12:39:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out/snps.vcf.gz.csi
[12:39:09] Walltime used: 20 seconds
[12:39:09] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:09] Done.
[Tue Jun 16 12:39:09 2020]
Finished job 129.
104 of 202 steps (51%) done

[Tue Jun 16 12:39:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
    jobid: 146
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB1026AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
[samclip] Processed 100000 records...
[12:39:09] This is snippy 4.4.3
[12:39:09] Written by Torsten Seemann
[12:39:09] Obtained from https://github.com/tseemann/snippy
[12:39:09] Detected operating system: linux
[12:39:09] Enabling bundled linux tools.
[12:39:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:09] Found gzip - /usr/bin/gzip
[12:39:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 65996 reads in 3.998 CPU sec, 0.464 real sec
[12:39:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:09] Treating reference as 'fasta' format.
[12:39:09] Will use 8 CPU cores.
[12:39:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta
[12:39:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[12:39:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[12:39:09] Creating reference folder: reference
[12:39:09] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320000 reads in 17.828 CPU sec, 2.509 real sec
[12:39:09] Wrote 3 sequences to ref.fa
[12:39:09] Wrote 0 features to ref.gff
[12:39:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA4237AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:09] This is snippy 4.4.3
[12:39:09] Written by Torsten Seemann
[12:39:09] Obtained from https://github.com/tseemann/snippy
[12:39:09] Detected operating system: linux
[12:39:09] Enabling bundled linux tools.
[12:39:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:09] Found gzip - /usr/bin/gzip
[samclip] Processed 300000 records...
[12:39:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:39:09] This is snippy 4.4.3
[12:39:09] Written by Torsten Seemann
[12:39:09] Obtained from https://github.com/tseemann/snippy
[12:39:09] Detected operating system: linux
[12:39:09] Enabling bundled linux tools.
[12:39:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:09] Found gzip - /usr/bin/gzip
[12:39:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:09] Treating reference as 'fasta' format.
[12:39:09] Will use 8 CPU cores.
[12:39:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta
[12:39:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[12:39:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[12:39:09] Creating reference folder: reference
[12:39:09] Extracting FASTA and GFF from reference.
[12:39:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB6160AA_AS.out\tSM:SAL_AB6160AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.741 sec; CPU: 21.896 sec
[samclip] Total SAM records 386357, removed 1270, allowed 143, passed 385087
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 66996 reads in 4.096 CPU sec, 0.469 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:10] Wrote 3 sequences to ref.fa
[12:39:10] Wrote 0 features to ref.gff
[12:39:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IB9302AA_AS.fasta into pseudo-reads
[12:39:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 200000 records...
[12:39:10] Treating reference as 'fasta' format.
[12:39:10] Will use 8 CPU cores.
[12:39:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta
[12:39:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[12:39:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[12:39:10] Creating reference folder: reference
[12:39:10] Extracting FASTA and GFF from reference.
[12:39:10] Wrote 3 sequences to ref.fa
[12:39:10] Wrote 0 features to ref.gff
[12:39:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB1026AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB6580AA_AS.out\tSM:SAL_JB6580AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.911 sec; CPU: 22.500 sec
[samclip] Total SAM records 387265, removed 654, allowed 75, passed 386611
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:11] Wrote 389494 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:11] Using BAM RG (Read Group) ID: SAL_TA6324AA_AS.out
[12:39:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:11] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 25
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:11] Running: samtools index snps.bam 2>> snps.log
[12:39:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:12] Wrote 389584 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:12] Using BAM RG (Read Group) ID: SAL_UA4237AA_AS.out
[12:39:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:12] Running: samtools index snps.bam 2>> snps.log
[12:39:12] Wrote 386730 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:12] Using BAM RG (Read Group) ID: SAL_IB9302AA_AS.out
[12:39:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:39:12] Wrote 386242 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:12] Using BAM RG (Read Group) ID: SAL_EB1026AA_AS.out
[12:39:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:12] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320064 sequences (80000266 bp)...
[M::process] read 69430 sequences (17349116 bp)...
[12:39:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320106 sequences (80000138 bp)...
[M::process] read 69478 sequences (17359898 bp)...
[12:39:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320082 sequences (80000060 bp)...
[12:39:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 123
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 66648 sequences (16662000 bp)...
[12:39:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320070 sequences (80000452 bp)...
[12:39:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:15] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 66172 sequences (16527628 bp)...

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320064 reads in 18.698 CPU sec, 2.699 real sec
[12:39:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:16] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:16] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:16] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:16] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:16] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:16] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:16] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 100000 records...
[12:39:16] Marked 0 heterozygous sites with 'n'
[12:39:16] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:16] Creating extra output files: BED GFF CSV TXT HTML
[12:39:16] Identified 25 variants.
[12:39:16] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out
[12:39:16] Result files:
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.aligned.fa
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bam.bai
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.bed
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.fa
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.consensus.subs.fa
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.csv
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.filt.vcf
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.gff
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.html
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.log
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.raw.vcf
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.subs.vcf
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.tab
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.txt
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz
[12:39:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out/snps.vcf.gz.csi
[12:39:16] Walltime used: 19 seconds
[12:39:16] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:39:16] Done.
[Tue Jun 16 12:39:16 2020]
Finished job 2.
105 of 202 steps (52%) done

[Tue Jun 16 12:39:16 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
    jobid: 175
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OA4067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69430 reads in 4.918 CPU sec, 0.587 real sec
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA6324AA_AS.out\tSM:SAL_TA6324AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.183 sec; CPU: 24.175 sec
[samclip] Total SAM records 389663, removed 1036, allowed 184, passed 388627
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 320106 reads in 19.539 CPU sec, 2.639 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:17] This is snippy 4.4.3
[12:39:17] Written by Torsten Seemann
[12:39:17] Obtained from https://github.com/tseemann/snippy
[12:39:17] Detected operating system: linux
[12:39:17] Enabling bundled linux tools.
[12:39:17] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:17] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:17] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:17] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:17] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:17] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:17] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:17] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:17] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:17] Found gzip - /usr/bin/gzip
[12:39:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:39:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:17] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:17] Treating reference as 'fasta' format.
[12:39:17] Will use 8 CPU cores.
[12:39:17] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta
[12:39:17] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[12:39:17] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[12:39:17] Creating reference folder: reference
[12:39:17] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 69478 reads in 4.308 CPU sec, 0.504 real sec
[12:39:17] Wrote 3 sequences to ref.fa
[12:39:17] Wrote 0 features to ref.gff
[12:39:17] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4067AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320070 reads in 17.287 CPU sec, 2.656 real sec
[M::mem_process_seqs] Processed 320082 reads in 17.907 CPU sec, 2.866 real sec
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA4237AA_AS.out\tSM:SAL_UA4237AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.122 sec; CPU: 24.435 sec
[samclip] Total SAM records 389774, removed 1167, allowed 287, passed 388607
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 66172 reads in 3.806 CPU sec, 0.457 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 66648 reads in 4.302 CPU sec, 0.507 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB1026AA_AS.out\tSM:SAL_EB1026AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.063 sec; CPU: 21.655 sec
[samclip] Total SAM records 386598, removed 843, allowed 136, passed 385755
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IB9302AA_AS.out\tSM:SAL_IB9302AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.296 sec; CPU: 22.780 sec
[samclip] Total SAM records 387142, removed 1082, allowed 126, passed 386060
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:19] Running: samtools index snps.bam 2>> snps.log
[12:39:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:19] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:19] Creating extra output files: BED GFF CSV TXT HTML
[12:39:19] Identified 123 variants.
[12:39:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out
[12:39:19] Result files:
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.aligned.fa
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bam.bai
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.bed
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.fa
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.consensus.subs.fa
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.csv
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.filt.vcf
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.gff
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.html
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.log
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.raw.vcf
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.subs.vcf
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.tab
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.txt
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz
[12:39:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out/snps.vcf.gz.csi
[12:39:19] Walltime used: 18 seconds
[12:39:19] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:39:19] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Tue Jun 16 12:39:19 2020]
Finished job 5.
106 of 202 steps (52%) done

[Tue Jun 16 12:39:19 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
    jobid: 60
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7261AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[12:39:20] Running: samtools index snps.bam 2>> snps.log
[12:39:20] Wrote 390044 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:20] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:20] Using BAM RG (Read Group) ID: SAL_OA4067AA_AS.out
[12:39:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:20] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:20] Marked 0 heterozygous sites with 'n'
[12:39:20] Creating extra output files: BED GFF CSV TXT HTML
[12:39:20] Identified 16 variants.
[12:39:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out
[12:39:20] Result files:
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.aligned.fa
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bam.bai
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.bed
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.fa
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.consensus.subs.fa
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.csv
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.filt.vcf
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.gff
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.html
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.log
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.raw.vcf
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.subs.vcf
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.tab
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.txt
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz
[12:39:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out/snps.vcf.gz.csi
[12:39:20] Walltime used: 19 seconds
[12:39:20] Questionable SNP? Try the --report option to see the alignments.
[12:39:20] Done.
[Tue Jun 16 12:39:20 2020]
Finished job 85.
107 of 202 steps (53%) done

[Tue Jun 16 12:39:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
    jobid: 78
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9820AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:20] Running: samtools index snps.bam 2>> snps.log
[12:39:20] This is snippy 4.4.3
[12:39:20] Written by Torsten Seemann
[12:39:20] Obtained from https://github.com/tseemann/snippy
[12:39:20] Detected operating system: linux
[12:39:20] Enabling bundled linux tools.
[12:39:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:20] Running: samtools index snps.bam 2>> snps.log
[12:39:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:20] Found gzip - /usr/bin/gzip
[12:39:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:21] Treating reference as 'fasta' format.
[12:39:21] Will use 8 CPU cores.
[12:39:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta
[12:39:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[12:39:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[12:39:21] Creating reference folder: reference
[12:39:21] Extracting FASTA and GFF from reference.
[12:39:21] Wrote 3 sequences to ref.fa
[12:39:21] Wrote 0 features to ref.gff
[12:39:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7261AA_AS.fasta into pseudo-reads
[12:39:21] This is snippy 4.4.3
[12:39:21] Written by Torsten Seemann
[12:39:21] Obtained from https://github.com/tseemann/snippy
[12:39:21] Detected operating system: linux
[12:39:21] Enabling bundled linux tools.
[12:39:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:21] Found gzip - /usr/bin/gzip
[12:39:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:21] Treating reference as 'fasta' format.
[12:39:21] Will use 8 CPU cores.
[12:39:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta
[12:39:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[12:39:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[12:39:21] Creating reference folder: reference
[12:39:21] Extracting FASTA and GFF from reference.
[12:39:21] Wrote 3 sequences to ref.fa
[12:39:21] Wrote 0 features to ref.gff
[12:39:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9820AA_AS.fasta into pseudo-reads
[12:39:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:22] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320132 sequences (80000202 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 24

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 24
       total no. variants observed              : 1806
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:39:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69912 sequences (17453658 bp)...
[12:39:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1796
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:39:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:39:23] Wrote 386562 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:39:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:24] Using BAM RG (Read Group) ID: SAL_BB7261AA_AS.out
[12:39:24] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:24] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:24] Wrote 385396 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:24] Using BAM RG (Read Group) ID: SAL_CB9820AA_AS.out
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:24] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320132 reads in 17.941 CPU sec, 2.530 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69912 reads in 4.817 CPU sec, 0.557 real sec
[samclip] Processed 300000 records...
[12:39:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4067AA_AS.out\tSM:SAL_OA4067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.934 sec; CPU: 23.306 sec
[samclip] Total SAM records 390296, removed 893, allowed 191, passed 389403
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320170 sequences (80000294 bp)...
[M::process] read 66392 sequences (16598000 bp)...
[12:39:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65396 sequences (16349000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:27] Marked 0 heterozygous sites with 'n'
[12:39:27] Creating extra output files: BED GFF CSV TXT HTML
[12:39:27] Identified 1806 variants.
[12:39:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out
[12:39:27] Result files:
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.aligned.fa
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bam.bai
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.bed
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.fa
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.consensus.subs.fa
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.csv
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.filt.vcf
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.gff
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.html
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.log
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.raw.vcf
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.subs.vcf
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.tab
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.txt
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz
[12:39:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out/snps.vcf.gz.csi
[12:39:27] Walltime used: 20 seconds
[12:39:27] May the SNPs be with you.
[12:39:27] Done.
[Tue Jun 16 12:39:27 2020]
Finished job 170.
108 of 202 steps (53%) done

[Tue Jun 16 12:39:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
    jobid: 112
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB7634AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:28] This is snippy 4.4.3
[12:39:28] Written by Torsten Seemann
[12:39:28] Obtained from https://github.com/tseemann/snippy
[12:39:28] Detected operating system: linux
[12:39:28] Enabling bundled linux tools.
[12:39:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:28] Running: samtools index snps.bam 2>> snps.log
[12:39:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:28] Found gzip - /usr/bin/gzip
[12:39:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:28] Treating reference as 'fasta' format.
[12:39:28] Will use 8 CPU cores.
[12:39:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta
[12:39:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[12:39:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[12:39:28] Creating reference folder: reference
[12:39:28] Extracting FASTA and GFF from reference.
[12:39:28] Wrote 3 sequences to ref.fa
[12:39:28] Wrote 0 features to ref.gff
[12:39:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB7634AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320170 reads in 16.870 CPU sec, 2.296 real sec
[12:39:28] Marked 0 heterozygous sites with 'n'
[12:39:28] Creating extra output files: BED GFF CSV TXT HTML
[12:39:28] Marked 0 heterozygous sites with 'n'
[12:39:28] Identified 12 variants.
[12:39:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out
[12:39:28] Result files:
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.aligned.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bam.bai
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.bed
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.consensus.subs.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.csv
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.filt.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.gff
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.html
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.log
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.raw.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.subs.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.tab
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.txt
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out/snps.vcf.gz.csi
[12:39:28] Walltime used: 19 seconds
[12:39:28] Questionable SNP? Try the --report option to see the alignments.
[12:39:28] Done.
[12:39:28] Marked 0 heterozygous sites with 'n'
[Tue Jun 16 12:39:28 2020]
Finished job 146.
109 of 202 steps (54%) done

[Tue Jun 16 12:39:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
    jobid: 181
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA6621AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
[12:39:28] Creating extra output files: BED GFF CSV TXT HTML
[12:39:28] Identified 27 variants.
[12:39:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out
[12:39:28] Result files:
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.aligned.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bam.bai
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.bed
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.consensus.subs.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.csv
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.filt.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.gff
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.html
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.log
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.raw.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.subs.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.tab
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.txt
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out/snps.vcf.gz.csi
[12:39:28] Walltime used: 19 seconds
[12:39:28] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:39:28] Done.
[Tue Jun 16 12:39:28 2020]
Finished job 41.
110 of 202 steps (54%) done

[Tue Jun 16 12:39:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
    jobid: 3
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7197AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[12:39:28] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 100000 records...
[12:39:28] Identified 1796 variants.
[12:39:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out
[12:39:28] Result files:
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.aligned.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bam.bai
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.bed
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.consensus.subs.fa
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.csv
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.filt.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.gff
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.html
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.log
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.raw.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.subs.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.tab
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.txt
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz
[12:39:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out/snps.vcf.gz.csi
[12:39:28] Walltime used: 19 seconds
[12:39:28] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:39:28] Done.
[Tue Jun 16 12:39:28 2020]
Finished job 191.
111 of 202 steps (55%) done

[Tue Jun 16 12:39:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
    jobid: 66
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EA3229AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[M::mem_process_seqs] Processed 66392 reads in 4.121 CPU sec, 0.480 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320000 reads in 16.840 CPU sec, 2.340 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[12:39:29] This is snippy 4.4.3
[12:39:29] Written by Torsten Seemann
[12:39:29] Obtained from https://github.com/tseemann/snippy
[12:39:29] Detected operating system: linux
[12:39:29] Enabling bundled linux tools.
[12:39:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:29] This is snippy 4.4.3
[12:39:29] Written by Torsten Seemann
[12:39:29] Obtained from https://github.com/tseemann/snippy
[12:39:29] Detected operating system: linux
[12:39:29] Enabling bundled linux tools.
[12:39:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:29] Found gzip - /usr/bin/gzip
[12:39:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:29] Found gzip - /usr/bin/gzip
[12:39:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:29] This is snippy 4.4.3
[12:39:29] Written by Torsten Seemann
[12:39:29] Obtained from https://github.com/tseemann/snippy
[12:39:29] Detected operating system: linux
[12:39:29] Enabling bundled linux tools.
[12:39:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7261AA_AS.out\tSM:SAL_BB7261AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.690 sec; CPU: 21.537 sec
[12:39:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[samclip] Total SAM records 386977, removed 1091, allowed 73, passed 385886
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[M::mem_process_seqs] Processed 65396 reads in 3.922 CPU sec, 0.459 real sec
[12:39:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:29] Found gzip - /usr/bin/gzip
[12:39:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[12:39:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:29] Treating reference as 'fasta' format.
[12:39:29] Will use 8 CPU cores.
[12:39:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta
[12:39:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[12:39:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[12:39:29] Creating reference folder: reference
[12:39:29] Extracting FASTA and GFF from reference.
[12:39:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:29] Treating reference as 'fasta' format.
[12:39:29] Will use 8 CPU cores.
[12:39:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta
[12:39:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[12:39:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[12:39:29] Creating reference folder: reference
[12:39:29] Extracting FASTA and GFF from reference.
[12:39:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:29] Treating reference as 'fasta' format.
[12:39:29] Will use 8 CPU cores.
[12:39:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta
[12:39:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[12:39:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[12:39:29] Creating reference folder: reference
[12:39:29] Extracting FASTA and GFF from reference.
[12:39:29] Wrote 3 sequences to ref.fa
[12:39:29] Wrote 0 features to ref.gff
[12:39:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA6621AA_AS.fasta into pseudo-reads
[12:39:29] Wrote 3 sequences to ref.fa
[12:39:29] Wrote 0 features to ref.gff
[12:39:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7197AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[12:39:29] Wrote 3 sequences to ref.fa
[12:39:29] Wrote 0 features to ref.gff
[12:39:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EA3229AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9820AA_AS.out\tSM:SAL_CB9820AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.724 sec; CPU: 21.330 sec
[samclip] Total SAM records 385665, removed 767, allowed 60, passed 384898
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:31] Wrote 385520 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:31] Using BAM RG (Read Group) ID: SAL_AB7634AA_AS.out
[12:39:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:31] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:31] Running: samtools index snps.bam 2>> snps.log
[12:39:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:31] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:32] Running: samtools index snps.bam 2>> snps.log
[12:39:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:32] Wrote 389570 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:32] Using BAM RG (Read Group) ID: SAL_UA6621AA_AS.out
[12:39:32] Wrote 386790 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:32] Using BAM RG (Read Group) ID: SAL_BB7197AA_AS.out
[12:39:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:32] Wrote 389758 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:32] Using BAM RG (Read Group) ID: SAL_EA3229AA_AS.out
[12:39:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65520 sequences (16365686 bp)...
[12:39:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:39:34] Running: ln -sf reference/ref.fa . 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:39:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:39:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:39:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320016 sequences (80000308 bp)...
[12:39:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:35] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 66774 sequences (16651596 bp)...
[12:39:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320054 sequences (80000000 bp)...
[M::process] read 69516 sequences (17369250 bp)...
[M::process] read 320092 sequences (80000166 bp)...
[12:39:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69666 sequences (17412620 bp)...
[12:39:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:35] Marked 0 heterozygous sites with 'n'
[12:39:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:35] Creating extra output files: BED GFF CSV TXT HTML
[12:39:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:35] Identified 18 variants.
[12:39:35] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out
[12:39:35] Result files:
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.aligned.fa
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bam.bai
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.bed
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.fa
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.consensus.subs.fa
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.csv
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.filt.vcf
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.gff
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.html
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.log
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.raw.vcf
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.subs.vcf
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.tab
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.txt
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz
[12:39:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out/snps.vcf.gz.csi
[12:39:35] Walltime used: 18 seconds
[12:39:35] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:35] Done.
[12:39:35] Running: rm -f fake_reads\.fq 2>> snps.log
[Tue Jun 16 12:39:35 2020]
Finished job 175.
112 of 202 steps (55%) done

[Tue Jun 16 12:39:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
    jobid: 128
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA9926AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
[12:39:35] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 18.319 CPU sec, 2.696 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[12:39:36] This is snippy 4.4.3
[12:39:36] Written by Torsten Seemann
[12:39:36] Obtained from https://github.com/tseemann/snippy
[12:39:36] Detected operating system: linux
[12:39:36] Enabling bundled linux tools.
[M::mem_process_seqs] Processed 65520 reads in 3.657 CPU sec, 0.441 real sec
[12:39:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:36] Found gzip - /usr/bin/gzip
[12:39:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[12:39:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:36] Treating reference as 'fasta' format.
[12:39:36] Will use 8 CPU cores.
[12:39:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta
[12:39:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[12:39:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[12:39:36] Creating reference folder: reference
[12:39:36] Extracting FASTA and GFF from reference.
[12:39:37] Wrote 3 sequences to ref.fa
[12:39:37] Wrote 0 features to ref.gff
[12:39:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA9926AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB7634AA_AS.out\tSM:SAL_AB7634AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.153 sec; CPU: 22.563 sec
[samclip] Total SAM records 385694, removed 562, allowed 45, passed 385132
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320016 reads in 17.355 CPU sec, 2.553 real sec
[M::mem_process_seqs] Processed 320092 reads in 18.510 CPU sec, 2.453 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 66774 reads in 4.008 CPU sec, 0.476 real sec
[M::mem_process_seqs] Processed 320054 reads in 19.423 CPU sec, 2.816 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 69666 reads in 4.586 CPU sec, 0.539 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69516 reads in 4.802 CPU sec, 0.557 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7197AA_AS.out\tSM:SAL_BB7197AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.990 sec; CPU: 21.930 sec
[samclip] Total SAM records 387008, removed 613, allowed 54, passed 386395
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EA3229AA_AS.out\tSM:SAL_EA3229AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.857 sec; CPU: 23.632 sec
[samclip] Total SAM records 389981, removed 1621, allowed 403, passed 388360
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA6621AA_AS.out\tSM:SAL_UA6621AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.222 sec; CPU: 24.772 sec
[samclip] Total SAM records 389757, removed 1287, allowed 188, passed 388470
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:39] Marked 1 heterozygous sites with 'n'
[12:39:39] Running: samtools index snps.bam 2>> snps.log
[12:39:39] Creating extra output files: BED GFF CSV TXT HTML
[12:39:39] Identified 19 variants.
[12:39:39] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out
[12:39:39] Result files:
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.aligned.fa
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bam.bai
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.bed
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.fa
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.consensus.subs.fa
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.csv
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.filt.vcf
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.gff
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.html
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.log
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.raw.vcf
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.subs.vcf
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.tab
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.txt
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz
[12:39:39] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out/snps.vcf.gz.csi
[12:39:39] Walltime used: 19 seconds
[12:39:39] May the SNPs be with you.
[12:39:39] Done.
[Tue Jun 16 12:39:39 2020]
Finished job 60.
113 of 202 steps (56%) done

[Tue Jun 16 12:39:39 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
    jobid: 97
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OA4072AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[12:39:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:39] Wrote 389852 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:39] Using BAM RG (Read Group) ID: SAL_WA9926AA_AS.out
[12:39:39] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:39] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:40] Marked 0 heterozygous sites with 'n'
[12:39:40] Creating extra output files: BED GFF CSV TXT HTML
[12:39:40] Identified 22 variants.
[12:39:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out
[12:39:40] Result files:
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.aligned.fa
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bam.bai
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.bed
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.fa
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.consensus.subs.fa
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.csv
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.filt.vcf
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.gff
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.html
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.log
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.raw.vcf
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.subs.vcf
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.tab
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.txt
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz
[12:39:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out/snps.vcf.gz.csi
[12:39:40] Walltime used: 19 seconds
[12:39:40] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:39:40] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Tue Jun 16 12:39:40 2020]
Finished job 78.
114 of 202 steps (56%) done

[Tue Jun 16 12:39:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
    jobid: 161
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PB8418AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:40] This is snippy 4.4.3
[12:39:40] Written by Torsten Seemann
[12:39:40] Obtained from https://github.com/tseemann/snippy
[12:39:40] Detected operating system: linux
[12:39:40] Enabling bundled linux tools.
[12:39:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:40] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:40] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:40] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:40] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:40] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:40] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:40] Found gzip - /usr/bin/gzip
[12:39:40] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:40] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:40] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:40] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:40] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:40] Treating reference as 'fasta' format.
[12:39:40] Will use 8 CPU cores.
[12:39:40] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta
[12:39:40] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[12:39:40] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[12:39:40] Creating reference folder: reference
[12:39:40] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:40] Running: samtools index snps.bam 2>> snps.log
[12:39:40] Wrote 3 sequences to ref.fa
[12:39:40] Wrote 0 features to ref.gff
[12:39:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OA4072AA_AS.fasta into pseudo-reads
[12:39:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:40] Running: samtools index snps.bam 2>> snps.log
[12:39:40] This is snippy 4.4.3
[12:39:40] Written by Torsten Seemann
[12:39:40] Obtained from https://github.com/tseemann/snippy
[12:39:40] Detected operating system: linux
[12:39:40] Enabling bundled linux tools.
[12:39:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:40] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:40] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:40] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:40] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:40] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:40] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:40] Found gzip - /usr/bin/gzip
[12:39:40] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:40] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:40] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:40] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:40] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:40] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:41] Running: samtools index snps.bam 2>> snps.log
[12:39:41] Treating reference as 'fasta' format.
[12:39:41] Will use 8 CPU cores.
[12:39:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta
[12:39:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[12:39:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[12:39:41] Creating reference folder: reference
[12:39:41] Extracting FASTA and GFF from reference.
[12:39:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:41] Wrote 3 sequences to ref.fa
[12:39:41] Wrote 0 features to ref.gff
[12:39:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PB8418AA_AS.fasta into pseudo-reads
[12:39:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:41] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320172 sequences (80000152 bp)...
[12:39:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 69680 sequences (17397876 bp)...
[12:39:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:43] Wrote 390014 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:43] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:43] Using BAM RG (Read Group) ID: SAL_OA4072AA_AS.out
[12:39:43] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:43] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:44] Wrote 385894 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:44] Using BAM RG (Read Group) ID: SAL_PB8418AA_AS.out
[12:39:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:44] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 24
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 30

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 30
       total no. variants observed              : 1918
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:39:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 23
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1801
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:39:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320172 reads in 17.589 CPU sec, 2.693 real sec
[12:39:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:44] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] Processed 100000 records...
[12:39:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:45] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:45] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:45] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:45] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 69680 reads in 4.354 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[12:39:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320208 sequences (80000248 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA9926AA_AS.out\tSM:SAL_WA9926AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 390278, removed 1126, allowed 137, passed 389152

[main] Real time: 4.108 sec; CPU: 22.497 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 69806 sequences (17445592 bp)...
[12:39:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 65894 sequences (16464040 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:47] Marked 0 heterozygous sites with 'n'
[12:39:47] Creating extra output files: BED GFF CSV TXT HTML
[12:39:47] Identified 16 variants.
[12:39:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out
[12:39:47] Result files:
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.aligned.fa
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bam.bai
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.bed
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.fa
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.consensus.subs.fa
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.csv
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.filt.vcf
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.gff
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.html
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.log
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.raw.vcf
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.subs.vcf
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.tab
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.txt
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz
[12:39:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out/snps.vcf.gz.csi
[12:39:47] Walltime used: 19 seconds
[12:39:47] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:47] Done.
[Tue Jun 16 12:39:47 2020]
Finished job 112.
115 of 202 steps (57%) done

[Tue Jun 16 12:39:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
    jobid: 176
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB2372AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[12:39:47] Running: samtools index snps.bam 2>> snps.log
[12:39:47] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 320208 reads in 16.985 CPU sec, 2.321 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:48] This is snippy 4.4.3
[12:39:48] Written by Torsten Seemann
[12:39:48] Obtained from https://github.com/tseemann/snippy
[12:39:48] Detected operating system: linux
[12:39:48] Enabling bundled linux tools.
[12:39:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:48] Found gzip - /usr/bin/gzip
[samclip] Processed 100000 records...
[12:39:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:48] Treating reference as 'fasta' format.
[12:39:48] Will use 8 CPU cores.
[12:39:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta
[12:39:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[12:39:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[12:39:48] Creating reference folder: reference
[12:39:48] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 69806 reads in 4.494 CPU sec, 0.527 real sec
[samclip] Processed 200000 records...
[12:39:48] Wrote 3 sequences to ref.fa
[12:39:48] Wrote 0 features to ref.gff
[12:39:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB2372AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320000 reads in 18.027 CPU sec, 2.553 real sec
[samclip] Processed 300000 records...
[12:39:48] Marked 0 heterozygous sites with 'n'
[12:39:49] Creating extra output files: BED GFF CSV TXT HTML
[12:39:49] Identified 24 variants.
[12:39:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out
[12:39:49] Result files:
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.aligned.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bam.bai
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.bed
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.consensus.subs.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.csv
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.filt.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.gff
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.html
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.log
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.raw.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.subs.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.tab
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.txt
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out/snps.vcf.gz.csi
[12:39:49] Walltime used: 20 seconds
[12:39:49] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:49] Done.
[Tue Jun 16 12:39:49 2020]
Finished job 3.
116 of 202 steps (57%) done

[Tue Jun 16 12:39:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
    jobid: 190
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB8135AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OA4072AA_AS.out\tSM:SAL_OA4072AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.772 sec; CPU: 22.041 sec
[samclip] Total SAM records 390269, removed 1087, allowed 146, passed 389182
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:49] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:49] Marked 0 heterozygous sites with 'n'
[12:39:49] Creating extra output files: BED GFF CSV TXT HTML
[12:39:49] Identified 1918 variants.
[12:39:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out
[12:39:49] Result files:
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.aligned.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bam.bai
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.bed
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.consensus.subs.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.csv
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.filt.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.gff
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.html
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.log
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.raw.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.subs.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.tab
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.txt
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out/snps.vcf.gz.csi
[12:39:49] Walltime used: 20 seconds
[12:39:49] Questionable SNP? Try the --report option to see the alignments.
[12:39:49] Done.
[Tue Jun 16 12:39:49 2020]
Finished job 66.
117 of 202 steps (58%) done
[12:39:49] Creating extra output files: BED GFF CSV TXT HTML

[Tue Jun 16 12:39:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
    jobid: 12
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1136AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
[12:39:49] Identified 1801 variants.
[12:39:49] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out
[12:39:49] Result files:
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.aligned.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bam.bai
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.bed
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.consensus.subs.fa
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.csv
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.filt.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.gff
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.html
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.log
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.raw.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.subs.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.tab
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.txt
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz
[12:39:49] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out/snps.vcf.gz.csi
[12:39:49] Walltime used: 20 seconds
[12:39:49] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:49] Done.
[Tue Jun 16 12:39:49 2020]
Finished job 181.
118 of 202 steps (58%) done

[Tue Jun 16 12:39:49 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
    jobid: 163
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB7027AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 65894 reads in 4.625 CPU sec, 0.537 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:49] This is snippy 4.4.3
[12:39:49] Written by Torsten Seemann
[12:39:49] Obtained from https://github.com/tseemann/snippy
[12:39:49] Detected operating system: linux
[12:39:49] Enabling bundled linux tools.
[12:39:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:49] Found gzip - /usr/bin/gzip
[12:39:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_PB8418AA_AS.out\tSM:SAL_PB8418AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.967 sec; CPU: 23.215 sec
[samclip] Total SAM records 386153, removed 1352, allowed 154, passed 384801
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:49] This is snippy 4.4.3
[12:39:49] Written by Torsten Seemann
[12:39:49] Obtained from https://github.com/tseemann/snippy
[12:39:49] Detected operating system: linux
[12:39:49] Enabling bundled linux tools.
[12:39:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:49] This is snippy 4.4.3
[12:39:49] Written by Torsten Seemann
[12:39:49] Obtained from https://github.com/tseemann/snippy
[12:39:49] Detected operating system: linux
[12:39:49] Enabling bundled linux tools.
[12:39:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:50] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:50] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:50] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:50] Found gzip - /usr/bin/gzip
[12:39:50] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:50] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:50] Treating reference as 'fasta' format.
[12:39:50] Will use 8 CPU cores.
[12:39:50] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta
[12:39:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[12:39:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[12:39:50] Creating reference folder: reference
[12:39:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:50] Extracting FASTA and GFF from reference.
[12:39:50] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:50] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:50] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:50] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:50] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:50] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:50] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:50] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:50] Found gzip - /usr/bin/gzip
[12:39:50] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:50] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:50] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:50] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:50] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:39:50] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:50] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:50] Wrote 3 sequences to ref.fa
[12:39:50] Wrote 0 features to ref.gff
[12:39:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8135AA_AS.fasta into pseudo-reads
[12:39:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:50] Treating reference as 'fasta' format.
[12:39:50] Will use 8 CPU cores.
[12:39:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta
[12:39:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[12:39:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[12:39:50] Creating reference folder: reference
[12:39:50] Extracting FASTA and GFF from reference.
[12:39:50] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:50] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:50] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:39:50] Treating reference as 'fasta' format.
[12:39:50] Will use 8 CPU cores.
[12:39:50] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta
[12:39:50] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[12:39:50] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[12:39:50] Creating reference folder: reference
[12:39:50] Extracting FASTA and GFF from reference.
[12:39:50] Wrote 3 sequences to ref.fa
[12:39:50] Wrote 0 features to ref.gff
[12:39:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1136AA_AS.fasta into pseudo-reads
[12:39:50] Wrote 3 sequences to ref.fa
[12:39:50] Wrote 0 features to ref.gff
[12:39:50] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB7027AA_AS.fasta into pseudo-reads
[12:39:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 27
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:51] Running: samtools index snps.bam 2>> snps.log
[12:39:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:51] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:51] Wrote 386116 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:51] Using BAM RG (Read Group) ID: SAL_CB2372AA_AS.out
[12:39:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:51] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:51] Running: samtools index snps.bam 2>> snps.log
[12:39:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:39:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:52] Wrote 385784 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:52] Using BAM RG (Read Group) ID: SAL_BB8135AA_AS.out
[12:39:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:53] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:53] Wrote 385248 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:53] Using BAM RG (Read Group) ID: SAL_KB1136AA_AS.out
[12:39:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:53] Wrote 385918 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:53] Running: bwa index reference/ref.fa 2>> snps.log
[12:39:53] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:53] Using BAM RG (Read Group) ID: SAL_BB7027AA_AS.out
[12:39:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:53] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:39:53] Running: bwa index reference/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 66116 sequences (16515168 bp)...
[12:39:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:39:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:39:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:39:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:39:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:39:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:39:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:54] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:39:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:39:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:39:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:55] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:39:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:39:55] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:39:55] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:39:55] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:39:55] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:39:55] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 20
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:39:55] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:39:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320026 sequences (80000438 bp)...
[12:39:55] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:39:55] Marked 0 heterozygous sites with 'n'
[12:39:55] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 65758 sequences (16399466 bp)...
[M::process] read 320066 sequences (80000238 bp)...
[12:39:55] Creating extra output files: BED GFF CSV TXT HTML
[12:39:55] Identified 27 variants.
[12:39:55] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out
[12:39:55] Result files:
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.aligned.fa
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bam.bai
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.bed
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.fa
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.consensus.subs.fa
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.csv
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.filt.vcf
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.gff
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.html
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.log
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.raw.vcf
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.subs.vcf
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.tab
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.txt
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz
[12:39:55] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out/snps.vcf.gz.csi
[12:39:55] Walltime used: 19 seconds
[12:39:55] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:39:55] Done.
[12:39:55] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[Tue Jun 16 12:39:55 2020]
Finished job 128.
119 of 202 steps (59%) done

[Tue Jun 16 12:39:55 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
    jobid: 82
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB4088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[M::process] read 320000 sequences (80000000 bp)...
[12:39:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 65182 sequences (16295500 bp)...
[12:39:55] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[M::process] read 65918 sequences (16444206 bp)...
[12:39:55] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:39:55] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:39:55] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:39:55] Running: rm -f fake_reads\.fq 2>> snps.log
[12:39:55] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 16.761 CPU sec, 2.397 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[12:39:56] This is snippy 4.4.3
[12:39:56] Written by Torsten Seemann
[12:39:56] Obtained from https://github.com/tseemann/snippy
[12:39:56] Detected operating system: linux
[12:39:56] Enabling bundled linux tools.
[12:39:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:39:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:39:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:39:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:39:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:39:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:39:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:39:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:39:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:39:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:39:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:39:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:39:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:39:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:39:56] Found gzip - /usr/bin/gzip
[12:39:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:39:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:39:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:39:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:39:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[M::mem_process_seqs] Processed 66116 reads in 4.062 CPU sec, 0.488 real sec
[12:39:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:39:56] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:39:56] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:39:56] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:39:56] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 200000 records...
[12:39:56] Treating reference as 'fasta' format.
[12:39:56] Will use 8 CPU cores.
[12:39:56] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta
[12:39:56] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[12:39:56] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[12:39:56] Creating reference folder: reference
[12:39:56] Extracting FASTA and GFF from reference.
[12:39:56] Wrote 3 sequences to ref.fa
[12:39:56] Wrote 0 features to ref.gff
[12:39:56] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4088AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB2372AA_AS.out\tSM:SAL_CB2372AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 386460, removed 948, allowed 111, passed 385512

[main] Real time: 3.983 sec; CPU: 21.430 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320026 reads in 17.353 CPU sec, 2.438 real sec
[M::mem_process_seqs] Processed 320000 reads in 17.575 CPU sec, 2.534 real sec
[M::mem_process_seqs] Processed 320066 reads in 17.877 CPU sec, 2.643 real sec
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 65758 reads in 3.563 CPU sec, 0.451 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65918 reads in 3.591 CPU sec, 0.447 real sec
[M::mem_process_seqs] Processed 65182 reads in 4.134 CPU sec, 0.493 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8135AA_AS.out\tSM:SAL_BB8135AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.937 sec; CPU: 21.531 sec
[samclip] Total SAM records 386016, removed 651, allowed 69, passed 385365
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:59] Marked 1 heterozygous sites with 'n'
[12:39:59] Creating extra output files: BED GFF CSV TXT HTML
[12:39:59] Identified 18 variants.
[12:39:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out
[12:39:59] Result files:
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.aligned.fa
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bam.bai
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.bed
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.fa
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.consensus.subs.fa
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.csv
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.filt.vcf
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.gff
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.html
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.log
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.raw.vcf
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.subs.vcf
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.tab
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.txt
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz
[12:39:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out/snps.vcf.gz.csi
[12:39:59] Walltime used: 19 seconds
[12:39:59] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:39:59] Done.
[12:39:59] Running: samtools index snps.bam 2>> snps.log
[Tue Jun 16 12:39:59 2020]
Finished job 97.
120 of 202 steps (59%) done

[Tue Jun 16 12:39:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
    jobid: 6
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9822AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1136AA_AS.out\tSM:SAL_KB1136AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.066 sec; CPU: 22.587 sec
[samclip] Total SAM records 385591, removed 1562, allowed 190, passed 384029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB7027AA_AS.out\tSM:SAL_BB7027AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.093 sec; CPU: 21.791 sec
[samclip] Total SAM records 386160, removed 736, allowed 68, passed 385424
[samclip] Header contained 5 lines
[samclip] Done.
[12:39:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:39:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:39:59] Wrote 385496 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:39:59] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:39:59] Using BAM RG (Read Group) ID: SAL_EB4088AA_AS.out
[12:39:59] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:39:59] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:39:59] Marked 1 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:00] Creating extra output files: BED GFF CSV TXT HTML
[12:40:00] Identified 1811 variants.
[12:40:00] This is snippy 4.4.3
[12:40:00] Written by Torsten Seemann
[12:40:00] Obtained from https://github.com/tseemann/snippy
[12:40:00] Detected operating system: linux
[12:40:00] Enabling bundled linux tools.
[12:40:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:00] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out
[12:40:00] Result files:
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.aligned.fa
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bam.bai
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.bed
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.fa
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.consensus.subs.fa
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.csv
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.filt.vcf
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.gff
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.html
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.log
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.raw.vcf
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.subs.vcf
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.tab
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.txt
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz
[12:40:00] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out/snps.vcf.gz.csi
[12:40:00] Walltime used: 20 seconds
[12:40:00] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:40:00] Done.
[12:40:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[Tue Jun 16 12:40:00 2020]
[12:40:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
Finished job 161.
121 of 202 steps (60%) done

[Tue Jun 16 12:40:00 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
    jobid: 114
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA7988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
[12:40:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:00] Found gzip - /usr/bin/gzip
[12:40:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:00] Treating reference as 'fasta' format.
[12:40:00] Will use 8 CPU cores.
[12:40:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta
[12:40:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[12:40:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[12:40:00] Creating reference folder: reference
[12:40:00] Extracting FASTA and GFF from reference.
[12:40:00] Wrote 3 sequences to ref.fa
[12:40:00] Wrote 0 features to ref.gff
[12:40:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9822AA_AS.fasta into pseudo-reads
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:00] This is snippy 4.4.3
[12:40:00] Written by Torsten Seemann
[12:40:00] Obtained from https://github.com/tseemann/snippy
[12:40:00] Detected operating system: linux
[12:40:00] Enabling bundled linux tools.
[12:40:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:00] Found gzip - /usr/bin/gzip
[12:40:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:01] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:01] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:01] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:01] Running: samtools index snps.bam 2>> snps.log
[12:40:01] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:01] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:01] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:01] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:01] Treating reference as 'fasta' format.
[12:40:01] Will use 8 CPU cores.
[12:40:01] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta
[12:40:01] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[12:40:01] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[12:40:01] Creating reference folder: reference
[12:40:01] Extracting FASTA and GFF from reference.
[12:40:01] Running: samtools index snps.bam 2>> snps.log
[12:40:01] Running: samtools index snps.bam 2>> snps.log
[12:40:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:01] Wrote 3 sequences to ref.fa
[12:40:01] Wrote 0 features to ref.gff
[12:40:01] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7988AA_AS.fasta into pseudo-reads
[12:40:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:40:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:01] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:01] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[12:40:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 65496 sequences (16331678 bp)...
[12:40:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:03] Wrote 386426 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:03] Using BAM RG (Read Group) ID: SAL_CB9822AA_AS.out
[12:40:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:03] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:04] Wrote 389786 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:04] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:04] Using BAM RG (Read Group) ID: SAL_UA7988AA_AS.out
[12:40:04] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:04] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:40:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.996 CPU sec, 2.805 real sec
[12:40:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:04] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:40:04] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:40:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1912
       total no. reference observed             : 0

Time elapsed: 0.02s

[samclip] Processed 100000 records...
[12:40:04] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:04] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:05] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 65496 reads in 4.340 CPU sec, 0.501 real sec
[samclip] Processed 200000 records...
[12:40:05] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:05] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:05] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:05] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:05] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:05] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:05] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] Processed 300000 records...
[12:40:05] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320118 sequences (80000430 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4088AA_AS.out\tSM:SAL_EB4088AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 385770, removed 766, allowed 52, passed 385004

[main] Real time: 4.184 sec; CPU: 21.883 sec
[samclip] Header contained 5 lines
[samclip] Done.
[M::process] read 66308 sequences (16564590 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320082 sequences (80000088 bp)...
[M::process] read 69704 sequences (17426000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:06] Marked 1 heterozygous sites with 'n'
[12:40:07] Creating extra output files: BED GFF CSV TXT HTML
[12:40:07] Identified 16 variants.
[12:40:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out
[12:40:07] Result files:
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.aligned.fa
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bam.bai
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.bed
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.fa
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.consensus.subs.fa
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.csv
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.filt.vcf
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.gff
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.html
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.log
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.raw.vcf
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.subs.vcf
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.tab
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.txt
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz
[12:40:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out/snps.vcf.gz.csi
[12:40:07] Walltime used: 19 seconds
[12:40:07] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:40:07] Done.
[Tue Jun 16 12:40:07 2020]
Finished job 176.
122 of 202 steps (60%) done

[Tue Jun 16 12:40:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
    jobid: 126
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB9988AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
[12:40:07] Running: samtools index snps.bam 2>> snps.log
[12:40:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320118 reads in 17.291 CPU sec, 2.443 real sec
[12:40:07] This is snippy 4.4.3
[12:40:07] Written by Torsten Seemann
[12:40:07] Obtained from https://github.com/tseemann/snippy
[12:40:07] Detected operating system: linux
[12:40:07] Enabling bundled linux tools.
[12:40:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:08] Found gzip - /usr/bin/gzip
[12:40:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:08] Treating reference as 'fasta' format.
[12:40:08] Will use 8 CPU cores.
[12:40:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta
[12:40:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[12:40:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[12:40:08] Creating reference folder: reference
[12:40:08] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[12:40:08] Wrote 3 sequences to ref.fa
[12:40:08] Wrote 0 features to ref.gff
[12:40:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB9988AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 66308 reads in 4.027 CPU sec, 0.478 real sec
[samclip] Processed 200000 records...
[12:40:08] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[12:40:08] Creating extra output files: BED GFF CSV TXT HTML
[12:40:08] Identified 22 variants.
[12:40:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out
[12:40:08] Result files:
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.aligned.fa
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bam.bai
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.bed
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.fa
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.consensus.subs.fa
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.csv
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.filt.vcf
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.gff
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.html
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.log
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.raw.vcf
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.subs.vcf
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.tab
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.txt
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz
[12:40:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out/snps.vcf.gz.csi
[12:40:08] Walltime used: 19 seconds
[12:40:08] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:40:08] Done.
[Tue Jun 16 12:40:08 2020]
Finished job 190.
123 of 202 steps (61%) done

[Tue Jun 16 12:40:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
    jobid: 167
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA2453AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[M::mem_process_seqs] Processed 320082 reads in 19.359 CPU sec, 2.692 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9822AA_AS.out\tSM:SAL_CB9822AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.926 sec; CPU: 21.907 sec
[samclip] Total SAM records 386705, removed 879, allowed 74, passed 385826
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:09] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:09] Creating extra output files: BED GFF CSV TXT HTML
[12:40:09] Identified 22 variants.
[12:40:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out
[12:40:09] Result files:
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.aligned.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bam.bai
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.bed
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.consensus.subs.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.csv
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.filt.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.gff
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.html
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.log
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.raw.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.subs.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.tab
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.txt
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out/snps.vcf.gz.csi
[12:40:09] Walltime used: 20 seconds
[12:40:09] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:40:09] Done.
[Tue Jun 16 12:40:09 2020]
Finished job 163.
124 of 202 steps (61%) done

[Tue Jun 16 12:40:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
    jobid: 59
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_DB1444AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 69704 reads in 4.406 CPU sec, 0.505 real sec
[12:40:09] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[12:40:09] Creating extra output files: BED GFF CSV TXT HTML
[12:40:09] Identified 1912 variants.
[12:40:09] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out
[12:40:09] Result files:
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.aligned.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bam.bai
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.bed
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.consensus.subs.fa
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.csv
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.filt.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.gff
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.html
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.log
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.raw.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.subs.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.tab
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.txt
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz
[12:40:09] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out/snps.vcf.gz.csi
[12:40:09] Walltime used: 20 seconds
[12:40:09] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:40:09] Done.
[Tue Jun 16 12:40:09 2020]
Finished job 12.
125 of 202 steps (62%) done

[Tue Jun 16 12:40:09 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
    jobid: 109
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB9523AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[12:40:09] This is snippy 4.4.3
[12:40:09] Written by Torsten Seemann
[12:40:09] Obtained from https://github.com/tseemann/snippy
[12:40:09] Detected operating system: linux
[12:40:09] Enabling bundled linux tools.
[12:40:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:09] Found gzip - /usr/bin/gzip
[12:40:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[12:40:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:09] Treating reference as 'fasta' format.
[12:40:09] Will use 8 CPU cores.
[12:40:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta
[12:40:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[12:40:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[12:40:09] Creating reference folder: reference
[12:40:09] Extracting FASTA and GFF from reference.
[12:40:09] This is snippy 4.4.3
[12:40:09] Written by Torsten Seemann
[12:40:09] Obtained from https://github.com/tseemann/snippy
[12:40:09] Detected operating system: linux
[12:40:09] Enabling bundled linux tools.
[12:40:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:09] Found gzip - /usr/bin/gzip
[12:40:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:09] Wrote 3 sequences to ref.fa
[12:40:09] Wrote 0 features to ref.gff
[12:40:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA2453AA_AS.fasta into pseudo-reads
[12:40:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_UA7988AA_AS.out\tSM:SAL_UA7988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.109 sec; CPU: 24.327 sec
[samclip] Total SAM records 389973, removed 1419, allowed 239, passed 388554
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:10] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:10] Treating reference as 'fasta' format.
[12:40:10] Will use 8 CPU cores.
[12:40:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta
[12:40:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[12:40:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[12:40:10] Creating reference folder: reference
[12:40:10] Extracting FASTA and GFF from reference.
[12:40:10] This is snippy 4.4.3
[12:40:10] Written by Torsten Seemann
[12:40:10] Obtained from https://github.com/tseemann/snippy
[12:40:10] Detected operating system: linux
[12:40:10] Enabling bundled linux tools.
[12:40:10] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:10] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:10] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:10] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:10] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:10] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:10] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:10] Wrote 3 sequences to ref.fa
[12:40:10] Wrote 0 features to ref.gff
[12:40:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_DB1444AA_AS.fasta into pseudo-reads
[12:40:10] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:10] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:10] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:10] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:10] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:10] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:10] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:10] Found gzip - /usr/bin/gzip
[12:40:10] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:10] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:10] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:10] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:10] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:10] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:10] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:10] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:10] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:10] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:10] Treating reference as 'fasta' format.
[12:40:10] Will use 8 CPU cores.
[12:40:10] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta
[12:40:10] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[12:40:10] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[12:40:10] Creating reference folder: reference
[12:40:10] Extracting FASTA and GFF from reference.
[12:40:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:10] Wrote 3 sequences to ref.fa
[12:40:10] Wrote 0 features to ref.gff
[12:40:10] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB9523AA_AS.fasta into pseudo-reads
[12:40:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:11] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:11] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:11] Running: samtools index snps.bam 2>> snps.log
[12:40:11] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:11] Wrote 384936 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:11] Using BAM RG (Read Group) ID: SAL_CB9988AA_AS.out
[12:40:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:11] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:11] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:11] Running: samtools index snps.bam 2>> snps.log
[12:40:12] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:12] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:12] Wrote 388114 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:12] Using BAM RG (Read Group) ID: SAL_SA2453AA_AS.out
[12:40:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:13] Wrote 384592 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:40:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:13] Using BAM RG (Read Group) ID: SAL_DB1444AA_AS.out
[12:40:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:13] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[12:40:13] Wrote 384522 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:13] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:13] Using BAM RG (Read Group) ID: SAL_KB9523AA_AS.out
[12:40:13] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:13] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 64936 sequences (16193398 bp)...
[12:40:14] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:14] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:14] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320138 sequences (80000116 bp)...
[12:40:15] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 67976 sequences (16989752 bp)...
[12:40:15] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:15] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:15] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:15] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:15] Marked 0 heterozygous sites with 'n'
[12:40:15] Creating extra output files: BED GFF CSV TXT HTML
[12:40:15] Identified 20 variants.
[12:40:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out
[12:40:15] Result files:
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.aligned.fa
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bam.bai
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.bed
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.fa
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.consensus.subs.fa
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.csv
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.filt.vcf
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.gff
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.html
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.log
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.raw.vcf
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.subs.vcf
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.tab
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.txt
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz
[12:40:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out/snps.vcf.gz.csi
[12:40:15] Walltime used: 19 seconds
[12:40:15] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:40:15] Done.
[12:40:15] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 320044 sequences (80000246 bp)...
[Tue Jun 16 12:40:15 2020]
Finished job 82.
126 of 202 steps (62%) done

[Tue Jun 16 12:40:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
    jobid: 32
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB5876AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 25
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1791
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:15] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 64548 sequences (16137000 bp)...
[M::process] read 320054 sequences (80000440 bp)...
[12:40:15] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 64468 sequences (16115374 bp)...
[12:40:15] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:15] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:15] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:15] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:15] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:15] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:15] Running: rm -f fake_reads\.fq 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320000 reads in 17.951 CPU sec, 2.574 real sec
[12:40:15] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:16] This is snippy 4.4.3
[12:40:16] Written by Torsten Seemann
[12:40:16] Obtained from https://github.com/tseemann/snippy
[12:40:16] Detected operating system: linux
[12:40:16] Enabling bundled linux tools.
[12:40:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:16] Found gzip - /usr/bin/gzip
[12:40:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[M::mem_process_seqs] Processed 64936 reads in 3.530 CPU sec, 0.443 real sec
[12:40:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 100000 records...
[12:40:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:16] Treating reference as 'fasta' format.
[12:40:16] Will use 8 CPU cores.
[12:40:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta
[12:40:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[12:40:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[12:40:16] Creating reference folder: reference
[12:40:16] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[12:40:16] Wrote 3 sequences to ref.fa
[12:40:16] Wrote 0 features to ref.gff
[12:40:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB5876AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB9988AA_AS.out\tSM:SAL_CB9988AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.166 sec; CPU: 22.109 sec
[samclip] Total SAM records 385174, removed 953, allowed 138, passed 384221
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320138 reads in 18.852 CPU sec, 2.577 real sec
[M::mem_process_seqs] Processed 320044 reads in 17.383 CPU sec, 2.366 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67976 reads in 4.359 CPU sec, 0.509 real sec
[M::mem_process_seqs] Processed 64548 reads in 3.780 CPU sec, 0.446 real sec
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320054 reads in 17.821 CPU sec, 2.639 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 64468 reads in 4.034 CPU sec, 0.460 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA2453AA_AS.out\tSM:SAL_SA2453AA_AS.out[samclip] Total SAM records 388314, removed 1268, allowed 208, passed 387046
 -t 8[samclip] Header contained 5 lines
 reference/ref.fa[samclip] Done.
 fake_reads.fq
[main] Real time: 3.981 sec; CPU: 23.760 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_DB1444AA_AS.out\tSM:SAL_DB1444AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.793 sec; CPU: 21.746 sec
[samclip] Total SAM records 384693, removed 741, allowed 49, passed 383952
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:18] Marked 0 heterozygous sites with 'n'
[12:40:18] Creating extra output files: BED GFF CSV TXT HTML
[12:40:18] Identified 17 variants.
[12:40:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out
[12:40:18] Result files:
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.aligned.fa
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bam.bai
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.bed
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.fa
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.consensus.subs.fa
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.csv
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.filt.vcf
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.gff
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.html
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.log
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.raw.vcf
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.subs.vcf
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.tab
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.txt
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz
[12:40:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out/snps.vcf.gz.csi
[12:40:18] Walltime used: 18 seconds
[12:40:18] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:40:18] Done.
[Tue Jun 16 12:40:18 2020]
Finished job 6.
127 of 202 steps (63%) done

[Tue Jun 16 12:40:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
    jobid: 18
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB6687AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R[samclip] Total SAM records 384620, removed 583, allowed 44, passed 384037
 @RG\tID:SAL_KB9523AA_AS.out\tSM:SAL_KB9523AA_AS.out -t 8[samclip] Header contained 5 lines
 reference/ref.fa fake_reads.fq[samclip] Done.

[main] Real time: 4.002 sec; CPU: 22.402 sec
[12:40:19] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:19] Wrote 385642 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:19] Using BAM RG (Read Group) ID: SAL_EB5876AA_AS.out
[12:40:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:19] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:20] This is snippy 4.4.3
[12:40:20] Written by Torsten Seemann
[12:40:20] Obtained from https://github.com/tseemann/snippy
[12:40:20] Detected operating system: linux
[12:40:20] Enabling bundled linux tools.
[12:40:20] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:20] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:20] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:20] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:20] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:20] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:20] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:20] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:20] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:20] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:20] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:20] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:20] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:20] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:20] Found gzip - /usr/bin/gzip
[12:40:20] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:20] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:20] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:20] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:20] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:20] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:20] Marked 0 heterozygous sites with 'n'
[12:40:20] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:20] Creating extra output files: BED GFF CSV TXT HTML
[12:40:20] Identified 1791 variants.
[12:40:20] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out
[12:40:20] Result files:
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.aligned.fa
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bam.bai
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.bed
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.fa
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.consensus.subs.fa
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.csv
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.filt.vcf
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.gff
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.html
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.log
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.raw.vcf
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.subs.vcf
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.tab
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.txt
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz
[12:40:20] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out/snps.vcf.gz.csi
[12:40:20] Walltime used: 20 seconds
[12:40:20] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:40:20] Done.
[Tue Jun 16 12:40:20 2020]
Finished job 114.
128 of 202 steps (63%) done

[Tue Jun 16 12:40:20 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
    jobid: 91
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_UA7989AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[12:40:20] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:20] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:20] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:20] Treating reference as 'fasta' format.
[12:40:20] Will use 8 CPU cores.
[12:40:20] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta
[12:40:20] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[12:40:20] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[12:40:20] Creating reference folder: reference
[12:40:20] Extracting FASTA and GFF from reference.
[12:40:20] Wrote 3 sequences to ref.fa
[12:40:20] Wrote 0 features to ref.gff
[12:40:20] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB6687AA_AS.fasta into pseudo-reads
[12:40:20] Running: samtools index snps.bam 2>> snps.log
[12:40:20] Running: samtools index snps.bam 2>> snps.log
[12:40:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:21] Running: samtools index snps.bam 2>> snps.log
[12:40:21] This is snippy 4.4.3
[12:40:21] Written by Torsten Seemann
[12:40:21] Obtained from https://github.com/tseemann/snippy
[12:40:21] Detected operating system: linux
[12:40:21] Enabling bundled linux tools.
[12:40:21] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:21] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:21] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:21] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:21] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:21] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:21] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:21] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:21] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:21] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:21] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:21] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:21] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:21] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:21] Found gzip - /usr/bin/gzip
[12:40:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:21] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:21] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:21] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:21] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:21] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:21] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:21] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:40:21] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:21] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:21] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:21] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:21] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:21] Treating reference as 'fasta' format.
[12:40:21] Will use 8 CPU cores.
[12:40:21] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta
[12:40:21] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[12:40:21] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[12:40:21] Creating reference folder: reference
[12:40:21] Extracting FASTA and GFF from reference.
[12:40:21] Wrote 3 sequences to ref.fa
[12:40:21] Wrote 0 features to ref.gff
[12:40:21] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_UA7989AA_AS.fasta into pseudo-reads
[M::process] read 320010 sequences (80000096 bp)...
[M::process] read 65632 sequences (16408000 bp)...
[12:40:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 14
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 14

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 14
       total no. variants observed              : 516
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:23] Wrote 384322 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:23] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:23] Using BAM RG (Read Group) ID: SAL_BB6687AA_AS.out
[12:40:23] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:23] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 137
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 10
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 13

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 13
       total no. variants observed              : 142
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1811
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:24] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:24] Wrote 390182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:24] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:24] Using BAM RG (Read Group) ID: SAL_UA7989AA_AS.out
[12:40:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:24] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:24] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:24] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::mem_process_seqs] Processed 320010 reads in 18.324 CPU sec, 2.971 real sec
[12:40:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:24] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[samclip] Processed 100000 records...
[12:40:25] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:25] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:25] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:25] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:25] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 65632 reads in 4.614 CPU sec, 0.530 real sec
[samclip] Processed 300000 records...
[M::process] read 320202 sequences (80000426 bp)...
[M::process] read 64120 sequences (16030000 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB5876AA_AS.out\tSM:SAL_EB5876AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.369 sec; CPU: 23.493 sec
[samclip] Total SAM records 385979, removed 1409, allowed 205, passed 384570
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:26] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:26] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:26] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:26] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:26] Running: bwa mem  -Y -M -R '@RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320094 sequences (80000282 bp)...
[M::process] read 70088 sequences (17520596 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:27] Marked 0 heterozygous sites with 'n'
[12:40:27] Creating extra output files: BED GFF CSV TXT HTML
[12:40:27] Identified 516 variants.
[12:40:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out
[12:40:27] Result files:
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.aligned.fa
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bam.bai
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.bed
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.fa
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.consensus.subs.fa
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.csv
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.filt.vcf
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.gff
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.html
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.log
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.raw.vcf
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.subs.vcf
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.tab
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.txt
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz
[12:40:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out/snps.vcf.gz.csi
[12:40:27] Walltime used: 20 seconds
[12:40:27] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:40:27] Done.
[Tue Jun 16 12:40:27 2020]
Finished job 126.
129 of 202 steps (64%) done

[Tue Jun 16 12:40:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
    jobid: 79
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB4083AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
[12:40:27] Running: samtools index snps.bam 2>> snps.log
[12:40:27] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320202 reads in 17.895 CPU sec, 2.530 real sec
[12:40:28] This is snippy 4.4.3
[12:40:28] Written by Torsten Seemann
[12:40:28] Obtained from https://github.com/tseemann/snippy
[12:40:28] Detected operating system: linux
[12:40:28] Enabling bundled linux tools.
[12:40:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:28] Found gzip - /usr/bin/gzip
[12:40:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[samclip] Processed 100000 records...
[12:40:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[M::mem_process_seqs] Processed 64120 reads in 3.964 CPU sec, 0.462 real sec
[12:40:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:28] Treating reference as 'fasta' format.
[12:40:28] Will use 8 CPU cores.
[12:40:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta
[12:40:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[12:40:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[12:40:28] Creating reference folder: reference
[12:40:28] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[12:40:28] Wrote 3 sequences to ref.fa
[12:40:28] Wrote 0 features to ref.gff
[12:40:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB4083AA_AS.fasta into pseudo-reads
[12:40:28] Marked 26 heterozygous sites with 'n'
[12:40:28] Creating extra output files: BED GFF CSV TXT HTML
[12:40:28] Identified 137 variants.
[12:40:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out
[12:40:28] Result files:
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.aligned.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bam.bai
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.bed
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.consensus.subs.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.csv
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.filt.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.gff
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.html
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.log
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.raw.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.subs.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.tab
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.txt
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out/snps.vcf.gz.csi
[12:40:28] Walltime used: 19 seconds
[12:40:28] May the SNPs be with you.
[12:40:28] Done.
[Tue Jun 16 12:40:28 2020]
Finished job 59.
130 of 202 steps (64%) done

[Tue Jun 16 12:40:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
    jobid: 195
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_MA3067AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[samclip] Processed 300000 records...
[12:40:28] Marked 8 heterozygous sites with 'n'
[12:40:28] Creating extra output files: BED GFF CSV TXT HTML
[12:40:28] Identified 142 variants.
[12:40:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out
[12:40:28] Result files:
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.aligned.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bam.bai
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.bed
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.consensus.subs.fa
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.csv
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.filt.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.gff
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.html
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.log
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.raw.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.subs.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.tab
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.txt
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz
[12:40:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out/snps.vcf.gz.csi
[12:40:28] Walltime used: 18 seconds
[12:40:28] Questionable SNP? Try the --report option to see the alignments.
[12:40:28] Done.
[Tue Jun 16 12:40:28 2020]
Finished job 109.
131 of 202 steps (65%) done

[Tue Jun 16 12:40:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
    jobid: 93
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB3497AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[12:40:28] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320094 reads in 18.417 CPU sec, 2.473 real sec
[12:40:29] Creating extra output files: BED GFF CSV TXT HTML
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB6687AA_AS.out\tSM:SAL_BB6687AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.929 sec; CPU: 22.442 sec
[samclip] Total SAM records 384473, removed 460, allowed 55, passed 384013
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:29] Identified 1811 variants.
[12:40:29] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out
[12:40:29] Result files:
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.aligned.fa
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bam.bai
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.bed
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.fa
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.consensus.subs.fa
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.csv
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.filt.vcf
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.gff
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.html
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.log
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.raw.vcf
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.subs.vcf
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.tab
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.txt
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz
[12:40:29] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out/snps.vcf.gz.csi
[12:40:29] Walltime used: 20 seconds
[12:40:29] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:40:29] Done.
[Tue Jun 16 12:40:29 2020]
Finished job 167.
132 of 202 steps (65%) done

[Tue Jun 16 12:40:29 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
    jobid: 11
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB0088AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 70088 reads in 4.344 CPU sec, 0.504 real sec
[12:40:29] This is snippy 4.4.3
[12:40:29] Written by Torsten Seemann
[12:40:29] Obtained from https://github.com/tseemann/snippy
[12:40:29] Detected operating system: linux
[12:40:29] Enabling bundled linux tools.
[12:40:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[samclip] Processed 200000 records...
[12:40:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:29] Found gzip - /usr/bin/gzip
[12:40:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:29] This is snippy 4.4.3
[12:40:29] Written by Torsten Seemann
[12:40:29] Obtained from https://github.com/tseemann/snippy
[12:40:29] Detected operating system: linux
[12:40:29] Enabling bundled linux tools.
[12:40:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:29] Found gzip - /usr/bin/gzip
[12:40:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:29] Treating reference as 'fasta' format.
[12:40:29] Will use 8 CPU cores.
[12:40:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta
[12:40:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[12:40:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[12:40:29] Creating reference folder: reference
[12:40:29] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[12:40:29] This is snippy 4.4.3
[12:40:29] Written by Torsten Seemann
[12:40:29] Obtained from https://github.com/tseemann/snippy
[12:40:29] Detected operating system: linux
[12:40:29] Enabling bundled linux tools.
[12:40:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:29] Found gzip - /usr/bin/gzip
[12:40:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:29] Treating reference as 'fasta' format.
[12:40:29] Will use 8 CPU cores.
[12:40:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta
[12:40:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[12:40:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[12:40:29] Creating reference folder: reference
[12:40:29] Extracting FASTA and GFF from reference.
[12:40:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:29] Wrote 3 sequences to ref.fa
[12:40:29] Wrote 0 features to ref.gff
[12:40:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_MA3067AA_AS.fasta into pseudo-reads
[12:40:30] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:30] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:30] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:30] Wrote 3 sequences to ref.fa
[12:40:30] Wrote 0 features to ref.gff
[12:40:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3497AA_AS.fasta into pseudo-reads
[12:40:30] Treating reference as 'fasta' format.
[12:40:30] Will use 8 CPU cores.
[12:40:30] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta
[12:40:30] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[12:40:30] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[12:40:30] Creating reference folder: reference
[12:40:30] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 390362, removed 1702, allowed 252, passed 388660
 -R @RG\tID:SAL_UA7989AA_AS.out\tSM:SAL_UA7989AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.889 sec; CPU: 23.320 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:30] Wrote 3 sequences to ref.fa
[12:40:30] Wrote 0 features to ref.gff
[12:40:30] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0088AA_AS.fasta into pseudo-reads
[12:40:31] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:40:31] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:40:31] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1930
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:31] Wrote 384666 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:31] Using BAM RG (Read Group) ID: SAL_EB4083AA_AS.out
[12:40:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:31] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:31] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:32] Running: samtools index snps.bam 2>> snps.log
[12:40:32] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:32] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:32] Wrote 385416 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:32] Using BAM RG (Read Group) ID: SAL_CB3497AA_AS.out
[12:40:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:32] Wrote 384750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:33] Using BAM RG (Read Group) ID: SAL_CB0088AA_AS.out
[12:40:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:33] Wrote 388222 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:33] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:33] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:33] Using BAM RG (Read Group) ID: SAL_MA3067AA_AS.out
[12:40:33] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:33] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 64666 sequences (16094524 bp)...
[12:40:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:34] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[M::process] read 320154 sequences (80000190 bp)...
[12:40:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 65262 sequences (16282550 bp)...
[12:40:35] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:35] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:35] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:35] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:35] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:35] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1804
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:35] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320126 sequences (80000090 bp)...
[M::process] read 68096 sequences (17012204 bp)...
[12:40:35] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 320024 sequences (80000480 bp)...
[12:40:35] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 64726 sequences (16096746 bp)...
[12:40:35] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:35] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:35] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:35] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:35] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:35] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320000 reads in 16.392 CPU sec, 2.252 real sec
[12:40:35] Marked 0 heterozygous sites with 'n'
[12:40:36] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:36] Creating extra output files: BED GFF CSV TXT HTML
[12:40:36] Identified 1930 variants.
[12:40:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out
[12:40:36] Result files:
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.aligned.fa
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bam.bai
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.bed
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.fa
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.consensus.subs.fa
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.csv
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.filt.vcf
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.gff
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.html
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.log
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.raw.vcf
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.subs.vcf
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.tab
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.txt
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz
[12:40:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out/snps.vcf.gz.csi
[12:40:36] Walltime used: 20 seconds
[12:40:36] Wishing you a life free of homopolymer errors.
[12:40:36] Done.
[Tue Jun 16 12:40:36 2020]
Finished job 32.
133 of 202 steps (66%) done

[Tue Jun 16 12:40:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
    jobid: 189
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_IA5065AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64666 reads in 3.818 CPU sec, 0.469 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:40:36] This is snippy 4.4.3
[12:40:36] Written by Torsten Seemann
[12:40:36] Obtained from https://github.com/tseemann/snippy
[12:40:36] Detected operating system: linux
[12:40:36] Enabling bundled linux tools.
[12:40:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:36] Found gzip - /usr/bin/gzip
[12:40:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB4083AA_AS.out\tSM:SAL_EB4083AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.828 sec; CPU: 20.844 sec
[samclip] Total SAM records 384812, removed 583, allowed 99, passed 384229
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:37] Treating reference as 'fasta' format.
[12:40:37] Will use 8 CPU cores.
[12:40:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta
[12:40:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[12:40:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[12:40:37] Creating reference folder: reference
[12:40:37] Extracting FASTA and GFF from reference.
[12:40:37] Wrote 3 sequences to ref.fa
[12:40:37] Wrote 0 features to ref.gff
[12:40:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_IA5065AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320154 reads in 17.049 CPU sec, 2.468 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320126 reads in 18.060 CPU sec, 2.445 real sec
[M::mem_process_seqs] Processed 320024 reads in 17.434 CPU sec, 2.430 real sec
[M::mem_process_seqs] Processed 65262 reads in 4.001 CPU sec, 0.476 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 68096 reads in 3.834 CPU sec, 0.453 real sec
[M::mem_process_seqs] Processed 64726 reads in 3.599 CPU sec, 0.424 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB3497AA_AS.out\tSM:SAL_CB3497AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 385748, removed 1012, allowed 128, passed 384736
 fake_reads.fq[samclip] Header contained 5 lines
[samclip] Done.

[main] Real time: 3.848 sec; CPU: 21.586 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[12:40:38] Marked 0 heterozygous sites with 'n'
[12:40:38] Creating extra output files: BED GFF CSV TXT HTML
[12:40:38] Identified 98 variants.
[12:40:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out
[12:40:38] Result files:
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.aligned.fa
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bam.bai
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.bed
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.fa
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.consensus.subs.fa
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.csv
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.filt.vcf
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.gff
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.html
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.log
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.raw.vcf
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.subs.vcf
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.tab
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.txt
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz
[12:40:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out/snps.vcf.gz.csi
[12:40:38] Walltime used: 18 seconds
[12:40:38] Wishing you a life free of homopolymer errors.
[12:40:38] Done.
[Tue Jun 16 12:40:39 2020]
Finished job 18.
134 of 202 steps (66%) done

[Tue Jun 16 12:40:39 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
    jobid: 19
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA7945AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_MA3067AA_AS.out\tSM:SAL_MA3067AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.851 sec; CPU: 22.471 sec
[samclip] Total SAM records 388325, removed 994, allowed 107, passed 387331
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0088AA_AS.out\tSM:SAL_CB0088AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 385165, removed 942, allowed 100, passed 384223

[main] Real time: 3.807 sec; CPU: 21.595 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:39] Running: samtools index snps.bam 2>> snps.log
[12:40:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:39] This is snippy 4.4.3
[12:40:39] Written by Torsten Seemann
[12:40:39] Obtained from https://github.com/tseemann/snippy
[12:40:39] Detected operating system: linux
[12:40:39] Enabling bundled linux tools.
[12:40:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:39] Found gzip - /usr/bin/gzip
[12:40:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:39] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:40] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:40] Treating reference as 'fasta' format.
[12:40:40] Will use 8 CPU cores.
[12:40:40] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta
[12:40:40] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[12:40:40] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[12:40:40] Creating reference folder: reference
[12:40:40] Extracting FASTA and GFF from reference.
[12:40:40] Wrote 389202 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:40] Using BAM RG (Read Group) ID: SAL_IA5065AA_AS.out
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:40] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:40] Marked 0 heterozygous sites with 'n'
[12:40:40] Wrote 3 sequences to ref.fa
[12:40:40] Wrote 0 features to ref.gff
[12:40:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7945AA_AS.fasta into pseudo-reads
[12:40:40] Creating extra output files: BED GFF CSV TXT HTML
[12:40:40] Identified 1804 variants.
[12:40:40] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out
[12:40:40] Result files:
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.aligned.fa
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bam.bai
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.bed
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.fa
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.consensus.subs.fa
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.csv
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.filt.vcf
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.gff
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.html
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.log
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.raw.vcf
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.subs.vcf
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.tab
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.txt
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz
[12:40:40] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out/snps.vcf.gz.csi
[12:40:40] Walltime used: 19 seconds
[12:40:40] Wishing you a life free of homopolymer errors.
[12:40:40] Done.
[Tue Jun 16 12:40:40 2020]
Finished job 91.
135 of 202 steps (67%) done

[Tue Jun 16 12:40:40 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
    jobid: 89
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB3127AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[12:40:40] Running: samtools index snps.bam 2>> snps.log
[12:40:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:40] This is snippy 4.4.3
[12:40:40] Written by Torsten Seemann
[12:40:40] Obtained from https://github.com/tseemann/snippy
[12:40:40] Detected operating system: linux
[12:40:40] Enabling bundled linux tools.
[12:40:40] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:40] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:40] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:40] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:40] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:40] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:40] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:40] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:41] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:41] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:41] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:41] Running: samtools index snps.bam 2>> snps.log
[12:40:41] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:41] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:41] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:41] Found gzip - /usr/bin/gzip
[12:40:41] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:41] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:41] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:41] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:41] Running: samtools index snps.bam 2>> snps.log
[12:40:41] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:41] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:41] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:41] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:41] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:41] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:41] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:41] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:41] Treating reference as 'fasta' format.
[12:40:41] Will use 8 CPU cores.
[12:40:41] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta
[12:40:41] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[12:40:41] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[12:40:41] Creating reference folder: reference
[12:40:41] Extracting FASTA and GFF from reference.
[12:40:41] Wrote 3 sequences to ref.fa
[12:40:41] Wrote 0 features to ref.gff
[12:40:41] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB3127AA_AS.fasta into pseudo-reads
[12:40:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:41] Running: bwa mem  -Y -M -R '@RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 103
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320126 sequences (80000184 bp)...
[M::process] read 69076 sequences (17261518 bp)...
[12:40:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:42] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:42] Wrote 387992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:42] Using BAM RG (Read Group) ID: SAL_BA7945AA_AS.out
[12:40:42] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:42] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 74
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:44] Wrote 384102 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:44] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:44] Using BAM RG (Read Group) ID: SAL_BB3127AA_AS.out
[12:40:44] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:44] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:40:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:40:44] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:40:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 374
       total no. reference observed             : 0

Time elapsed: 0.00s


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:44] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:44] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:44] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:44] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:44] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:44] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:44] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:44] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:44] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 320126 reads in 18.356 CPU sec, 2.469 real sec
[samclip] Processed 100000 records...
[M::process] read 320056 sequences (80000148 bp)...
[M::process] read 67936 sequences (16980480 bp)...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 69076 reads in 4.439 CPU sec, 0.520 real sec
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_IA5065AA_AS.out\tSM:SAL_IA5065AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.851 sec; CPU: 23.339 sec
[samclip] Total SAM records 389418, removed 1376, allowed 263, passed 388042
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:45] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:45] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:45] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:45] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:45] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320118 sequences (80000104 bp)...
[M::process] read 63984 sequences (15961616 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:46] Marked 1 heterozygous sites with 'n'
[12:40:46] Creating extra output files: BED GFF CSV TXT HTML
[12:40:46] Identified 103 variants.
[12:40:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out
[12:40:46] Result files:
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.aligned.fa
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bam.bai
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.bed
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.fa
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.consensus.subs.fa
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.csv
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.filt.vcf
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.gff
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.html
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.log
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.raw.vcf
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.subs.vcf
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.tab
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.txt
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz
[12:40:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out/snps.vcf.gz.csi
[12:40:46] Walltime used: 18 seconds
[12:40:46] Questionable SNP? Try the --report option to see the alignments.
[12:40:46] Done.
[Tue Jun 16 12:40:46 2020]
Finished job 79.
136 of 202 steps (67%) done

[Tue Jun 16 12:40:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
    jobid: 63
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB3375AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320056 reads in 18.206 CPU sec, 2.435 real sec
[12:40:47] This is snippy 4.4.3
[12:40:47] Written by Torsten Seemann
[12:40:47] Obtained from https://github.com/tseemann/snippy
[12:40:47] Detected operating system: linux
[12:40:47] Enabling bundled linux tools.
[12:40:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:47] Found gzip - /usr/bin/gzip
[12:40:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:47] Running: samtools index snps.bam 2>> snps.log
[samclip] Processed 100000 records...
[12:40:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:47] Treating reference as 'fasta' format.
[12:40:47] Will use 8 CPU cores.
[12:40:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta
[12:40:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[12:40:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[12:40:47] Creating reference folder: reference
[12:40:47] Extracting FASTA and GFF from reference.
[12:40:47] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[M::mem_process_seqs] Processed 67936 reads in 4.113 CPU sec, 0.479 real sec
[12:40:48] Wrote 3 sequences to ref.fa
[12:40:48] Wrote 0 features to ref.gff
[12:40:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3375AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320118 reads in 15.666 CPU sec, 2.059 real sec
[12:40:48] Marked 0 heterozygous sites with 'n'
[12:40:48] Creating extra output files: BED GFF CSV TXT HTML
[12:40:48] Identified 74 variants.
[12:40:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out
[12:40:48] Result files:
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.aligned.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bam.bai
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.bed
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.consensus.subs.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.csv
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.filt.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.gff
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.html
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.log
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.raw.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.subs.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.tab
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.txt
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out/snps.vcf.gz.csi
[12:40:48] Walltime used: 19 seconds
[12:40:48] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:40:48] Done.
[Tue Jun 16 12:40:48 2020]
Finished job 93.
137 of 202 steps (68%) done

[Tue Jun 16 12:40:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
    jobid: 104
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB6210AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7945AA_AS.out\tSM:SAL_BA7945AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.875 sec; CPU: 22.869 sec
[samclip] Total SAM records 388364, removed 1774, allowed 267, passed 386590
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:48] Marked 0 heterozygous sites with 'n'
[12:40:48] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 63984 reads in 3.885 CPU sec, 0.449 real sec
[12:40:48] Creating extra output files: BED GFF CSV TXT HTML
[12:40:48] Identified 26 variants.
[12:40:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out
[12:40:48] Result files:
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.aligned.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bam.bai
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.bed
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.consensus.subs.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.csv
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.filt.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.gff
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.html
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.log
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.raw.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.subs.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.tab
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.txt
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out/snps.vcf.gz.csi
[12:40:48] Walltime used: 19 seconds
[12:40:48] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:40:48] Done.
[12:40:48] Creating extra output files: BED GFF CSV TXT HTML
[12:40:48] Identified 374 variants.
[12:40:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out
[12:40:48] Result files:
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.aligned.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bam.bai
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.bed
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.consensus.subs.fa
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.csv
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.filt.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.gff
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.html
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.log
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.raw.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.subs.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.tab
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.txt
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz
[12:40:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out/snps.vcf.gz.csi
[12:40:48] Walltime used: 19 seconds
[12:40:48] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:40:48] Done.
[Tue Jun 16 12:40:48 2020]
Finished job 11.
138 of 202 steps (68%) done

[Tue Jun 16 12:40:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
    jobid: 50
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB2744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
[Tue Jun 16 12:40:48 2020]
Finished job 195.
139 of 202 steps (69%) done

[Tue Jun 16 12:40:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
    jobid: 152
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB9562AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:40:49] This is snippy 4.4.3
[12:40:49] Written by Torsten Seemann
[12:40:49] Obtained from https://github.com/tseemann/snippy
[12:40:49] Detected operating system: linux
[12:40:49] Enabling bundled linux tools.
[12:40:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:49] Found gzip - /usr/bin/gzip
[12:40:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB3127AA_AS.out\tSM:SAL_BB3127AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.423 sec; CPU: 20.088 sec
[samclip] Total SAM records 384381, removed 794, allowed 64, passed 383587
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:49] Treating reference as 'fasta' format.
[12:40:49] Will use 8 CPU cores.
[12:40:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta
[12:40:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[12:40:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[12:40:49] Creating reference folder: reference
[12:40:49] Extracting FASTA and GFF from reference.
[12:40:49] This is snippy 4.4.3
[12:40:49] Written by Torsten Seemann
[12:40:49] Obtained from https://github.com/tseemann/snippy
[12:40:49] Detected operating system: linux
[12:40:49] Enabling bundled linux tools.
[12:40:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:49] This is snippy 4.4.3
[12:40:49] Written by Torsten Seemann
[12:40:49] Obtained from https://github.com/tseemann/snippy
[12:40:49] Detected operating system: linux
[12:40:49] Enabling bundled linux tools.
[12:40:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:49] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:49] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:49] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:49] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:49] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:49] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:49] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:49] Found gzip - /usr/bin/gzip
[12:40:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:49] Found gzip - /usr/bin/gzip
[12:40:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:40:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:49] Wrote 3 sequences to ref.fa
[12:40:49] Wrote 0 features to ref.gff
[12:40:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB6210AA_AS.fasta into pseudo-reads
[12:40:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:49] Treating reference as 'fasta' format.
[12:40:49] Will use 8 CPU cores.
[12:40:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta
[12:40:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[12:40:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[12:40:49] Creating reference folder: reference
[12:40:49] Extracting FASTA and GFF from reference.
[12:40:49] Treating reference as 'fasta' format.
[12:40:49] Will use 8 CPU cores.
[12:40:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta
[12:40:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
[12:40:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
[12:40:49] Creating reference folder: reference
[12:40:49] Extracting FASTA and GFF from reference.
[12:40:49] Wrote 3 sequences to ref.fa
[12:40:49] Wrote 0 features to ref.gff
[12:40:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB2744AA_AS.fasta into pseudo-reads
[12:40:49] Wrote 3 sequences to ref.fa
[12:40:49] Wrote 0 features to ref.gff
[12:40:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB9562AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:50] Running: samtools index snps.bam 2>> snps.log
[12:40:50] Wrote 383716 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:50] Using BAM RG (Read Group) ID: SAL_KB3375AA_AS.out
[12:40:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 23
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 29

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 29
       total no. variants observed              : 1934
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:51] Running: samtools index snps.bam 2>> snps.log
[12:40:51] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:51] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:40:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:51] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:51] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:52] Wrote 384278 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:52] Using BAM RG (Read Group) ID: SAL_KB6210AA_AS.out
[12:40:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:52] Wrote 384294 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:40:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:52] Using BAM RG (Read Group) ID: SAL_KB2744AA_AS.out
[12:40:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:52] Wrote 384058 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:40:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:52] Using BAM RG (Read Group) ID: SAL_BB9562AA_AS.out
[12:40:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:52] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63716 sequences (15905020 bp)...
[12:40:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 27

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 27
       total no. variants observed              : 1897
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:40:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:54] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:40:54] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:40:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:40:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:40:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:54] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:40:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:54] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:54] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:40:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:40:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:40:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:40:54] Running: rm -f fake_reads\.fq 2>> snps.log
[12:40:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:40:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:40:54] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:40:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:40:54] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:40:54] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:40:54] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:40:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:40:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:40:54] Running: rm -f fake_reads\.fq 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320012 sequences (80000380 bp)...
[12:40:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64282 sequences (16022514 bp)...
[M::process] read 320200 sequences (80000492 bp)...
[M::process] read 64078 sequences (16019500 bp)...
[M::process] read 320068 sequences (80000456 bp)...
[M::process] read 63990 sequences (15953704 bp)...
[M::mem_process_seqs] Processed 320000 reads in 18.794 CPU sec, 2.637 real sec
[12:40:55] Marked 0 heterozygous sites with 'n'
[12:40:56] Creating extra output files: BED GFF CSV TXT HTML
[12:40:56] Identified 1934 variants.
[samclip] Processed 100000 records...
[12:40:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out
[12:40:56] Result files:
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.aligned.fa
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bam.bai
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.bed
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.fa
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.consensus.subs.fa
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.csv
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.filt.vcf
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.gff
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.html
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.log
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.raw.vcf
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.subs.vcf
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.tab
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.txt
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz
[12:40:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out/snps.vcf.gz.csi
[12:40:56] Walltime used: 20 seconds
[12:40:56] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:40:56] Done.
[Tue Jun 16 12:40:56 2020]
Finished job 189.
140 of 202 steps (69%) done

[Tue Jun 16 12:40:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
    jobid: 26
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1956AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[M::mem_process_seqs] Processed 63716 reads in 3.660 CPU sec, 0.433 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:56] This is snippy 4.4.3
[12:40:56] Written by Torsten Seemann
[12:40:56] Obtained from https://github.com/tseemann/snippy
[12:40:56] Detected operating system: linux
[12:40:56] Enabling bundled linux tools.
[12:40:56] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:56] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:56] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:56] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:56] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:56] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:56] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:56] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:56] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3375AA_AS.out\tSM:SAL_KB3375AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.091 sec; CPU: 23.051 sec
[samclip] Total SAM records 384046, removed 1464, allowed 120, passed 382582
[samclip] Header contained 5 lines
[samclip] Done.
[12:40:56] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:56] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:56] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:56] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:56] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:56] Found gzip - /usr/bin/gzip
[12:40:56] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:56] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:56] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:56] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:56] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:56] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:40:56] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:40:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:40:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:40:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:40:57] Treating reference as 'fasta' format.
[12:40:57] Will use 8 CPU cores.
[12:40:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta
[12:40:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[12:40:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[12:40:57] Creating reference folder: reference
[12:40:57] Extracting FASTA and GFF from reference.
[12:40:57] Wrote 3 sequences to ref.fa
[12:40:57] Wrote 0 features to ref.gff
[12:40:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1956AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320200 reads in 16.932 CPU sec, 2.303 real sec
[M::mem_process_seqs] Processed 320012 reads in 17.572 CPU sec, 2.527 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320068 reads in 16.680 CPU sec, 2.485 real sec
[M::mem_process_seqs] Processed 64078 reads in 3.830 CPU sec, 0.457 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64282 reads in 3.583 CPU sec, 0.426 real sec
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 63990 reads in 3.672 CPU sec, 0.431 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB6210AA_AS.out\tSM:SAL_KB6210AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.733 sec; CPU: 21.336 sec
[samclip] Total SAM records 384534, removed 690, allowed 104, passed 383844
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB2744AA_AS.out\tSM:SAL_KB2744AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.015 sec; CPU: 21.773 sec
[samclip] Total SAM records 384504, removed 583, allowed 58, passed 383921
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB9562AA_AS.out\tSM:SAL_BB9562AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.920 sec; CPU: 20.934 sec
[samclip] Total SAM records 384273, removed 658, allowed 66, passed 383615
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:40:58] Running: samtools index snps.bam 2>> snps.log
[12:40:58] Marked 0 heterozygous sites with 'n'
[12:40:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:40:58] Creating extra output files: BED GFF CSV TXT HTML
[12:40:58] Identified 1897 variants.
[12:40:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out
[12:40:58] Result files:
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.aligned.fa
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bam.bai
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.bed
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.fa
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.consensus.subs.fa
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.csv
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.filt.vcf
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.gff
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.html
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.log
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.raw.vcf
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.subs.vcf
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.tab
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.txt
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz
[12:40:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out/snps.vcf.gz.csi
[12:40:58] Walltime used: 19 seconds
[12:40:58] Wishing you a life free of homopolymer errors.
[12:40:58] Done.
[12:40:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[Tue Jun 16 12:40:59 2020]
Finished job 19.
141 of 202 steps (70%) done

[Tue Jun 16 12:40:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
    jobid: 100
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4524AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[12:40:59] Marked 0 heterozygous sites with 'n'
[12:40:59] Creating extra output files: BED GFF CSV TXT HTML
[12:40:59] Identified 19 variants.
[12:40:59] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out
[12:40:59] Result files:
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.aligned.fa
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bam.bai
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.bed
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.fa
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.consensus.subs.fa
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.csv
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.filt.vcf
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.gff
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.html
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.log
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.raw.vcf
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.subs.vcf
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.tab
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.txt
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz
[12:40:59] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out/snps.vcf.gz.csi
[12:40:59] Walltime used: 19 seconds
[12:40:59] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:40:59] Done.
[Tue Jun 16 12:40:59 2020]
Finished job 89.
142 of 202 steps (70%) done

[Tue Jun 16 12:40:59 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
    jobid: 145
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FB8051AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:40:59] This is snippy 4.4.3
[12:40:59] Written by Torsten Seemann
[12:40:59] Obtained from https://github.com/tseemann/snippy
[12:40:59] Detected operating system: linux
[12:40:59] Enabling bundled linux tools.
[12:40:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:40:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:40:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:40:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:40:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:40:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:40:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:40:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:40:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:40:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:40:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:40:59] Wrote 384132 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:40:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:40:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:40:59] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:40:59] Using BAM RG (Read Group) ID: SAL_BB1956AA_AS.out
[12:40:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:40:59] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:40:59] Found gzip - /usr/bin/gzip
[12:40:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:40:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:40:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:40:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:40:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:00] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:00] This is snippy 4.4.3
[12:41:00] Written by Torsten Seemann
[12:41:00] Obtained from https://github.com/tseemann/snippy
[12:41:00] Detected operating system: linux
[12:41:00] Enabling bundled linux tools.
[12:41:00] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:00] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:00] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:00] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:00] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:00] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:00] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:00] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:00] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:00] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:00] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:00] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:00] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:00] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:00] Found gzip - /usr/bin/gzip
[12:41:00] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:00] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:00] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:00] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:00] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:00] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:00] Treating reference as 'fasta' format.
[12:41:00] Will use 8 CPU cores.
[12:41:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta
[12:41:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[12:41:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[12:41:00] Creating reference folder: reference
[12:41:00] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:00] Extracting FASTA and GFF from reference.
[12:41:00] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:00] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:00] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:00] Treating reference as 'fasta' format.
[12:41:00] Will use 8 CPU cores.
[12:41:00] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta
[12:41:00] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[12:41:00] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[12:41:00] Creating reference folder: reference
[12:41:00] Extracting FASTA and GFF from reference.
[12:41:00] Wrote 3 sequences to ref.fa
[12:41:00] Wrote 0 features to ref.gff
[12:41:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4524AA_AS.fasta into pseudo-reads
[12:41:00] Running: samtools index snps.bam 2>> snps.log
[12:41:00] Wrote 3 sequences to ref.fa
[12:41:00] Wrote 0 features to ref.gff
[12:41:00] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FB8051AA_AS.fasta into pseudo-reads
[12:41:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:00] Running: samtools index snps.bam 2>> snps.log
[12:41:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:00] Running: samtools index snps.bam 2>> snps.log
[12:41:00] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:00] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 18
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 19

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 19
       total no. variants observed              : 847
       total no. reference observed             : 0

Time elapsed: 0.01s

[12:41:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320012 sequences (80000380 bp)...
[M::process] read 64120 sequences (15987614 bp)...
[12:41:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:03] Wrote 383942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:03] Using BAM RG (Read Group) ID: SAL_BB4524AA_AS.out
[12:41:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:03] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:03] Wrote 383886 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:03] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:03] Using BAM RG (Read Group) ID: SAL_FB8051AA_AS.out
[12:41:03] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:03] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 24
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:03] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:03] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:03] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:04] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:04] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:04] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:04] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:04] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:04] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:04] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320012 reads in 17.526 CPU sec, 2.448 real sec
[samclip] Processed 100000 records...
[12:41:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::mem_process_seqs] Processed 64120 reads in 3.676 CPU sec, 0.426 real sec
[12:41:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:05] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[samclip] Processed 200000 records...
[12:41:05] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:05] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:05] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:05] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63942 sequences (15930326 bp)...
[M::process] read 320060 sequences (80000366 bp)...
[M::process] read 63826 sequences (15956500 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1956AA_AS.out\tSM:SAL_BB1956AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.834 sec; CPU: 21.783 sec
[samclip] Total SAM records 384529, removed 962, allowed 111, passed 383567
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:06] Marked 0 heterozygous sites with 'n'
[12:41:06] Creating extra output files: BED GFF CSV TXT HTML
[12:41:06] Identified 847 variants.
[12:41:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out
[12:41:06] Result files:
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.aligned.fa
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bam.bai
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.bed
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.fa
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.consensus.subs.fa
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.csv
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.filt.vcf
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.gff
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.html
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.log
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.raw.vcf
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.subs.vcf
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.tab
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.txt
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz
[12:41:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out/snps.vcf.gz.csi
[12:41:06] Walltime used: 19 seconds
[12:41:06] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:41:06] Done.
[Tue Jun 16 12:41:06 2020]
Finished job 63.
143 of 202 steps (71%) done

[Tue Jun 16 12:41:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
    jobid: 64
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB5062AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:07] This is snippy 4.4.3
[12:41:07] Written by Torsten Seemann
[12:41:07] Obtained from https://github.com/tseemann/snippy
[12:41:07] Detected operating system: linux
[12:41:07] Enabling bundled linux tools.
[12:41:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:07] Running: samtools index snps.bam 2>> snps.log
[12:41:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:07] Found gzip - /usr/bin/gzip
[12:41:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[M::mem_process_seqs] Processed 320000 reads in 16.605 CPU sec, 2.245 real sec
[12:41:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:07] Treating reference as 'fasta' format.
[12:41:07] Will use 8 CPU cores.
[12:41:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta
[12:41:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[12:41:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[12:41:07] Creating reference folder: reference
[12:41:07] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320060 reads in 17.033 CPU sec, 2.353 real sec
[samclip] Processed 100000 records...
[12:41:07] Wrote 3 sequences to ref.fa
[12:41:07] Wrote 0 features to ref.gff
[12:41:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB5062AA_AS.fasta into pseudo-reads
[12:41:07] Marked 0 heterozygous sites with 'n'
[12:41:08] Creating extra output files: BED GFF CSV TXT HTML
[12:41:08] Identified 24 variants.
[12:41:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out
[12:41:08] Result files:
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.aligned.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bam.bai
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.bed
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.consensus.subs.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.csv
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.filt.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.gff
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.html
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.log
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.raw.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.subs.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.tab
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.txt
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out/snps.vcf.gz.csi
[12:41:08] Walltime used: 19 seconds
[12:41:08] Wishing you a life free of homopolymer errors.
[12:41:08] Done.
[Tue Jun 16 12:41:08 2020]
Finished job 104.
144 of 202 steps (71%) done

[Tue Jun 16 12:41:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
    jobid: 99
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB0053AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[M::mem_process_seqs] Processed 63942 reads in 3.751 CPU sec, 0.439 real sec
[samclip] Processed 100000 records...
[12:41:08] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[12:41:08] Creating extra output files: BED GFF CSV TXT HTML
[12:41:08] Identified 22 variants.
[12:41:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out
[12:41:08] Result files:
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.aligned.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bam.bai
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.bed
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.consensus.subs.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.csv
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.filt.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.gff
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.html
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.log
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.raw.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.subs.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.tab
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.txt
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out/snps.vcf.gz.csi
[12:41:08] Walltime used: 19 seconds
[12:41:08] May the SNPs be with you.
[12:41:08] Done.
[Tue Jun 16 12:41:08 2020]
Finished job 50.
145 of 202 steps (72%) done

[Tue Jun 16 12:41:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
    jobid: 178
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_EB6812AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[12:41:08] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 63826 reads in 4.114 CPU sec, 0.486 real sec
[12:41:08] Creating extra output files: BED GFF CSV TXT HTML
[12:41:08] Identified 22 variants.
[12:41:08] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out
[12:41:08] Result files:
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.aligned.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bam.bai
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.bed
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.consensus.subs.fa
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.csv
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.filt.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.gff
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.html
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.log
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.raw.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.subs.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.tab
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.txt
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz
[12:41:08] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out/snps.vcf.gz.csi
[12:41:08] Walltime used: 19 seconds
[12:41:08] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:41:08] Done.
[Tue Jun 16 12:41:08 2020]
Finished job 152.
146 of 202 steps (72%) done

[Tue Jun 16 12:41:08 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
    jobid: 169
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_VA4537AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4524AA_AS.out\tSM:SAL_BB4524AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.678 sec; CPU: 20.936 sec
[samclip] Total SAM records 384262, removed 775, allowed 114, passed 383487
[samclip] Header contained 5 lines
[samclip] Done.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FB8051AA_AS.out\tSM:SAL_FB8051AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.779 sec; CPU: 21.705 sec
[samclip] Total SAM records 384144, removed 807, allowed 81, passed 383337
[samclip] Header contained 5 lines
[samclip] Done.
[12:41:08] This is snippy 4.4.3
[12:41:08] Written by Torsten Seemann
[12:41:08] Obtained from https://github.com/tseemann/snippy
[12:41:08] Detected operating system: linux
[12:41:08] Enabling bundled linux tools.
[12:41:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:08] This is snippy 4.4.3
[12:41:08] Written by Torsten Seemann
[12:41:08] Obtained from https://github.com/tseemann/snippy
[12:41:08] Detected operating system: linux
[12:41:08] Enabling bundled linux tools.
[12:41:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:09] Found gzip - /usr/bin/gzip
[12:41:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:09] Found gzip - /usr/bin/gzip
[12:41:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:09] This is snippy 4.4.3
[12:41:09] Written by Torsten Seemann
[12:41:09] Obtained from https://github.com/tseemann/snippy
[12:41:09] Detected operating system: linux
[12:41:09] Enabling bundled linux tools.
[12:41:09] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:09] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:09] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:09] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:09] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:09] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:09] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:09] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:09] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:09] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:09] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:09] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:09] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:09] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:09] Found gzip - /usr/bin/gzip
[12:41:09] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:09] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:09] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:09] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:09] Treating reference as 'fasta' format.
[12:41:09] Will use 8 CPU cores.
[12:41:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta
[12:41:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[12:41:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[12:41:09] Creating reference folder: reference
[12:41:09] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:09] Extracting FASTA and GFF from reference.
[12:41:09] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:09] Treating reference as 'fasta' format.
[12:41:09] Will use 8 CPU cores.
[12:41:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta
[12:41:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[12:41:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[12:41:09] Creating reference folder: reference
[12:41:09] Extracting FASTA and GFF from reference.
[12:41:09] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:09] Wrote 3 sequences to ref.fa
[12:41:09] Wrote 0 features to ref.gff
[12:41:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB0053AA_AS.fasta into pseudo-reads
[12:41:09] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:09] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:09] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:09] Treating reference as 'fasta' format.
[12:41:09] Will use 8 CPU cores.
[12:41:09] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta
[12:41:09] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[12:41:09] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[12:41:09] Creating reference folder: reference
[12:41:09] Extracting FASTA and GFF from reference.
[12:41:09] Wrote 3 sequences to ref.fa
[12:41:09] Wrote 0 features to ref.gff
[12:41:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_EB6812AA_AS.fasta into pseudo-reads
[12:41:09] Wrote 3 sequences to ref.fa
[12:41:09] Wrote 0 features to ref.gff
[12:41:09] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA4537AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:41:10] Running: samtools index snps.bam 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:10] Wrote 383068 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:10] Using BAM RG (Read Group) ID: SAL_BB5062AA_AS.out
[12:41:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:10] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:10] Running: samtools index snps.bam 2>> snps.log
[12:41:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:11] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:11] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:11] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:12] Wrote 383198 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:12] Using BAM RG (Read Group) ID: SAL_CB0053AA_AS.out
[12:41:12] Wrote 382772 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:12] Using BAM RG (Read Group) ID: SAL_EB6812AA_AS.out
[12:41:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:12] Wrote 386146 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:12] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:12] Using BAM RG (Read Group) ID: SAL_VA4537AA_AS.out
[12:41:12] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:12] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 63068 sequences (15720238 bp)...
[12:41:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 15
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:14] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:14] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:41:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:14] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:41:14] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[12:41:14] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:14] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320154 sequences (80000430 bp)...
[M::process] read 320090 sequences (80000322 bp)...
[M::process] read 320030 sequences (80000202 bp)...
[M::process] read 66056 sequences (16510148 bp)...
[M::process] read 62618 sequences (15639390 bp)...
[M::process] read 63168 sequences (15744678 bp)...
[12:41:15] Marked 0 heterozygous sites with 'n'
[12:41:15] Creating extra output files: BED GFF CSV TXT HTML
[12:41:15] Identified 29 variants.
[12:41:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out
[12:41:15] Result files:
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.aligned.fa
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bam.bai
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.bed
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.fa
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.consensus.subs.fa
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.csv
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.filt.vcf
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.gff
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.html
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.log
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.raw.vcf
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.subs.vcf
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.tab
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.txt
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz
[12:41:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out/snps.vcf.gz.csi
[12:41:15] Walltime used: 19 seconds
[12:41:15] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:41:15] Done.
[Tue Jun 16 12:41:15 2020]
Finished job 26.
147 of 202 steps (73%) done

[Tue Jun 16 12:41:15 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
    jobid: 122
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_FA1940AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 16.915 CPU sec, 2.524 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63068 reads in 3.794 CPU sec, 0.455 real sec
[12:41:16] This is snippy 4.4.3
[12:41:16] Written by Torsten Seemann
[12:41:16] Obtained from https://github.com/tseemann/snippy
[12:41:16] Detected operating system: linux
[12:41:16] Enabling bundled linux tools.
[12:41:16] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:16] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:16] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:16] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:16] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:16] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:16] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:16] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:16] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:16] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:16] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:16] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:16] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:16] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:16] Found gzip - /usr/bin/gzip
[12:41:16] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:16] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:16] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:16] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:16] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:16] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:16] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 200000 records...
[12:41:16] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:16] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:16] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:16] Treating reference as 'fasta' format.
[12:41:16] Will use 8 CPU cores.
[12:41:16] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta
[12:41:16] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[12:41:16] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[12:41:16] Creating reference folder: reference
[12:41:16] Extracting FASTA and GFF from reference.
[12:41:16] Wrote 3 sequences to ref.fa
[12:41:16] Wrote 0 features to ref.gff
[12:41:16] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_FA1940AA_AS.fasta into pseudo-reads
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB5062AA_AS.out\tSM:SAL_BB5062AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.073 sec; CPU: 21.327 sec
[samclip] Total SAM records 383216, removed 391, allowed 42, passed 382825
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320030 reads in 16.604 CPU sec, 2.281 real sec
[M::mem_process_seqs] Processed 320154 reads in 16.916 CPU sec, 2.507 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 63168 reads in 3.525 CPU sec, 0.417 real sec
[M::mem_process_seqs] Processed 320090 reads in 19.054 CPU sec, 2.754 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 62618 reads in 3.453 CPU sec, 0.399 real sec
[samclip] Processed 100000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 66056 reads in 4.007 CPU sec, 0.461 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB0053AA_AS.out\tSM:SAL_CB0053AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.698 sec; CPU: 20.705 sec
[samclip] Total SAM records 383409, removed 657, allowed 121, passed 382752
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_EB6812AA_AS.out\tSM:SAL_EB6812AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.929 sec; CPU: 20.972 sec
[samclip] Total SAM records 383012, removed 642, allowed 66, passed 382370
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA4537AA_AS.out\tSM:SAL_VA4537AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.139 sec; CPU: 23.635 sec
[samclip] Total SAM records 386415, removed 1281, allowed 219, passed 385134
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:18] Marked 0 heterozygous sites with 'n'
[12:41:18] Marked 0 heterozygous sites with 'n'
[12:41:18] Creating extra output files: BED GFF CSV TXT HTML
[12:41:18] Identified 15 variants.
[12:41:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out
[12:41:18] Result files:
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.aligned.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bam.bai
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.bed
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.consensus.subs.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.csv
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.filt.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.gff
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.html
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.log
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.raw.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.subs.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.tab
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.txt
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out/snps.vcf.gz.csi
[12:41:18] Walltime used: 19 seconds
[12:41:18] Wishing you a life free of homopolymer errors.
[12:41:18] Done.
[12:41:18] Creating extra output files: BED GFF CSV TXT HTML
[12:41:18] Identified 22 variants.
[12:41:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out
[12:41:18] Result files:
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.aligned.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bam.bai
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.bed
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.consensus.subs.fa
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.csv
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.filt.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.gff
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.html
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.log
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.raw.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.subs.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.tab
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.txt
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz
[12:41:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out/snps.vcf.gz.csi
[12:41:18] Walltime used: 18 seconds
[12:41:18] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:41:18] Done.
[Tue Jun 16 12:41:18 2020]
Finished job 100.
148 of 202 steps (73%) done

[Tue Jun 16 12:41:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
    jobid: 71
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB6250AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[Tue Jun 16 12:41:18 2020]
Finished job 145.
149 of 202 steps (74%) done

[Tue Jun 16 12:41:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
    jobid: 139
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_PA3767AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
[12:41:18] Running: samtools index snps.bam 2>> snps.log
[12:41:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:19] Wrote 387290 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:19] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:19] Using BAM RG (Read Group) ID: SAL_FA1940AA_AS.out
[12:41:19] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:19] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:19] This is snippy 4.4.3
[12:41:19] Written by Torsten Seemann
[12:41:19] Obtained from https://github.com/tseemann/snippy
[12:41:19] Detected operating system: linux
[12:41:19] Enabling bundled linux tools.
[12:41:19] This is snippy 4.4.3
[12:41:19] Written by Torsten Seemann
[12:41:19] Obtained from https://github.com/tseemann/snippy
[12:41:19] Detected operating system: linux
[12:41:19] Enabling bundled linux tools.
[12:41:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:19] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:19] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:19] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:19] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:19] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:19] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:19] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:19] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:19] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:19] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:19] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:19] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:19] Found gzip - /usr/bin/gzip
[12:41:19] Found gzip - /usr/bin/gzip
[12:41:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:19] Treating reference as 'fasta' format.
[12:41:19] Will use 8 CPU cores.
[12:41:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta
[12:41:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[12:41:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[12:41:19] Creating reference folder: reference
[12:41:19] Treating reference as 'fasta' format.
[12:41:19] Will use 8 CPU cores.
[12:41:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta
[12:41:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[12:41:19] Extracting FASTA and GFF from reference.
[12:41:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[12:41:19] Creating reference folder: reference
[12:41:19] Extracting FASTA and GFF from reference.
[12:41:19] Wrote 3 sequences to ref.fa
[12:41:19] Wrote 0 features to ref.gff
[12:41:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_PA3767AA_AS.fasta into pseudo-reads
[12:41:19] Wrote 3 sequences to ref.fa
[12:41:19] Wrote 0 features to ref.gff
[12:41:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB6250AA_AS.fasta into pseudo-reads
[12:41:19] Running: samtools index snps.bam 2>> snps.log
[12:41:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:20] Running: samtools index snps.bam 2>> snps.log
[12:41:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:20] Running: samtools index snps.bam 2>> snps.log
[12:41:20] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:20] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:21] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:21] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:21] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:21] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:21] Running: bwa mem  -Y -M -R '@RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320084 sequences (80000418 bp)...
[12:41:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 62
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 67206 sequences (16796958 bp)...
[12:41:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:22] Wrote 382802 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:22] Using BAM RG (Read Group) ID: SAL_CB6250AA_AS.out
[12:41:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:22] Wrote 385754 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:22] Using BAM RG (Read Group) ID: SAL_PA3767AA_AS.out
[12:41:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:22] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:22] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 26
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 29
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:23] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:23] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:23] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:23] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:23] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:41:23] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1781
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:41:23] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:23] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:24] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:24] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:24] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:24] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:24] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:24] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:24] Running: rm -f fake_reads\.fq 2>> snps.log
[M::mem_process_seqs] Processed 320084 reads in 19.492 CPU sec, 2.845 real sec
[12:41:24] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 100000 records...
[12:41:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::mem_process_seqs] Processed 67206 reads in 3.934 CPU sec, 0.453 real sec
[samclip] Processed 200000 records...
[M::process] read 320016 sequences (80000024 bp)...
[M::process] read 62786 sequences (15639610 bp)...
[M::process] read 320114 sequences (80000118 bp)...
[M::process] read 65640 sequences (16400950 bp)...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_FA1940AA_AS.out\tSM:SAL_FA1940AA_AS.out -t 8 reference/ref.fa[samclip] Total SAM records 387568, removed 2133, allowed 398, passed 385435
 fake_reads.fq[samclip] Header contained 5 lines

[main] Real time: 4.243 sec; CPU: 23.996 sec
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:26] Marked 0 heterozygous sites with 'n'
[12:41:26] Creating extra output files: BED GFF CSV TXT HTML
[12:41:26] Identified 62 variants.
[12:41:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out
[12:41:26] Result files:
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.aligned.fa
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bam.bai
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.bed
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.fa
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.consensus.subs.fa
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.csv
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.filt.vcf
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.gff
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.html
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.log
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.raw.vcf
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.subs.vcf
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.tab
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.txt
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz
[12:41:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out/snps.vcf.gz.csi
[12:41:26] Walltime used: 19 seconds
[12:41:26] May the SNPs be with you.
[12:41:26] Done.
[Tue Jun 16 12:41:26 2020]
Finished job 64.
150 of 202 steps (74%) done

[Tue Jun 16 12:41:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
    jobid: 95
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_GB0225AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[M::mem_process_seqs] Processed 320016 reads in 16.150 CPU sec, 2.130 real sec
[samclip] Processed 100000 records...
[12:41:27] Running: samtools index snps.bam 2>> snps.log
[12:41:27] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[M::mem_process_seqs] Processed 62786 reads in 3.882 CPU sec, 0.454 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:27] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320114 reads in 19.187 CPU sec, 2.608 real sec
[12:41:27] This is snippy 4.4.3
[12:41:27] Written by Torsten Seemann
[12:41:27] Obtained from https://github.com/tseemann/snippy
[12:41:27] Detected operating system: linux
[12:41:27] Enabling bundled linux tools.
[12:41:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:27] Found gzip - /usr/bin/gzip
[12:41:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[12:41:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:27] Marked 0 heterozygous sites with 'n'
[12:41:27] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[12:41:27] Creating extra output files: BED GFF CSV TXT HTML
[12:41:27] Identified 29 variants.
[12:41:27] Creating extra output files: BED GFF CSV TXT HTML
[12:41:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out
[12:41:27] Result files:
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.aligned.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bam.bai
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.bed
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.consensus.subs.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.csv
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.filt.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.gff
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.html
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.log
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.raw.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.subs.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.tab
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.txt
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out/snps.vcf.gz.csi
[12:41:27] Walltime used: 19 seconds
[12:41:27] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:41:27] Done.
[12:41:27] Identified 26 variants.
[12:41:27] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out
[12:41:27] Result files:
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.aligned.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bam.bai
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.bed
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.consensus.subs.fa
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.csv
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.filt.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.gff
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.html
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.log
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.raw.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.subs.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.tab
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.txt
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz
[12:41:27] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out/snps.vcf.gz.csi
[12:41:27] Walltime used: 19 seconds
[12:41:27] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:41:27] Done.
[Tue Jun 16 12:41:27 2020]
Finished job 99.
151 of 202 steps (75%) done
[12:41:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[Tue Jun 16 12:41:27 2020]
Finished job 178.
152 of 202 steps (75%) done
[12:41:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa

[Tue Jun 16 12:41:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
    jobid: 86
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_OB6949AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta

[Tue Jun 16 12:41:27 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
    jobid: 61
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CA4744AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[12:41:27] Treating reference as 'fasta' format.
[12:41:27] Will use 8 CPU cores.
[12:41:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta
[12:41:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[12:41:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[12:41:27] Creating reference folder: reference
[12:41:27] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB6250AA_AS.out\tSM:SAL_CB6250AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.511 sec; CPU: 20.582 sec
[samclip] Total SAM records 382942, removed 640, allowed 72, passed 382302
[samclip] Header contained 5 lines
[samclip] Done.
[M::mem_process_seqs] Processed 65640 reads in 4.013 CPU sec, 0.461 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:28] Wrote 3 sequences to ref.fa
[12:41:28] Wrote 0 features to ref.gff
[12:41:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_GB0225AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:28] Marked 0 heterozygous sites with 'n'
[12:41:28] Creating extra output files: BED GFF CSV TXT HTML
[12:41:28] Identified 1781 variants.
[12:41:28] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out
[12:41:28] Result files:
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.aligned.fa
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bam.bai
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.bed
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.fa
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.consensus.subs.fa
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.csv
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.filt.vcf
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.gff
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.html
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.log
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.raw.vcf
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.subs.vcf
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.tab
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.txt
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz
[12:41:28] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out/snps.vcf.gz.csi
[12:41:28] Walltime used: 19 seconds
[12:41:28] May the SNPs be with you.
[12:41:28] Done.
[Tue Jun 16 12:41:28 2020]
Finished job 169.
153 of 202 steps (76%) done

[Tue Jun 16 12:41:28 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
    jobid: 47
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9330AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[12:41:28] This is snippy 4.4.3
[12:41:28] Written by Torsten Seemann
[12:41:28] Obtained from https://github.com/tseemann/snippy
[12:41:28] Detected operating system: linux
[12:41:28] Enabling bundled linux tools.
[12:41:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:28] This is snippy 4.4.3
[12:41:28] Written by Torsten Seemann
[12:41:28] Obtained from https://github.com/tseemann/snippy
[12:41:28] Detected operating system: linux
[12:41:28] Enabling bundled linux tools.
[12:41:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:28] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:28] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:28] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:28] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[main] Version: 0.7.17-r1188
[main] CMD:[samclip] Total SAM records 385939, removed 1166, allowed 215, passed 384773
 bwa mem -Y[samclip] Header contained 5 lines
 -M -R[samclip] Done.
 @RG\tID:SAL_PA3767AA_AS.out\tSM:SAL_PA3767AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.004 sec; CPU: 23.771 sec
[12:41:28] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:28] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:28] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:28] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:28] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:28] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:28] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:28] Found gzip - /usr/bin/gzip
[12:41:28] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:28] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:28] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:28] Found gzip - /usr/bin/gzip
[12:41:28] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:28] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:28] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:28] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:28] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:28] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:28] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:28] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:28] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:28] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:28] Treating reference as 'fasta' format.
[12:41:28] Will use 8 CPU cores.
[12:41:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta
[12:41:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[12:41:28] Treating reference as 'fasta' format.
[12:41:28] Will use 8 CPU cores.
[12:41:28] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta
[12:41:28] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[12:41:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[12:41:28] Creating reference folder: reference
[12:41:28] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[12:41:28] Creating reference folder: reference
[12:41:28] Extracting FASTA and GFF from reference.
[12:41:28] Extracting FASTA and GFF from reference.
[12:41:29] Wrote 3 sequences to ref.fa
[12:41:29] Wrote 0 features to ref.gff
[12:41:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_OB6949AA_AS.fasta into pseudo-reads
[12:41:29] Wrote 3 sequences to ref.fa
[12:41:29] Wrote 0 features to ref.gff
[12:41:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CA4744AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:29] This is snippy 4.4.3
[12:41:29] Written by Torsten Seemann
[12:41:29] Obtained from https://github.com/tseemann/snippy
[12:41:29] Detected operating system: linux
[12:41:29] Enabling bundled linux tools.
[12:41:29] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:29] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:29] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:29] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:29] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:29] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:29] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:29] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:29] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:29] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:29] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:29] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:29] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:29] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:29] Found gzip - /usr/bin/gzip
[12:41:29] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:29] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:29] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:29] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:29] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:29] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:29] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:29] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:29] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:29] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:29] Treating reference as 'fasta' format.
[12:41:29] Will use 8 CPU cores.
[12:41:29] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta
[12:41:29] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[12:41:29] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[12:41:29] Creating reference folder: reference
[12:41:29] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:29] Wrote 3 sequences to ref.fa
[12:41:29] Wrote 0 features to ref.gff
[12:41:29] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9330AA_AS.fasta into pseudo-reads
[12:41:29] Running: samtools index snps.bam 2>> snps.log
[12:41:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:30] Running: samtools index snps.bam 2>> snps.log
[12:41:30] Wrote 381952 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:30] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:30] Using BAM RG (Read Group) ID: SAL_GB0225AA_AS.out
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:41:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:30] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 19
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1889
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:41:30] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:30] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:31] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:31] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:31] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:31] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:31] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:31] Wrote 381814 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:31] Using BAM RG (Read Group) ID: SAL_OB6949AA_AS.out
[12:41:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:31] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:31] Wrote 385818 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:31] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:31] Using BAM RG (Read Group) ID: SAL_CA4744AA_AS.out
[12:41:31] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:31] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:32] Wrote 393650 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:32] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:32] Using BAM RG (Read Group) ID: SAL_SA9330AA_AS.out
[12:41:32] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:32] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 100
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 320076 sequences (80000300 bp)...
[12:41:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 61876 sequences (15469000 bp)...
[12:41:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:41:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:33] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:33] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:33] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:33] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:33] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[12:41:34] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 61814 sequences (15447022 bp)...

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1818
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:41:34] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320062 sequences (80000348 bp)...
[M::process] read 65756 sequences (16430214 bp)...
[12:41:34] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:34] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:34] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:34] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:34] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:34] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:41:34] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:34] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:34] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:34] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:34] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:34] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:34] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:34] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320180 sequences (80000496 bp)...
[M::process] read 73470 sequences (18340998 bp)...
[12:41:35] Marked 22 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320076 reads in 16.747 CPU sec, 2.527 real sec
[12:41:35] Creating extra output files: BED GFF CSV TXT HTML
[12:41:35] Identified 1889 variants.
[12:41:35] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out
[12:41:35] Result files:
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.aligned.fa
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bam.bai
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.bed
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.fa
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.consensus.subs.fa
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.csv
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.filt.vcf
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.gff
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.html
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.log
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.raw.vcf
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.subs.vcf
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.tab
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.txt
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz
[12:41:35] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out/snps.vcf.gz.csi
[12:41:35] Walltime used: 19 seconds
[12:41:35] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:41:35] Done.
[Tue Jun 16 12:41:35 2020]
Finished job 122.
154 of 202 steps (76%) done

[Tue Jun 16 12:41:35 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
    jobid: 188
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB5221AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61876 reads in 3.610 CPU sec, 0.422 real sec
[samclip] Processed 200000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:36] This is snippy 4.4.3
[12:41:36] Written by Torsten Seemann
[12:41:36] Obtained from https://github.com/tseemann/snippy
[12:41:36] Detected operating system: linux
[12:41:36] Enabling bundled linux tools.
[12:41:36] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:36] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:36] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:36] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:36] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:36] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:36] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:36] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[samclip] Processed 300000 records...
[12:41:36] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:36] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:36] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:36] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:36] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:36] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:36] Found gzip - /usr/bin/gzip
[12:41:36] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:36] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:36] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:36] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:36] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:36] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:36] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:36] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:36] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:36] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::mem_process_seqs] Processed 320062 reads in 18.578 CPU sec, 2.516 real sec
[12:41:36] Treating reference as 'fasta' format.
[12:41:36] Will use 8 CPU cores.
[12:41:36] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta
[12:41:36] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[12:41:36] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[12:41:36] Creating reference folder: reference
[12:41:36] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320000 reads in 19.061 CPU sec, 2.741 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_GB0225AA_AS.out\tSM:SAL_GB0225AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.974 sec; CPU: 20.965 sec
[samclip] Total SAM records 382179, removed 672, allowed 60, passed 381507
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:36] Wrote 3 sequences to ref.fa
[12:41:36] Wrote 0 features to ref.gff
[12:41:36] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5221AA_AS.fasta into pseudo-reads
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65756 reads in 4.195 CPU sec, 0.492 real sec
[M::mem_process_seqs] Processed 61814 reads in 4.109 CPU sec, 0.478 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 320180 reads in 17.849 CPU sec, 2.837 real sec
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[samclip] Processed 100000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_OB6949AA_AS.out\tSM:SAL_OB6949AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.155 sec; CPU: 23.733 sec
[samclip] Total SAM records 382038, removed 796, allowed 164, passed 381242
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CA4744AA_AS.out\tSM:SAL_CA4744AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.960 sec; CPU: 23.343 sec
[samclip] Total SAM records 386081, removed 1419, allowed 302, passed 384662
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:37] Marked 0 heterozygous sites with 'n'
[12:41:37] Creating extra output files: BED GFF CSV TXT HTML
[12:41:37] Identified 100 variants.
[12:41:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out
[12:41:37] Result files:
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.aligned.fa
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bam.bai
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.bed
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.fa
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.consensus.subs.fa
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.csv
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.filt.vcf
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.gff
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.html
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.log
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.raw.vcf
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.subs.vcf
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.tab
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.txt
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz
[12:41:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out/snps.vcf.gz.csi
[12:41:37] Walltime used: 18 seconds
[12:41:37] May the SNPs be with you.
[12:41:37] Done.
[Tue Jun 16 12:41:37 2020]
Finished job 71.
155 of 202 steps (77%) done

[Tue Jun 16 12:41:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
    jobid: 187
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA1119AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
[samclip] Processed 200000 records...
[M::mem_process_seqs] Processed 73470 reads in 4.673 CPU sec, 0.539 real sec
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9330AA_AS.out\tSM:SAL_SA9330AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 393741, removed 505, allowed 55, passed 393236

[main] Real time: 4.244 sec; CPU: 23.073 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:38] This is snippy 4.4.3
[12:41:38] Written by Torsten Seemann
[12:41:38] Obtained from https://github.com/tseemann/snippy
[12:41:38] Detected operating system: linux
[12:41:38] Enabling bundled linux tools.
[12:41:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:38] Found gzip - /usr/bin/gzip
[12:41:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:38] Running: samtools index snps.bam 2>> snps.log
[12:41:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:38] Marked 0 heterozygous sites with 'n'
[12:41:38] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:38] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:38] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:38] Treating reference as 'fasta' format.
[12:41:38] Will use 8 CPU cores.
[12:41:38] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta
[12:41:38] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[12:41:38] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[12:41:38] Creating reference folder: reference
[12:41:38] Extracting FASTA and GFF from reference.
[12:41:38] Creating extra output files: BED GFF CSV TXT HTML
[12:41:38] Identified 1818 variants.
[12:41:38] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out
[12:41:38] Result files:
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.aligned.fa
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bam.bai
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.bed
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.fa
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.consensus.subs.fa
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.csv
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.filt.vcf
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.gff
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.html
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.log
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.raw.vcf
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.subs.vcf
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.tab
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.txt
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz
[12:41:38] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out/snps.vcf.gz.csi
[12:41:38] Walltime used: 19 seconds
[12:41:38] Questionable SNP? Try the --report option to see the alignments.
[12:41:38] Done.
[Tue Jun 16 12:41:38 2020]
Finished job 139.
156 of 202 steps (77%) done

[Tue Jun 16 12:41:38 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
    jobid: 43
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9246AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
[12:41:39] Wrote 3 sequences to ref.fa
[12:41:39] Wrote 0 features to ref.gff
[12:41:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA1119AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:39] Wrote 384312 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:39] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:39] Using BAM RG (Read Group) ID: SAL_JB5221AA_AS.out
[12:41:39] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:39] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:39] Running: samtools index snps.bam 2>> snps.log
[12:41:39] Running: samtools index snps.bam 2>> snps.log
[12:41:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:39] This is snippy 4.4.3
[12:41:39] Written by Torsten Seemann
[12:41:39] Obtained from https://github.com/tseemann/snippy
[12:41:39] Detected operating system: linux
[12:41:39] Enabling bundled linux tools.
[12:41:39] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:39] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:39] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:39] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:39] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:39] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:39] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:39] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:39] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:39] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:39] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:39] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:39] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:39] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:39] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:39] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:39] Found gzip - /usr/bin/gzip
[12:41:39] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:39] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:39] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:39] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:39] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:39] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:40] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:40] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:40] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:40] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:40] Treating reference as 'fasta' format.
[12:41:40] Will use 8 CPU cores.
[12:41:40] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta
[12:41:40] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[12:41:40] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[12:41:40] Creating reference folder: reference
[12:41:40] Extracting FASTA and GFF from reference.
[12:41:40] Wrote 3 sequences to ref.fa
[12:41:40] Wrote 0 features to ref.gff
[12:41:40] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9246AA_AS.fasta into pseudo-reads
[12:41:40] Running: samtools index snps.bam 2>> snps.log
[12:41:40] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:40] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:41] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:41] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:41] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:41] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:41] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320032 sequences (80000340 bp)...
[12:41:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:41] Wrote 386028 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[M::process] read 64280 sequences (16070000 bp)...
[12:41:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:41] Using BAM RG (Read Group) ID: SAL_KA1119AA_AS.out

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 22
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:41] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:42] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:42] Wrote 385860 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:41:42] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:42] Using BAM RG (Read Group) ID: SAL_SA9246AA_AS.out
[12:41:43] Running: samtools faidx reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1708
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:41:43] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 3
          no. right trimmed                     : 22
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 28

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 28
       total no. variants observed              : 1908
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:41:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:43] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 116
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:43] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:41:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:43] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:43] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:43] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:43] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:43] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:43] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:43] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:43] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:43] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:43] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320276 sequences (80000470 bp)...
[12:41:44] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 65752 sequences (16413928 bp)...
[M::mem_process_seqs] Processed 320032 reads in 18.011 CPU sec, 2.435 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64280 reads in 3.806 CPU sec, 0.436 real sec
[samclip] Processed 200000 records...
[12:41:44] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:44] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:44] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:44] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:44] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320236 sequences (80000442 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5221AA_AS.out\tSM:SAL_JB5221AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.835 sec; CPU: 22.406 sec
[samclip] Total SAM records 384410, removed 587, allowed 42, passed 383823
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 65624 sequences (16391106 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:46] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320276 reads in 17.531 CPU sec, 2.434 real sec
[12:41:46] Creating extra output files: BED GFF CSV TXT HTML
[12:41:46] Identified 22 variants.
[12:41:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out
[12:41:46] Result files:
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.aligned.fa
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bam.bai
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.bed
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.fa
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.consensus.subs.fa
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.csv
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.filt.vcf
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.gff
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.html
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.log
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.raw.vcf
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.subs.vcf
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.tab
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.txt
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz
[12:41:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out/snps.vcf.gz.csi
[12:41:46] Walltime used: 19 seconds
[12:41:46] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:41:46] Done.
[Tue Jun 16 12:41:46 2020]
Finished job 95.
157 of 202 steps (78%) done

[Tue Jun 16 12:41:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
    jobid: 125
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA0984AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 65752 reads in 3.876 CPU sec, 0.447 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 200000 records...
[12:41:47] Running: samtools index snps.bam 2>> snps.log
[12:41:47] This is snippy 4.4.3
[12:41:47] Written by Torsten Seemann
[12:41:47] Obtained from https://github.com/tseemann/snippy
[12:41:47] Detected operating system: linux
[12:41:47] Enabling bundled linux tools.
[12:41:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:47] Found gzip - /usr/bin/gzip
[12:41:47] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[samclip] Processed 300000 records...
[12:41:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:47] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:47] Treating reference as 'fasta' format.
[12:41:47] Will use 8 CPU cores.
[12:41:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta
[12:41:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[12:41:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[12:41:47] Creating reference folder: reference
[12:41:47] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA1119AA_AS.out\tSM:SAL_KA1119AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.834 sec; CPU: 21.985 sec
[samclip] Total SAM records 386267, removed 676, allowed 238, passed 385591
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320236 reads in 17.278 CPU sec, 2.397 real sec
[12:41:47] Wrote 3 sequences to ref.fa
[12:41:47] Wrote 0 features to ref.gff
[12:41:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0984AA_AS.fasta into pseudo-reads
[12:41:47] Marked 0 heterozygous sites with 'n'
[12:41:47] Creating extra output files: BED GFF CSV TXT HTML
[12:41:47] Identified 1708 variants.
[12:41:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out
[12:41:47] Result files:
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.aligned.fa
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bam.bai
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.bed
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.fa
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.consensus.subs.fa
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.csv
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.filt.vcf
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.gff
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.html
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.log
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.raw.vcf
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.subs.vcf
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.tab
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.txt
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz
[12:41:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out/snps.vcf.gz.csi
[12:41:47] Walltime used: 19 seconds
[12:41:47] May the SNPs be with you.
[12:41:47] Done.
[samclip] Processed 100000 records...
[Tue Jun 16 12:41:47 2020]
Finished job 86.
158 of 202 steps (78%) done

[Tue Jun 16 12:41:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
    jobid: 96
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA7932AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
[12:41:47] Marked 0 heterozygous sites with 'n'
[12:41:48] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 65624 reads in 3.920 CPU sec, 0.456 real sec
[12:41:48] Identified 1908 variants.
[12:41:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out
[12:41:48] Result files:
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.aligned.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bam.bai
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.bed
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.consensus.subs.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.csv
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.filt.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.gff
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.html
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.log
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.raw.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.subs.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.tab
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.txt
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out/snps.vcf.gz.csi
[12:41:48] Walltime used: 20 seconds
[12:41:48] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:41:48] Done.
[Tue Jun 16 12:41:48 2020]
Finished job 61.
159 of 202 steps (79%) done

[Tue Jun 16 12:41:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
    jobid: 27
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB3640AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[samclip] Processed 200000 records...
[12:41:48] Marked 0 heterozygous sites with 'n'
[12:41:48] Creating extra output files: BED GFF CSV TXT HTML
[12:41:48] Identified 116 variants.
[12:41:48] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out
[12:41:48] Result files:
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.aligned.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bam.bai
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.bed
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.consensus.subs.fa
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.csv
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.filt.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.gff
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.html
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.log
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.raw.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.subs.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.tab
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.txt
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz
[12:41:48] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out/snps.vcf.gz.csi
[12:41:48] Walltime used: 19 seconds
[12:41:48] Questionable SNP? Try the --report option to see the alignments.
[12:41:48] Done.
[Tue Jun 16 12:41:48 2020]
Finished job 47.
160 of 202 steps (79%) done

[Tue Jun 16 12:41:48 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
    jobid: 101
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA3156AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:48] This is snippy 4.4.3
[12:41:48] Written by Torsten Seemann
[12:41:48] Obtained from https://github.com/tseemann/snippy
[12:41:48] Detected operating system: linux
[12:41:48] Enabling bundled linux tools.
[12:41:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:48] Found gzip - /usr/bin/gzip
[12:41:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9246AA_AS.out\tSM:SAL_SA9246AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.782 sec; CPU: 21.755 sec
[samclip] Total SAM records 386177, removed 759, allowed 180, passed 385418
[samclip] Header contained 5 lines
[samclip] Done.
[12:41:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:48] This is snippy 4.4.3
[12:41:48] Written by Torsten Seemann
[12:41:48] Obtained from https://github.com/tseemann/snippy
[12:41:48] Detected operating system: linux
[12:41:48] Enabling bundled linux tools.
[12:41:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:48] Treating reference as 'fasta' format.
[12:41:48] Will use 8 CPU cores.
[12:41:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta
[12:41:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[12:41:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[12:41:48] Creating reference folder: reference
[12:41:48] Extracting FASTA and GFF from reference.
[12:41:48] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:48] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:48] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:48] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:48] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:48] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:48] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:48] Found gzip - /usr/bin/gzip
[12:41:48] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:48] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:48] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:48] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:48] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:48] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:48] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:48] Wrote 3 sequences to ref.fa
[12:41:48] Wrote 0 features to ref.gff
[12:41:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA7932AA_AS.fasta into pseudo-reads
[12:41:48] This is snippy 4.4.3
[12:41:48] Written by Torsten Seemann
[12:41:48] Obtained from https://github.com/tseemann/snippy
[12:41:48] Detected operating system: linux
[12:41:48] Enabling bundled linux tools.
[12:41:48] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:48] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:48] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:48] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:48] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:48] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:48] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:49] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:49] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:49] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:49] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:49] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:49] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:49] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:49] Treating reference as 'fasta' format.
[12:41:49] Will use 8 CPU cores.
[12:41:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta
[12:41:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[12:41:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[12:41:49] Creating reference folder: reference
[12:41:49] Extracting FASTA and GFF from reference.
[12:41:49] Found gzip - /usr/bin/gzip
[12:41:49] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:49] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:49] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:49] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:49] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:49] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:49] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:49] Wrote 3 sequences to ref.fa
[12:41:49] Wrote 0 features to ref.gff
[12:41:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB3640AA_AS.fasta into pseudo-reads
[12:41:49] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:49] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:49] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:49] Treating reference as 'fasta' format.
[12:41:49] Will use 8 CPU cores.
[12:41:49] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta
[12:41:49] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[12:41:49] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[12:41:49] Creating reference folder: reference
[12:41:49] Extracting FASTA and GFF from reference.
[12:41:49] Wrote 3 sequences to ref.fa
[12:41:49] Wrote 0 features to ref.gff
[12:41:49] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA3156AA_AS.fasta into pseudo-reads
[12:41:49] Running: samtools index snps.bam 2>> snps.log
[12:41:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:50] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 70
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:50] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:50] Wrote 385598 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:50] Using BAM RG (Read Group) ID: SAL_KA0984AA_AS.out
[12:41:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:50] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:50] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:50] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:50] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:50] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:50] Running: samtools index snps.bam 2>> snps.log
[12:41:50] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:50] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:50] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:50] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:50] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:50] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:51] Wrote 387022 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:51] Using BAM RG (Read Group) ID: SAL_BA7932AA_AS.out
[12:41:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:51] Wrote 384090 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:51] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:51] Using BAM RG (Read Group) ID: SAL_KB3640AA_AS.out
[12:41:51] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:51] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:52] Wrote 385394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:52] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:52] Using BAM RG (Read Group) ID: SAL_XA3156AA_AS.out
[12:41:52] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:52] Running: bwa index reference/ref.fa 2>> snps.log
[12:41:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:52] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:52] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320104 sequences (80000368 bp)...
[M::process] read 65494 sequences (16362658 bp)...
[12:41:52] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:52] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:52] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:52] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:52] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:52] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:52] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:52] Running: rm -f fake_reads\.fq 2>> snps.log
[12:41:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:41:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 21
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:41:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:41:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:41:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:41:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:53] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:41:53] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:41:53] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:41:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:41:53] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:41:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:41:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:41:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:41:54] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:41:54] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:41:54] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:41:54] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:41:54] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 320016 sequences (80000392 bp)...
[12:41:54] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64090 sequences (16022500 bp)...
[M::process] read 67006 sequences (16751500 bp)...
[M::process] read 320482 sequences (80000282 bp)...
[M::process] read 64912 sequences (16226712 bp)...
[12:41:54] Marked 0 heterozygous sites with 'n'
[12:41:54] Creating extra output files: BED GFF CSV TXT HTML
[12:41:54] Identified 70 variants.
[12:41:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out
[12:41:54] Result files:
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.aligned.fa
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bam.bai
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.bed
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.fa
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.consensus.subs.fa
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.csv
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.filt.vcf
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.gff
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.html
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.log
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.raw.vcf
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.subs.vcf
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.tab
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.txt
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz
[12:41:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out/snps.vcf.gz.csi
[12:41:54] Walltime used: 18 seconds
[12:41:54] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:41:54] Done.
[Tue Jun 16 12:41:54 2020]
Finished job 188.
161 of 202 steps (80%) done

[Tue Jun 16 12:41:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
    jobid: 51
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB2899AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
[M::mem_process_seqs] Processed 320104 reads in 16.752 CPU sec, 2.464 real sec
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 65494 reads in 3.648 CPU sec, 0.449 real sec
[samclip] Processed 200000 records...
[12:41:55] This is snippy 4.4.3
[12:41:55] Written by Torsten Seemann
[12:41:55] Obtained from https://github.com/tseemann/snippy
[12:41:55] Detected operating system: linux
[12:41:55] Enabling bundled linux tools.
[12:41:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:55] Found gzip - /usr/bin/gzip
[12:41:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[12:41:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:55] Treating reference as 'fasta' format.
[12:41:55] Will use 8 CPU cores.
[12:41:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta
[12:41:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[12:41:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[12:41:55] Creating reference folder: reference
[12:41:55] Extracting FASTA and GFF from reference.
[12:41:56] Wrote 3 sequences to ref.fa
[12:41:56] Wrote 0 features to ref.gff
[12:41:56] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB2899AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA0984AA_AS.out\tSM:SAL_KA0984AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.925 sec; CPU: 20.977 sec
[samclip] Total SAM records 385989, removed 1810, allowed 301, passed 384179
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320000 reads in 16.388 CPU sec, 2.345 real sec
[M::mem_process_seqs] Processed 320016 reads in 17.513 CPU sec, 2.404 real sec
[M::mem_process_seqs] Processed 320482 reads in 17.616 CPU sec, 2.412 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64090 reads in 3.560 CPU sec, 0.427 real sec
[M::mem_process_seqs] Processed 67006 reads in 3.729 CPU sec, 0.444 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64912 reads in 3.733 CPU sec, 0.444 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:57] Marked 0 heterozygous sites with 'n'
[12:41:57] Creating extra output files: BED GFF CSV TXT HTML
[12:41:57] Identified 13 variants.
[samclip] Processed 300000 records...
[12:41:57] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out
[12:41:57] Result files:
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.aligned.fa
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bam.bai
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.bed
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.fa
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.consensus.subs.fa
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.csv
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.filt.vcf
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.gff
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.html
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.log
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.raw.vcf
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.subs.vcf
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.tab
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.txt
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz
[12:41:57] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out/snps.vcf.gz.csi
[12:41:57] Walltime used: 19 seconds
[12:41:57] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:41:57] Done.
[Tue Jun 16 12:41:57 2020]
Finished job 187.
162 of 202 steps (80%) done

[Tue Jun 16 12:41:57 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
    jobid: 147
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA5244AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB3640AA_AS.out\tSM:SAL_KB3640AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.822 sec; CPU: 20.557 sec
[samclip] Total SAM records 384260, removed 823, allowed 90, passed 383437
[samclip] Header contained 5 lines
[samclip] Done.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA7932AA_AS.out\tSM:SAL_BA7932AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.866 sec; CPU: 21.806 sec
[samclip] Total SAM records 387279, removed 2243, allowed 481, passed 385036
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA3156AA_AS.out\tSM:SAL_XA3156AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 385802, removed 1041, allowed 135, passed 384761

[main] Real time: 3.880 sec; CPU: 21.921 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:58] This is snippy 4.4.3
[12:41:58] Written by Torsten Seemann
[12:41:58] Obtained from https://github.com/tseemann/snippy
[12:41:58] Detected operating system: linux
[12:41:58] Enabling bundled linux tools.
[12:41:58] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:58] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:58] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:58] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:58] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:58] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:58] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:58] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:58] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:58] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:58] Found gzip - /usr/bin/gzip
[12:41:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:58] Running: samtools index snps.bam 2>> snps.log
[12:41:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:58] Marked 0 heterozygous sites with 'n'
[12:41:58] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:58] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:58] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:58] Treating reference as 'fasta' format.
[12:41:58] Will use 8 CPU cores.
[12:41:58] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta
[12:41:58] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[12:41:58] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[12:41:58] Creating reference folder: reference
[12:41:58] Extracting FASTA and GFF from reference.
[12:41:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:58] Creating extra output files: BED GFF CSV TXT HTML
[12:41:58] Identified 21 variants.
[12:41:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out
[12:41:58] Result files:
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.aligned.fa
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bam.bai
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.bed
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.fa
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.consensus.subs.fa
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.csv
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.filt.vcf
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.gff
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.html
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.log
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.raw.vcf
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.subs.vcf
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.tab
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.txt
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz
[12:41:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out/snps.vcf.gz.csi
[12:41:58] Walltime used: 19 seconds
[12:41:58] May the SNPs be with you.
[12:41:58] Done.
[Tue Jun 16 12:41:58 2020]
Finished job 43.
163 of 202 steps (81%) done

[Tue Jun 16 12:41:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
    jobid: 118
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB8607AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[12:41:58] Wrote 3 sequences to ref.fa
[12:41:58] Wrote 0 features to ref.gff
[12:41:58] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA5244AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:41:58] Wrote 380182 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:41:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:41:58] Using BAM RG (Read Group) ID: SAL_BB2899AA_AS.out
[12:41:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:41:58] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:41:59] This is snippy 4.4.3
[12:41:59] Written by Torsten Seemann
[12:41:59] Obtained from https://github.com/tseemann/snippy
[12:41:59] Detected operating system: linux
[12:41:59] Enabling bundled linux tools.
[12:41:59] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:41:59] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:41:59] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:41:59] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:41:59] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:41:59] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:41:59] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:41:59] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:41:59] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:41:59] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:41:59] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:41:59] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:41:59] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:41:59] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:41:59] Found gzip - /usr/bin/gzip
[12:41:59] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:41:59] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:41:59] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:41:59] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:41:59] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:41:59] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:41:59] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:41:59] Running: samtools index snps.bam 2>> snps.log
[12:41:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:41:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:41:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:41:59] Treating reference as 'fasta' format.
[12:41:59] Will use 8 CPU cores.
[12:41:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta
[12:41:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[12:41:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[12:41:59] Creating reference folder: reference
[12:41:59] Extracting FASTA and GFF from reference.
[12:41:59] Running: samtools index snps.bam 2>> snps.log
[12:41:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:59] Running: samtools index snps.bam 2>> snps.log
[12:41:59] Wrote 3 sequences to ref.fa
[12:41:59] Wrote 0 features to ref.gff
[12:41:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB8607AA_AS.fasta into pseudo-reads
[12:41:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:41:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:41:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:00] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320000 sequences (80000000 bp)...
[12:42:01] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:01] Using BAM RG (Read Group) ID: SAL_KA5244AA_AS.out
[12:42:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:01] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 60182 sequences (15045500 bp)...
[12:42:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 2
          no. left and right trimmed            : 1
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 234
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:01] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:02] Wrote 379750 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:02] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:02] Using BAM RG (Read Group) ID: SAL_KB8607AA_AS.out
[12:42:02] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:02] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 12
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 12

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 12
       total no. variants observed              : 122
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 20
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:42:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 28
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:03] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:03] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:03] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:03] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:03] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:03] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:03] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:03] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:03] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:42:03] Running: rm -f fake_reads\.fq 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:42:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:03] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:03] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:03] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:03] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:03] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:03] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320000 reads in 16.910 CPU sec, 2.404 real sec
[M::process] read 320220 sequences (80000454 bp)...
[M::process] read 64386 sequences (16095548 bp)...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60182 reads in 3.316 CPU sec, 0.389 real sec
[samclip] Processed 200000 records...
[12:42:04] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:04] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:04] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:04] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:04] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB2899AA_AS.out\tSM:SAL_BB2899AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.776 sec; CPU: 20.802 sec
[samclip] Total SAM records 380347, removed 432, allowed 42, passed 379915
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320006 sequences (80000192 bp)...
[M::process] read 59744 sequences (14936000 bp)...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320220 reads in 16.965 CPU sec, 2.320 real sec
[12:42:05] Marked 41 heterozygous sites with 'n'
[12:42:06] Creating extra output files: BED GFF CSV TXT HTML
[12:42:06] Identified 234 variants.
[12:42:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out
[12:42:06] Result files:
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.aligned.fa
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bam.bai
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.bed
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.fa
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.consensus.subs.fa
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.csv
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.filt.vcf
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.gff
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.html
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.log
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.raw.vcf
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.subs.vcf
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.tab
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.txt
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz
[12:42:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out/snps.vcf.gz.csi
[12:42:06] Walltime used: 19 seconds
[12:42:06] Wishing you a life free of homopolymer errors.
[12:42:06] Done.
[Tue Jun 16 12:42:06 2020]
Finished job 125.
164 of 202 steps (81%) done

[Tue Jun 16 12:42:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
    jobid: 134
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_RA1578AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64386 reads in 3.741 CPU sec, 0.435 real sec
[samclip] Processed 200000 records...
[12:42:06] Running: samtools index snps.bam 2>> snps.log
[12:42:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:42:06] This is snippy 4.4.3
[12:42:06] Written by Torsten Seemann
[12:42:06] Obtained from https://github.com/tseemann/snippy
[12:42:06] Detected operating system: linux
[12:42:06] Enabling bundled linux tools.
[12:42:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:06] Found gzip - /usr/bin/gzip
[12:42:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KA5244AA_AS.out\tSM:SAL_KA5244AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.690 sec; CPU: 21.248 sec
[12:42:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[samclip] Total SAM records 384768, removed 794, allowed 154, passed 383974
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[M::mem_process_seqs] Processed 320006 reads in 17.746 CPU sec, 2.376 real sec
[12:42:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:06] Treating reference as 'fasta' format.
[12:42:06] Will use 8 CPU cores.
[12:42:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta
[12:42:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[12:42:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[12:42:06] Creating reference folder: reference
[12:42:06] Extracting FASTA and GFF from reference.
[12:42:07] Wrote 3 sequences to ref.fa
[12:42:07] Wrote 0 features to ref.gff
[12:42:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1578AA_AS.fasta into pseudo-reads
[12:42:07] Marked 0 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[12:42:07] Creating extra output files: BED GFF CSV TXT HTML
[12:42:07] Identified 122 variants.
[12:42:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out
[12:42:07] Result files:
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.aligned.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bam.bai
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.bed
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.consensus.subs.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.csv
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.filt.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.gff
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.html
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.log
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.raw.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.subs.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.tab
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.txt
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out/snps.vcf.gz.csi
[12:42:07] Walltime used: 19 seconds
[12:42:07] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:07] Done.
[12:42:07] Marked 0 heterozygous sites with 'n'
[Tue Jun 16 12:42:07 2020]
Finished job 27.
165 of 202 steps (82%) done

[Tue Jun 16 12:42:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
    jobid: 14
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB4431AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[12:42:07] Creating extra output files: BED GFF CSV TXT HTML
[12:42:07] Identified 20 variants.
[12:42:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out
[12:42:07] Result files:
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.aligned.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bam.bai
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.bed
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.consensus.subs.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.csv
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.filt.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.gff
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.html
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.log
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.raw.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.subs.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.tab
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.txt
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out/snps.vcf.gz.csi
[12:42:07] Walltime used: 19 seconds
[12:42:07] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:42:07] Done.
[Tue Jun 16 12:42:07 2020]
Finished job 96.
166 of 202 steps (82%) done

[Tue Jun 16 12:42:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
    jobid: 160
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JA4169AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[M::mem_process_seqs] Processed 59744 reads in 3.653 CPU sec, 0.424 real sec
[12:42:07] Marked 0 heterozygous sites with 'n'
[samclip] Processed 200000 records...
[12:42:07] Creating extra output files: BED GFF CSV TXT HTML
[12:42:07] Identified 28 variants.
[12:42:07] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out
[12:42:07] Result files:
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.aligned.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bam.bai
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.bed
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.consensus.subs.fa
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.csv
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.filt.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.gff
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.html
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.log
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.raw.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.subs.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.tab
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.txt
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz
[12:42:07] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out/snps.vcf.gz.csi
[12:42:07] Walltime used: 19 seconds
[12:42:07] Wishing you a life free of homopolymer errors.
[12:42:07] Done.
[Tue Jun 16 12:42:07 2020]
Finished job 101.
167 of 202 steps (83%) done

[Tue Jun 16 12:42:07 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
    jobid: 8
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_AB5674AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB8607AA_AS.out\tSM:SAL_KB8607AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.744 sec; CPU: 21.963 sec
[samclip] Total SAM records 379993, removed 681, allowed 155, passed 379312
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:08] This is snippy 4.4.3
[12:42:08] Written by Torsten Seemann
[12:42:08] Obtained from https://github.com/tseemann/snippy
[12:42:08] Detected operating system: linux
[12:42:08] Enabling bundled linux tools.
[12:42:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:08] Found gzip - /usr/bin/gzip
[12:42:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:08] This is snippy 4.4.3
[12:42:08] Written by Torsten Seemann
[12:42:08] Obtained from https://github.com/tseemann/snippy
[12:42:08] Detected operating system: linux
[12:42:08] Enabling bundled linux tools.
[12:42:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:08] Found gzip - /usr/bin/gzip
[12:42:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:08] This is snippy 4.4.3
[12:42:08] Written by Torsten Seemann
[12:42:08] Obtained from https://github.com/tseemann/snippy
[12:42:08] Detected operating system: linux
[12:42:08] Enabling bundled linux tools.
[12:42:08] Treating reference as 'fasta' format.
[12:42:08] Will use 8 CPU cores.
[12:42:08] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta
[12:42:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[12:42:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[12:42:08] Creating reference folder: reference
[12:42:08] Extracting FASTA and GFF from reference.
[12:42:08] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:08] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:08] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:08] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:08] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:08] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:08] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:08] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:08] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:08] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:08] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:08] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:08] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:08] Found gzip - /usr/bin/gzip
[12:42:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:08] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:08] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:08] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:08] Treating reference as 'fasta' format.
[12:42:08] Will use 8 CPU cores.
[12:42:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta
[12:42:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[12:42:08] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[12:42:08] Creating reference folder: reference
[12:42:08] Extracting FASTA and GFF from reference.
[12:42:08] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:08] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:08] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:08] Wrote 3 sequences to ref.fa
[12:42:08] Wrote 0 features to ref.gff
[12:42:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB4431AA_AS.fasta into pseudo-reads
[12:42:08] Wrote 3 sequences to ref.fa
[12:42:08] Wrote 0 features to ref.gff
[12:42:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JA4169AA_AS.fasta into pseudo-reads
[12:42:08] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:08] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:08] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:08] Treating reference as 'fasta' format.
[12:42:08] Will use 8 CPU cores.
[12:42:08] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta
[12:42:08] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[12:42:08] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[12:42:08] Creating reference folder: reference
[12:42:08] Extracting FASTA and GFF from reference.
[12:42:08] Wrote 3 sequences to ref.fa
[12:42:08] Wrote 0 features to ref.gff
[12:42:08] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_AB5674AA_AS.fasta into pseudo-reads
[12:42:08] Running: samtools index snps.bam 2>> snps.log
[12:42:08] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:08] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 16
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:09] Wrote 384808 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:09] Using BAM RG (Read Group) ID: SAL_RA1578AA_AS.out
[12:42:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:09] Running: samtools index snps.bam 2>> snps.log
[12:42:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:09] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:10] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:10] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:10] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:11] Wrote 380504 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:11] Using BAM RG (Read Group) ID: SAL_BB4431AA_AS.out
[12:42:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:11] Wrote 384438 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:11] Using BAM RG (Read Group) ID: SAL_JA4169AA_AS.out
[12:42:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:11] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:11] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:11] Wrote 380346 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:11] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:11] Using BAM RG (Read Group) ID: SAL_AB5674AA_AS.out
[12:42:11] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:11] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:11] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 10
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:11] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:11] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:12] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:12] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:12] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:12] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:12] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:12] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:12] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:12] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 320108 sequences (80000268 bp)...
[12:42:12] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64700 sequences (16153866 bp)...
[12:42:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:42:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 22
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 26

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 26
       total no. variants observed              : 1674
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:42:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:13] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:42:13] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:42:13] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:13] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:13] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:13] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:13] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 320008 sequences (80000076 bp)...
[12:42:13] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 60496 sequences (15090634 bp)...
[12:42:13] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:13] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:13] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320006 sequences (80000212 bp)...
[M::process] read 320056 sequences (80000472 bp)...
[12:42:13] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:13] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 60340 sequences (15075616 bp)...
[12:42:13] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 64382 sequences (16063010 bp)...
[12:42:14] Marked 0 heterozygous sites with 'n'
[12:42:14] Creating extra output files: BED GFF CSV TXT HTML
[12:42:14] Identified 16 variants.
[12:42:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out
[12:42:14] Result files:
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.aligned.fa
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bam.bai
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.bed
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.fa
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.consensus.subs.fa
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.csv
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.filt.vcf
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.gff
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.html
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.log
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.raw.vcf
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.subs.vcf
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.tab
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.txt
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz
[12:42:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out/snps.vcf.gz.csi
[12:42:14] Walltime used: 19 seconds
[12:42:14] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:42:14] Done.
[Tue Jun 16 12:42:14 2020]
Finished job 51.
168 of 202 steps (83%) done

[Tue Jun 16 12:42:14 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
    jobid: 70
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_RA1599AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320108 reads in 17.158 CPU sec, 2.780 real sec
[12:42:15] This is snippy 4.4.3
[12:42:15] Written by Torsten Seemann
[12:42:15] Obtained from https://github.com/tseemann/snippy
[12:42:15] Detected operating system: linux
[12:42:15] Enabling bundled linux tools.
[12:42:15] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:15] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:15] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:15] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:15] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:15] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:15] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:15] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:15] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:15] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:15] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:15] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:15] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:15] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:15] Found gzip - /usr/bin/gzip
[12:42:15] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:15] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:15] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:15] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:15] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:15] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 100000 records...
[12:42:15] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:15] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:15] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:15] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::mem_process_seqs] Processed 64700 reads in 4.252 CPU sec, 0.504 real sec
[12:42:15] Treating reference as 'fasta' format.
[12:42:15] Will use 8 CPU cores.
[12:42:15] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta
[12:42:15] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[12:42:15] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[12:42:15] Creating reference folder: reference
[12:42:15] Extracting FASTA and GFF from reference.
[samclip] Processed 200000 records...
[12:42:15] Wrote 3 sequences to ref.fa
[12:42:15] Wrote 0 features to ref.gff
[12:42:15] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_RA1599AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 320006 reads in 16.743 CPU sec, 2.253 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320008 reads in 15.916 CPU sec, 2.406 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_RA1578AA_AS.out\tSM:SAL_RA1578AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.230 sec; CPU: 21.981 sec
[samclip] Total SAM records 385138, removed 940, allowed 215, passed 384198
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320056 reads in 17.616 CPU sec, 2.654 real sec
[M::mem_process_seqs] Processed 60496 reads in 3.331 CPU sec, 0.399 real sec
[M::mem_process_seqs] Processed 60340 reads in 3.725 CPU sec, 0.440 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[12:42:16] Marked 4 heterozygous sites with 'n'
[samclip] Processed 100000 records...
[12:42:16] Creating extra output files: BED GFF CSV TXT HTML
[12:42:16] Identified 10 variants.
[12:42:16] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out
[12:42:16] Result files:
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.aligned.fa
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bam.bai
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.bed
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.fa
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.consensus.subs.fa
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.csv
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.filt.vcf
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.gff
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.html
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.log
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.raw.vcf
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.subs.vcf
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.tab
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.txt
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz
[12:42:16] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out/snps.vcf.gz.csi
[12:42:16] Walltime used: 18 seconds
[12:42:16] May the SNPs be with you.
[12:42:16] Done.
[Tue Jun 16 12:42:16 2020]
Finished job 147.
169 of 202 steps (84%) done

[Tue Jun 16 12:42:16 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
    jobid: 165
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB8331AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 64382 reads in 3.793 CPU sec, 0.438 real sec
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_AB5674AA_AS.out\tSM:SAL_AB5674AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.652 sec; CPU: 21.017 sec
[samclip] Total SAM records 380570, removed 718, allowed 108, passed 379852
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB4431AA_AS.out\tSM:SAL_BB4431AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.863 sec; CPU: 19.809 sec
[samclip] Total SAM records 380712, removed 512, allowed 63, passed 380200
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JA4169AA_AS.out\tSM:SAL_JA4169AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.030 sec; CPU: 21.959 sec
[samclip] Total SAM records 384524, removed 316, allowed 111, passed 384208
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:17] This is snippy 4.4.3
[12:42:17] Written by Torsten Seemann
[12:42:17] Obtained from https://github.com/tseemann/snippy
[12:42:17] Detected operating system: linux
[12:42:17] Enabling bundled linux tools.
[12:42:17] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:17] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:17] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:17] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:17] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:17] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:17] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:17] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:17] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:17] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:17] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:17] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:17] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:17] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:17] Found gzip - /usr/bin/gzip
[12:42:17] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:17] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:17] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:17] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:17] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:17] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:17] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:17] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:17] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:17] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:17] Treating reference as 'fasta' format.
[12:42:17] Will use 8 CPU cores.
[12:42:17] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta
[12:42:17] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[12:42:17] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[12:42:17] Creating reference folder: reference
[12:42:17] Extracting FASTA and GFF from reference.
[12:42:17] Wrote 3 sequences to ref.fa
[12:42:17] Wrote 0 features to ref.gff
[12:42:17] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB8331AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:17] Marked 0 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:18] Creating extra output files: BED GFF CSV TXT HTML
[12:42:18] Identified 1674 variants.
[12:42:18] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out
[12:42:18] Result files:
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.aligned.fa
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bam.bai
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.bed
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.fa
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.consensus.subs.fa
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.csv
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.filt.vcf
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.gff
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.html
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.log
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.raw.vcf
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.subs.vcf
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.tab
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.txt
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz
[12:42:18] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out/snps.vcf.gz.csi
[12:42:18] Walltime used: 19 seconds
[12:42:18] Wishing you a life free of homopolymer errors.
[12:42:18] Done.
[Tue Jun 16 12:42:18 2020]
Finished job 118.
170 of 202 steps (84%) done

[Tue Jun 16 12:42:18 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
    jobid: 74
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA1344AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[12:42:18] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:18] Wrote 384606 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:18] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:18] Using BAM RG (Read Group) ID: SAL_RA1599AA_AS.out
[12:42:18] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:18] Running: bwa index reference/ref.fa 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:18] Running: samtools index snps.bam 2>> snps.log
[12:42:18] This is snippy 4.4.3
[12:42:18] Written by Torsten Seemann
[12:42:18] Obtained from https://github.com/tseemann/snippy
[12:42:18] Detected operating system: linux
[12:42:18] Enabling bundled linux tools.
[12:42:18] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:18] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:18] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:18] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:18] Running: samtools index snps.bam 2>> snps.log
[12:42:18] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:18] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:18] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:18] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:18] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:18] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:18] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:18] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:19] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:19] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:19] Found gzip - /usr/bin/gzip
[12:42:19] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:19] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:19] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:19] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:19] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:19] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:19] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:19] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:19] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:19] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:19] Treating reference as 'fasta' format.
[12:42:19] Will use 8 CPU cores.
[12:42:19] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta
[12:42:19] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[12:42:19] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[12:42:19] Creating reference folder: reference
[12:42:19] Extracting FASTA and GFF from reference.
[12:42:19] Running: samtools index snps.bam 2>> snps.log
[12:42:19] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:19] Wrote 3 sequences to ref.fa
[12:42:19] Wrote 0 features to ref.gff
[12:42:19] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA1344AA_AS.fasta into pseudo-reads
[12:42:19] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:20] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:20] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:20] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:20] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:20] Running: bwa mem  -Y -M -R '@RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:20] Wrote 380542 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:20] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:20] Using BAM RG (Read Group) ID: SAL_BB8331AA_AS.out
[12:42:20] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:20] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320112 sequences (80000222 bp)...
[M::process] read 64494 sequences (16109924 bp)...
[12:42:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:21] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 1
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 1

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 1
       total no. variants observed              : 17
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 19
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 22

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 22
       total no. variants observed              : 859
       total no. reference observed             : 0

Time elapsed: 0.01s

[12:42:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:22] Wrote 384188 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:22] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:22] Using BAM RG (Read Group) ID: SAL_SA1344AA_AS.out
[12:42:22] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:22] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:22] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:22] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:22] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:22] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:22] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:42:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:22] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:42:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 4
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 4

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 4
       total no. variants observed              : 32
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:22] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::process] read 320140 sequences (80000372 bp)...
[12:42:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 60402 sequences (15100500 bp)...
[12:42:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320112 reads in 18.158 CPU sec, 2.594 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64494 reads in 3.898 CPU sec, 0.447 real sec
[samclip] Processed 200000 records...
[12:42:24] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:24] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:24] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:24] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:24] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] Processed 300000 records...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_RA1599AA_AS.out\tSM:SAL_RA1599AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.994 sec; CPU: 22.638 sec
[samclip] Total SAM records 384931, removed 1093, allowed 191, passed 383838
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320152 sequences (80000390 bp)...
[M::process] read 64036 sequences (16006868 bp)...
[M::mem_process_seqs] Processed 320140 reads in 18.555 CPU sec, 2.507 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60402 reads in 4.305 CPU sec, 0.499 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[12:42:26] Marked 0 heterozygous sites with 'n'
[12:42:26] Creating extra output files: BED GFF CSV TXT HTML
[12:42:26] Identified 19 variants.
[12:42:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out
[12:42:26] Result files:
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.aligned.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bam.bai
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.bed
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.consensus.subs.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.csv
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.filt.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.gff
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.html
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.log
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.raw.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.subs.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.tab
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.txt
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out/snps.vcf.gz.csi
[12:42:26] Walltime used: 20 seconds
[12:42:26] May the SNPs be with you.
[12:42:26] Done.
[Tue Jun 16 12:42:26 2020]
Finished job 134.
171 of 202 steps (85%) done

[Tue Jun 16 12:42:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
    jobid: 192
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA2865AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB8331AA_AS.out\tSM:SAL_BB8331AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.861 sec; CPU: 23.394 sec
[samclip] Total SAM records 381164, removed 1853, allowed 265, passed 379311
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:26] Running: samtools index snps.bam 2>> snps.log
[12:42:26] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:26] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:26] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:26] Creating extra output files: BED GFF CSV TXT HTML
[12:42:26] Identified 17 variants.
[12:42:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out
[12:42:26] Result files:
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.aligned.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bam.bai
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.bed
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.consensus.subs.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.csv
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.filt.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.gff
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.html
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.log
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.raw.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.subs.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.tab
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.txt
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out/snps.vcf.gz.csi
[12:42:26] Walltime used: 18 seconds
[12:42:26] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:26] Done.
[Tue Jun 16 12:42:26 2020]
Finished job 14.
172 of 202 steps (85%) done

[Tue Jun 16 12:42:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
    jobid: 24
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB1150AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[12:42:26] Marked 0 heterozygous sites with 'n'
[12:42:26] This is snippy 4.4.3
[12:42:26] Written by Torsten Seemann
[12:42:26] Obtained from https://github.com/tseemann/snippy
[12:42:26] Detected operating system: linux
[12:42:26] Enabling bundled linux tools.
[12:42:26] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:26] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:26] Creating extra output files: BED GFF CSV TXT HTML
[12:42:26] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:26] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:26] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:26] Identified 859 variants.
[12:42:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out
[12:42:26] Result files:
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.aligned.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bam.bai
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.bed
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.consensus.subs.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.csv
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.filt.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.gff
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.html
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.log
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.raw.vcf
[12:42:26] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.subs.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.tab
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.txt
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out/snps.vcf.gz.csi
[12:42:26] Walltime used: 18 seconds
[12:42:26] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:42:26] Done.
[12:42:26] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:26] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:26] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:26] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:26] Marked 0 heterozygous sites with 'n'
[12:42:26] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[M::mem_process_seqs] Processed 320152 reads in 17.382 CPU sec, 2.440 real sec
[Tue Jun 16 12:42:26 2020]
Finished job 8.
173 of 202 steps (86%) done

[Tue Jun 16 12:42:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
    jobid: 149
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_CB3409AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[12:42:26] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:26] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:26] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:26] Found gzip - /usr/bin/gzip
[12:42:26] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:26] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:26] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:26] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:26] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:26] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:26] Creating extra output files: BED GFF CSV TXT HTML
[12:42:26] Identified 32 variants.
[12:42:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out
[12:42:26] Result files:
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.aligned.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bam.bai
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.bed
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.consensus.subs.fa
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.csv
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.filt.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.gff
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.html
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.log
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.raw.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.subs.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.tab
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.txt
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz
[12:42:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out/snps.vcf.gz.csi
[12:42:26] Walltime used: 18 seconds
[12:42:26] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:26] Done.
[Tue Jun 16 12:42:26 2020]
Finished job 160.
174 of 202 steps (86%) done

[Tue Jun 16 12:42:26 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
    jobid: 174
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BB1066AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[12:42:26] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:27] Treating reference as 'fasta' format.
[12:42:27] Will use 8 CPU cores.
[12:42:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta
[12:42:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[12:42:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[12:42:27] Creating reference folder: reference
[12:42:27] Extracting FASTA and GFF from reference.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:27] Wrote 3 sequences to ref.fa
[12:42:27] Wrote 0 features to ref.gff
[12:42:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA2865AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 64036 reads in 3.930 CPU sec, 0.452 real sec
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:27] This is snippy 4.4.3
[12:42:27] Written by Torsten Seemann
[12:42:27] Obtained from https://github.com/tseemann/snippy
[12:42:27] Detected operating system: linux
[12:42:27] Enabling bundled linux tools.
[12:42:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[samclip] Processed 200000 records...
[12:42:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:27] Found gzip - /usr/bin/gzip
[12:42:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:27] This is snippy 4.4.3
[12:42:27] Written by Torsten Seemann
[12:42:27] Obtained from https://github.com/tseemann/snippy
[12:42:27] Detected operating system: linux
[12:42:27] Enabling bundled linux tools.
[12:42:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:27] Found gzip - /usr/bin/gzip
[12:42:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:27] Treating reference as 'fasta' format.
[12:42:27] Will use 8 CPU cores.
[12:42:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta
[12:42:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[12:42:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[12:42:27] Creating reference folder: reference
[12:42:27] Extracting FASTA and GFF from reference.
[12:42:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:27] This is snippy 4.4.3
[12:42:27] Written by Torsten Seemann
[12:42:27] Obtained from https://github.com/tseemann/snippy
[12:42:27] Detected operating system: linux
[12:42:27] Enabling bundled linux tools.
[12:42:27] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:27] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[samclip] Processed 300000 records...
[12:42:27] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:27] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:27] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:27] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:27] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:27] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:27] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:27] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:27] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:27] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:27] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:27] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:27] Found gzip - /usr/bin/gzip
[12:42:27] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:27] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:27] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:27] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:27] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:27] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:27] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:27] Wrote 3 sequences to ref.fa
[12:42:27] Wrote 0 features to ref.gff
[12:42:27] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB1150AA_AS.fasta into pseudo-reads
[12:42:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:27] Treating reference as 'fasta' format.
[12:42:27] Will use 8 CPU cores.
[12:42:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta
[12:42:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[12:42:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[12:42:27] Creating reference folder: reference
[12:42:27] Extracting FASTA and GFF from reference.
[12:42:27] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:27] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:27] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:27] Treating reference as 'fasta' format.
[12:42:27] Will use 8 CPU cores.
[12:42:27] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta
[12:42:27] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[12:42:27] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[12:42:27] Creating reference folder: reference
[12:42:27] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA1344AA_AS.out\tSM:SAL_SA1344AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.835 sec; CPU: 21.881 sec
[samclip] Total SAM records 384466, removed 997, allowed 98, passed 383469
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:28] Wrote 3 sequences to ref.fa
[12:42:28] Wrote 0 features to ref.gff
[12:42:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_CB3409AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:28] Wrote 3 sequences to ref.fa
[12:42:28] Wrote 0 features to ref.gff
[12:42:28] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BB1066AA_AS.fasta into pseudo-reads
[12:42:28] Running: samtools index snps.bam 2>> snps.log
[12:42:28] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:28] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:29] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 18
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:29] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:29] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:29] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:29] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:29] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:29] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:29] Running: samtools index snps.bam 2>> snps.log
[12:42:29] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:29] Wrote 383654 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:29] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:29] Using BAM RG (Read Group) ID: SAL_NA2865AA_AS.out
[12:42:29] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:29] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:29] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:30] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:30] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:30] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:30] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:30] Wrote 380042 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:30] Using BAM RG (Read Group) ID: SAL_JB1150AA_AS.out
[12:42:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:30] Wrote 378962 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:30] Using BAM RG (Read Group) ID: SAL_CB3409AA_AS.out
[12:42:30] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:30] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:30] Wrote 380858 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:30] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:30] Using BAM RG (Read Group) ID: SAL_BB1066AA_AS.out
[12:42:30] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:30] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:31] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2586
       total no. reference observed             : 0

Time elapsed: 0.03s

[12:42:31] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:31] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:31] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:31] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:31] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:31] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:31] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:31] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:31] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:42:31] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:32] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:32] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:32] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:32] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:32] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:32] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320240 sequences (80000242 bp)...
[M::process] read 63414 sequences (15840838 bp)...
[12:42:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:42:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:42:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:32] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:32] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:32] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:32] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:32] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320016 sequences (80000400 bp)...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 60026 sequences (14956226 bp)...
[M::process] read 58962 sequences (14740500 bp)...
[12:42:33] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 3
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 3

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 3
       total no. variants observed              : 12
       total no. reference observed             : 0

Time elapsed: 0.00s

[M::process] read 320024 sequences (80000386 bp)...
[12:42:33] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:33] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:33] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[M::process] read 60834 sequences (15204810 bp)...
[12:42:33] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:33] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:33] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:33] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:33] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:33] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:33] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:34] Marked 0 heterozygous sites with 'n'
[12:42:34] Creating extra output files: BED GFF CSV TXT HTML
[12:42:34] Identified 18 variants.
[12:42:34] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out
[12:42:34] Result files:
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.aligned.fa
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bam.bai
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.bed
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.fa
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.consensus.subs.fa
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.csv
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.filt.vcf
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.gff
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.html
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.log
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.raw.vcf
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.subs.vcf
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.tab
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.txt
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz
[12:42:34] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out/snps.vcf.gz.csi
[12:42:34] Walltime used: 19 seconds
[12:42:34] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:42:34] Done.
[Tue Jun 16 12:42:34 2020]
Finished job 70.
175 of 202 steps (87%) done

[Tue Jun 16 12:42:34 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
    jobid: 57
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KA0676AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 320240 reads in 17.349 CPU sec, 2.683 real sec
[12:42:35] This is snippy 4.4.3
[12:42:35] Written by Torsten Seemann
[12:42:35] Obtained from https://github.com/tseemann/snippy
[12:42:35] Detected operating system: linux
[12:42:35] Enabling bundled linux tools.
[12:42:35] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:35] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:35] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:35] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:35] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:35] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:35] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:35] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:35] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:35] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:35] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:35] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:35] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:35] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:35] Found gzip - /usr/bin/gzip
[12:42:35] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:35] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:35] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:35] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:35] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:35] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:35] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:42:35] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:35] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:35] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:35] Treating reference as 'fasta' format.
[12:42:35] Will use 8 CPU cores.
[12:42:35] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta
[12:42:35] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[12:42:35] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[12:42:35] Creating reference folder: reference
[12:42:35] Extracting FASTA and GFF from reference.
[M::mem_process_seqs] Processed 320016 reads in 19.021 CPU sec, 2.544 real sec
[M::mem_process_seqs] Processed 63414 reads in 3.855 CPU sec, 0.455 real sec
[M::mem_process_seqs] Processed 320024 reads in 16.498 CPU sec, 2.427 real sec
[12:42:35] Wrote 3 sequences to ref.fa
[12:42:35] Wrote 0 features to ref.gff
[12:42:35] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KA0676AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 320000 reads in 17.405 CPU sec, 2.788 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 60026 reads in 3.486 CPU sec, 0.414 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 60834 reads in 3.719 CPU sec, 0.443 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 58962 reads in 3.305 CPU sec, 0.389 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA2865AA_AS.out\tSM:SAL_NA2865AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.163 sec; CPU: 21.779 sec
[samclip] Total SAM records 383807, removed 436, allowed 38, passed 383371
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB1150AA_AS.out\tSM:SAL_JB1150AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.957 sec; CPU: 23.047 sec
[samclip] Total SAM records 380486, removed 1599, allowed 282, passed 378887
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:36] Marked 1 heterozygous sites with 'n'
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:36] Creating extra output files: BED GFF CSV TXT HTML
[samclip] Processed 300000 records...
[12:42:36] Identified 2586 variants.
[12:42:36] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out
[12:42:36] Result files:
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BB1066AA_AS.out\tSM:SAL_BB1066AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.889 sec; CPU: 20.794 sec
[samclip] Total SAM records 381031, removed 423, allowed 39, passed 380608
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.aligned.fa
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bam.bai
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.bed
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.fa
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.consensus.subs.fa
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.csv
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.filt.vcf
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.gff
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.html
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.log
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.raw.vcf
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.subs.vcf
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.tab
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.txt
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz
[12:42:36] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out/snps.vcf.gz.csi
[12:42:36] Walltime used: 19 seconds
[12:42:36] Questionable SNP? Try the --report option to see the alignments.
[12:42:36] Done.
[Tue Jun 16 12:42:36 2020]
Finished job 165.
176 of 202 steps (87%) done

[Tue Jun 16 12:42:36 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
    jobid: 29
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_NA5728AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_CB3409AA_AS.out\tSM:SAL_CB3409AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.274 sec; CPU: 21.315 sec
[samclip] Total SAM records 379448, removed 1280, allowed 130, passed 378168
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:37] This is snippy 4.4.3
[12:42:37] Written by Torsten Seemann
[12:42:37] Obtained from https://github.com/tseemann/snippy
[12:42:37] Detected operating system: linux
[12:42:37] Enabling bundled linux tools.
[12:42:37] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:37] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:37] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:37] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:37] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:37] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:37] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:37] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:37] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:37] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:37] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:37] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:37] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:37] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:37] Found gzip - /usr/bin/gzip
[12:42:37] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:37] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:37] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:37] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:37] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:37] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:37] Checking version: java -version is >= 1.8 - ok, have 1.8
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:37] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:37] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:37] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:37] Treating reference as 'fasta' format.
[12:42:37] Will use 8 CPU cores.
[12:42:37] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta
[12:42:37] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[12:42:37] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[12:42:37] Creating reference folder: reference
[12:42:37] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:37] Wrote 3 sequences to ref.fa
[12:42:37] Wrote 0 features to ref.gff
[12:42:37] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_NA5728AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:37] Marked 0 heterozygous sites with 'n'
[12:42:37] Creating extra output files: BED GFF CSV TXT HTML
[12:42:37] Identified 12 variants.
[12:42:37] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out
[12:42:37] Result files:
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.aligned.fa
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bam.bai
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.bed
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.fa
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.consensus.subs.fa
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.csv
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.filt.vcf
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.gff
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.html
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.log
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.raw.vcf
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.subs.vcf
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.tab
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.txt
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz
[12:42:37] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out/snps.vcf.gz.csi
[12:42:37] Walltime used: 19 seconds
[12:42:37] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:37] Done.
[Tue Jun 16 12:42:37 2020]
Finished job 74.
177 of 202 steps (88%) done

[Tue Jun 16 12:42:37 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
    jobid: 107
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB1789AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
[12:42:38] Running: samtools index snps.bam 2>> snps.log
[12:42:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:38] Wrote 384394 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:38] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:38] Using BAM RG (Read Group) ID: SAL_KA0676AA_AS.out
[12:42:38] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:38] Running: samtools index snps.bam 2>> snps.log
[12:42:38] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:38] Running: samtools index snps.bam 2>> snps.log
[12:42:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:38] Running: samtools index snps.bam 2>> snps.log
[12:42:38] This is snippy 4.4.3
[12:42:38] Written by Torsten Seemann
[12:42:38] Obtained from https://github.com/tseemann/snippy
[12:42:38] Detected operating system: linux
[12:42:38] Enabling bundled linux tools.
[12:42:38] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:38] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:38] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:38] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:38] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:38] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:38] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:38] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:38] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:38] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:38] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:38] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:38] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:38] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:38] Found gzip - /usr/bin/gzip
[12:42:38] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:38] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:38] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:38] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:38] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:38] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:38] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:38] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:38] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:39] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:39] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:39] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:39] Treating reference as 'fasta' format.
[12:42:39] Will use 8 CPU cores.
[12:42:39] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta
[12:42:39] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[12:42:39] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[12:42:39] Creating reference folder: reference
[12:42:39] Extracting FASTA and GFF from reference.
[12:42:39] Wrote 3 sequences to ref.fa
[12:42:39] Wrote 0 features to ref.gff
[12:42:39] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB1789AA_AS.fasta into pseudo-reads
[12:42:40] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:40] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:40] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:40] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:40] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:40] Wrote 387300 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:40] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:40] Using BAM RG (Read Group) ID: SAL_NA5728AA_AS.out
[12:42:40] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:40] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320118 sequences (80000194 bp)...
[M::process] read 64276 sequences (16058486 bp)...
[12:42:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:41] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:41] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:41] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:41] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:41] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:41] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:41] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:41] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 5
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 5

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 5
       total no. variants observed              : 73
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:41] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 8
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 8

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 8
       total no. variants observed              : 105
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:41] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:41] Wrote 379942 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:41] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:41] Using BAM RG (Read Group) ID: SAL_KB1789AA_AS.out
[12:42:41] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:41] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:41] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log

stats: biallelic
          no. left trimmed                      : 5
          no. right trimmed                     : 47
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 57

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 57
       total no. variants observed              : 3912
       total no. reference observed             : 0

Time elapsed: 0.05s

[12:42:42] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:42] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:42] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:42] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:42] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:42] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:42] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:42] Running: bwa mem  -Y -M -R '@RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[12:42:42] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:42] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:42] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:42] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:42] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[M::process] read 320082 sequences (80000274 bp)...
[12:42:42] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:42] Running: rm -f fake_reads\.fq 2>> snps.log
[M::process] read 67218 sequences (16796756 bp)...
[12:42:42] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320118 reads in 17.644 CPU sec, 2.430 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 64276 reads in 3.681 CPU sec, 0.422 real sec
[12:42:43] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:43] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:43] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:43] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[samclip] Processed 200000 records...
[12:42:43] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[M::process] read 320000 sequences (80000000 bp)...
[M::process] read 59942 sequences (14950530 bp)...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M[samclip] Total SAM records 384690, removed 1014, allowed 244, passed 383676
 -R @RG\tID:SAL_KA0676AA_AS.out\tSM:SAL_KA0676AA_AS.out[samclip] Header contained 5 lines
 -t[samclip] Done.
 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.821 sec; CPU: 21.897 sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320082 reads in 17.479 CPU sec, 2.259 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 67218 reads in 4.093 CPU sec, 0.480 real sec
[samclip] Processed 200000 records...
[samclip] Processed 300000 records...
[12:42:45] Marked 0 heterozygous sites with 'n'
[12:42:45] Creating extra output files: BED GFF CSV TXT HTML
[12:42:45] Identified 13 variants.
[12:42:45] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out
[12:42:45] Result files:
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.aligned.fa
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bam.bai
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.bed
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.fa
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.consensus.subs.fa
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.csv
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.filt.vcf
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.gff
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.html
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.log
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.raw.vcf
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.subs.vcf
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.tab
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.txt
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz
[12:42:45] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out/snps.vcf.gz.csi
[12:42:45] Walltime used: 19 seconds
[12:42:45] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:45] Done.
[Tue Jun 16 12:42:45 2020]
Finished job 192.
178 of 202 steps (88%) done

[Tue Jun 16 12:42:45 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
    jobid: 194
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_WA2841AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_NA5728AA_AS.out\tSM:SAL_NA5728AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.709 sec; CPU: 22.128 sec
[samclip] Total SAM records 387496, removed 1647, allowed 406, passed 385849
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:46] Running: samtools index snps.bam 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:46] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:46] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:46] Marked 0 heterozygous sites with 'n'
[12:42:46] Marked 0 heterozygous sites with 'n'
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:46] Creating extra output files: BED GFF CSV TXT HTML
[12:42:46] Identified 105 variants.
[12:42:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out
[12:42:46] Result files:
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.aligned.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bam.bai
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.bed
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.consensus.subs.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.csv
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.filt.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.gff
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.html
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.log
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.raw.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.subs.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.tab
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.txt
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out/snps.vcf.gz.csi
[12:42:46] Walltime used: 19 seconds
[12:42:46] The Snippy manual is at https://github.com/tseemann/snippy/blob/master/README.md
[12:42:46] Done.
[Tue Jun 16 12:42:46 2020]
Finished job 149.
179 of 202 steps (89%) done

[Tue Jun 16 12:42:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
    jobid: 80
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_SA9173AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[12:42:46] Creating extra output files: BED GFF CSV TXT HTML
[12:42:46] Identified 73 variants.
[12:42:46] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out
[12:42:46] Result files:
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.aligned.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bam.bai
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.bed
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.consensus.subs.fa
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.csv
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.filt.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.gff
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.html
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.log
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.raw.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.subs.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.tab
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.txt
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz
[12:42:46] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out/snps.vcf.gz.csi
[12:42:46] Walltime used: 19 seconds
[12:42:46] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:42:46] Done.
[Tue Jun 16 12:42:46 2020]
Finished job 174.
180 of 202 steps (89%) done

[Tue Jun 16 12:42:46 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
    jobid: 144
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_TA1967AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[M::mem_process_seqs] Processed 320000 reads in 18.488 CPU sec, 2.471 real sec
[12:42:46] This is snippy 4.4.3
[12:42:46] Written by Torsten Seemann
[12:42:46] Obtained from https://github.com/tseemann/snippy
[12:42:46] Detected operating system: linux
[12:42:46] Enabling bundled linux tools.
[12:42:46] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:46] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:46] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:46] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:46] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:46] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:46] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:46] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:46] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:46] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:46] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:46] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:46] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:46] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:46] Found gzip - /usr/bin/gzip
[12:42:46] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:46] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:46] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:46] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:46] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:46] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:46] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:42:46] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:46] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:46] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:46] Treating reference as 'fasta' format.
[12:42:46] Will use 8 CPU cores.
[12:42:46] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta
[12:42:46] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[12:42:46] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[12:42:46] Creating reference folder: reference
[12:42:46] Extracting FASTA and GFF from reference.
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:47] Marked 53 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 59942 reads in 4.312 CPU sec, 0.501 real sec
[12:42:47] Wrote 3 sequences to ref.fa
[12:42:47] Wrote 0 features to ref.gff
[12:42:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_WA2841AA_AS.fasta into pseudo-reads
[samclip] Processed 200000 records...
[12:42:47] Creating extra output files: BED GFF CSV TXT HTML
[12:42:47] Identified 3912 variants.
[12:42:47] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out
[12:42:47] Result files:
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.aligned.fa
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bam.bai
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.bed
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.fa
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.consensus.subs.fa
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.csv
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.filt.vcf
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.gff
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.html
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.log
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.raw.vcf
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.subs.vcf
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.tab
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.txt
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz
[12:42:47] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out/snps.vcf.gz.csi
[12:42:47] Walltime used: 20 seconds
[12:42:47] May the SNPs be with you.
[12:42:47] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[Tue Jun 16 12:42:47 2020]
Finished job 24.
181 of 202 steps (90%) done

[Tue Jun 16 12:42:47 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
    jobid: 55
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_XA1733AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[12:42:47] This is snippy 4.4.3
[12:42:47] Written by Torsten Seemann
[12:42:47] Obtained from https://github.com/tseemann/snippy
[12:42:47] Detected operating system: linux
[12:42:47] Enabling bundled linux tools.
[12:42:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:47] This is snippy 4.4.3
[12:42:47] Written by Torsten Seemann
[12:42:47] Obtained from https://github.com/tseemann/snippy
[12:42:47] Detected operating system: linux
[12:42:47] Enabling bundled linux tools.
[12:42:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:47] Found gzip - /usr/bin/gzip
[12:42:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:47] Found gzip - /usr/bin/gzip
[12:42:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 300000 records...
[12:42:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:47] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:47] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:47] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:47] Treating reference as 'fasta' format.
[12:42:47] Will use 8 CPU cores.
[12:42:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta
[12:42:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[12:42:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[12:42:47] Creating reference folder: reference
[12:42:47] Extracting FASTA and GFF from reference.
[12:42:47] Treating reference as 'fasta' format.
[12:42:47] Will use 8 CPU cores.
[12:42:47] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta
[12:42:47] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[12:42:47] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[12:42:47] Creating reference folder: reference
[12:42:47] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB1789AA_AS.out\tSM:SAL_KB1789AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.839 sec; CPU: 23.346 sec
[samclip] Total SAM records 380645, removed 1858, allowed 207, passed 378787
[samclip] Header contained 5 lines
[samclip] Done.
[12:42:47] Wrote 3 sequences to ref.fa
[12:42:47] Wrote 0 features to ref.gff
[12:42:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_SA9173AA_AS.fasta into pseudo-reads
[12:42:47] Wrote 3 sequences to ref.fa
[12:42:47] Wrote 0 features to ref.gff
[12:42:47] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_TA1967AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:47] This is snippy 4.4.3
[12:42:47] Written by Torsten Seemann
[12:42:47] Obtained from https://github.com/tseemann/snippy
[12:42:47] Detected operating system: linux
[12:42:47] Enabling bundled linux tools.
[12:42:47] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:47] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:47] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:47] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:47] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:47] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:47] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:47] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:47] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:47] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:47] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:47] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:47] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:47] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:47] Found gzip - /usr/bin/gzip
[12:42:47] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:47] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:47] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:47] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:47] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:47] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:47] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:48] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:48] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:48] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:48] Treating reference as 'fasta' format.
[12:42:48] Will use 8 CPU cores.
[12:42:48] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta
[12:42:48] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[12:42:48] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[12:42:48] Creating reference folder: reference
[12:42:48] Extracting FASTA and GFF from reference.
[12:42:48] Running: samtools index snps.bam 2>> snps.log
[12:42:48] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:48] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:48] Wrote 3 sequences to ref.fa
[12:42:48] Wrote 0 features to ref.gff
[12:42:48] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_XA1733AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:49] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 13
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:42:49] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:49] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:49] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:49] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:49] Running: samtools index snps.bam 2>> snps.log
[12:42:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:49] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:49] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:49] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:49] Wrote 383460 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:49] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:49] Using BAM RG (Read Group) ID: SAL_WA2841AA_AS.out
[12:42:49] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:49] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:49] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:49] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:49] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:49] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:49] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:50] Wrote 382446 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:50] Wrote 382468 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:50] Using BAM RG (Read Group) ID: SAL_SA9173AA_AS.out
[12:42:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:50] Using BAM RG (Read Group) ID: SAL_TA1967AA_AS.out
[12:42:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:50] Wrote 383002 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:50] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:50] Using BAM RG (Read Group) ID: SAL_XA1733AA_AS.out
[12:42:50] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:50] Running: bwa index reference/ref.fa 2>> snps.log
[12:42:51] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1807
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:42:51] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:42:51] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:42:51] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:51] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:51] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:51] Running: bwa mem  -Y -M -R '@RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:51] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:51] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:51] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:51] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:51] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[M::process] read 320192 sequences (80000106 bp)...
[12:42:51] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:51] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[M::process] read 63268 sequences (15805028 bp)...
[12:42:51] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:52] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:42:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:42:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320240 sequences (80000250 bp)...
[M::process] read 62206 sequences (15551500 bp)...
[12:42:52] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:42:52] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:42:52] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:42:52] Running: bwa mem  -Y -M -R '@RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320190 sequences (80000004 bp)...
[12:42:53] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 27
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 32

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 32
       total no. variants observed              : 2591
       total no. reference observed             : 0

Time elapsed: 0.03s

[12:42:53] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[M::process] read 62278 sequences (15552298 bp)...
[12:42:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[M::process] read 320254 sequences (80000470 bp)...
[12:42:53] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:42:53] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:42:53] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:42:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:42:53] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:42:53] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:42:53] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:42:53] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:42:53] Running: rm -f fake_reads\.fq 2>> snps.log
[12:42:53] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 62748 sequences (15675344 bp)...
[12:42:54] Marked 0 heterozygous sites with 'n'
[12:42:54] Creating extra output files: BED GFF CSV TXT HTML
[12:42:54] Identified 13 variants.
[12:42:54] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out
[12:42:54] Result files:
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.aligned.fa
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bam.bai
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.bed
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.fa
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.consensus.subs.fa
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.csv
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.filt.vcf
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.gff
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.html
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.log
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.raw.vcf
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.subs.vcf
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.tab
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.txt
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz
[12:42:54] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out/snps.vcf.gz.csi
[12:42:54] Walltime used: 19 seconds
[12:42:54] Wishing you a life free of homopolymer errors.
[12:42:54] Done.
[Tue Jun 16 12:42:54 2020]
Finished job 57.
182 of 202 steps (90%) done

[Tue Jun 16 12:42:54 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
    jobid: 23
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA9385AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[M::mem_process_seqs] Processed 320192 reads in 17.610 CPU sec, 2.601 real sec
[samclip] Processed 100000 records...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[M::mem_process_seqs] Processed 63268 reads in 3.800 CPU sec, 0.454 real sec
[samclip] Processed 200000 records...
[12:42:55] This is snippy 4.4.3
[12:42:55] Written by Torsten Seemann
[12:42:55] Obtained from https://github.com/tseemann/snippy
[12:42:55] Detected operating system: linux
[12:42:55] Enabling bundled linux tools.
[12:42:55] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:55] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:55] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:55] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:55] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:55] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:55] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:55] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:55] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:55] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:55] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:55] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:55] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:55] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:55] Found gzip - /usr/bin/gzip
[12:42:55] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:55] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:55] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:55] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:55] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:55] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:55] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:55] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:55] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:55] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[M::mem_process_seqs] Processed 320240 reads in 17.616 CPU sec, 2.500 real sec
[12:42:55] Treating reference as 'fasta' format.
[12:42:55] Will use 8 CPU cores.
[12:42:55] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta
[12:42:55] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[12:42:55] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[12:42:55] Creating reference folder: reference
[12:42:55] Extracting FASTA and GFF from reference.
[samclip] Processed 300000 records...
[12:42:55] Wrote 3 sequences to ref.fa
[12:42:55] Wrote 0 features to ref.gff
[12:42:55] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA9385AA_AS.fasta into pseudo-reads
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_WA2841AA_AS.out\tSM:SAL_WA2841AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.046 sec; CPU: 22.001 sec
[samclip] Total SAM records 383660, removed 620, allowed 53, passed 383040
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 320190 reads in 18.211 CPU sec, 2.608 real sec
[M::mem_process_seqs] Processed 62206 reads in 3.708 CPU sec, 0.433 real sec
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 62278 reads in 3.778 CPU sec, 0.438 real sec
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320254 reads in 17.548 CPU sec, 2.850 real sec
[samclip] Processed 200000 records...
[12:42:56] Marked 6 heterozygous sites with 'n'
[12:42:56] Creating extra output files: BED GFF CSV TXT HTML
[12:42:56] Identified 1807 variants.
[12:42:56] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out
[12:42:56] Result files:
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.aligned.fa
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bam.bai
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.bed
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.fa
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.consensus.subs.fa
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.csv
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.filt.vcf
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.gff
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.html
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.log
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.raw.vcf
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.subs.vcf
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.tab
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.txt
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz
[12:42:56] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out/snps.vcf.gz.csi
[12:42:56] Walltime used: 19 seconds
[12:42:56] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:42:56] Done.
[Tue Jun 16 12:42:56 2020]
Finished job 29.
183 of 202 steps (91%) done

[Tue Jun 16 12:42:56 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
    jobid: 102
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6663AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_SA9173AA_AS.out\tSM:SAL_SA9173AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.904 sec; CPU: 21.873 sec
[samclip] Total SAM records 382546, removed 556, allowed 115, passed 381990
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::mem_process_seqs] Processed 62748 reads in 3.984 CPU sec, 0.466 real sec
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_TA1967AA_AS.out\tSM:SAL_TA1967AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.990 sec; CPU: 22.561 sec
[samclip] Total SAM records 382578, removed 523, allowed 104, passed 382055
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 200000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[samclip] Processed 300000 records...
[12:42:57] This is snippy 4.4.3
[12:42:57] Written by Torsten Seemann
[12:42:57] Obtained from https://github.com/tseemann/snippy
[12:42:57] Detected operating system: linux
[12:42:57] Enabling bundled linux tools.
[12:42:57] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:57] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:57] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:57] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:57] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:57] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:57] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:57] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:57] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:57] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:57] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:57] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:57] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:57] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:57] Found gzip - /usr/bin/gzip
[12:42:57] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:57] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:57] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:57] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:57] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:57] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:57] Checking version: java -version is >= 1.8 - ok, have 1.8
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_XA1733AA_AS.out\tSM:SAL_XA1733AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 383174, removed 683, allowed 38, passed 382491

[main] Real time: 4.269 sec; CPU: 22.059 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:57] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:57] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:57] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:57] Treating reference as 'fasta' format.
[12:42:57] Will use 8 CPU cores.
[12:42:57] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta
[12:42:57] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[12:42:57] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[12:42:57] Creating reference folder: reference
[12:42:57] Extracting FASTA and GFF from reference.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:57] Wrote 3 sequences to ref.fa
[12:42:57] Wrote 0 features to ref.gff
[12:42:57] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6663AA_AS.fasta into pseudo-reads
[12:42:57] Running: samtools index snps.bam 2>> snps.log
[12:42:57] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:57] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:58] Marked 1 heterozygous sites with 'n'
[12:42:58] Creating extra output files: BED GFF CSV TXT HTML
[12:42:58] Identified 2591 variants.
[12:42:58] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out
[12:42:58] Result files:
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.aligned.fa
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bam.bai
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.bed
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.fa
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.consensus.subs.fa
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.csv
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.filt.vcf
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.gff
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.html
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.log
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.raw.vcf
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.subs.vcf
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.tab
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.txt
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz
[12:42:58] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out/snps.vcf.gz.csi
[12:42:58] Walltime used: 20 seconds
[12:42:58] May the SNPs be with you.
[12:42:58] Done.
[12:42:58] Wrote 381576 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:42:58] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:42:58] Using BAM RG (Read Group) ID: SAL_YA9385AA_AS.out
[Tue Jun 16 12:42:58 2020]
Finished job 107.
184 of 202 steps (91%) done

[Tue Jun 16 12:42:58 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
    jobid: 87
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_KB4651AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
[12:42:58] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:42:58] Running: bwa index reference/ref.fa 2>> snps.log
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:42:58] Running: samtools index snps.bam 2>> snps.log
[12:42:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:58] Running: samtools index snps.bam 2>> snps.log
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:42:58] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:58] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:58] This is snippy 4.4.3
[12:42:58] Written by Torsten Seemann
[12:42:58] Obtained from https://github.com/tseemann/snippy
[12:42:58] Detected operating system: linux
[12:42:58] Enabling bundled linux tools.
[12:42:58] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:42:58] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:42:58] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:42:58] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:42:58] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:42:58] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:42:58] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:42:58] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:42:58] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:42:58] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:42:58] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:42:58] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:42:58] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:42:58] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:42:58] Found gzip - /usr/bin/gzip
[12:42:58] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:42:58] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:42:58] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:42:58] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:42:58] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:42:58] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:42:58] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:42:59] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:42:59] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:42:59] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:42:59] Treating reference as 'fasta' format.
[12:42:59] Will use 8 CPU cores.
[12:42:59] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta
[12:42:59] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[12:42:59] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[12:42:59] Creating reference folder: reference
[12:42:59] Extracting FASTA and GFF from reference.
[12:42:59] Running: samtools index snps.bam 2>> snps.log
[12:42:59] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:42:59] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:42:59] Wrote 3 sequences to ref.fa
[12:42:59] Wrote 0 features to ref.gff
[12:42:59] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_KB4651AA_AS.fasta into pseudo-reads
[12:42:59] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:00] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:00] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:00] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:00] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:43:00] Wrote 381992 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:00] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:00] Using BAM RG (Read Group) ID: SAL_YA6663AA_AS.out
[12:43:00] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:00] Running: bwa index reference/ref.fa 2>> snps.log
[M::process] read 320140 sequences (80000490 bp)...
[M::process] read 61436 sequences (15348128 bp)...
[12:43:00] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 2
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 2

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 2
       total no. variants observed              : 19
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:00] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:00] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:00] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:00] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:00] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:00] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:00] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:00] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:00] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:01] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 101
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:01] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:43:01] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 10
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 10

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 10
       total no. variants observed              : 98
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:01] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:01] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:01] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:01] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:01] Wrote 377314 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:01] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:01] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:01] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:01] Using BAM RG (Read Group) ID: SAL_KB4651AA_AS.out
[12:43:01] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:01] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:01] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:01] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:01] Running: bwa index reference/ref.fa 2>> snps.log
[12:43:01] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[12:43:01] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:01] Running: rm -f fake_reads\.fq 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:43:01] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 7
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 7

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 7
       total no. variants observed              : 86
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:02] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::process] read 320452 sequences (80000068 bp)...
[12:43:02] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[M::process] read 61540 sequences (15359146 bp)...
[12:43:02] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:02] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:02] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:02] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:02] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:02] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:02] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320140 reads in 18.644 CPU sec, 2.552 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61436 reads in 4.061 CPU sec, 0.480 real sec
[samclip] Processed 200000 records...
[12:43:03] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:03] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:03] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:03] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:03] Running: bwa mem  -Y -M -R '@RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA9385AA_AS.out\tSM:SAL_YA9385AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.949 sec; CPU: 23.271 sec
[samclip] Total SAM records 381934, removed 1047, allowed 230, passed 380887
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[M::process] read 320088 sequences (80000324 bp)...
[M::process] read 57226 sequences (14306500 bp)...
[M::mem_process_seqs] Processed 320452 reads in 16.467 CPU sec, 2.201 real sec
[samclip] Processed 100000 records...
[M::mem_process_seqs] Processed 61540 reads in 3.669 CPU sec, 0.427 real sec
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 200000 records...
[12:43:05] Marked 0 heterozygous sites with 'n'
[samclip] Processed 300000 records...
[12:43:05] Creating extra output files: BED GFF CSV TXT HTML
[12:43:05] Identified 19 variants.
[12:43:05] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out
[12:43:05] Result files:
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.aligned.fa
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bam.bai
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.bed
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.fa
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.consensus.subs.fa
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.csv
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.filt.vcf
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.gff
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.html
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.log
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.raw.vcf
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.subs.vcf
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.tab
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.txt
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz
[12:43:05] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out/snps.vcf.gz.csi
[12:43:05] Walltime used: 19 seconds
[12:43:05] May the SNPs be with you.
[12:43:05] Done.
[Tue Jun 16 12:43:05 2020]
Finished job 194.
185 of 202 steps (92%) done

[Tue Jun 16 12:43:05 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
    jobid: 36
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_VA1155AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6663AA_AS.out\tSM:SAL_YA6663AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.589 sec; CPU: 20.695 sec
[samclip] Total SAM records 382173, removed 587, allowed 309, passed 381586
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:43:05] Running: samtools index snps.bam 2>> snps.log
[12:43:06] This is snippy 4.4.3
[12:43:06] Written by Torsten Seemann
[12:43:06] Obtained from https://github.com/tseemann/snippy
[12:43:06] Detected operating system: linux
[12:43:06] Enabling bundled linux tools.
[12:43:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:43:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:43:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:43:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:43:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:43:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:43:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:43:06] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:43:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:43:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:43:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:43:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:43:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:43:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:43:06] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:06] Found gzip - /usr/bin/gzip
[12:43:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:43:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:43:06] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:43:06] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:43:06] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:43:06] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:43:06] Marked 0 heterozygous sites with 'n'
[12:43:06] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:43:06] Creating extra output files: BED GFF CSV TXT HTML
[12:43:06] Identified 101 variants.
[12:43:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out
[12:43:06] Result files:
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.aligned.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bam.bai
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.bed
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.consensus.subs.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.csv
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.filt.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.gff
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.html
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.log
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.raw.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.subs.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.tab
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.txt
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out/snps.vcf.gz.csi
[12:43:06] Walltime used: 19 seconds
[12:43:06] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:43:06] Done.
[Tue Jun 16 12:43:06 2020]
Finished job 80.
186 of 202 steps (92%) done

[Tue Jun 16 12:43:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
    jobid: 10
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_YA6631AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[12:43:06] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:43:06] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:43:06] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:43:06] Treating reference as 'fasta' format.
[12:43:06] Will use 8 CPU cores.
[12:43:06] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta
[12:43:06] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[12:43:06] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[12:43:06] Creating reference folder: reference
[12:43:06] Extracting FASTA and GFF from reference.
[12:43:06] Marked 0 heterozygous sites with 'n'
[12:43:06] Wrote 3 sequences to ref.fa
[12:43:06] Wrote 0 features to ref.gff
[12:43:06] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_VA1155AA_AS.fasta into pseudo-reads
[12:43:06] Creating extra output files: BED GFF CSV TXT HTML
[12:43:06] Identified 98 variants.
[12:43:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out
[12:43:06] Result files:
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.aligned.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bam.bai
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.bed
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.consensus.subs.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.csv
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.filt.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.gff
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.html
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.log
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.raw.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.subs.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.tab
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.txt
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out/snps.vcf.gz.csi
[12:43:06] Walltime used: 19 seconds
[12:43:06] Questionable SNP? Try the --report option to see the alignments.
[12:43:06] Done.
[Tue Jun 16 12:43:06 2020]
Finished job 144.
187 of 202 steps (93%) done

[Tue Jun 16 12:43:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
    jobid: 150
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_BA5105AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:43:06] Marked 0 heterozygous sites with 'n'
[12:43:06] Creating extra output files: BED GFF CSV TXT HTML
[12:43:06] Identified 86 variants.
[12:43:06] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out
[12:43:06] Result files:
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.aligned.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bam.bai
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.bed
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.consensus.subs.fa
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.csv
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.filt.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.gff
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.html
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.log
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.raw.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.subs.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.tab
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.txt
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz
[12:43:06] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out/snps.vcf.gz.csi
[12:43:06] Walltime used: 19 seconds
[12:43:06] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:43:06] Done.
[Tue Jun 16 12:43:06 2020]
Finished job 55.
188 of 202 steps (93%) done

[Tue Jun 16 12:43:06 2020]
rule snippy_run:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
    jobid: 133
    wildcards: output_prefix=Agona_200, reference=SG17-135, sample=SAL_JB5195AA_AS
    threads: 5

snippy --outdir /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa --ctgs /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[M::mem_process_seqs] Processed 320088 reads in 21.248 CPU sec, 2.824 real sec
[12:43:06] This is snippy 4.4.3
[12:43:06] Written by Torsten Seemann
[12:43:06] Obtained from https://github.com/tseemann/snippy
[12:43:06] Detected operating system: linux
[12:43:06] Enabling bundled linux tools.
[12:43:06] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:43:06] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:43:06] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:43:06] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:43:06] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:43:06] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:43:06] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:43:06] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:43:06] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:43:06] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:43:06] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:43:06] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:43:06] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:43:06] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:43:06] Found gzip - /usr/bin/gzip
[12:43:06] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:43:06] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:43:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:43:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:43:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[samclip] Processed 100000 records...
[12:43:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:43:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:43:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:43:07] This is snippy 4.4.3
[12:43:07] Written by Torsten Seemann
[12:43:07] Obtained from https://github.com/tseemann/snippy
[12:43:07] Detected operating system: linux
[12:43:07] Enabling bundled linux tools.
[12:43:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:43:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:43:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:43:07] Treating reference as 'fasta' format.
[12:43:07] Will use 8 CPU cores.
[12:43:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta
[12:43:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[12:43:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[12:43:07] Creating reference folder: reference
[12:43:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:43:07] Extracting FASTA and GFF from reference.
[12:43:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:43:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:43:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:43:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:43:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:43:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:43:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:43:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:43:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:43:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:43:07] Found gzip - /usr/bin/gzip
[12:43:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:43:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:43:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:43:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[12:43:07] Checking version: java -version is >= 1.8 - ok, have 1.8
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[12:43:07] Wrote 3 sequences to ref.fa
[12:43:07] Wrote 0 features to ref.gff
[12:43:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_YA6631AA_AS.fasta into pseudo-reads
[M::mem_process_seqs] Processed 57226 reads in 4.077 CPU sec, 0.469 real sec
[12:43:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:43:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:43:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[samclip] Processed 200000 records...
[12:43:07] Treating reference as 'fasta' format.
[12:43:07] Will use 8 CPU cores.
[12:43:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta
[12:43:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[12:43:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[12:43:07] Creating reference folder: reference
[12:43:07] Extracting FASTA and GFF from reference.
[12:43:07] Running: samtools index snps.bam 2>> snps.log
[12:43:07] This is snippy 4.4.3
[12:43:07] Written by Torsten Seemann
[12:43:07] Obtained from https://github.com/tseemann/snippy
[12:43:07] Detected operating system: linux
[12:43:07] Enabling bundled linux tools.
[12:43:07] Wrote 3 sequences to ref.fa
[12:43:07] Wrote 0 features to ref.gff
[12:43:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_BA5105AA_AS.fasta into pseudo-reads
[12:43:07] Found bwa - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bwa
[12:43:07] Found bcftools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bcftools
[12:43:07] Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
[12:43:07] Found java - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/java
[12:43:07] Found snpEff - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snpEff
[12:43:07] Found samclip - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samclip
[12:43:07] Found seqtk - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/seqtk
[12:43:07] Found parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/parallel
[12:43:07] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:07] Found freebayes - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes
[12:43:07] Found freebayes-parallel - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/freebayes-parallel
[12:43:07] Found fasta_generate_regions.py - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/fasta_generate_regions.py
[12:43:07] Found vcfstreamsort - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfstreamsort
[12:43:07] Found vcfuniq - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcfuniq
[12:43:07] Found vcffirstheader - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vcffirstheader
[12:43:07] Found gzip - /usr/bin/gzip
[12:43:07] Found vt - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/vt
[12:43:07] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:07] Found snippy-vcf_to_tab - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab
[12:43:07] Found snippy-vcf_report - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_report
[12:43:07] Checking version: samtools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: bcftools --version is >= 1.7 - ok, have 1.9
[12:43:07] Checking version: freebayes --version is >= 1.1 - ok, have 1.3
[samclip] Processed 300000 records...
[12:43:07] Checking version: java -version is >= 1.8 - ok, have 1.8
[12:43:07] Checking version: snpEff -version is >= 4.3 - ok, have 4.3
[12:43:07] Checking version: bwa is >= 7.12 - ok, have 7.17
[12:43:07] Using reference: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
[12:43:07] Treating reference as 'fasta' format.
[12:43:07] Will use 8 CPU cores.
[12:43:07] Using read file: /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta
[12:43:07] Creating folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[12:43:07] Changing working directory: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[12:43:07] Creating reference folder: reference
[12:43:07] Extracting FASTA and GFF from reference.
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_KB4651AA_AS.out\tSM:SAL_KB4651AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.216 sec; CPU: 25.893 sec
[samclip] Total SAM records 377664, removed 1635, allowed 449, passed 376029
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:43:07] Wrote 3 sequences to ref.fa
[12:43:07] Wrote 0 features to ref.gff
[12:43:07] Shredding /data/malcummi/Manuscripts/Salmonella_AMR/Agona_assemblies/Agona_no_ref/SAL_JB5195AA_AS.fasta into pseudo-reads
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:43:09] Wrote 380298 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:09] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:09] Using BAM RG (Read Group) ID: SAL_VA1155AA_AS.out
[12:43:09] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:09] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:43:09] Running: bwa index reference/ref.fa 2>> snps.log

stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1701
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:43:09] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:09] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:09] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:09] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:09] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:09] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:09] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:09] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:09] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:09] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:09] Running: samtools index snps.bam 2>> snps.log
[12:43:10] Wrote 381088 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:10] Using BAM RG (Read Group) ID: SAL_YA6631AA_AS.out
[12:43:10] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:10] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:10] Running: bwa index reference/ref.fa 2>> snps.log
[12:43:10] Wrote 380120 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:10] Using BAM RG (Read Group) ID: SAL_BA5105AA_AS.out
[12:43:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:10] Running: bwa index reference/ref.fa 2>> snps.log
[12:43:10] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 6
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 6

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 6
       total no. variants observed              : 65
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:10] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:10] Wrote 388682 fake 250bp reads (20x, stride 25bp) to fake_reads.fq
[12:43:10] Freebayes will process 15 chunks of 349241 bp, 8 chunks at a time.
[12:43:10] Using BAM RG (Read Group) ID: SAL_JB5195AA_AS.out
[12:43:10] Running: samtools faidx reference/ref.fa 2>> snps.log
[12:43:10] Running: bwa index reference/ref.fa 2>> snps.log
[12:43:10] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:10] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:10] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:10] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:10] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:10] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:11] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:11] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:11] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320230 sequences (80000192 bp)...
[M::process] read 60068 sequences (15013292 bp)...
[12:43:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:11] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:11] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:11] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:11] Running: bwa mem  -Y -M -R '@RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[12:43:11] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320044 sequences (80000428 bp)...
[M::process] read 61044 sequences (15249832 bp)...
[M::process] read 320060 sequences (80000344 bp)...
[12:43:12] Running: mkdir -p reference/genomes && cp -f reference/ref.fa reference/genomes/ref.fa 2>> snps.log
[12:43:12] Running: ln -sf reference/ref.fa . 2>> snps.log
[12:43:12] Running: ln -sf reference/ref.fa.fai . 2>> snps.log
[12:43:12] Running: mkdir -p reference/ref && gzip -c reference/ref.gff > reference/ref/genes.gff.gz 2>> snps.log
[12:43:12] Running: bwa mem  -Y -M -R '@RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out' -t 8 reference/ref.fa fake_reads.fq | samclip --max 10 --ref reference/ref.fa.fai | samtools sort -n -l 0 -T /tmp --threads 8 -m 500M | samtools fixmate -m - - | samtools sort -l 0 -T /tmp --threads 8 -m 500M | samtools markdup -T /tmp -r -s - - > snps.bam 2>> snps.log
[M::bwa_idx_load_from_disk] read 0 ALT contigs
[M::process] read 60060 sequences (15011480 bp)...
[samclip] samclip 0.2 by Torsten Seemann (@torstenseemann)
[samclip] Loading: reference/ref.fa.fai
[samclip] Found 3 sequences in reference/ref.fa.fai
[M::process] read 320082 sequences (80000226 bp)...
[M::process] read 68600 sequences (17150000 bp)...
[12:43:13] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 10
          no. right trimmed                     : 59
          no. left and right trimmed            : 3
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 72

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 72
       total no. variants observed              : 6603
       total no. reference observed             : 0

Time elapsed: 0.08s

[12:43:13] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:14] Marked 0 heterozygous sites with 'n'
[12:43:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:14] Creating extra output files: BED GFF CSV TXT HTML
[12:43:14] Identified 1701 variants.
[12:43:14] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out
[12:43:14] Result files:
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.aligned.fa
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bam.bai
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.bed
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.fa
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.consensus.subs.fa
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.csv
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.filt.vcf
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.gff
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.html
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.log
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.raw.vcf
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.subs.vcf
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.tab
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.txt
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz
[12:43:14] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out/snps.vcf.gz.csi
[12:43:14] Walltime used: 19 seconds
[12:43:14] Found a bug? Post it at https://github.com/tseemann/snippy/issues
[12:43:14] Done.
[Tue Jun 16 12:43:14 2020]
Finished job 23.
189 of 202 steps (94%) done
[12:43:14] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:14] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:14] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:14] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:14] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:14] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:14] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:14] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:14] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[M::mem_process_seqs] Processed 320230 reads in 22.628 CPU sec, 3.346 real sec
[M::mem_process_seqs] Processed 320060 reads in 17.999 CPU sec, 2.553 real sec
[samclip] Processed 100000 records...
[samclip] Processed 100000 records...
[12:43:15] Marked 0 heterozygous sites with 'n'
[M::mem_process_seqs] Processed 320044 reads in 18.802 CPU sec, 3.057 real sec
[12:43:15] Creating extra output files: BED GFF CSV TXT HTML
[M::mem_process_seqs] Processed 60060 reads in 3.651 CPU sec, 0.427 real sec
[12:43:15] Identified 65 variants.
[12:43:15] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out
[12:43:15] Result files:
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.aligned.fa
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bam.bai
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.bed
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.fa
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.consensus.subs.fa
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.csv
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.filt.vcf
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.gff
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.html
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.log
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.raw.vcf
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.subs.vcf
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.tab
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.txt
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz
[12:43:15] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out/snps.vcf.gz.csi
[12:43:15] Walltime used: 18 seconds
[12:43:15] Wishing you a life free of homopolymer errors.
[12:43:15] Done.
[Tue Jun 16 12:43:15 2020]
Finished job 102.
190 of 202 steps (94%) done
[M::mem_process_seqs] Processed 60068 reads in 4.537 CPU sec, 0.534 real sec
[samclip] Processed 200000 records...
[samclip] Processed 200000 records...
[samclip] Processed 100000 records...
[samclip] Processed 300000 records...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 320082 reads in 17.802 CPU sec, 2.828 real sec
[M::mem_process_seqs] Processed 61044 reads in 4.197 CPU sec, 0.490 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_VA1155AA_AS.out\tSM:SAL_VA1155AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.778 sec; CPU: 27.719 sec
[samclip] Total SAM records 380650, removed 1633, allowed 584, passed 379017
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_BA5105AA_AS.out\tSM:SAL_BA5105AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 3.989 sec; CPU: 22.250 sec
[samclip] Total SAM records 380432, removed 950, allowed 256, passed 379482
[samclip] Header contained 5 lines
[samclip] Done.
[samclip] Processed 100000 records...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[M::mem_process_seqs] Processed 68600 reads in 4.227 CPU sec, 0.490 real sec
[samclip] Processed 200000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_YA6631AA_AS.out\tSM:SAL_YA6631AA_AS.out -t 8 reference/ref.fa fake_reads.fq
[main] Real time: 4.460 sec; CPU: 23.569 sec
[samclip] Total SAM records 382314, removed 2907, allowed 309, passed 379407
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[samclip] Processed 300000 records...
[main] Version: 0.7.17-r1188
[main] CMD: bwa mem -Y -M -R @RG\tID:SAL_JB5195AA_AS.out\tSM:SAL_JB5195AA_AS.out -t 8 reference/ref.fa fake_reads.fq[samclip] Total SAM records 389159, removed 1713, allowed 88, passed 387446

[main] Real time: 4.230 sec; CPU: 22.582 sec
[samclip] Header contained 5 lines
[samclip] Done.
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[bam_sort_core] merging from 0 files and 8 in-memory blocks...
[12:43:17] Running: samtools index snps.bam 2>> snps.log
[12:43:17] Running: samtools index snps.bam 2>> snps.log
[12:43:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:18] Running: samtools index snps.bam 2>> snps.log
[12:43:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:18] Running: samtools index snps.bam 2>> snps.log
[12:43:18] Running: fasta_generate_regions.py reference/ref.fa.fai 349241 > reference/ref.txt 2>> snps.log
[12:43:18] Running: freebayes-parallel reference/ref.txt 8 -p 2 -P 0 -C 10 --min-repeat-entropy 1.5 --strict-vcf -q 13 -m 60 --min-coverage 10 -F 0.05  -f reference/ref.fa snps.bam > snps.raw.vcf 2>> snps.log
[12:43:18] Marked 2 heterozygous sites with 'n'
[12:43:19] Creating extra output files: BED GFF CSV TXT HTML
[12:43:19] Identified 6603 variants.
[12:43:19] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out
[12:43:19] Result files:
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.aligned.fa
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bam.bai
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.bed
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.fa
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.consensus.subs.fa
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.csv
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.filt.vcf
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.gff
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.html
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.log
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.raw.vcf
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.subs.vcf
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.tab
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.txt
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz
[12:43:19] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out/snps.vcf.gz.csi
[12:43:19] Walltime used: 21 seconds
[12:43:19] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:43:19] Done.
[Tue Jun 16 12:43:19 2020]
Finished job 87.
191 of 202 steps (95%) done
[12:43:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa


stats: biallelic
          no. left trimmed                      : 2
          no. right trimmed                     : 21
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 25

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 25
       total no. variants observed              : 1678
       total no. reference observed             : 0

Time elapsed: 0.02s

[12:43:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:21] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:21] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:43:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
[12:43:21] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:43:21] Running: rm -f fake_reads\.fq 2>> snps.log

stats: biallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 9
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 9

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 9
       total no. variants observed              : 126
       total no. reference observed             : 0

Time elapsed: 0.00s

[12:43:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log

stats: biallelic
          no. left trimmed                      : 11
          no. right trimmed                     : 62
          no. left and right trimmed            : 5
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 78

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 78
       total no. variants observed              : 7174
       total no. reference observed             : 0

Time elapsed: 0.09s

[12:43:21] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:21] Running: bcftools view --include 'FMT/GT="1/1" && QUAL>=100 && FMT/DP>=10 && (FMT/AO)/(FMT/DP)>=0' snps.raw.vcf  | vt normalize -r reference/ref.fa - | bcftools annotate --remove '^INFO/TYPE,^INFO/DP,^INFO/RO,^INFO/AO,^INFO/AB,^FORMAT/GT,^FORMAT/DP,^FORMAT/RO,^FORMAT/AO,^FORMAT/QR,^FORMAT/QA,^FORMAT/GL' > snps.filt.vcf 2>> snps.log
normalize v0.5

options:     input VCF file                                  -
         [o] output VCF file                                 -
         [w] sorting window size                             10000
         [n] no fail on reference inconsistency for non SNPs false
         [q] quiet                                           false
         [d] debug                                           false
         [r] reference FASTA file                            reference/ref.fa

[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:21] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log

stats: biallelic
          no. left trimmed                      : 1
          no. right trimmed                     : 34
          no. left and right trimmed            : 2
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. biallelic normalized           : 37

       multiallelic
          no. left trimmed                      : 0
          no. right trimmed                     : 0
          no. left and right trimmed            : 0
          no. right trimmed and left aligned    : 0
          no. left aligned                      : 0

       total no. multiallelic normalized        : 0

       total no. variants normalized            : 37
       total no. variants observed              : 2446
       total no. reference observed             : 0

Time elapsed: 0.03s

[12:43:21] Running: cp snps.filt.vcf snps.vcf 2>> snps.log
[12:43:21] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:21] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_to_tab --gff reference/ref.gff --ref reference/ref.fa --vcf snps.vcf > snps.tab 2>> snps.log
[12:43:21] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:22] Running: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snippy-vcf_extract_subs snps.filt.vcf > snps.subs.vcf 2>> snps.log
[12:43:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:22] Running: bcftools convert -Oz -o snps.vcf.gz snps.vcf 2>> snps.log
[12:43:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools index -f snps.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.fa snps.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools convert -Oz -o snps.subs.vcf.gz snps.subs.vcf 2>> snps.log
[12:43:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:22] Running: bcftools index -f snps.subs.vcf.gz 2>> snps.log
[12:43:22] Running: bcftools consensus -f reference/ref.fa -o snps.consensus.subs.fa snps.subs.vcf.gz 2>> snps.log
[12:43:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:22] Running: rm -f snps.subs.vcf.gz snps.subs.vcf.gz.csi snps.subs.vcf.gz.tbi 2>> snps.log
[12:43:22] Running: rm -f fake_reads\.fq 2>> snps.log
[12:43:22] Generating reference aligned/masked FASTA relative to reference: snps.aligned.fa
[12:43:25] Marked 0 heterozygous sites with 'n'
[12:43:25] Creating extra output files: BED GFF CSV TXT HTML
[12:43:26] Identified 1678 variants.
[12:43:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out
[12:43:26] Result files:
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.aligned.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bam.bai
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.bed
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.consensus.subs.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.csv
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.filt.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.gff
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.html
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.log
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.raw.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.subs.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.tab
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.txt
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out/snps.vcf.gz.csi
[12:43:26] Walltime used: 19 seconds
[12:43:26] Wishing you a life free of homopolymer errors.
[12:43:26] Done.
[Tue Jun 16 12:43:26 2020]
Finished job 150.
192 of 202 steps (95%) done
[12:43:26] Marked 0 heterozygous sites with 'n'
[12:43:26] Creating extra output files: BED GFF CSV TXT HTML
[12:43:26] Identified 126 variants.
[12:43:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out
[12:43:26] Result files:
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.aligned.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bam.bai
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.bed
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.consensus.subs.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.csv
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.filt.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.gff
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.html
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.log
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.raw.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.subs.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.tab
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.txt
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out/snps.vcf.gz.csi
[12:43:26] Walltime used: 19 seconds
[12:43:26] Have a suggestion? Tell me at https://github.com/tseemann/snippy/issues
[12:43:26] Done.
[Tue Jun 16 12:43:26 2020]
Finished job 133.
193 of 202 steps (96%) done
[12:43:26] Marked 0 heterozygous sites with 'n'
[12:43:26] Creating extra output files: BED GFF CSV TXT HTML
[12:43:26] Identified 2446 variants.
[12:43:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out
[12:43:26] Result files:
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.aligned.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bam.bai
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.bed
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.consensus.subs.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.csv
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.filt.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.gff
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.html
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.log
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.raw.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.subs.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.tab
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.txt
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out/snps.vcf.gz.csi
[12:43:26] Walltime used: 20 seconds
[12:43:26] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:43:26] Done.
[Tue Jun 16 12:43:26 2020]
Finished job 10.
194 of 202 steps (96%) done
[12:43:26] Marked 10 heterozygous sites with 'n'
[12:43:26] Creating extra output files: BED GFF CSV TXT HTML
[12:43:26] Identified 7174 variants.
[12:43:26] Result folder: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out
[12:43:26] Result files:
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.aligned.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bam.bai
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.bed
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.consensus.subs.fa
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.csv
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.filt.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.gff
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.html
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.log
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.raw.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.subs.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.tab
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.txt
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz
[12:43:26] * /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out/snps.vcf.gz.csi
[12:43:26] Walltime used: 20 seconds
[12:43:26] Did you know? Snippy is a combination of SNP, Skippy, and snappy.
[12:43:26] Done.
[Tue Jun 16 12:43:26 2020]
Finished job 36.
195 of 202 steps (97%) done

[Tue Jun 16 12:43:26 2020]
rule snippy_core:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
    jobid: 201
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32


        snippy-core --prefix /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135 --ref /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/*.out
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
This is snippy-core 4.4.3
Obtained from http://github.com/tseemann/snippy
Enabling bundled tools.
Found any2fasta - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/binaries/noarch/any2fasta
Found samtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/samtools
Found minimap2 - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/minimap2
Found bedtools - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/bedtools
Found snp-sites - /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609/bin/snp-sites
Saving reference FASTA: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.ref.fa
This is any2fasta 0.4.2
Opening '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Detected FASTA format
Read 64410 lines from '/home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/data/refs/SG17-135.fa'
Wrote 3 sequences from FASTA file.
Processed 1 files.
Done.
Loaded 3 sequences totalling 5152410 bp.
Will mask 0 regions totalling 0 bp ~ 0.00%
0	SAL_AB5642AA_AS.out	snp=182	del=42	ins=8	het=0	unaligned=445626
1	SAL_AB5674AA_AS.out	snp=942	del=14	ins=50	het=0	unaligned=500594
2	SAL_AB5906AA_AS.out	snp=215	del=25	ins=8	het=0	unaligned=478900
3	SAL_AB5909AA_AS.out	snp=115	del=24	ins=5	het=0	unaligned=485170
4	SAL_AB6160AA_AS.out	snp=130	del=3	ins=5	het=0	unaligned=440603
5	SAL_AB7534AA_AS.out	snp=13	del=1	ins=1	het=68	unaligned=425297
6	SAL_AB7542AA_AS.out	snp=25	del=10	ins=8	het=0	unaligned=435908
7	SAL_AB7588AA_AS.out	snp=357	del=20	ins=40	het=216	unaligned=452649
8	SAL_AB7634AA_AS.out	snp=12	del=10	ins=7	het=0	unaligned=443024
9	SAL_AB8884AA_AS.out	snp=60	del=10	ins=17	het=0	unaligned=433934
10	SAL_AB9321AA_AS.out	snp=357	del=19	ins=25	het=224	unaligned=454860
11	SAL_BA5105AA_AS.out	snp=1835	del=49	ins=47	het=0	unaligned=501233
12	SAL_BA7932AA_AS.out	snp=22	del=2	ins=4	het=0	unaligned=439729
13	SAL_BA7945AA_AS.out	snp=2136	del=23	ins=56	het=0	unaligned=482931
14	SAL_BA8052AA_AS.out	snp=15	del=1	ins=1	het=0	unaligned=433098
15	SAL_BB0648AA_AS.out	snp=382	del=27	ins=60	het=430	unaligned=487563
16	SAL_BB1066AA_AS.out	snp=68	del=1	ins=9	het=0	unaligned=492941
17	SAL_BB1371AA_AS.out	snp=384	del=27	ins=53	het=432	unaligned=477178
18	SAL_BB1424AA_AS.out	snp=18	del=2	ins=1	het=0	unaligned=462047
19	SAL_BB1915AA_AS.out	snp=19	del=1	ins=0	het=0	unaligned=471321
20	SAL_BB1956AA_AS.out	snp=24	del=7	ins=7	het=0	unaligned=429822
21	SAL_BB2131AA_AS.out	snp=22	del=10	ins=2	het=0	unaligned=457273
22	SAL_BB2593AA_AS.out	snp=2238	del=68	ins=57	het=151	unaligned=477954
23	SAL_BB2899AA_AS.out	snp=15	del=1	ins=0	het=0	unaligned=473454
24	SAL_BB2967AA_AS.out	snp=49	del=8	ins=1	het=0	unaligned=429507
25	SAL_BB2970AA_AS.out	snp=12	del=3	ins=2	het=0	unaligned=454351
26	SAL_BB3127AA_AS.out	snp=17	del=1	ins=1	het=0	unaligned=431185
27	SAL_BB4431AA_AS.out	snp=16	del=1	ins=0	het=0	unaligned=447855
28	SAL_BB4524AA_AS.out	snp=17	del=7	ins=1	het=0	unaligned=429092
29	SAL_BB4921AA_AS.out	snp=2171	del=41	ins=68	het=0	unaligned=470442
30	SAL_BB4937AA_AS.out	snp=26	del=1	ins=1	het=0	unaligned=450484
31	SAL_BB5050AA_AS.out	snp=25	del=1	ins=1	het=0	unaligned=450435
32	SAL_BB5062AA_AS.out	snp=55	del=3	ins=4	het=0	unaligned=450035
33	SAL_BB6441AA_AS.out	snp=145	del=15	ins=5	het=0	unaligned=419421
34	SAL_BB6687AA_AS.out	snp=91	del=2	ins=13	het=0	unaligned=491312
35	SAL_BB7027AA_AS.out	snp=20	del=1	ins=1	het=0	unaligned=433286
36	SAL_BB7197AA_AS.out	snp=22	del=1	ins=1	het=0	unaligned=428581
37	SAL_BB7261AA_AS.out	snp=17	del=1	ins=1	het=1	unaligned=430804
38	SAL_BB7947AA_AS.out	snp=183	del=6	ins=5	het=1	unaligned=439268
39	SAL_BB8135AA_AS.out	snp=21	del=1	ins=1	het=0	unaligned=428995
40	SAL_BB8331AA_AS.out	snp=2887	del=23	ins=54	het=1	unaligned=510146
41	SAL_BB9086AA_AS.out	snp=17	del=1	ins=13	het=236	unaligned=436116
42	SAL_BB9562AA_AS.out	snp=19	del=2	ins=2	het=0	unaligned=428737
43	SAL_BB9988AA_AS.out	snp=41	del=2	ins=1	het=0	unaligned=433129
44	SAL_CA4728AA_AS.out	snp=112	del=9	ins=9	het=1	unaligned=492607
45	SAL_CA4744AA_AS.out	snp=2141	del=21	ins=57	het=0	unaligned=477717
46	SAL_CA4803AA_AS.out	snp=2156	del=20	ins=54	het=0	unaligned=492612
47	SAL_CB0053AA_AS.out	snp=25	del=1	ins=4	het=0	unaligned=439538
48	SAL_CB0088AA_AS.out	snp=25	del=1	ins=0	het=0	unaligned=453288
49	SAL_CB1153AA_AS.out	snp=361	del=21	ins=40	het=216	unaligned=452235
50	SAL_CB1324AA_AS.out	snp=14	del=3	ins=2	het=0	unaligned=448816
51	SAL_CB1790AA_AS.out	snp=28	del=1	ins=4	het=0	unaligned=429741
52	SAL_CB2372AA_AS.out	snp=14	del=1	ins=1	het=1	unaligned=431433
53	SAL_CB2598AA_AS.out	snp=23	del=67	ins=3	het=0	unaligned=450203
54	SAL_CB2669AA_AS.out	snp=13	del=11	ins=1	het=0	unaligned=432606
55	SAL_CB3409AA_AS.out	snp=105	del=82	ins=9	het=0	unaligned=489134
56	SAL_CB3497AA_AS.out	snp=98	del=2	ins=2	het=0	unaligned=437109
57	SAL_CB5243AA_AS.out	snp=16	del=3	ins=3	het=0	unaligned=447151
58	SAL_CB5376AA_AS.out	snp=23	del=10	ins=1	het=0	unaligned=475461
59	SAL_CB5379AA_AS.out	snp=9	del=23	ins=1	het=0	unaligned=432804
60	SAL_CB5468AA_AS.out	snp=24	del=11	ins=1	het=0	unaligned=428976
61	SAL_CB6250AA_AS.out	snp=103	del=34	ins=3	het=0	unaligned=489069
62	SAL_CB9243AA_AS.out	snp=23	del=10	ins=1	het=0	unaligned=433761
63	SAL_CB9389AA_AS.out	snp=25	del=1	ins=1	het=0	unaligned=452454
64	SAL_CB9820AA_AS.out	snp=20	del=1	ins=1	het=0	unaligned=454161
65	SAL_CB9822AA_AS.out	snp=15	del=1	ins=1	het=0	unaligned=436302
66	SAL_CB9835AA_AS.out	snp=584	del=86	ins=17	het=0	unaligned=474879
67	SAL_CB9988AA_AS.out	snp=653	del=18	ins=26	het=0	unaligned=468036
68	SAL_DB1444AA_AS.out	snp=136	del=14	ins=5	het=26	unaligned=495052
69	SAL_EA3229AA_AS.out	snp=2165	del=22	ins=58	het=0	unaligned=476726
70	SAL_EB1026AA_AS.out	snp=10	del=1	ins=17	het=0	unaligned=433054
71	SAL_EB1045AA_AS.out	snp=414	del=24	ins=26	het=236	unaligned=451693
72	SAL_EB2895AA_AS.out	snp=35	del=1	ins=1	het=0	unaligned=430989
73	SAL_EB4083AA_AS.out	snp=106	del=34	ins=3	het=1	unaligned=489128
74	SAL_EB4088AA_AS.out	snp=17	del=1	ins=13	het=0	unaligned=435647
75	SAL_EB5876AA_AS.out	snp=2183	del=14	ins=58	het=0	unaligned=494656
76	SAL_EB6812AA_AS.out	snp=20	del=6	ins=2	het=0	unaligned=436001
77	SAL_EB8845AA_AS.out	snp=20	del=1	ins=1	het=1	unaligned=424985
78	SAL_FA1940AA_AS.out	snp=2127	del=29	ins=55	het=22	unaligned=483830
79	SAL_FA2493AA_AS.out	snp=258	del=12	ins=22	het=12	unaligned=462145
80	SAL_FA5706AA_AS.out	snp=2036	del=28	ins=53	het=7	unaligned=472577
81	SAL_FB5769AA_AS.out	snp=14	del=3	ins=2	het=0	unaligned=446572
82	SAL_FB7879AA_AS.out	snp=2624	del=27	ins=52	het=169	unaligned=459870
83	SAL_FB8051AA_AS.out	snp=20	del=10	ins=1	het=0	unaligned=529916
84	SAL_GB0225AA_AS.out	snp=16	del=6	ins=2	het=0	unaligned=437578
85	SAL_GB5373AA_AS.out	snp=905	del=26	ins=28	het=0	unaligned=493837
86	SAL_HB2219AA_AS.out	snp=14	del=1	ins=7	het=0	unaligned=430476
87	SAL_HB2224AA_AS.out	snp=21	del=10	ins=1	het=0	unaligned=424955
88	SAL_HB2237AA_AS.out	snp=902	del=26	ins=27	het=0	unaligned=492551
89	SAL_HB5660AA_AS.out	snp=113	del=24	ins=13	het=0	unaligned=485694
90	SAL_HB6699AA_AS.out	snp=64	del=10	ins=4	het=4	unaligned=457150
91	SAL_IA5065AA_AS.out	snp=2199	del=22	ins=57	het=0	unaligned=494061
92	SAL_IB1406AA_AS.out	snp=33	del=10	ins=1	het=0	unaligned=450789
93	SAL_IB3115AA_AS.out	snp=1852	del=120	ins=49	het=0	unaligned=497586
94	SAL_IB6779AA_AS.out	snp=2287	del=56	ins=61	het=0	unaligned=498247
95	SAL_IB6801AA_AS.out	snp=41	del=1	ins=1	het=0	unaligned=431592
96	SAL_IB7540AA_AS.out	snp=400	del=22	ins=26	het=224	unaligned=452028
97	SAL_IB7996AA_AS.out	snp=18	del=1	ins=1	het=0	unaligned=428956
98	SAL_IB9118AA_AS.out	snp=184	del=19	ins=12	het=4	unaligned=468420
99	SAL_IB9302AA_AS.out	snp=25	del=7	ins=0	het=0	unaligned=460664
100	SAL_JA4169AA_AS.out	snp=28	del=1	ins=15	het=0	unaligned=449094
101	SAL_JB0953AA_AS.out	snp=1990	del=13	ins=45	het=78	unaligned=498634
102	SAL_JB1150AA_AS.out	snp=4326	del=90	ins=107	het=53	unaligned=511625
103	SAL_JB4414AA_AS.out	snp=129	del=3	ins=5	het=0	unaligned=436417
104	SAL_JB5195AA_AS.out	snp=118	del=42	ins=2	het=0	unaligned=643923
105	SAL_JB5221AA_AS.out	snp=64	del=6	ins=2	het=0	unaligned=496464
106	SAL_JB6580AA_AS.out	snp=13	del=10	ins=1	het=0	unaligned=445733
107	SAL_JB9521AA_AS.out	snp=71	del=5	ins=2	het=0	unaligned=452706
108	SAL_JB9710AA_AS.out	snp=409	del=22	ins=40	het=198	unaligned=448903
109	SAL_KA0676AA_AS.out	snp=11	del=1	ins=1	het=0	unaligned=456413
110	SAL_KA0984AA_AS.out	snp=317	del=7	ins=3	het=41	unaligned=468314
111	SAL_KA1119AA_AS.out	snp=16	del=1	ins=0	het=0	unaligned=433355
112	SAL_KA4888AA_AS.out	snp=33	del=20	ins=3	het=0	unaligned=418336
113	SAL_KA5244AA_AS.out	snp=6	del=10	ins=7	het=4	unaligned=424842
114	SAL_KA8881AA_AS.out	snp=986	del=33	ins=38	het=374	unaligned=451257
115	SAL_KB1136AA_AS.out	snp=2150	del=30	ins=56	het=0	unaligned=485693
116	SAL_KB1789AA_AS.out	snp=2892	del=23	ins=54	het=1	unaligned=510985
117	SAL_KB1826AA_AS.out	snp=550	del=61	ins=16	het=0	unaligned=477081
118	SAL_KB2744AA_AS.out	snp=19	del=1	ins=7	het=0	unaligned=428444
119	SAL_KB3375AA_AS.out	snp=954	del=18	ins=29	het=0	unaligned=493014
120	SAL_KB3640AA_AS.out	snp=130	del=116	ins=8	het=0	unaligned=505200
121	SAL_KB4026AA_AS.out	snp=115	del=23	ins=10	het=24	unaligned=460680
122	SAL_KB4651AA_AS.out	snp=7355	del=124	ins=177	het=2	unaligned=533508
123	SAL_KB6210AA_AS.out	snp=20	del=2	ins=2	het=0	unaligned=429806
124	SAL_KB6734AA_AS.out	snp=99	del=11	ins=2	het=0	unaligned=495549
125	SAL_KB6773AA_AS.out	snp=271	del=22	ins=46	het=654	unaligned=490736
126	SAL_KB6830AA_AS.out	snp=1989	del=18	ins=64	het=11	unaligned=489822
127	SAL_KB8607AA_AS.out	snp=1832	del=42	ins=48	het=0	unaligned=497994
128	SAL_KB8676AA_AS.out	snp=431	del=35	ins=34	het=40	unaligned=473490
129	SAL_KB9523AA_AS.out	snp=147	del=20	ins=35	het=8	unaligned=494063
130	SAL_LA4572AA_AS.out	snp=127	del=9	ins=9	het=0	unaligned=486794
131	SAL_LA7782AA_AS.out	snp=2287	del=29	ins=64	het=9	unaligned=473932
132	SAL_LA7787AA_AS.out	snp=2321	del=27	ins=54	het=69	unaligned=472179
133	SAL_LB4034AA_AS.out	snp=1883	del=21	ins=48	het=0	unaligned=516596
134	SAL_LB7623AA_AS.out	snp=2377	del=23	ins=53	het=97	unaligned=490553
135	SAL_LB8076AA_AS.out	snp=497	del=35	ins=16	het=0	unaligned=451936
136	SAL_MA3067AA_AS.out	snp=492	del=2	ins=13	het=0	unaligned=464486
137	SAL_MB2521AA_AS.out	snp=303	del=39	ins=17	het=0	unaligned=451368
138	SAL_MB5439AA_AS.out	snp=1997	del=19	ins=65	het=0	unaligned=488147
139	SAL_MB7066AA_AS.out	snp=412	del=24	ins=27	het=199	unaligned=452079
140	SAL_MB7965AA_AS.out	snp=18	del=1	ins=6	het=0	unaligned=452272
141	SAL_NA2865AA_AS.out	snp=11	del=1	ins=1	het=0	unaligned=442577
142	SAL_NA5728AA_AS.out	snp=2004	del=26	ins=51	het=6	unaligned=529226
143	SAL_NA8627AA_AS.out	snp=377	del=27	ins=58	het=431	unaligned=477464
144	SAL_NB4129AA_AS.out	snp=2030	del=20	ins=57	het=0	unaligned=483720
145	SAL_NB6620AA_AS.out	snp=15	del=10	ins=1	het=0	unaligned=432044
146	SAL_OA4067AA_AS.out	snp=16	del=1	ins=2	het=0	unaligned=423923
147	SAL_OA4072AA_AS.out	snp=16	del=1	ins=2	het=1	unaligned=425979
148	SAL_OB6949AA_AS.out	snp=1868	del=19	ins=49	het=0	unaligned=498972
149	SAL_PA3767AA_AS.out	snp=2014	del=26	ins=48	het=0	unaligned=489942
150	SAL_PB5476AA_AS.out	snp=393	del=23	ins=42	het=150	unaligned=450870
151	SAL_PB8418AA_AS.out	snp=1982	del=20	ins=47	het=1	unaligned=495015
152	SAL_QA4878AA_AS.out	snp=539	del=35	ins=58	het=441	unaligned=466771
153	SAL_QA5436AA_AS.out	snp=901	del=28	ins=46	het=364	unaligned=455616
154	SAL_RA1578AA_AS.out	snp=16	del=10	ins=1	het=0	unaligned=424169
155	SAL_RA1599AA_AS.out	snp=15	del=10	ins=1	het=0	unaligned=425795
156	SAL_SA1324AA_AS.out	snp=23	del=10	ins=1	het=224	unaligned=425866
157	SAL_SA1344AA_AS.out	snp=9	del=10	ins=1	het=0	unaligned=423686
158	SAL_SA2453AA_AS.out	snp=1997	del=20	ins=48	het=0	unaligned=490787
159	SAL_SA9173AA_AS.out	snp=104	del=34	ins=3	het=0	unaligned=490802
160	SAL_SA9246AA_AS.out	snp=18	del=1	ins=13	het=0	unaligned=435538
161	SAL_SA9330AA_AS.out	snp=106	del=51	ins=2	het=0	unaligned=549158
162	SAL_TA1544AA_AS.out	snp=399	del=21	ins=41	het=228	unaligned=455204
163	SAL_TA1967AA_AS.out	snp=98	del=34	ins=18	het=0	unaligned=530657
164	SAL_TA2587AA_AS.out	snp=959	del=27	ins=38	het=380	unaligned=455206
165	SAL_TA4227AA_AS.out	snp=916	del=27	ins=38	het=381	unaligned=455510
166	SAL_TA6324AA_AS.out	snp=2010	del=13	ins=65	het=0	unaligned=487363
167	SAL_TA7615AA_AS.out	snp=2279	del=29	ins=52	het=95	unaligned=469510
168	SAL_UA4237AA_AS.out	snp=1983	del=19	ins=65	het=0	unaligned=488277
169	SAL_UA4307AA_AS.out	snp=914	del=31	ins=38	het=382	unaligned=454744
170	SAL_UA6621AA_AS.out	snp=1986	del=33	ins=53	het=0	unaligned=489817
171	SAL_UA7988AA_AS.out	snp=1972	del=34	ins=54	het=0	unaligned=503519
172	SAL_UA7989AA_AS.out	snp=2006	del=33	ins=52	het=0	unaligned=506489
173	SAL_VA1155AA_AS.out	snp=8038	del=112	ins=187	het=10	unaligned=529303
174	SAL_VA4537AA_AS.out	snp=1965	del=31	ins=54	het=0	unaligned=489119
175	SAL_WA2841AA_AS.out	snp=17	del=1	ins=1	het=0	unaligned=470280
176	SAL_WA5013AA_AS.out	snp=2261	del=32	ins=57	het=153	unaligned=475573
177	SAL_WA5463AA_AS.out	snp=2280	del=28	ins=52	het=189	unaligned=466557
178	SAL_WA5465AA_AS.out	snp=2268	del=27	ins=52	het=117	unaligned=464593
179	SAL_WA6251AA_AS.out	snp=332	del=23	ins=41	het=638	unaligned=476043
180	SAL_WA9926AA_AS.out	snp=23	del=3	ins=3	het=0	unaligned=447251
181	SAL_XA1299AA_AS.out	snp=22	del=12	ins=3	het=31	unaligned=440057
182	SAL_XA1733AA_AS.out	snp=79	del=13	ins=3	het=0	unaligned=519870
183	SAL_XA1782AA_AS.out	snp=140	del=2	ins=3	het=3	unaligned=468274
184	SAL_XA3156AA_AS.out	snp=26	del=1	ins=3	het=0	unaligned=427275
185	SAL_XA3268AA_AS.out	snp=92	del=37	ins=11	het=0	unaligned=479344
186	SAL_YA6600AA_AS.out	snp=2399	del=23	ins=72	het=96	unaligned=435696
187	SAL_YA6602AA_AS.out	snp=2403	del=24	ins=72	het=95	unaligned=443666
188	SAL_YA6631AA_AS.out	snp=2647	del=62	ins=82	het=0	unaligned=514171
189	SAL_YA6663AA_AS.out	snp=60	del=1	ins=10	het=0	unaligned=492831
190	SAL_YA7748AA_AS.out	snp=2007	del=22	ins=52	het=0	unaligned=489864
191	SAL_YA9385AA_AS.out	snp=1870	del=19	ins=48	het=0	unaligned=511360
192	SAL_ZA0287AA_AS.out	snp=2133	del=14	ins=57	het=0	unaligned=492379
193	SAL_ZA5298AA_AS.out	snp=403	del=22	ins=32	het=188	unaligned=444993
194	SAL_ZA8731AA_AS.out	snp=2260	del=58	ins=52	het=169	unaligned=468559
Opening: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.tab
Opening: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.vcf
Processing contig: CP048775.1
Processing contig: CP048776.1
Processing contig: CP048777.1
Generating /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
Creating TSV file: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.txt
Running: snp-sites -c -o /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.aln /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
This analysis is totally hard-core!
Done.
[Tue Jun 16 12:43:59 2020]
Finished job 201.
196 of 202 steps (97%) done

[Tue Jun 16 12:43:59 2020]
rule snippy_clean:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.clean.full.aln
    jobid: 200
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32

snippy-clean_full_aln /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.full.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.clean.full.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Tue Jun 16 12:44:30 2020]
Finished job 200.
197 of 202 steps (98%) done

[Tue Jun 16 12:44:30 2020]
rule gubbins:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.clean.full.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/gubbins/SG17-135.filtered_polymorphic_sites.fasta
    jobid: 199
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32


        run_gubbins.py -v -f 25 -p /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/gubbins/SG17-135 /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/core/SG17-135.clean.full.aln
        rm SG17-135.clean.full.aln.seq.joint.txt
        
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/0d285378


Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 distinct randomized MP trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s SG17-135.clean.full.aln.phylip -n SG17-135.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.231 0.274 0.265 0.231 

Inference[0]: Time 188.857008 CAT-based likelihood -157681.850495, best rearrangement setting 10


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 10.928872 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 24.593970 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 55.912488 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 128.023568 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 285.131295 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 647.801335 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.839585 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -157687.479613 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_1


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -157687.479613 .... 

Final GAMMA-based Score of best tree -157687.479522

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_1
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_1

Overall execution time: 377.219165 secs or 0.104783 hours or 0.004366 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpr17uu_yb/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.928010 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 24.592002 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 55.907962 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 128.013127 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 285.090936 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 647.708267 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.837243 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpr17uu_yb/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpr17uu_yb/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpr17uu_yb/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.182279



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2422 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.43%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2422
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_1.phylip -n SG17-135.clean.full.iteration_2 -t RAxML_result.SG17-135.clean.full.iteration_1 


Partition: 0 with name: No Name Provided
Base frequencies: 0.173 0.340 0.336 0.152 

Inference[0]: Time 80.590964 CAT-based likelihood -29232.873929, best rearrangement setting 15


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.144513 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.710074 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.486970 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 145.913451 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 326.872611 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 744.582645 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -29233.959265 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_2


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -29233.959265 .... 

Final GAMMA-based Score of best tree -29233.959265

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_2
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_2

Overall execution time: 157.881992 secs or 0.043856 hours or 0.001827 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpvr1velhw/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 10.099953 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 22.184049 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 49.352747 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 111.242685 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 244.150540 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 550.614230 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.811272 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpvr1velhw/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmpvr1velhw/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmpvr1velhw/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.488092



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2446 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.41%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2446
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_2.phylip -n SG17-135.clean.full.iteration_3 -t RAxML_result.SG17-135.clean.full.iteration_2 


Partition: 0 with name: No Name Provided
Base frequencies: 0.174 0.339 0.336 0.152 

Inference[0]: Time 49.858369 CAT-based likelihood -29464.558207, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.108209 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.604226 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.211642 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 145.239433 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 325.270811 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 740.838180 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -29465.659914 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_3


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -29465.659914 .... 

Final GAMMA-based Score of best tree -29465.652720

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_3
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_3

Overall execution time: 127.043071 secs or 0.035290 hours or 0.001470 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp0twfcd1_/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 21.785766 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.257378 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 108.376154 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 237.029117 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 533.585294 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.880673 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp0twfcd1_/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp0twfcd1_/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmp0twfcd1_/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.169640



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2456 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.64%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2456
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_3.phylip -n SG17-135.clean.full.iteration_4 -t RAxML_result.SG17-135.clean.full.iteration_3 


Partition: 0 with name: No Name Provided
Base frequencies: 0.174 0.339 0.335 0.152 

Inference[0]: Time 43.142740 CAT-based likelihood -29519.975458, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.100579 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.584995 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.165985 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 145.132986 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 325.024216 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 740.268215 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -29521.073738 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_4


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -29521.073738 .... 

Final GAMMA-based Score of best tree -29521.066469

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_4
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_4

Overall execution time: 120.347641 secs or 0.033430 hours or 0.001393 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmprh32vh13/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 21.785746 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.257332 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 108.376047 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 237.028877 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 533.584853 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.880675 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmprh32vh13/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmprh32vh13/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmprh32vh13/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.232817



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 2456 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 3.64%

RAxML rapid hill-climbing mode

Using 1 distinct models/data partitions with joint branch length optimization


Executing 1 inferences on the original alignment using 1 user-specified trees

All free model parameters will be estimated by RAxML
ML estimate of 25 per site rate categories

Likelihood of final tree will be evaluated and optimized under GAMMA

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 2456
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V -s RAxML_result.SG17-135.clean.full.iteration_4.phylip -n SG17-135.clean.full.iteration_5 -t RAxML_result.SG17-135.clean.full.iteration_4 


Partition: 0 with name: No Name Provided
Base frequencies: 0.174 0.339 0.335 0.152 

Inference[0]: Time 42.335412 CAT-based likelihood -29519.972900, best rearrangement setting 5


Conducting final model optimizations on all 1 trees under GAMMA-based models ....


WARNING the alpha parameter with a value of 12.100586 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 27.585013 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 63.166030 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 145.133074 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 325.024424 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 740.268618 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Inference[0] final GAMMA-based Likelihood: -29521.074270 tree written to file /data/malcummi/pipelord/snplord/RAxML_result.SG17-135.clean.full.iteration_5


Starting final GAMMA-based thorough Optimization on tree 0 likelihood -29521.074270 .... 

Final GAMMA-based Score of best tree -29521.066466

Program execution info written to /data/malcummi/pipelord/snplord/RAxML_info.SG17-135.clean.full.iteration_5
Best-scoring ML tree written to: /data/malcummi/pipelord/snplord/RAxML_bestTree.SG17-135.clean.full.iteration_5

Overall execution time: 118.421493 secs or 0.032895 hours or 0.001371 days


RAxML can't, parse the alignment file as phylip file 
it will now try to parse it as FASTA file



Using BFGS method to optimize GTR rate parameters, to disable this specify "--no-bfgs" 



This is RAxML version 8.2.12 released by Alexandros Stamatakis on May 2018.

With greatly appreciated code contributions by:
Andre Aberer      (HITS)
Simon Berger      (HITS)
Alexey Kozlov     (HITS)
Kassian Kobert    (HITS)
David Dao         (KIT and HITS)
Sarah Lutteropp   (KIT and HITS)
Nick Pattengale   (Sandia)
Wayne Pfeiffer    (SDSC)
Akifumi S. Tanabe (NRIFS)
Charlie Taylor    (UF)


Alignment has 4684 distinct alignment patterns

Proportion of gaps and completely undetermined characters in this alignment: 11.88%

RAxML marginal ancestral state computation

Using 1 distinct models/data partitions with joint branch length optimization


All free model parameters will be estimated by RAxML
GAMMA model of rate heterogeneity, ML estimate of alpha-parameter

GAMMA Model parameters will be estimated up to an accuracy of 0.1000000000 Log Likelihood units

Partition: 0
Alignment Patterns: 4684
Name: No Name Provided
DataType: DNA
Substitution Matrix: GTR




RAxML was called as follows:

raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp5xunrnsu/rooted_tree.newick -n internal 



WARNING the alpha parameter with a value of 21.785766 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 48.257379 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 108.376163 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 237.029141 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 533.585462 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 999.880675 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!


WARNING the alpha parameter with a value of 1000.000000 estimated by RAxML for partition number 0 with the name "No Name Provided"
is larger than 10.000000. You should do a model test and confirm that you actually need to incorporate a model of rate heterogeneity!
You can run inferences with a plain substitution model (without rate heterogeneity) by specifyng the CAT model and the "-V" option!

Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp5xunrnsu/RAxML_marginalAncestralProbabilities.internal

Ancestral Sequences based on Marginal Ancestral Probabilities written to file:
/data/malcummi/pipelord/snplord/tmp5xunrnsu/RAxML_marginalAncestralStates.internal

Node-laballed ROOTED tree written to file:
/data/malcummi/pipelord/snplord/tmp5xunrnsu/RAxML_nodeLabelledRootedTree.internal


Time for marginal ancestral state computation: 43.343467

Sample Reference has missing data percentage of 0.0
Sample SAL_AB5642AA_AS.out has missing data percentage of 9.029036897296605
Sample SAL_AB5674AA_AS.out has missing data percentage of 9.983599907616048
Sample SAL_AB5906AA_AS.out has missing data percentage of 9.590288816301499
Sample SAL_AB5909AA_AS.out has missing data percentage of 9.685060001048054
Sample SAL_AB6160AA_AS.out has missing data percentage of 8.885201294151669
Sample SAL_AB7534AA_AS.out has missing data percentage of 8.596540259800754
Sample SAL_AB7542AA_AS.out has missing data percentage of 8.768362766161854
Sample SAL_AB7588AA_AS.out has missing data percentage of 9.121925467887843
Sample SAL_AB7634AA_AS.out has missing data percentage of 8.895118983155456
Sample SAL_AB8884AA_AS.out has missing data percentage of 8.736416550701517
Sample SAL_AB9321AA_AS.out has missing data percentage of 9.2003159686438
Sample SAL_BA5105AA_AS.out has missing data percentage of 10.007452823047855
Sample SAL_BA7932AA_AS.out has missing data percentage of 9.069949790486394
Sample SAL_BA7945AA_AS.out has missing data percentage of 9.706525684097345
Sample SAL_BA8052AA_AS.out has missing data percentage of 8.781987458296214
Sample SAL_BB0648AA_AS.out has missing data percentage of 9.837260621728472
Sample SAL_BB1066AA_AS.out has missing data percentage of 9.966015903237514
Sample SAL_BB1371AA_AS.out has missing data percentage of 9.562709489345762
Sample SAL_BB1424AA_AS.out has missing data percentage of 9.20856453581916
Sample SAL_BB1915AA_AS.out has missing data percentage of 9.440223118889994
Sample SAL_BB1956AA_AS.out has missing data percentage of 8.693892760863363
Sample SAL_BB2131AA_AS.out has missing data percentage of 9.456778478420778
Sample SAL_BB2593AA_AS.out has missing data percentage of 9.797939216793695
Sample SAL_BB2899AA_AS.out has missing data percentage of 9.455070539805645
Sample SAL_BB2967AA_AS.out has missing data percentage of 8.68911829609833
Sample SAL_BB2970AA_AS.out has missing data percentage of 9.277813683305482
Sample SAL_BB3127AA_AS.out has missing data percentage of 8.664818987619386
Sample SAL_BB4431AA_AS.out has missing data percentage of 8.984397592582889
Sample SAL_BB4524AA_AS.out has missing data percentage of 8.66740030393544
Sample SAL_BB4921AA_AS.out has missing data percentage of 9.513450987013844
Sample SAL_BB4937AA_AS.out has missing data percentage of 9.079498720016458
Sample SAL_BB5050AA_AS.out has missing data percentage of 9.097373850295298
Sample SAL_BB5062AA_AS.out has missing data percentage of 9.002525031975328
Sample SAL_BB6441AA_AS.out has missing data percentage of 8.568999749631725
Sample SAL_BB6687AA_AS.out has missing data percentage of 9.79627009496527
Sample SAL_BB7027AA_AS.out has missing data percentage of 8.776960684417583
Sample SAL_BB7197AA_AS.out has missing data percentage of 8.703480507180135
Sample SAL_BB7261AA_AS.out has missing data percentage of 8.732690139177588
Sample SAL_BB7947AA_AS.out has missing data percentage of 8.829673880766476
Sample SAL_BB8135AA_AS.out has missing data percentage of 8.666294025514274
Sample SAL_BB8331AA_AS.out has missing data percentage of 10.23829625359783
Sample SAL_BB9086AA_AS.out has missing data percentage of 8.765994942172693
Sample SAL_BB9562AA_AS.out has missing data percentage of 8.632756321798926
Sample SAL_BB9988AA_AS.out has missing data percentage of 8.708643139812244
Sample SAL_CA4728AA_AS.out has missing data percentage of 9.855912087741464
Sample SAL_CA4744AA_AS.out has missing data percentage of 9.588367385359472
Sample SAL_CA4803AA_AS.out has missing data percentage of 9.898727003479925
Sample SAL_CB0053AA_AS.out has missing data percentage of 8.833070349603389
Sample SAL_CB0088AA_AS.out has missing data percentage of 9.115734190407984
Sample SAL_CB1153AA_AS.out has missing data percentage of 9.136675846836724
Sample SAL_CB1324AA_AS.out has missing data percentage of 9.07274459912934
Sample SAL_CB1790AA_AS.out has missing data percentage of 8.68777911695692
Sample SAL_CB2372AA_AS.out has missing data percentage of 8.770730590151016
Sample SAL_CB2598AA_AS.out has missing data percentage of 9.099547590350923
Sample SAL_CB2669AA_AS.out has missing data percentage of 8.730943383775747
Sample SAL_CB3409AA_AS.out has missing data percentage of 9.760675101554419
Sample SAL_CB3497AA_AS.out has missing data percentage of 8.833807868550833
Sample SAL_CB5243AA_AS.out has missing data percentage of 9.034820598516035
Sample SAL_CB5376AA_AS.out has missing data percentage of 9.539768768401583
Sample SAL_CB5379AA_AS.out has missing data percentage of 8.733388841338325
Sample SAL_CB5468AA_AS.out has missing data percentage of 8.694397379090562
Sample SAL_CB6250AA_AS.out has missing data percentage of 9.784974410033364
Sample SAL_CB9243AA_AS.out has missing data percentage of 8.770885857297847
Sample SAL_CB9389AA_AS.out has missing data percentage of 9.10240062417393
Sample SAL_CB9820AA_AS.out has missing data percentage of 9.145099089552268
Sample SAL_CB9822AA_AS.out has missing data percentage of 8.856379830021291
Sample SAL_CB9835AA_AS.out has missing data percentage of 9.588367385359472
Sample SAL_CB9988AA_AS.out has missing data percentage of 9.419786080688455
Sample SAL_DB1444AA_AS.out has missing data percentage of 9.850419512422341
Sample SAL_EA3229AA_AS.out has missing data percentage of 9.603020722341585
Sample SAL_EB1026AA_AS.out has missing data percentage of 8.72158853817922
Sample SAL_EB1045AA_AS.out has missing data percentage of 9.141566761961878
Sample SAL_EB2895AA_AS.out has missing data percentage of 8.683140510945364
Sample SAL_EB4083AA_AS.out has missing data percentage of 9.761529070861984
Sample SAL_EB4088AA_AS.out has missing data percentage of 8.757319390343548
Sample SAL_EB5876AA_AS.out has missing data percentage of 10.070355425907488
Sample SAL_EB6812AA_AS.out has missing data percentage of 8.721452679425745
Sample SAL_EB8845AA_AS.out has missing data percentage of 8.579402648469356
Sample SAL_FA1940AA_AS.out has missing data percentage of 9.774726778342561
Sample SAL_FA2493AA_AS.out has missing data percentage of 9.340522202231577
Sample SAL_FA5706AA_AS.out has missing data percentage of 9.52208772205628
Sample SAL_FB5769AA_AS.out has missing data percentage of 9.007357721920421
Sample SAL_FB7879AA_AS.out has missing data percentage of 9.492412288618336
Sample SAL_FB8051AA_AS.out has missing data percentage of 10.644572151672712
Sample SAL_GB0225AA_AS.out has missing data percentage of 8.777212993531183
Sample SAL_GB5373AA_AS.out has missing data percentage of 9.903404426278188
Sample SAL_HB2219AA_AS.out has missing data percentage of 8.6656535485336
Sample SAL_HB2224AA_AS.out has missing data percentage of 8.584875815395126
Sample SAL_HB2237AA_AS.out has missing data percentage of 9.892671584753543
Sample SAL_HB5660AA_AS.out has missing data percentage of 9.699325170163089
Sample SAL_HB6699AA_AS.out has missing data percentage of 9.291865360093626
Sample SAL_IA5065AA_AS.out has missing data percentage of 10.062281534272312
Sample SAL_IB1406AA_AS.out has missing data percentage of 9.123633406502977
Sample SAL_IB3115AA_AS.out has missing data percentage of 9.950469780161129
Sample SAL_IB6779AA_AS.out has missing data percentage of 10.016671809890905
Sample SAL_IB6801AA_AS.out has missing data percentage of 8.692883524408966
Sample SAL_IB7540AA_AS.out has missing data percentage of 9.144633288111777
Sample SAL_IB7996AA_AS.out has missing data percentage of 8.649893933130322
Sample SAL_IB9118AA_AS.out has missing data percentage of 9.39517623791585
Sample SAL_IB9302AA_AS.out has missing data percentage of 9.261588266461715
Sample SAL_JA4169AA_AS.out has missing data percentage of 8.977488204548939
Sample SAL_JB0953AA_AS.out has missing data percentage of 10.432981847329696
Sample SAL_JB1150AA_AS.out has missing data percentage of 10.240644669193639
Sample SAL_JB4414AA_AS.out has missing data percentage of 8.79338018519489
Sample SAL_JB5195AA_AS.out has missing data percentage of 13.999681702348997
Sample SAL_JB5221AA_AS.out has missing data percentage of 10.1134420591529
Sample SAL_JB6580AA_AS.out has missing data percentage of 8.96007887571059
Sample SAL_JB9521AA_AS.out has missing data percentage of 9.10587472658426
Sample SAL_JB9710AA_AS.out has missing data percentage of 9.061468322590787
Sample SAL_KA0676AA_AS.out has missing data percentage of 9.242179873107924
Sample SAL_KA0984AA_AS.out has missing data percentage of 9.471722941303195
Sample SAL_KA1119AA_AS.out has missing data percentage of 8.726692945631267
Sample SAL_KA4888AA_AS.out has missing data percentage of 8.44201063191788
Sample SAL_KA5244AA_AS.out has missing data percentage of 8.563196640018942
Sample SAL_KA8881AA_AS.out has missing data percentage of 9.12949474129582
Sample SAL_KB1136AA_AS.out has missing data percentage of 9.740665048006662
Sample SAL_KB1789AA_AS.out has missing data percentage of 10.225059729330546
Sample SAL_KB1826AA_AS.out has missing data percentage of 9.600614081565714
Sample SAL_KB2744AA_AS.out has missing data percentage of 8.646982674127253
Sample SAL_KB3375AA_AS.out has missing data percentage of 9.882986796470002
Sample SAL_KB3640AA_AS.out has missing data percentage of 10.466422509078276
Sample SAL_KB4026AA_AS.out has missing data percentage of 9.36532612893772
Sample SAL_KB4651AA_AS.out has missing data percentage of 10.73258921553215
Sample SAL_KB6210AA_AS.out has missing data percentage of 8.658685935319589
Sample SAL_KB6734AA_AS.out has missing data percentage of 9.85839636209075
Sample SAL_KB6773AA_AS.out has missing data percentage of 10.178615444034927
Sample SAL_KB6830AA_AS.out has missing data percentage of 9.868779852535027
Sample SAL_KB8607AA_AS.out has missing data percentage of 9.896029236803749
Sample SAL_KB8676AA_AS.out has missing data percentage of 9.476206280167922
Sample SAL_KB9523AA_AS.out has missing data percentage of 9.838172816216101
Sample SAL_LA4572AA_AS.out has missing data percentage of 9.725875852271074
Sample SAL_LA7782AA_AS.out has missing data percentage of 9.60434049308964
Sample SAL_LA7787AA_AS.out has missing data percentage of 9.542660619011297
Sample SAL_LB4034AA_AS.out has missing data percentage of 10.404762043393285
Sample SAL_LB7623AA_AS.out has missing data percentage of 10.803895652713972
Sample SAL_LB8076AA_AS.out has missing data percentage of 9.187816963323959
Sample SAL_MA3067AA_AS.out has missing data percentage of 9.319502912229423
Sample SAL_MB2521AA_AS.out has missing data percentage of 9.088329538992433
Sample SAL_MB5439AA_AS.out has missing data percentage of 9.748467222134884
Sample SAL_MB7066AA_AS.out has missing data percentage of 9.143313517363719
Sample SAL_MB7965AA_AS.out has missing data percentage of 9.069076412785472
Sample SAL_NA2865AA_AS.out has missing data percentage of 8.817271917413404
Sample SAL_NA5728AA_AS.out has missing data percentage of 10.90738120607638
Sample SAL_NA8627AA_AS.out has missing data percentage of 9.558575501561405
Sample SAL_NB4129AA_AS.out has missing data percentage of 9.678325288554289
Sample SAL_NB6620AA_AS.out has missing data percentage of 8.722636591420326
Sample SAL_OA4067AA_AS.out has missing data percentage of 8.534743935362286
Sample SAL_OA4072AA_AS.out has missing data percentage of 8.60436184232233
Sample SAL_OB6949AA_AS.out has missing data percentage of 9.932788733815826
Sample SAL_PA3767AA_AS.out has missing data percentage of 9.796619446045638
Sample SAL_PB5476AA_AS.out has missing data percentage of 9.102478257747345
Sample SAL_PB8418AA_AS.out has missing data percentage of 9.957398576588432
Sample SAL_QA4878AA_AS.out has missing data percentage of 9.393468299300716
Sample SAL_QA5436AA_AS.out has missing data percentage of 9.190728222327028
Sample SAL_RA1578AA_AS.out has missing data percentage of 8.545709677607178
Sample SAL_RA1599AA_AS.out has missing data percentage of 8.609815600854745
Sample SAL_SA1324AA_AS.out has missing data percentage of 8.590659516614554
Sample SAL_SA1344AA_AS.out has missing data percentage of 8.55186213830033
Sample SAL_SA2453AA_AS.out has missing data percentage of 9.820918754524582
Sample SAL_SA9173AA_AS.out has missing data percentage of 9.812689595742574
Sample SAL_SA9246AA_AS.out has missing data percentage of 8.718289111309076
Sample SAL_SA9330AA_AS.out has missing data percentage of 11.61027557977723
Sample SAL_TA1544AA_AS.out has missing data percentage of 9.21009779889411
Sample SAL_TA1967AA_AS.out has missing data percentage of 10.550771386593846
Sample SAL_TA2587AA_AS.out has missing data percentage of 9.20928264637325
Sample SAL_TA4227AA_AS.out has missing data percentage of 9.183760609113017
Sample SAL_TA6324AA_AS.out has missing data percentage of 9.734958980360647
Sample SAL_TA7615AA_AS.out has missing data percentage of 9.52146665346896
Sample SAL_UA4237AA_AS.out has missing data percentage of 9.776415308564342
Sample SAL_UA4307AA_AS.out has missing data percentage of 9.206546062910366
Sample SAL_UA6621AA_AS.out has missing data percentage of 9.821209880424888
Sample SAL_UA7988AA_AS.out has missing data percentage of 10.198974848663052
Sample SAL_UA7989AA_AS.out has missing data percentage of 10.314823548591823
Sample SAL_VA1155AA_AS.out has missing data percentage of 10.605289563524641
Sample SAL_VA4537AA_AS.out has missing data percentage of 9.771213859145526
Sample SAL_WA2841AA_AS.out has missing data percentage of 9.439097432075476
Sample SAL_WA5013AA_AS.out has missing data percentage of 9.613113086885555
Sample SAL_WA5463AA_AS.out has missing data percentage of 9.449655598059937
Sample SAL_WA5465AA_AS.out has missing data percentage of 9.397447019938243
Sample SAL_WA6251AA_AS.out has missing data percentage of 9.63065827447738
Sample SAL_WA9926AA_AS.out has missing data percentage of 9.035247583169818
Sample SAL_XA1299AA_AS.out has missing data percentage of 8.870159789302482
Sample SAL_XA1733AA_AS.out has missing data percentage of 10.426402401982761
Sample SAL_XA1782AA_AS.out has missing data percentage of 9.484066679476205
Sample SAL_XA3156AA_AS.out has missing data percentage of 8.573308412956267
Sample SAL_XA3268AA_AS.out has missing data percentage of 9.590579942201805
Sample SAL_YA6600AA_AS.out has missing data percentage of 8.837281970961161
Sample SAL_YA6602AA_AS.out has missing data percentage of 8.97917673477072
Sample SAL_YA6631AA_AS.out has missing data percentage of 10.305255210668406
Sample SAL_YA6663AA_AS.out has missing data percentage of 9.849313234001176
Sample SAL_YA7748AA_AS.out has missing data percentage of 9.836542511174382
Sample SAL_YA9385AA_AS.out has missing data percentage of 10.250698216950903
Sample SAL_ZA0287AA_AS.out has missing data percentage of 10.184321511680942
Sample SAL_ZA5298AA_AS.out has missing data percentage of 9.002039822141484
Sample SAL_ZA8731AA_AS.out has missing data percentage of 9.473916089752175
gubbins /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln
1592275580
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s SG17-135.clean.full.aln.phylip -n SG17-135.clean.full.iteration_1 
1592275974
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpr17uu_yb/rooted_tree.newick -n internal 
1592276018
1592276068
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_1 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592276110
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_1.phylip -n SG17-135.clean.full.iteration_2 -t RAxML_result.SG17-135.clean.full.iteration_1
1592276268
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmpvr1velhw/rooted_tree.newick -n internal 
1592276312
1592276363
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_2 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592276404
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_2.phylip -n SG17-135.clean.full.iteration_3 -t RAxML_result.SG17-135.clean.full.iteration_2
1592276532
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp0twfcd1_/rooted_tree.newick -n internal 
1592276575
1592276626
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_3 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592276666
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_3.phylip -n SG17-135.clean.full.iteration_4 -t RAxML_result.SG17-135.clean.full.iteration_3
1592276787
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmprh32vh13/rooted_tree.newick -n internal 
1592276830
1592276881
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_4 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592276922
Tree building command: raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V 
raxmlHPC-AVX2 -f d -p 1 -m GTRCAT -V  -s RAxML_result.SG17-135.clean.full.iteration_4.phylip -n SG17-135.clean.full.iteration_5 -t RAxML_result.SG17-135.clean.full.iteration_4
1592277041
Internal sequence reconstruction command: raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA 
raxmlHPC-AVX2 -f A -p 1 -m GTRGAMMA   -s /data/malcummi/pipelord/snplord/SG17-135.clean.full.aln.snp_sites.aln -t /data/malcummi/pipelord/snplord/tmp5xunrnsu/rooted_tree.newick -n internal 
1592277084
1592277134
gubbins -r -v SG17-135.clean.full.aln.gaps.vcf -a 100 -b 10000 -f /data/malcummi/pipelord/snplord/tmpdpa44y3n/SG17-135.clean.full.aln -t RAxML_result.SG17-135.clean.full.iteration_5 -m 3 SG17-135.clean.full.aln.gaps.snp_sites.aln
1592277176
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.tab regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1 regex:^RAxML_result.SG17-135.clean.full.iteration_1$
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.gff regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.gff regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.gff regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_2 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4 regex:^RAxML_result.SG17-135.clean.full.iteration_4$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.gff regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_info.SG17-135.clean.full.iteration_3 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.stats regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_log.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_4 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.stats regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.stats regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_bestTree.SG17-135.clean.full.iteration_5 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.tab regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.snp_sites.aln regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3 regex:^RAxML_result.SG17-135.clean.full.iteration_3$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.tab regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2 regex:^RAxML_result.SG17-135.clean.full.iteration_2$
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.tab regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_4.branch_snps.tab regex:^RAxML_result.SG17-135.clean.full.iteration_4\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_2.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_2\.
Deleting file: ./RAxML_parsimonyTree.SG17-135.clean.full.iteration_1 regex:^RAxML_(bestTree|info|log|parsimonyTree).SG17-135.clean.full.iteration_
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.phylip regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_3.stats regex:^RAxML_result.SG17-135.clean.full.iteration_3\.
Deleting file: ./RAxML_result.SG17-135.clean.full.iteration_1.vcf regex:^RAxML_result.SG17-135.clean.full.iteration_1\.
Deleting file: ./SG17-135.clean.full.aln.phylip regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.vcf regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.vcf regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.start regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.phylip regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.snp_sites.aln regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
Deleting file: ./SG17-135.clean.full.aln.gaps.snp_sites.aln regex:^SG17-135.clean.full.aln.(gaps|vcf|snp_sites|phylip|start)
[Tue Jun 16 13:13:02 2020]
Finished job 199.
198 of 202 steps (98%) done

[Tue Jun 16 13:13:02 2020]
rule snp_sites:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/gubbins/SG17-135.filtered_polymorphic_sites.fasta
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln
    jobid: 198
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32

snp-sites -c /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/gubbins/SG17-135.filtered_polymorphic_sites.fasta > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/88bf0609
[Tue Jun 16 13:13:03 2020]
Finished job 198.
199 of 202 steps (99%) done

[Tue Jun 16 13:13:03 2020]
rule snp_dists:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_dists/SG17-135.pairwise_snps.csv
    jobid: 197
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32

snp-dists -c /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_dists/SG17-135.pairwise_snps.csv
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/4ead7ed0
This is snp-dists 0.6.3
Read 196 sequences of length 1791
[Tue Jun 16 13:13:03 2020]
Finished job 197.
200 of 202 steps (99%) done

[Tue Jun 16 13:13:03 2020]
rule fasttree:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln
    output: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/fasttree/SG17-135.clean.fullcore.tree
    jobid: 196
    wildcards: output_prefix=Agona_200, reference=SG17-135
    threads: 32

fasttree -gtr -nt /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln > /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/fasttree/SG17-135.clean.fullcore.tree
Activating conda environment: /data/malcummi/pipelord/snplord/.snakemake/conda/89835887
FastTree Version 2.1.10 Double precision (No SSE3)
Alignment: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_sites/SG17-135.clean.fullcore.aln
Nucleotide distances: Jukes-Cantor Joins: balanced Support: SH-like 1000
Search: Normal +NNI +SPR (2 rounds range 10) +ML-NNI opt-each=1
TopHits: 1.00*sqrtN close=default refresh=0.80
ML Model: Generalized Time-Reversible, CAT approximation with 20 rate categories
      0.10 seconds: Joined    100 of    175
Initial topology in 0.15 seconds
Refining topology: 30 rounds ME-NNIs, 2 rounds ME-SPRs, 15 rounds ML-NNIs
      0.21 seconds: ME NNI round 5 of 30, 1 of 176 splits
      0.40 seconds: SPR round   1 of   2, 101 of 354 nodes
      0.58 seconds: SPR round   1 of   2, 201 of 354 nodes
      0.71 seconds: SPR round   1 of   2, 301 of 354 nodes
      0.91 seconds: SPR round   2 of   2, 101 of 354 nodes
      1.11 seconds: SPR round   2 of   2, 201 of 354 nodes
      1.27 seconds: SPR round   2 of   2, 301 of 354 nodes
Total branch-length 1.023 after 1.38 sec
      1.38 seconds: ML Lengths 1 of 176 splits
      1.51 seconds: ML NNI round 1 of 15, 1 of 176 splits
      1.80 seconds: ML NNI round 1 of 15, 101 of 176 splits, 26 changes (max delta 0.000)
ML-NNI round 1: LogLk = -15163.878 NNIs 45 max delta 0.00 Time 2.05
      2.04 seconds: Optimizing GTR model, step 1 of 12
      2.19 seconds: Optimizing GTR model, step 2 of 12
      2.37 seconds: Optimizing GTR model, step 3 of 12
      2.48 seconds: Optimizing GTR model, step 4 of 12
      2.72 seconds: Optimizing GTR model, step 5 of 12
      2.89 seconds: Optimizing GTR model, step 6 of 12
      3.02 seconds: Optimizing GTR model, step 7 of 12
      3.13 seconds: Optimizing GTR model, step 8 of 12
      3.24 seconds: Optimizing GTR model, step 9 of 12
      3.35 seconds: Optimizing GTR model, step 10 of 12
      3.49 seconds: Optimizing GTR model, step 11 of 12
      3.60 seconds: Optimizing GTR model, step 12 of 12
GTR Frequencies: 0.1664 0.3477 0.3431 0.1428
GTR rates(ac ag at cg ct gt) 1.1403 3.4124 1.6105 0.1593 3.6109 1.0000
      3.72 seconds: ML Lengths 1 of 176 splits
      3.83 seconds: ML Lengths 101 of 176 splits
      3.93 seconds: Site likelihoods with rate category 2 of 20
      4.04 seconds: Site likelihoods with rate category 10 of 20
      4.14 seconds: Site likelihoods with rate category 18 of 20
Switched to using 20 rate categories (CAT approximation)
Rate categories were divided by 0.786 so that average rate = 1.0
CAT-based log-likelihoods may not be comparable across runs
Use -gamma for approximate but comparable Gamma(20) log-likelihoods
      4.48 seconds: ML NNI round 2 of 15, 101 of 176 splits, 14 changes (max delta 0.000)
ML-NNI round 2: LogLk = -14540.277 NNIs 22 max delta 0.00 Time 4.76
Turning off heuristics for final round of ML NNIs (converged)
      4.75 seconds: ML NNI round 3 of 15, 1 of 176 splits
      5.19 seconds: ML NNI round 3 of 15, 101 of 176 splits, 0 changes
ML-NNI round 3: LogLk = -14539.850 NNIs 1 max delta 0.00 Time 5.51 (final)
      5.51 seconds: ML Lengths 1 of 176 splits
      5.62 seconds: ML Lengths 101 of 176 splits
Optimize all lengths: LogLk = -14539.850 Time 5.71
      6.33 seconds: ML split tests for    100 of    175 internal splits
Total time: 6.76 seconds Unique: 178/196 Bad splits: 0/175
[Tue Jun 16 13:13:11 2020]
Finished job 196.
201 of 202 steps (100%) done

[Tue Jun 16 13:13:11 2020]
localrule all:
    input: /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB0648AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5376AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7197AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA2587AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB6160AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9822AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA8052AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5674AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB5660AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6631AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0088AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1136AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5642AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4431AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7782AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA8627AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB1406AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6687AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7945AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5465AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA0287AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2593AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA9385AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB1150AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2131AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1956AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3640AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5909AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA5728AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9118AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6779AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB5876AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB2895AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6830AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1790AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA1155AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB6699AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB6620AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA8731AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9243AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB9302AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB6441AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9246AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7066AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB3115AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4026AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9330AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9086AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1153AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB2744AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2899AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA7787AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA7748AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB8076AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1733AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2219AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0676AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_DB1444AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7261AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4744AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA4227AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB3375AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5062AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4921AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EA3229AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA4878AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9835AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA4888AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1599AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB6250AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA8881AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5379AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1344AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB0953AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NB4129AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2598AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9820AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4083AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA9173AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3268AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB4088AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB8845AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB5439AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB6580AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OB6949AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB4651AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6773AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB3127AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB8884AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7989AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7534AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3497AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5468AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB0225AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA7932AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4072AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1826AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB0053AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4524AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA3156AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6663AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1371AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6210AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2237AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB1324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB1789AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB5769AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB9523AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA5706AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8676AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7634AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7588AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA7988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB7542AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB4937AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB4034AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB8607AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB6801AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4728AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1782AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA1940AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4307AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7996AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA0984AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9988AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1045AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA9926AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7947AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB2521AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1915AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LB7623AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5195AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_RA1578AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA6251AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6602AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB5050AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_HB2224AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PA3767AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KB6734AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2970AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FA2493AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA7615AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1967AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB8051AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB1026AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA5244AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_YA6600AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB3409AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BA5105AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MB7965AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB9562AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB2967AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_ZA5298AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB4414AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5013AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_XA1299AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IB7540AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB9321AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JA4169AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB8418AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_FB7879AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB7027AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CA4803AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8331AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_LA4572AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA2453AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1424AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_VA4537AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA6324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_PB5476AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_QA5436AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9710AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB1066AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_OA4067AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2372AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB2669AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_EB6812AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_SA1324AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_GB5373AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA6621AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB9389AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_TA1544AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA5463AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_CB5243AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_AB5906AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_KA1119AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB5221AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_IA5065AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_BB8135AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_UA4237AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_NA2865AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_JB9521AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_WA2841AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snippyout/SG17-135/SAL_MA3067AA_AS.out, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/fasttree/SG17-135.clean.fullcore.tree, /home/malcummi/Data/Manuscripts/Salmonella_AMR/Agona_assemblies/analysis/snp/Agona_200/snp_dists/SG17-135.pairwise_snps.csv
    jobid: 0

[Tue Jun 16 13:13:11 2020]
Finished job 0.
202 of 202 steps (100%) done
Complete log: /data/malcummi/pipelord/snplord/.snakemake/log/2020-06-16T123349.254004.snakemake.log
['SAL_BB0648AA_AS', 'SAL_CB5376AA_AS', 'SAL_BB7197AA_AS', 'SAL_TA2587AA_AS', 'SAL_AB6160AA_AS', 'SAL_CB9822AA_AS', 'SAL_BA8052AA_AS', 'SAL_AB5674AA_AS', 'SAL_HB5660AA_AS', 'SAL_YA6631AA_AS', 'SAL_CB0088AA_AS', 'SAL_KB1136AA_AS', 'SAL_AB5642AA_AS', 'SAL_BB4431AA_AS', 'SAL_LA7782AA_AS', 'SAL_NA8627AA_AS', 'SAL_IB1406AA_AS', 'SAL_BB6687AA_AS', 'SAL_BA7945AA_AS', 'SAL_WA5465AA_AS', 'SAL_ZA0287AA_AS', 'SAL_BB2593AA_AS', 'SAL_YA9385AA_AS', 'SAL_JB1150AA_AS', 'SAL_BB2131AA_AS', 'SAL_BB1956AA_AS', 'SAL_KB3640AA_AS', 'SAL_AB5909AA_AS', 'SAL_NA5728AA_AS', 'SAL_IB9118AA_AS', 'SAL_IB6779AA_AS', 'SAL_EB5876AA_AS', 'SAL_EB2895AA_AS', 'SAL_KB6830AA_AS', 'SAL_CB1790AA_AS', 'SAL_VA1155AA_AS', 'SAL_HB6699AA_AS', 'SAL_NB6620AA_AS', 'SAL_ZA8731AA_AS', 'SAL_CB9243AA_AS', 'SAL_IB9302AA_AS', 'SAL_BB6441AA_AS', 'SAL_SA9246AA_AS', 'SAL_MB7066AA_AS', 'SAL_IB3115AA_AS', 'SAL_KB4026AA_AS', 'SAL_SA9330AA_AS', 'SAL_BB9086AA_AS', 'SAL_CB1153AA_AS', 'SAL_KB2744AA_AS', 'SAL_BB2899AA_AS', 'SAL_LA7787AA_AS', 'SAL_YA7748AA_AS', 'SAL_LB8076AA_AS', 'SAL_XA1733AA_AS', 'SAL_HB2219AA_AS', 'SAL_KA0676AA_AS', 'SAL_BB9988AA_AS', 'SAL_DB1444AA_AS', 'SAL_BB7261AA_AS', 'SAL_CA4744AA_AS', 'SAL_TA4227AA_AS', 'SAL_KB3375AA_AS', 'SAL_BB5062AA_AS', 'SAL_BB4921AA_AS', 'SAL_EA3229AA_AS', 'SAL_QA4878AA_AS', 'SAL_CB9835AA_AS', 'SAL_KA4888AA_AS', 'SAL_RA1599AA_AS', 'SAL_CB6250AA_AS', 'SAL_KA8881AA_AS', 'SAL_CB5379AA_AS', 'SAL_SA1344AA_AS', 'SAL_JB0953AA_AS', 'SAL_NB4129AA_AS', 'SAL_CB2598AA_AS', 'SAL_CB9820AA_AS', 'SAL_EB4083AA_AS', 'SAL_SA9173AA_AS', 'SAL_XA3268AA_AS', 'SAL_EB4088AA_AS', 'SAL_EB8845AA_AS', 'SAL_MB5439AA_AS', 'SAL_JB6580AA_AS', 'SAL_OB6949AA_AS', 'SAL_KB4651AA_AS', 'SAL_KB6773AA_AS', 'SAL_BB3127AA_AS', 'SAL_AB8884AA_AS', 'SAL_UA7989AA_AS', 'SAL_AB7534AA_AS', 'SAL_CB3497AA_AS', 'SAL_CB5468AA_AS', 'SAL_GB0225AA_AS', 'SAL_BA7932AA_AS', 'SAL_OA4072AA_AS', 'SAL_KB1826AA_AS', 'SAL_CB0053AA_AS', 'SAL_BB4524AA_AS', 'SAL_XA3156AA_AS', 'SAL_YA6663AA_AS', 'SAL_BB1371AA_AS', 'SAL_KB6210AA_AS', 'SAL_HB2237AA_AS', 'SAL_CB1324AA_AS', 'SAL_KB1789AA_AS', 'SAL_FB5769AA_AS', 'SAL_KB9523AA_AS', 'SAL_FA5706AA_AS', 'SAL_KB8676AA_AS', 'SAL_AB7634AA_AS', 'SAL_AB7588AA_AS', 'SAL_UA7988AA_AS', 'SAL_AB7542AA_AS', 'SAL_BB4937AA_AS', 'SAL_LB4034AA_AS', 'SAL_KB8607AA_AS', 'SAL_IB6801AA_AS', 'SAL_CA4728AA_AS', 'SAL_XA1782AA_AS', 'SAL_FA1940AA_AS', 'SAL_UA4307AA_AS', 'SAL_IB7996AA_AS', 'SAL_KA0984AA_AS', 'SAL_CB9988AA_AS', 'SAL_EB1045AA_AS', 'SAL_WA9926AA_AS', 'SAL_BB7947AA_AS', 'SAL_MB2521AA_AS', 'SAL_BB1915AA_AS', 'SAL_LB7623AA_AS', 'SAL_JB5195AA_AS', 'SAL_RA1578AA_AS', 'SAL_WA6251AA_AS', 'SAL_YA6602AA_AS', 'SAL_BB5050AA_AS', 'SAL_HB2224AA_AS', 'SAL_PA3767AA_AS', 'SAL_KB6734AA_AS', 'SAL_BB2970AA_AS', 'SAL_FA2493AA_AS', 'SAL_TA7615AA_AS', 'SAL_TA1967AA_AS', 'SAL_FB8051AA_AS', 'SAL_EB1026AA_AS', 'SAL_KA5244AA_AS', 'SAL_YA6600AA_AS', 'SAL_CB3409AA_AS', 'SAL_BA5105AA_AS', 'SAL_MB7965AA_AS', 'SAL_BB9562AA_AS', 'SAL_BB2967AA_AS', 'SAL_ZA5298AA_AS', 'SAL_JB4414AA_AS', 'SAL_WA5013AA_AS', 'SAL_XA1299AA_AS', 'SAL_IB7540AA_AS', 'SAL_AB9321AA_AS', 'SAL_JA4169AA_AS', 'SAL_PB8418AA_AS', 'SAL_FB7879AA_AS', 'SAL_BB7027AA_AS', 'SAL_CA4803AA_AS', 'SAL_BB8331AA_AS', 'SAL_LA4572AA_AS', 'SAL_SA2453AA_AS', 'SAL_BB1424AA_AS', 'SAL_VA4537AA_AS', 'SAL_TA6324AA_AS', 'SAL_PB5476AA_AS', 'SAL_QA5436AA_AS', 'SAL_JB9710AA_AS', 'SAL_BB1066AA_AS', 'SAL_OA4067AA_AS', 'SAL_CB2372AA_AS', 'SAL_CB2669AA_AS', 'SAL_EB6812AA_AS', 'SAL_SA1324AA_AS', 'SAL_GB5373AA_AS', 'SAL_UA6621AA_AS', 'SAL_CB9389AA_AS', 'SAL_TA1544AA_AS', 'SAL_WA5463AA_AS', 'SAL_CB5243AA_AS', 'SAL_AB5906AA_AS', 'SAL_KA1119AA_AS', 'SAL_JB5221AA_AS', 'SAL_IA5065AA_AS', 'SAL_BB8135AA_AS', 'SAL_UA4237AA_AS', 'SAL_NA2865AA_AS', 'SAL_JB9521AA_AS', 'SAL_WA2841AA_AS', 'SAL_MA3067AA_AS']
['SG17-135']
